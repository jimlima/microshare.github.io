(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["448"],{2531:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(14),s=n(1383),o=n(1407),u=n(1388),a=n(1436),f=n(1404),l=n(1562),c=n(33),h=n(122);Object(h.n)([{rawString:".od-RemoveFromSharedList-Status{padding-top:5px}.od-RemoveFromSharedList-Status--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}"}]);var p=n(1361),d=n(2209),v=n(1371),m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{})||this;n.allowSpam=!!t.isSpam;n.isSpam=t.isSpam;n.status=t.status;n.hasError=t.hasError;var r=t.selection;t.hasError()?n.subText="":t.removeAccess?n.subText=r.length>1?d.e.itemsSubText:r[0].type===v.e.File?d.e.fileSubText:d.e.folderSubText:n.subText=r.length>1?d.e.itemsSubTextWithAccess:r[0].type===v.e.File?d.e.fileSubTextWithAccess:d.e.folderSubTextWithAccess;n.spamText=r.length>1?d.e.itemsSpamText:r[0].type===v.e.File?d.e.fileSpamText:d.e.folderSpamText;return n}return t})(p.t),g=n(1363).e({tagName:"ms-remove-from-sharedlist",template:'<div class="od-RemoveFromSharedList"><div class="od-RemoveFromSharedList-SubText" data-bind="text:subText"></div><span data-bind="if:allowSpam"><input id="RemoveFromSharedList-isSpam" type="checkbox" name="isSpam" class="od-isSpam" data-bind="checked:isSpam"><label for="RemoveFromSharedList-isSpam" class="spamText" data-bind="text:spamText"></label></span><div class="od-RemoveFromSharedList-Status" data-bind="text:status,css:{\'od-RemoveFromSharedList-Status--error\':hasError}"></div></div>',viewModel:m,synchronous:!0}),y=n(25),b=n(41),w=n(502),E=n(1378),S=n(345),x=n(1225),T=n(87),N=n(1377),C=n(1367),k=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources;n.name="RemoveFromSharedList";n._operationProvider=r.consume(o.e);n._urlDataSource=r.consume(T.ge);n._dialogProvider=r.consume(s.e);n._itemProvider=r.consume(x.resourceKey);n._engagement=r.consume(S.e);n._itemSelectionHelper=new(n.child(N.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return n}t.prototype.onIsAvailable=function(){if(!Object(w.isFeatureEnabled)(w.RemoveFromSharedList))return!1;var e=this._itemSelectionHelper.currentItem();if(!this._urlDataSource.isCurrentQuery(b.e.SharedWithMe,this._urlDataSource.getKeyParams(e.key)))return!1;var t=this._itemSelectionHelper.firstItem();return!(!t||t.queryType!==b.e.SharedWithMe)};t.prototype.onExecute=function(){return Object(r.__awaiter)(this,void 0,i.n,function(){var e,t,n,s,o,a,f=this;return Object(r.__generator)(this,function(h){switch(h.label){case 0:e=this.observables;return[4,this._itemSelectionHelper.resolveSelection()];case 1:t=h.sent();n=e.create("");s=e.create(!1);o=e.create(!0);a=function(e){return Object(r.__awaiter)(f,void 0,i.n,function(){return Object(r.__generator)(this,function(t){s(!0);n(e);return[2,1]})})};if(t.length>14){a(y.format(d.e.errorTooManyItems,14));o(!1);this._engagement.logData({name:"RemoveFromSharedList.TooManyItems",extraData:{itemCount:t.length}})}return[4,this._dialogProvider.requestDialog({title:t.length>1?d.e.itemsTitleWithAccess:t[0].type===v.e.File||t[0].type===v.e.Media?d.e.fileTitleWithAccess:d.e.folderTitleWithAccess,component:{name:g.tagName,params:{isSpam:null,selection:t,removeAccess:!1,hasError:s,status:n}},actions:[{name:d.e.actionText,execute:function(){return Object(r.__awaiter)(f,void 0,i.n,function(){var e,n,i,s,o=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e=new l.e;n=t.map(function(t){return o._operationProvider.register({name:t.displayName,type:u.e.removeFromSharedList,batch:e})});r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this._itemProvider.removeFromSharedList({items:t,markAsSpam:!1,parentKey:this._urlDataSource.getRootItemKey(b.e.SharedWithMe)})];case 2:if(i=r.sent())for(s=0;s<i.length;s++)L(i[s],n[s]);return[3,4];case 3:r.sent();for(s=0;s<n.length;s++)L(d.e.errorText,n[s]);return[3,4];case 4:return[2,2]}})})},isAvailable:o,isDefault:!0,icon:new E.e("Cancel"),automationId:"removeFromSharedListConfirm"}]}).wait()];case 2:h.sent();return[2,{resultType:c.e.Success}]}})})};return t})(C.e);t.default=k;function L(e,t){if(e){t.error(new a.e({message:e}));t.state(f.e.failed)}else t.state(f.e.completed)}}}]);
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-shared-react"],{505:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(2595),s=n(7),o=(function(){function e(e,t){this._componentType=e;this.dependencies=Object(r.__assign)(Object(r.__assign)({},e.dependencies||{}),t||{})}e.prototype.create=function(e){return{instance:Object(i.t)(this._componentType,e)}};return e})();(function(){function e(e,t){this._statelessComponent=e;this.dependencies=t}e.prototype.create=function(e){return{instance:Object(i.n)(this._statelessComponent,e)}}})();function u(e,t,n){return new s.t({name:e,factory:new o(t,n)})}},1292:function(e,t,n){"use strict";n.r(t);var r=n(40),i=n(145),s=n(935),o=r.n.isFeatureEnabled({ODB:1556}),u=(function(){function e(){}e.registerContentElement=function(t){if(e===Object(s.n)()){if(t!==e._contentElement){e._contentElement&&e._contentElement.removeEventListener("scroll",e._onScroll);e._contentElement=t;if(t)e._manageEventAttachment();else{e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}})}}}else Object(s.n)().registerContentElement(t)};e.registerCallbacks=function(t){if(e===Object(s.n)()){if(e._callbacks.indexOf(t)<0){e._callbacks.push(t);e._totalHeightDifference+=t.heightDifference;try{e._contentElement&&(e._contentElement.scrollTop-=t.heightDifference);this._isShyMode&&t.onShy()}catch(e){}e._manageEventAttachment();return!0}return!1}Object(s.n)().registerCallbacks(t)};e.unregisterCallback=function(t){if(e===Object(s.n)()){var n=e._callbacks.indexOf(t);if(n>=0){var r=e._callbacks[n];try{if(e._isShyMode){e._contentElement&&(e._contentElement.scrollTop+=r.heightDifference);r.onUnshy()}}catch(e){}e._totalHeightDifference-=r.heightDifference;e._callbacks.splice(n,1);e._manageEventAttachment();return!0}return!1}Object(s.n)().unregisterCallback(t)};e.unshy=function(){if(e===Object(s.n)()){e._enabledEventSent=!1;e._onShyEventSent=!1;e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}})}else Object(s.n)().unshy()};e._manageEventAttachment=function(){if(e.enabled&&e._contentElement){e._contentElement.removeEventListener("scroll",e._onScroll);e._contentElement.removeEventListener("mousedown",e._onMouseDown);e._contentElement.removeEventListener("mouseup",e._onMouseUp);if(e._callbacks.length){e._contentElement.addEventListener("scroll",e._onScroll);e._contentElement.addEventListener("mousedown",e._onMouseDown);e._contentElement.addEventListener("mouseup",e._onMouseUp);if(!e._enabledEventSent&&e._contentElement.scrollHeight-e._contentElement.clientHeight>e.scrollThresholdDown+e._totalHeightDifference){i.e.logData({name:"ShyConductor.Enabled"});e._enabledEventSent=!0}}}};e._onScroll=function(t){e._queueScrollEvent=!0;if(!e._isMouseDown){window.clearTimeout(e._handleScrollTimeoutId);e._handleScrollTimeoutId=window.setTimeout(e._handleScroll,25)}};e._onMouseDown=function(t){e._isMouseDown=!0};e._onMouseUp=function(t){e._isMouseDown=!1;e._queueScrollEvent&&e._handleScroll()};e._handleScroll=function(){if(e._queueScrollEvent){e._queueScrollEvent=!1;var t=e._contentElement.scrollTop-e._lastScrollPosition;if(t>=0&&!e._isShyMode){e._scrolledAmountConsecutively>=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t;if(e._scrolledAmountConsecutively>e.scrollThresholdDown&&e._contentElement.scrollTop-e._totalHeightDifference>e.scrollThresholdDown){if(!e._enabledEventSent){e._enabledEventSent=!0;i.e.logData({name:"ShyConductor.DelayedEnabled"})}if(!e._onShyEventSent){e._onShyEventSent=!0;i.e.logData({name:"ShyConductor.OnShy"})}e._isShyMode=!0;e._callbacks.forEach(function(e){try{e.onShy()}catch(e){}});e._contentElement.scrollTop-=e._totalHeightDifference}}else if(t<0&&e._isShyMode){e._scrolledAmountConsecutively<=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t;if(-e._scrolledAmountConsecutively>e.scrollThresholdUp||e._contentElement.scrollTop<e.scrollThresholdDown){e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}});e._contentElement.scrollTop+=e._totalHeightDifference}}e._lastScrollPosition=e._contentElement.scrollTop}};e.scrollThresholdDown=300;e.scrollThresholdUp=500;e.enabled=o;e._callbacks=[];e._totalHeightDifference=0;e._isShyMode=!1;e._lastScrollPosition=0;e._scrolledAmountConsecutively=0;e._isMouseDown=!1;e._queueScrollEvent=!1;e._enabledEventSent=!1;e._onShyEventSent=!1;return e})();t.default=u;Object(s.n)()||(window[s.e]=u)},1519:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(1);function s(e,t,n,s){var o=e.split("{0}");s=Object(r.__assign)({key:"key"},s||{});return[o[0],i.createElement(n,s,t),o[1]]}},1679:function(e,t,n){"use strict";n.r(t);n.d(t,"SiteScriptProgressIndicator",function(){return p});var r=n(0),i=n(1),s=n(1357),o=n(83),u=n(1356),a=n(145),f=n(1639),l=n(3335),c=n(108),h=Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("208")]).then(n.bind(null,3668))];case 1:return[2,e.sent().SiteScriptProgressPanel]}})})}),p=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onNewDataReceived=function(e){if(e.isSiteDesignPending&&!n._firstRunPanelExperience){a.e.logData({name:"SiteScripts.BarAppeared"});n._firstRunPanelExperience=!0}n.setState({isComplete:n._siteScriptProgressStateManager.isRunComplete(e.displayedRunKey),isVisible:e.isSiteDesignPending})};n._onOpenPanelAction=function(e){a.e.logData({name:"SiteScripts.OpenPanelFromGear.Click"});n.state.isPanelOpen||n.setState({isPanelOpen:!0})};n._onClickOpenPanel=function(e){a.e.logData({name:"SiteScripts.OpenPanelFromBar.Click"});n.setState({isPanelOpen:!0});e.stopPropagation();e.preventDefault()};n._onClickRefreshPage=function(e){a.e.logData({name:"SiteScripts.RefreshFromBar.Click"});window.location.href=n.props.pageContext?n.props.pageContext.webServerRelativeUrl:window.location.href};n._onPanelDismissed=function(){n.setState({isPanelOpen:!1})};n.state={isPanelOpen:!1,isComplete:!1,isVisible:!1};n._siteScriptProgressStateManager=f.SiteScriptProgressStateManager.getInstance({pageContext:t.pageContext});n._panelWasEverOpen=!1;n._firstRunPanelExperience=!1;return n}t.prototype.componentDidMount=function(){this._siteScriptProgressManagerKey="SiteScriptProgressIndicator"+Math.random().toString();this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.newProgressData,this._onNewDataReceived);this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.openPanelAction,this._onOpenPanelAction)};t.prototype.componentWillUnmount=function(){this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.newProgressData);this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.openPanelAction)};t.prototype.render=function(){this._panelWasEverOpen=this._panelWasEverOpen||this.state.isPanelOpen;var e;if(this.state.isVisible||this._siteScriptProgressStateManager.getState().isSiteDesignPending)if(this.state.isComplete){3!==(a=l.e.SiteScriptProgressIndicatorCompleteText.split(/{[01]}/)).length&&(a=[l.e.SiteScriptProgressIndicatorCompleteText,"",""]);var t=i.createElement(u.e,{onClick:this._onClickOpenPanel,"data-automationid":"SiteScriptProgressOpenPanelLink"},l.e.SiteScriptProgressIndicatorViewLink),n=i.createElement(u.e,{onClick:this._onClickRefreshPage},l.e.SiteScriptProgressIndicatorCompleteLink),r=void 0;r=l.e.SiteScriptProgressIndicatorCompleteText.indexOf("{0}")<=l.e.SiteScriptProgressIndicatorCompleteText.indexOf("{1}")?[t,n]:[n,t];e=i.createElement(s.e,{messageBarType:o.e.warning},a[0],r[0],a[1],r[1],a[2])}else{var a;2!==(a=l.e.SiteScriptProgressIndicatorIncompleteText5.split("{0}")).length&&(a=[l.e.SiteScriptProgressIndicatorIncompleteText5,""]);e=i.createElement(s.e,{messageBarType:o.e.warning},a[0],i.createElement(u.e,{onClick:this._onClickOpenPanel,"data-automationid":"SiteScriptProgressOpenPanelLink"},l.e.SiteScriptProgressIndicatorViewProgressLink5),a[1])}else{if(!this._panelWasEverOpen)return null;e=void 0}return i.createElement("div",null,e,i.createElement(h,{onDismissed:this._onPanelDismissed,siteScriptProgressStateManager:this._siteScriptProgressStateManager,isOpen:this.state.isPanelOpen,firstRunPanelExperience:this._firstRunPanelExperience,responsiveMode:this.props.responsiveMode,imageUrls:this.props.imageUrls,pageContext:this.props.pageContext}))};return t})(i.Component)},1860:function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(36),o=n(860),u=n(1227),a=n(1243),f=n(854),l=n(3664),c=n(2257),h=n(716),p=n(1356),d=n(1267),v="teamsIcon_940a0a6b",m="infoIcon_940a0a6b",g="tooltip_940a0a6b",y="createTeamText_940a0a6b",b="description_940a0a6b",w=n(3498),E=n(1519),S=n(145),x=n(3685),T=n(25),N=n(3076),C=n(1245),k=n(303),L=n(15),A=n(40),O=n(82);n.d(t,"e",function(){return D});var M=i.lazy(function(){return n.e("129").then(n.bind(null,3904))}),_={ODB:1936},D=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._hideTeamifyKillswitch=!1;n._renderTooltipContent=function(){return A.n.isFeatureEnabled(_)?i.createElement("div",{className:g},w.e.toolTipContent):i.createElement("div",{className:g},w.e.teamsDescription1,i.createElement("br",null),i.createElement("br",null),Object(E.e)(w.e.teamsDescription2,w.e.createTeam,"span",{className:y}))};n._onHideTeamifyBanner=function(){new x.e({pageContext:n.props.pageContext}).hideTeamifyBanner();S.e.logData({name:"TeamifyBanner.Hide",isIntentional:!0});n.setState({hasDismissed:!0});n._onCloseHideTeamifyDialog()};n._onDismissTeamifyBanner=function(){var e=new x.e({pageContext:n.props.pageContext});S.e.logData({name:"TeamifyBanner.DismissPermanently",isIntentional:!0});e.dismissTeamifyBanner().then(function(){n._onCloseHideTeamifyDialog();n.setState({hasDismissed:!0})})};n._onClick=function(){n.setState({hasClickedLink:!0});if(A.n.isFeatureEnabled(_)){n._teamifyQos=new O.e({name:"TeamifyWizardLoader.Load"});n._toggleTeamify()}else{new x.e({pageContext:n.props.pageContext}).teamify().done(function(e){void 0!==e?n.setState({responseHasFailure:!1,responseHasSuccess:!0,teamUrl:e}):n.setState({responseHasFailure:!0})},function(e){n.setState({responseHasFailure:!0})})}S.e.logData({name:"TeamifyBanner.Click",isIntentional:!0})};n._onCloseHideTeamifyDialog=function(){n.setState({hideTeamifyDialogOpen:!1})};n._onOpenHideTeamifyDialog=function(){S.e.logData({name:"TeamifyBanner.OpenHideDialog",isIntentional:!0});n.setState({hideTeamifyDialogOpen:!0})};n._logClick=function(){n.setState({hasClickedLink:!0});S.e.logData({name:"TeamifyBanner.Click",isIntentional:!0})};n._toggleTeamify=function(){n.setState(function(e){return{showTeamifyWizard:!e.showTeamifyWizard}})};n.state={};n._createUrl=t.pageContext.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?Target=TEAM&Create=TRUE";n._usePostmethod=!L.e.isActivated("67615EE2-7930-41EE-A90D-4D174AB85A58","01/15/2019","Enable Teamify through POST method only.");n._hideTeamifyKillswitch=L.e.isActivated("61F9968C-D778-4963-9A95-573BC29B5CBF","02/03/2019","Enable Hide teamify banner");return n}t.prototype.render=function(){var e;if(!this._hideTeamifyKillswitch){if(this.state.hasDismissed)return null;e=[i.createElement(u.e,{className:"hideTeamifyButton_940a0a6b",ariaLabel:w.e.hideTeamifyButtonAriaLabel,iconProps:{iconName:"ChromeClose",className:"hideTeamifyIcon_940a0a6b"},onClick:this._onOpenHideTeamifyDialog}),this._renderHideTeamifyDialog()]}if(A.n.isFeatureEnabled(_)){var t=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:m,tabIndex:0}));return i.createElement("div",null,i.createElement("div",{className:Object(s.e)(this.props.className,"teamifyBanner_940a0a6b")},e,i.createElement("div",{className:"titleWrapper_940a0a6b"},i.createElement(h.e,{className:v,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_940a0a6b"},w.e.title)),i.createElement("div",{className:b},w.e.teamifyDescription,!this._hideTeamifyKillswitch&&i.createElement("span",{className:"toolTipContainer_940a0a6b"},t),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_940a0a6b"},w.e.linkDescription))),this.state.showTeamifyWizard&&i.createElement(i.Suspense,{fallback:null},i.createElement(M,{pageContext:this.props.pageContext,onDismiss:this._toggleTeamify,entryPoint:N.e.TeamifyBanner,strings:this.props.teamifyStrings,qos:this._teamifyQos})))}if(this._usePostmethod){var n="Microsoft Teams",r=(t=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:m,tabIndex:0,ariaLabel:n+". "+w.e.description})),void 0);this.state.hasClickedLink?this.state.responseHasFailure||this.state.responseHasSuccess?this.state.responseHasFailure?r=i.createElement("div",{className:b},w.e.error):this.state.responseHasSuccess&&(r=i.createElement("div",{className:b},i.createElement(p.e,{href:this.state.teamUrl,target:"_blank"},w.e.visitTeam))):r=i.createElement("div",{className:b},w.e.description,i.createElement("br",null),i.createElement(C.e,{size:k.e.xSmall,className:"teamifySpinner_940a0a6b teamifySpinner_940a0a6b"})," ",w.e.creating):r=i.createElement("div",{className:b},w.e.description,!this._hideTeamifyKillswitch&&i.createElement("span",{className:"toolTipContainer_940a0a6b"},t),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_940a0a6b"},w.e.createTeam));return i.createElement("div",{className:Object(s.e)(this.props.className,"teamifyBanner_940a0a6b")},e,i.createElement("div",{className:"titleWrapper_940a0a6b"},i.createElement(h.e,{className:v,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_940a0a6b"},n),this._hideTeamifyKillswitch&&t),r)}if(this.state.hasClickedLink)return null;n="Microsoft Teams";return i.createElement("div",{className:Object(s.e)(this.props.className,"teamifyBanner_940a0a6b")},e,i.createElement("div",{className:"titleWrapper_940a0a6b"},i.createElement(h.e,{className:v,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_940a0a6b"},n),i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:m,tabIndex:0,ariaLabel:n+". "+w.e.description}))),i.createElement("div",{className:b},w.e.description,i.createElement("br",null),i.createElement(p.e,{href:this._createUrl,onClick:this._logClick,target:"_blank"},w.e.createTeam)))};t.prototype.componentDidMount=function(){S.e.logData({name:"TeamifyBanner.Render",isIntentional:!1})};t.prototype._renderHideTeamifyDialog=function(){return i.createElement(l.e,{hidden:!this.state.hideTeamifyDialogOpen,type:c.e.close,dialogContentProps:{type:c.e.close,title:w.e.hideTeamifyDialogTitle,subText:T.format(w.e.hideTeamifyDialogDescription,w.e.hideTeamifyDialogPermanentDismissLink),showCloseButton:!0,onDismiss:this._onCloseHideTeamifyDialog},modalProps:{onDismiss:this._onCloseHideTeamifyDialog},isBlocking:!1},i.createElement("div",{className:"hideTeamifyDialogButtonContainer_940a0a6b"},i.createElement("div",{className:"hideTeamifyDialogButton_940a0a6b"},i.createElement(a.e,{onClick:this._onHideTeamifyBanner}," ",w.e.hideTeamifyDialogYesButton," ")),i.createElement("div",{className:"hideTeamifyDialogButton_940a0a6b"},i.createElement(f.e,{onClick:this._onCloseHideTeamifyDialog}," ",w.e.hideTeamifyDialogNoButton," "))),i.createElement("div",{className:"hideTeamifyDialogButtonContainer_940a0a6b"},i.createElement(p.e,{className:"dismissPermanentlyLink_940a0a6b",onClick:this._onDismissTeamifyBanner},w.e.hideTeamifyDialogPermanentDismissLink)))};return t})(o.e)},1910:function(e,t,n){"use strict";n.r(t);var r=n(1860);n.d(t,"TeamifyBanner",function(){return r.e});n.d(t,"default",function(){return r.e})},2595:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});var r=n(0),i=n(1),s=n(503),o={dependencies:s.object.isRequired};function u(e,t){var n=e,s={dependencies:Object(r.__assign)({},t||{})};return(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getChildContext=function(){return s};t.prototype.render=function(){return i.createElement(n,Object(r.__assign)({},this.props))};t.childContextTypes=Object(r.__assign)({},o);return t})(i.Component)}function a(e,t){var n=e.contextTypes,i=void 0===n?{}:n,s=(i.dependencies,Object(r.__rest)(i,["dependencies"])),o=function(n,i){return e(n,Object(r.__assign)(Object(r.__assign)({},i),{dependencies:t}))};o.contextTypes=s;return o}},2852:function(e,t,n){"use strict";var r,i,s=n(0),o=n(1),u=n(503),a=n(3071),f=n(145),l=n(3762),c=n(305),h=n(85),p=n(1245),d=n(303),v=n(1244),m=n(254),g=n(1347),y=n(1276),b=n(3789),w=(function(e){Object(s.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderCell=function(e,n,r){var i=t.props,s=i.onRenderMissingActivity,u=i.enableShimmer,a=i.isDataReady,f=i.isNewCommentExperienceEnabled,c=i.deeplinkCommentThreadId;if(n){if(!a&&u)return o.createElement("div",{className:"od-ItemActivityList-activity"},o.createElement(y.e,{shimmerElements:[{type:1,height:48}]}));var h=n.getCommentThreadId(),v=h&&h===c;return o.createElement(l.default,{key:n.getKey(),activity:n,isInGrid:!0,isNewCommentExperienceEnabled:f,isFocusedOnFirstLoad:v})}if(s)return o.createElement(b.e,{activityIndex:r,onGetMoreActivities:t._onRequestMissingItemActivity},o.createElement("div",{className:"od-ItemActivityList-activity od-ItemActivityList-missingActivity"},o.createElement(p.e,{size:d.e.large})))};t._onRenderHeader=function(e){var t=e.group;return o.createElement("h2",{className:"od-ItemActivityList-grouplistTitle"},t.name)};t._onRequestMissingItemActivity=function(e,n){var r=t.props.onRenderMissingActivity;n&&f.e.logData({name:"ItemActivityFeed.scrolled",isIntentional:!0});r&&r(e,n)};return t}t.prototype.render=function(){var e=this.props,t=e.activities,n=e.groups;return o.createElement(v.e,{direction:m.e.vertical,isCircularNavigation:!1,isInnerZoneKeystroke:function(e){return e.which===Object(c.t)(h.e.right)}},o.createElement(g.e,{items:t,onRenderCell:this._onRenderCell,groupProps:{onRenderHeader:this._onRenderHeader},groups:n,onShouldVirtualize:function(){return!1}}))};return t})(o.Component),E=n(3684),S=n(3923),x=n(2854),T=n(346),N=n(3073),C=864e5,k=7;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.older="Older"})(i||(i={}));var L=((r={})[i.today]=N.e.today,r[i.yesterday]=N.e.yesterday,r[i.thisWeek]=N.e.thisWeek,r[i.lastWeek]=N.e.lastWeek,r[i.twoWeeksAgo]=N.e.twoWeeksAgo,r[i.threeWeeksAgo]=N.e.threeWeeksAgo,r[i.thisMonth]=N.e.thisMonth,r[i.lastMonth]=N.e.lastMonth,r);function A(e){var t=e.time,n=new Date;return t?(function(e,t){return O(t,e)})(t,n)?i.today:(function(e,t){return O(new Date(t.getTime()-C),e)})(t,n)?i.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*C;return e.getTime()>n})(t,n)?i.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+k)*C;return e.getTime()>n})(t,n)?i.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-2*k*C;return e.getTime()>n})(t,n)?i.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-3*k*C;return e.getTime()>n})(t,n)?i.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(t,n)?i.thisMonth:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(t,n)?i.lastMonth:(function(e,t){return t.getFullYear()===e.getFullYear()})(t,n)?t.toLocaleString(T.e.language,{month:"long"}):(function(e,t){return t.getFullYear()>e.getFullYear()})(t,n)?t.toLocaleString(T.e.language,{month:"long",year:"numeric"}):i.older:i.older}function O(e,t){return e.toDateString()===t.toDateString()}var M=n(1988),_=140,D=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={charLimit:t.charLimit?t.charLimit:_,expanded:!1};return n}t.prototype.getSeeMoreContent=function(){var e,t=this,n=this.state,r=n.charLimit,i=n.expanded,s=this.props,u=s.text,a=s.seeMoreText,f=s.seeLessText;e=u.length<=r?u:i?u+" ":u.substr(0,r)+"... ";return o.createElement("span",null,e,u.length>r&&o.createElement("span",{className:"od-ItemActivity-SeeMoreText",onClick:this.toggleExpanded.bind(this),onKeyDown:function(e){e.which!==h.e.select&&e.which!==h.e.enter&&e.which!==h.e.space||t.toggleExpanded()},role:"button","data-is-focusable":"true","aria-expanded":i},i?f:a))};t.prototype.toggleExpanded=function(){var e=this.state.expanded;this.setState({expanded:!e})};t.prototype.render=function(){return o.createElement("div",null,this.getSeeMoreContent())};return t})(o.Component),P=n(1875),H={isPlaceholder:!1,activities:[],success:!0},B=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onRenderMissingActivity=function(e,t){var n=r.state,i=n.isEndOfActivities,s=n.showComments,o=n.deeplinkCommentThreadId,u=r.props,a=u.commentsOnly,f=u.containingItem,l=u.currentUserEmail,c=u.environment,h=u.activityApiHeaders,p=u.getListActivities,d=u.commentListItem;if(!i&&!a){var v="sharePointList"===c?"ItemActivityFeed-spList":"ItemActivityFeed";r._store.fetchItemActivities({item:f,startIndex:e,currentUserEmail:l,qosPrefix:v,environment:c,isScrollEvent:t,activityApiHeaders:h,getListActivities:p})}s&&r._itemCommentsStore.fetchItemComments({itemWrapper:d,currentUserEmail:l});r.setState({deeplinkCommentThreadId:t?void 0:o})};r._onFetchCommentsError=function(e){var t=r.props.onFetchCommentsError;t&&t(e);r.setState({showAllCommentActivities:!0,itemCommentsQueried:!0})};r._displayLargeText=function(e){return o.createElement(D,{charLimit:e.charLimit,seeMoreText:e.seeMoreText,seeLessText:e.seeLessText,text:e.text})};r._store=n.itemActivityFeedStore;r._itemCommentsStore=n.itemCommentsStore;r._engagementSource=n.engagementSource||"ActivityFeed";var i="sharePointList"===t.environment,s=!!t.commentListItem,u=!!t.commentsOnly?H:r._store.getItemActivities({item:r.props.containingItem,currentUserEmail:t.currentUserEmail}),a=s&&r._itemCommentsStore.getItemComments({itemWrapper:t.commentListItem,currentUserEmail:t.currentUserEmail,startIndex:0,onError:r._onFetchCommentsError,isReplyDisabled:i})||void 0;r.state={activities:u,itemComments:a,isEndOfActivities:!1,itemCommentsQueried:a&&!a.isPlaceHolder,showAllCommentActivities:!s,showComments:s,feedUpdatedMessage:"",isSPCustomListFeed:i,deeplinkCommentThreadId:t.deeplinkCommentThreadId};return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.containingItem.graphItemUrl!==this.props.containingItem.graphItemUrl||e.currentUserEmail!==this.props.currentUserEmail){var t="sharePointList"===e.environment,n=!!e.commentListItem,r=!!e.commentsOnly?H:this._store.getItemActivities({item:this.props.containingItem,currentUserEmail:e.currentUserEmail}),i=n&&this._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,startIndex:0,onError:this._onFetchCommentsError,isReplyDisabled:t})||void 0;this.setState({activities:r,showComments:n,itemComments:i,showAllCommentActivities:!n,itemCommentsQueried:i&&!i.isPlaceHolder,isEndOfActivities:!1,feedUpdatedMessage:"",isSPCustomListFeed:t});this._removeCurrentListeners();this._addListeners(e)}e.containingItem!==this.props.containingItem&&this._refreshActivityFeed(e);e.commentsOnly!==this.props.commentsOnly&&this.setState({isEndOfActivities:!1})};t.prototype.componentDidMount=function(){this._addListeners(this.props)};t.prototype.componentWillUnmount=function(){this._removeCurrentListeners()};t.prototype.render=function(){var e=this.state,t=e.activities,n=e.itemComments,r=e.showComments,i=e.itemCommentsQueried,s=e.deeplinkCommentThreadId,u=this.props,a=u.isReadonly,f=u.commentsOnly,l=u.isNewCommentExperienceEnabled,c=this._getViewableItemActivitiesAndGroups(t,n),h=c.activities,p=c.dateGroups;if((t.isPlaceholder||t.nextRequestToken||n&&n.nextLink)&&(!f||!this._noCommentActivities())){var d=p.length;h.push(void 0);0===d?p.push({key:"",name:"",startIndex:0,count:1}):d>0&&(p[p.length-1].count+=1)}var v=this._renderNoActivitiesNote(),m=this._renderError(),g=h.slice(0,h.length);return o.createElement("div",{className:"od-ItemActivityFeed"},o.createElement("div",{"aria-live":"assertive",role:"status","aria-atomic":"true",className:"od-ItemActivityFeed-screenReaderOnly"},this.state.feedUpdatedMessage),this._renderAddCommentField(),o.createElement("div",{"aria-label":N.e.activityListAriaLabel},v,o.createElement(w,{activities:g,groups:p,onRenderMissingActivity:this._onRenderMissingActivity,enableShimmer:!0,isDataReady:!r||!!i,isReadonly:a,isNewCommentExperienceEnabled:l,deeplinkCommentThreadId:s}),m))};t.prototype._renderError=function(){var e=this.state,t=e.activities,n=e.itemComments,r=!!this.props.commentsOnly;if(r||t.success){if(r&&n&&n.missingComments){i=n.comments.length>0?N.e.fetchMoreCommentsError:N.e.fetchCommentsError;return o.createElement("div",{className:"od-ItemActivityFeed-error"},i)}return null}var i=t.activities.length>0?N.e.fetchMoreError:N.e.fetchError;return o.createElement("div",{className:"od-ItemActivityFeed-error"},i)};t.prototype._renderNoActivitiesNote=function(){var e=this.state,t=e.activities,n=e.showComments,r=e.itemComments,i=this.props,s=i.commentsOnly,u=i.NoCommentsView;return!t.success||t.isPlaceholder||0!==t.activities.length||t.nextRequestToken||n&&!this._noCommentActivities()||s?s&&this._noCommentActivities()&&r&&!r.missingComments?u&&o.createElement(u,null)||o.createElement("div",{className:"od-ItemActivityFeed-noActivities"},N.e.noCommentActivities):null:o.createElement("div",{className:"od-ItemActivityFeed-noActivities"},N.e.noActivities)};t.prototype._noCommentActivities=function(){var e=this.state,t=e.itemComments;return e.showComments&&(!t||t&&t.comments&&t.comments.length<1)};t.prototype._renderAddCommentField=function(){var e=this,t=this.props,n=t.commentListItem,r=t.isReadonly,i=t.environment,s=t.onGrantAccess,u=t.onCheckUserAccess,a=t.commentTextBoxPlaceholder,f=t.isPublicEmailAddressMentionSupported,l=t.focusCommentInputOnMount,c=t.refreshCurrentItemCallback,h=t.isWXPCommentingDisabled,p="consumer"===i,d="sharePointList"===i;if((!r||p||d)&&n&&!h){var v=function(t,r,i,s){e._itemCommentsStore.addComment(n,t,s).then(function(t){e._refreshActivityFeed(e.props);r&&r();c&&c()},function(e){var t=e&&e.message&&e.message.value;i&&i(t)})},m=n&&n.item,g=m.isRootFolder?"driveRoot":m.folder?"folder":m.extension||"file",y=void 0!==m.sharingType?P.e[m.sharingType]:void 0;return this.props.isAtMentionEnabled?o.createElement(S.e,{commentItemId:n.item&&n.item.id,isPublicEmailAddressSupported:f,placeholderText:a,peoplePickerProvider:this.context.peoplePickerProvider,onSend:v,onGrantAccess:s,onCheckUserAccess:u,disabled:r,focusOnMount:l}):o.createElement(E.e,{commentItemId:n.item&&n.item.id,placeholderText:r?a:N.e.addCommentPlaceHolder,sendButtonTitle:"",onSend:v,engagementSource:this._engagementSource+".AddComment",engagementExtraData:{itemType:g,sharingType:y,environment:i},disabled:r,focusOnMount:l,enableNewCommentingExperience:p||d})}};t.prototype._refreshActivityFeed=function(e){var t="sharePointList"===e.environment?"ItemActivityFeed-spList":"ItemActivityFeed";e.commentsOnly||this._store.fetchItemActivities({item:e.containingItem,startIndex:0,currentUserEmail:e.currentUserEmail,qosPrefix:t,environment:e.environment,activityApiHeaders:e.activityApiHeaders,getListActivities:e.getListActivities});var n=!!e.commentListItem;n&&this._itemCommentsStore.fetchItemComments({itemWrapper:e.commentListItem,startIndex:0,currentUserEmail:e.currentUserEmail});this.setState({itemCommentsQueried:!1,showComments:n,isEndOfActivities:!1,deeplinkCommentThreadId:void 0});this._removeCurrentListeners();this._addListeners(e)};t.prototype._getViewableItemActivitiesAndGroups=function(e,t){var n,r=this.props.commentsOnly,i=[],s=[],o=function(){if(0===s.length)return 0;var e=s[s.length-1];return e.startIndex+e.count};if(e)for(var u=this.canAppendCommentsAfterOldestActivity(!!r,e,t),a=0,f=this._prepareActivitiesList(e.activities,t,u);a<f.length;a++){var l=f[a];if(l){var c=void 0;(!r||l instanceof x.t||2===l.type)&&(c=this._getViewableItemActivity(l));if(c){i.push(c);var h=A(l),p=L[h]||h;if(p!==n){s.push({key:"activityDateGroup-"+s.length,name:p,count:1,startIndex:o()});n=p}else s[s.length-1].count+=1}}}return{activities:i,dateGroups:s}};t.prototype.canAppendCommentsAfterOldestActivity=function(e,t,n){return!!((e||t&&t.success&&!t.isPlaceholder&&!t.nextRequestToken)&&n&&n.comments)};t.prototype._prepareActivitiesList=function(e,t,n){var r;if(this.props.commentsOnly)return(null===(r=t)||void 0===r?void 0:r.comments)||[];if(!(t&&t.comments&&t.comments.length>0))return e;var i=e.length>0?e[e.length-1].time:new Date,s=t.comments,o=new Set;return e.concat(s).filter(function(e){if(e.time<i&&!n)return!1;if(e instanceof x.t||2===e.type){if(o.has(e.action.comment.commentId))return!1;o.add(e.action.comment.commentId);return!0}return!0}).sort(function(e,t){return e.time>t.time?-1:e.time<t.time?1:0})};t.prototype._getViewableItemActivity=function(e){var t=this.props,n=t.currentUserEmail,r=t.containingItem,i=t.canOpenItem,o=t.onItemClick,u=t.isSingleLevel,a=t.onRenderUser,f=t.populateItemNameToDisplay,l=t.currentListTitle,c=t.currentRootTitle,h=t.defaultItemTitle,p=t.commentListItem,d=t.commentsOnly,v=t.isReadonly,m=t.canDeleteActivity,g=t.activityMenuFunctions,y=t.isNewCommentExperienceEnabled,b=t.isAtMentionEnabled,w=t.environment,E=t.getpersonaIconUrl,S=this.state,T=S.showComments,N=S.itemComments,C=S.isSPCustomListFeed,k={currentUserEmail:n,containingItem:r,canOpenItem:i,onItemClick:o,isSingleLevel:u,activity:e,strings:M.e,onRenderUser:a,populateItemNameToDisplay:f,currentListTitle:l,currentRootTitle:c,defaultItemTitle:h,commentListItem:p,isReadonly:v,canDeleteActivity:m,activityMenuFunctions:g&&g[e.type],isNewCommentExperienceEnabled:y,isAtMentionEnabled:b,environment:w,getpersonaIconUrl:E,displayLargeText:this._displayLargeText,isListItem:C};if(!d||2===e.type)switch(e.type){case 0:return new x.s(k);case 1:return new x.u(k);case 2:var L=void 0;if(T&&N){var A=this._getPopulatedCommentActivity(e);if(A&&A.isDeleted)return;L=Object(s.__assign)(Object(s.__assign)({},k),{activity:A})}return new x.t(L||k);case 3:return new x.n(k);case 4:return new x.o(k);case 5:return new x.h(k);case 6:return new x.l(k);case 9:return new x.f(k);case 10:return new x.i(k);case 11:return new x.r(k);case 12:return new x.c(k);case 14:return new x.e(k);case 15:return new x.a(k);default:return}};t.prototype._addStoreListener=function(e){var t=this;this._storeListener=this._store.addListener(function(){var n=t._store.getItemActivities({item:e.containingItem,currentUserEmail:e.currentUserEmail}),r="sharePointList"===e.environment;t.setState({activities:n,isEndOfActivities:r&&!!e.getListActivities||n.success&&!n.isPlaceholder&&!n.nextRequestToken})},{item:e.containingItem,currentUserEmail:e.currentUserEmail,environment:e.environment,activityApiHeaders:e.activityApiHeaders,getListActivities:e.getListActivities})};t.prototype._addCommentsStoreListener=function(e){var t=this,n=e.currentUserEmail,r=e.commentsOnly,i=e.commentListItem;this._commentsStoreListener=this._itemCommentsStore.addListener(function(n){var i=t._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,onError:t._onFetchCommentsError,isReplyDisabled:t.state.isSPCustomListFeed});t.setState({itemComments:i,itemCommentsQueried:!!i.comments,showAllCommentActivities:!i.isPlaceHolder&&i.missingComments,isEndOfActivities:r&&i.success&&!i.isPlaceHolder&&!i.nextLink});n&&t._announceCommentUpdate(n)},{commentItemWrapper:i,currentUserEmail:n})};t.prototype._addCommentSettingsListener=function(e){var t=this,n=e.onCommentSettingsChanged,r=e.currentUserEmail,i=e.commentListItem;this._commentSettingsListener=this._itemCommentsStore.addCommentSettingsListener(function(){var e=t._itemCommentsStore.getIsCommentsDisabled(i,r);if("boolean"==typeof e&&n){n(e);t._announceCommentUpdate(e?a.e.CommentsDisabled:a.e.CommentsEnabled)}},{commentItemWrapper:i,currentUserEmail:r})};t.prototype._addListeners=function(e){this._addStoreListener(e);if(e.commentListItem){this._addCommentsStoreListener(e);this._addCommentSettingsListener(e)}};t.prototype._removeCurrentListeners=function(){this._storeListener&&this._store.removeListener(this._storeListener);if(this._commentsStoreListener){this._itemCommentsStore.removeListener(this._commentsStoreListener);this._commentsStoreListener=void 0}if(this._commentSettingsListener){this._itemCommentsStore.removeCommentSettingsListener(this._commentSettingsListener);this._commentSettingsListener=void 0}};t.prototype._getPopulatedCommentActivity=function(e){var t=e.action&&e.action.comment;if(t&&t.commentId){var n=this._getCommentById(t.commentId);if(n){return Object(s.__assign)(Object(s.__assign)({},n),{time:e.time,friendlyDisplayTime:e.friendlyDisplayTime})}if(this.state.itemCommentsQueried&&!this.state.showAllCommentActivities)return Object(s.__assign)(Object(s.__assign)({},e),{isDeleted:!0})}return e};t.prototype._getCommentById=function(e){var t=this.state.itemComments,n=t&&t.comments;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r],o=s.action&&s.action.comment&&s.action.comment.commentDetail;if(o&&o.id===e)return s}};t.prototype._announceCommentUpdate=function(e){var t="";e===a.e.DeletedAll?t=N.e.deletedAllComments:e===a.e.DeletedSingle?t=N.e.deletedSingleComment:e===a.e.CommentsEnabled?t=N.e.commentsEnabled:e===a.e.CommentsDisabled&&(t=N.e.commentsDisabled);this.setState({feedUpdatedMessage:t})};t.contextTypes={itemActivityFeedStore:u.object.isRequired,itemCommentsStore:u.object.isRequired,peoplePickerProvider:u.object,engagementSource:u.string};return t})(o.Component);t.e=B},3071:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.DeletedSingle=0]="DeletedSingle";e[e.DeletedAll=1]="DeletedAll";e[e.CommentsEnabled=2]="CommentsEnabled";e[e.CommentsDisabled=3]="CommentsDisabled"})(r||(r={}))},3072:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(0),i=n(1);function s(e,t){return{definitionKey:e,props:t}}var o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.props,i=r.specification,s=r.placeholder,o=r.resources;n.state={componentType:i&&(u(i)?i.componentType:o.consume(i.definitionKey.optional)),placeholderType:s&&(u(s)?s.componentType:o.consume(s.definitionKey.optional))};return n}t.prototype.componentDidMount=function(){var e=this,t=this.props.specification;this.state.componentType||t&&!u(t)&&(this._resolveSpecificationPromise=this.props.resources.consumeAsync(t.definitionKey).then(function(t){e.setState({componentType:t})}))};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.specification,n=e.placeholder,r=e.resources;t===this.props.specification&&r===this.props.resources||this.setState({componentType:t&&(u(t)?t.componentType:this.props.resources.consume(t.definitionKey.optional))});n===this.props.placeholder&&r===this.props.resources||this.setState({placeholderType:n&&(u(n)?n.componentType:r.consume(n.definitionKey.optional))})};t.prototype.componentDidUpdate=function(e,t){var n=this,r=this.props,i=r.specification,s=r.resources;if(i!==e.specification||s!==this.props.resources){if(this._resolveSpecificationPromise){this._resolveSpecificationPromise.cancel();this._resolveSpecificationPromise=void 0}this.state.componentType||i&&!u(i)&&(this._resolveSpecificationPromise=this.props.resources.consumeAsync(i.definitionKey).then(function(e){n.setState({componentType:e})}))}};t.prototype.componentWillUnmount=function(){this._resolveSpecificationPromise&&this._resolveSpecificationPromise.cancel()};t.prototype.render=function(){var e=this.state,t=e.componentType,n=e.placeholderType;return t?i.createElement(t,Object(r.__assign)({key:"content"},this.props.specification.props)):n?i.createElement(n,Object(r.__assign)({key:"placeholder"},this.props.placeholder.props)):null};return t})(i.Component);function u(e){return!!e.componentType}},3433:function(e,t,n){"use strict";var r=n(14),i=n(145),s=n(2056),o=(function(){function e(e,t){this._itemActivitiesService=t.itemActivitiesService;this._lastListenerId=-1;this._dictListener={};this._dictItemActivities={};this._promiseDeduplicator=new s.e}e.prototype.addListener=function(e,t){var n=this._getItemActivitiesDictionaryKey(t);this._lastListenerId++;this._dictListener[n]||(this._dictListener[n]={});this._dictListener[n][this._lastListenerId]=e;return{key:this._lastListenerId,itemKey:n}};e.prototype.fetchItemActivities=function(e){var t=this,n=this._getItemActivitiesDictionaryKey(e),i=this._dictItemActivities[n];if(!i||0===e.startIndex){var s=0;i&&0===i.startIndex&&(s=i.noOfUnsuccessfulRequests);i={activities:{isPlaceholder:!0,activities:[],success:!0},noOfUnsuccessfulRequests:s,startIndex:0}}var o=i.activities,u="sharePointList"===e.environment;if(o.nextRequestToken||e.item.graphItemUrl){var a=(o.nextRequestToken||e.item.graphItemUrl)+"_"+(e.startIndex||0),f={};"consumer"===e.environment&&(f.Prefer=e.activityApiHeaders?e.activityApiHeaders:"Get-Self,Force-VaultItems-Filter");this._promiseDeduplicator.deduplicate(a,function(){var s={item:e.item,nextRequestToken:o.nextRequestToken,qosPrefix:e.qosPrefix,headers:f,environment:e.environment};return(u&&e.getListActivities?e.getListActivities():t._itemActivitiesService.getItemActivities(s)).then(function(r){if(r&&r.success||i.noOfUnsuccessfulRequests+1>=2){t._dictItemActivities[n]={activities:t._mergeItemActivities(o,r,e.isScrollEvent,e.environment),noOfUnsuccessfulRequests:0,startIndex:e.startIndex};t._emitChange(e)}else{t._dictItemActivities[n]={activities:o,noOfUnsuccessfulRequests:i.noOfUnsuccessfulRequests+1,startIndex:i.startIndex};t.fetchItemActivities(e)}},function(e){return r.n.reject(e)})})}};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t].activities:{isPlaceholder:!0,activities:[],success:!0}};e.prototype.removeListener=function(e){if(!this._dictListener[e.itemKey]||!this._dictListener[e.itemKey][e.key])throw"Listener with key "+e.key+" for item "+e.itemKey+" not found";delete this._dictListener[e.itemKey][e.key]};e.prototype._emitChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictListener[t];if(n)for(var r=0,i=Object.getOwnPropertyNames(n);r<i.length;r++){(0,n[i[r]])()}};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item&&(e.item.graphItemUrl||e.item.absolutePath);e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._mergeItemActivities=function(e,t,n,r){this._logActivitiesTelemetry(t.activities,n,r);var i=(e.activities||[]).concat(t.activities||[]);return{isPlaceholder:!e&&!t||e.isPlaceholder&&t.isPlaceholder,activities:i,nextRequestToken:t.nextRequestToken||!t&&e.nextRequestToken,success:e.success&&t&&t.success}};e.prototype._logActivitiesTelemetry=function(e,t,n){i.e.logData({name:"ActivityFeed.activitiesFetched",isIntentional:!0,extraData:{isScrollEvent:!!t,noOfActivities:e.length,environment:n}})};return e})();t.e=o},3434:function(e,t,n){"use strict";var r,i,s,o=n(1470),u=n(1413),a={sharePoint:(r={},r[0]=30,r[3]=30,r),consumer:(i={},i[0]=30,i[3]=30,i),sharePointList:(s={},s[0]=720,s[2]=30,s)},f={"SharePoint App":!0,"System Account":!0},l=(function(){function e(e,t){this._baseStore=t.itemActivityFeedStore;this._dictItemActivities={}}e.prototype.addListener=function(e,t){var n=this,r=this._getItemActivitiesDictionaryKey(t);this._dictItemActivities[r]=this._transformItemActivities(t,this._baseStore.getItemActivities(t));return this._baseStore.addListener(function(){n._dictItemActivities[r]=n._transformItemActivities(t,n._baseStore.getItemActivities(t));e()},t)};e.prototype.fetchItemActivities=function(e){this._baseStore.fetchItemActivities(e)};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t]:this._baseStore.getItemActivities(e)};e.prototype.removeListener=function(e){this._baseStore.removeListener(e)};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item.graphItemUrl;e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._areNewActivitiesFetched=function(e,t){var n=this._getItemActivitiesDictionaryKey(e);return!this._dictItemActivities[n]||this._dictItemActivities[n].activities.length!==t.length};e.prototype._transformItemActivities=function(e,t){var n=[];if(t.activities.length>0)for(var r={},i=0;i<t.activities.length;i++){var s=t.activities[i];if(!this._shouldHideActivity(s,e.currentUserEmail)){var o=t.activities[i-1],u=this._getCacheItemKeyAndGroupingRange(s,e.environment),a=u.cacheItemKey,f=u.groupingRange,l=s.actors[0];o&&this._isMergableMoveActivity(o,s)?this._handleMergableMoveActivity(o,s,n):a&&l?this._handleGroupableActivity(r,a,f,s,n):n.push(s)}}!this._areNewActivitiesFetched(e,n)&&t.nextRequestToken&&this.fetchItemActivities(e);return{isPlaceholder:t.isPlaceholder,activities:n,nextRequestToken:t.nextRequestToken,success:t.success}};e.prototype._handleMergableMoveActivity=function(e,t,n){n[n.length-1]={id:e.id,type:e.type,actors:e.actors,item:e.item,parentItem:e.parentItem,time:e.time,friendlyDisplayTime:e.friendlyDisplayTime,action:{move:{from:e&&e.action&&e.action.move&&e.action.move.from,to:t&&t.action&&t.action.move&&t.action.move.to}}}};e.prototype._handleGroupableActivity=function(e,t,n,r,i){var s=r.actors[0],o=this._getActorKey(s),u=e[t],a=u&&this._shouldResetGroupingItem(u,r,n);if(!u||a){var f={};f[o]=s;e[t]={activity:r,lastActivityTime:r.time,actors:f,groupedIndex:i.length};i.push(r)}else if(!u.actors[o]){u.actors[o]=s;if(1===u.activity.actors.length){var l=u.activity,c={id:l.id,type:l.type,actors:[l.actors[0]],item:l.item,parentItem:l.parentItem,time:l.time,action:l.action,friendlyDisplayTime:l.friendlyDisplayTime};u.activity=c;i[u.groupedIndex]=c}u.activity.actors.push(s)}};e.prototype._shouldResetGroupingItem=function(e,t,n){return e.lastActivityTime.getTime()-6e4*n>t.time.getTime()};e.prototype._getCacheItemKeyAndGroupingRange=function(e,t){var n=t&&a[t]&&a[t][e.type]||0;if(n){var r=void 0;e.item.driveItem&&e.item.driveItem.id?r=e.type.toString()+"_"+e.item.driveItem.id:e.item.graphItemUrl&&(r=e.type.toString()+"_"+e.item.graphItemUrl);var i=e.action.commentResponse;r&&i&&i.commentAuthor&&(r+="_"+i.commentAuthor.email);return{cacheItemKey:r,groupingRange:n}}return{}};e.prototype._shouldHideActivity=function(e,t){var n=!1,r=e.item&&e.item.name&&e.item.name.toLowerCase();if(r){var i=r.lastIndexOf(".");if(-1!==i){var s=r.substring(i+1);u.t.File;o.r(s)===u.t.OneNote&&(n=!0)}}return n||this._isSystemAccount(e)||5===e.type||!e.item};e.prototype._isSystemAccount=function(e){var t=e.actors.length>0&&e.actors[0];return t&&f[t.displayName]};e.prototype._isMergableMoveActivity=function(e,t){return 1===e.type&&1===t.type&&!!e.action.move.from&&!e.action.move.to&&!t.action.move.from&&!!t.action.move.to&&e.item&&t.item&&e.item.name===t.item.name};e.prototype._getActorKey=function(e){return e.email||"@@noemail@@_"+e.displayName};return e})();t.e=l},3435:function(e,t,n){"use strict";var r=n(0),i=n(14),s=n(3071),o=n(2056),u=(function(){function e(e,t){this._itemCommentsDataSource=t.itemCommentsDataSource;this._lastListenerId=-1;this._lastRepliesListenerId=-1;this._dictListener={};this._dictRepliesListener={};this._dictItemComments={};this._dictItemCommentReplies={};this._dictItemCommentIsDiabled={};this._dictItemCommentSettingsListener={};this._promiseDeduplicator=new o.e}e.prototype.addListener=function(e,t){this._lastListenerId++;var n=t.commentItemWrapper,r={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(r);this._dictListener[i]||(this._dictListener[i]={});this._dictListener[i][this._lastListenerId]=e;this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled;return{key:this._lastListenerId,itemKey:i}};e.prototype.removeListener=function(e){this._dictListener[e.itemKey]&&this._dictListener[e.itemKey][e.key]?delete this._dictListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.fetchItemComments=function(e){var t=this,n={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},s=this._getItemActivitiesDictionaryKey(n),o=this._dictItemComments[s];(!o||0===e.startIndex)&&(o={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var u=o.itemComments;if(u.nextLink||e.itemWrapper.item&&0===e.startIndex){var a=this._dictItemComments[s]&&this._dictItemComments[s].noOfUnsuccessfulRequests||0,f=(u.nextLink||e.itemWrapper.item.id)+"_"+a;this._promiseDeduplicator.deduplicate(f,function(){var f={itemWrapper:e.itemWrapper,nextLink:u.nextLink,currentUserEmail:e.currentUserEmail};return t._itemCommentsDataSource.getComments(f).then(function(i){if(i&&i.success||o.noOfUnsuccessfulRequests>3){var f=t._updatedComments(u,i);t._dictItemComments[s]={itemComments:f,noOfUnsuccessfulRequests:0};for(var l=0,c=f.comments;l<c.length;l++){var h=c[l],p=h.action&&h.action.comment&&h.action.comment.commentDetail,d=t._getItemCommentRepliesDictionaryKey(n,p.id);t._dictItemCommentReplies[d]={itemComments:p.replies,noOfUnsuccessfulRequests:0}}t._emitChange(n)}else if(i&&i.isPermanentFailure||a>=3){t._dictItemComments[s]={itemComments:Object(r.__assign)(Object(r.__assign)({},u),{missingComments:!0}),noOfUnsuccessfulRequests:a+1};e.onError&&e.onError();t._emitChange(n)}else{t._dictItemComments[s]={itemComments:u,noOfUnsuccessfulRequests:a+1};t.fetchItemComments(e)}},function(t){e.onError&&e.onError();return i.n.reject(t)})})}};e.prototype.addRepliesListener=function(e,t,n){this._lastRepliesListenerId++;var r=this._getItemCommentRepliesDictionaryKey(t,n);this._dictRepliesListener[r]||(this._dictRepliesListener[r]={});this._dictRepliesListener[r][this._lastRepliesListenerId]=e;return{key:this._lastRepliesListenerId,itemKey:r}};e.prototype.removeRepliesListener=function(e){this._dictRepliesListener[e.itemKey]&&this._dictRepliesListener[e.itemKey][e.key]?delete this._dictRepliesListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.getItemComments=function(e){var t={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},n=this._getItemActivitiesDictionaryKey(t),i=this._dictItemComments[n];if(i)return i.noOfUnsuccessfulRequests>3?Object(r.__assign)(Object(r.__assign)({},i.itemComments),{missingComments:!0}):i.itemComments;this.fetchItemComments(Object(r.__assign)(Object(r.__assign)({},e),{startIndex:i?e.startIndex:0}));return{isPlaceHolder:!0,comments:void 0,success:!0}};e.prototype.addComment=function(e,t,n){return this._itemCommentsDataSource.addComment(e,t,n)};e.prototype.addItemCommentReply=function(e,t,n){return this._itemCommentsDataSource.addReply(e.itemWrapper,t,n)};e.prototype.getItemCommentReplies=function(e,t){var n={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},i=this._getItemCommentRepliesDictionaryKey(n,t),s=this._dictItemCommentReplies[i];if(s)return s.itemComments;this.fetchItemCommentReplies(Object(r.__assign)(Object(r.__assign)({},e),{startIndex:0}),t);return{isPlaceHolder:!0,comments:void 0,success:!0}};e.prototype.addCommentSettingsListener=function(e,t){var n=t.commentItemWrapper,r={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(r);this._dictItemCommentSettingsListener[i]=e;this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled;return{key:1,itemKey:i}};e.prototype.removeCommentSettingsListener=function(e){this._dictItemCommentSettingsListener[e.itemKey]&&this._dictItemCommentSettingsListener[e.itemKey][e.key]?delete this._dictItemCommentSettingsListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.fetchIsCommentsDisabled=function(e){return this._itemCommentsDataSource.getIsCommentsDisabled(e)};e.prototype.getIsCommentsDisabled=function(e,t){var n={item:e.activityItemWrapper,currentUserEmail:t},r=this._getItemActivitiesDictionaryKey(n);return this._dictItemCommentIsDiabled[r]};e.prototype.setCommentsDisabled=function(e,t,n){var r=this;return this._itemCommentsDataSource.setCommentsDisabled(e,t).then(function(i){var s={item:e.activityItemWrapper,currentUserEmail:n},o=r._getItemActivitiesDictionaryKey(s);r._dictItemCommentIsDiabled[o]=t;r._emitCommentsSettingChange(s);return i})};e.prototype.deleteCommentById=function(e,t,n){var o=this;return this._itemCommentsDataSource.deleteCommentById(e,t).then(function(){var u={item:e.activityItemWrapper,currentUserEmail:n},a=o._getItemActivitiesDictionaryKey(u),f=o._dictItemComments[a],l=f&&f.itemComments&&f.itemComments.comments;if(l){var c=l.filter(function(e){return(e&&e.action&&e.action.comment&&e.action.comment.commentId)!==t});o._dictItemComments[a]=Object(r.__assign)(Object(r.__assign)({},f),{itemComments:Object(r.__assign)(Object(r.__assign)({},f.itemComments),{comments:c})});o._emitChange(u,s.e.DeletedSingle)}return i.n.resolve(!0)},function(e){return i.n.reject(e)})};e.prototype.deleteAllComments=function(e,t){var n=this;return this._itemCommentsDataSource.deleteAllComments(e).then(function(){var r={item:e.activityItemWrapper,currentUserEmail:t},o=n._getItemActivitiesDictionaryKey(r);n._dictItemComments[o]=void 0;n._emitChange(r,s.e.DeletedAll);return i.n.resolve(!0)},function(e){return i.n.reject(e)})};e.prototype.fetchItemCommentReplies=function(e,t){var n=this,r={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},s=this._getItemCommentRepliesDictionaryKey(r,t),o=this._dictItemCommentReplies[s];(!o||0===e.startIndex)&&(o={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var u=o.itemComments;if(u.nextLink||e.itemWrapper.item&&0===e.startIndex){var a=(u.nextLink||e.itemWrapper.item.id)+"_"+o.noOfUnsuccessfulRequests;this._promiseDeduplicator.deduplicate(a,function(){var a={itemWrapper:e.itemWrapper,nextLink:u.nextLink,currentUserEmail:e.currentUserEmail};return n._itemCommentsDataSource.getReplies(a,t).then(function(i){var a=n._dictItemCommentReplies[s]&&n._dictItemCommentReplies[s].noOfUnsuccessfulRequests||0;if(i&&i.success||a>3){n._dictItemCommentReplies[s]={itemComments:n._updatedCommentWithReplies(u,i),noOfUnsuccessfulRequests:a};n._emitChangeForReplies(r,t)}else{n._dictItemComments[s]={itemComments:u,noOfUnsuccessfulRequests:o.noOfUnsuccessfulRequests+1};n.fetchItemCommentReplies(e,t)}},function(e){return i.n.reject(e)})})}};e.prototype._emitChange=function(e,t){var n=this._getItemActivitiesDictionaryKey(e),r=this._dictListener[n];if(r)for(var i=0,s=Object.getOwnPropertyNames(r);i<s.length;i++){(0,r[s[i]])(t)}};e.prototype._emitChangeForReplies=function(e,t){var n=this._getItemCommentRepliesDictionaryKey(e,t),r=this._dictRepliesListener[n];if(r)for(var i=0,s=Object.getOwnPropertyNames(r);i<s.length;i++){(0,r[s[i]])()}};e.prototype._emitCommentsSettingChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictItemCommentSettingsListener[t];n&&n()};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item&&(e.item.graphItemUrl||e.item.absolutePath);e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._getItemCommentRepliesDictionaryKey=function(e,t){var n=e.item&&(e.item.graphItemUrl||e.item.absolutePath);e.currentUserEmail&&t&&(n+="_"+e.currentUserEmail+"_"+t);return n};e.prototype._updatedComments=function(e,t){return{comments:(e&&e.comments||[]).concat(t.comments),nextLink:t.nextLink,success:!0}};e.prototype._updatedCommentWithReplies=function(e,t){var n=e&&e.comments||[];return{comments:t.comments.concat(n),nextLink:t.nextLink,success:!0}};return e})();t.e=u},3946:function(e,t,n){"use strict";n.r(t);var r,i=n(1158),s=n(0),o=n(908),u=n(1),a=n(15),f=n(1244),l=n(254),c=n(36),h=n(305),p=n(860),d=n(40),v=n(558),m=n(101),g=n(887),y=n(437),b=n(716),w=n(122),E=n(228),S=n(396),x=n(451),T=n(1352),N=n(84),C=n(17),k=n(25),L=n(750),A=n(82),O=n(33),M=n(416),_=Object(S.e)();(function(e){e[e.KeyPress=0]="KeyPress";e[e.Hover=1]="Hover";e[e.Click=2]="Click"})(r||(r={}));var D,P="overflow";function H(e){return e.key+e.name+e.url}var B,j=(function(e){Object(s.__extends)(t,e);function t(n,r){var i=e.call(this,n,r)||this;i._horizontalNavItemsRef={};i._boundItemClick={};i._boundMainItemHover={};i._renderShimmer=function(e,n){var r=e&&e.data;i._asyncFetch(r);return i._getDeferredShimmer({customElementsGroup:i._getOneLeveOndemandElements(),width:t.MENU_WIDTH})};i._getOneLeveOndemandElements=function(){var e={type:3,width:t.MENU_ITEM_SIDE_MARGIN,height:t.MENU_ITEM_HEIGHT};return i._getDeferredShimmerElementsGroup({flexWrap:!0,shimmerElements:[e,{type:1,width:t.MENU_WIDTH-2*t.MENU_ITEM_SIDE_MARGIN,height:10},e,e,{type:1,width:t.MENU_WIDTH-2*t.MENU_ITEM_SIDE_MARGIN,height:10},e]})};i._onOverflowClick=function(e){if(i.state.contextMenuItems||i.state.lastTriggeringItem===P){i._onNavMenuDismiss();i.setState({lastTriggeringItem:null})}else i.setState({contextMenuItems:i.state.overflowItems,contextMenuRef:e.currentTarget,lastTriggeringItem:P})};i._onEditClick=function(e){i.props.editLink.onClick(e);i._fixNavEditExperienceKSActivated()?i.setState({isEditMode:!1}):i.setState({isEditMode:!0})};i._onMouseLeave=function(){i._async.clearTimeout(i._navItemHoverTimerId)};i._onMegaMenuMouseLeave=function(e){0!==i.state.lastTriggeringAction&&i._onNavMenuDismiss()};i._onNavMenuDismiss=function(e){if(e&&e.relatedTarget&&i._horizontalNavRegion.contains(e.relatedTarget)){e.stopPropagation();e.preventDefault()}else i.setState({contextMenuItems:null})};i._instanceIdPrefix=Object(x.e)("HorizontalNav");if(i._isAudienceTargeted()){i.state=i._getStateFromProps(Object(s.__assign)(Object(s.__assign)({},i.props),{items:[]}));i._applyInitialAudienceTargeting()}else i.state=i._getStateFromProps(i.props);i._editLinkWidth=-1;i._resolvedElement=function(e){return function(t){return i._horizontalNavItemsRef[e]=t}};Object(w.t)();i._foundSelectedLink=!1;i._qosEvent=new A.e({name:"HorizontalNav"});return i}t._isHeader=function(e){return!e||e===L.t};t.prototype.componentDidMount=function(){if(!this._isAudienceTargeted()||(this.state.items||[]).length>0){this._updateItemMeasurements();this._updateRenderedItems()}this._events.on(window,"resize",this._updateRenderedItems);this.props.onRendered&&this.props.onRendered(!0);this._isMounted=!0;this._qosEvent.end({resultType:O.e.Success});this._events.on(window,t.SUBMENU_OPEN_EVENT,this._onNavMenuDismiss)};t.prototype.componentWillUnmount=function(){this._isMounted=!1};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this._hasItemWidthChanged(this.props.items||[],e.items||[]),n=this._hasItemWidthChanged(this.props.overflowItems||[],e.overflowItems||[]);if(t){this._navItemWidths=void 0;this._navItemMargin=void 0}(t||n||!this._fixNavEditExperienceKSActivated()&&this.state.isEditMode&&this.state.isEditMode!==e.isEditMode||this.props.isEditMode!==e.isEditMode)&&this.setState(this._getStateFromProps(e))};t.prototype.componentDidUpdate=function(e,t){var n=this.state.overflowItems,r=t.overflowItems;if(!this._navItemWidths&&!this.state.isEditMode||!this._overflowStateChangedKSActive()&&n&&(!r||r.length!==n.length)||!this._fixNavEditExperienceKSActivated()&&t.isEditMode&&t.isEditMode!==this.state.isEditMode){this._updateItemMeasurements();this._updateRenderedItems()}this.props.onRendered&&this.props.onRendered(!1)};t.prototype.render=function(){var e=this.props,t=e.styles,n=void 0===t?this.props.getStyles:t,r=e.theme;this._classNames=_(n,{theme:r});var i=this.state,s=i.contextMenuItems,o=i.isEditMode,c=this._useMegaMenu&&this.state.lastTriggeringItem!==P;this._foundSelectedLink=!1;if(this._fixNavEditExperienceKSActivated()&&o)return u.createElement("div",null);var h=void 0;s&&(c&&(this._isOnDemandMegaMenuDisabled()||this._navItemHovered)?h=this._getDeferredMegaMenu(this._getMegaMenuProps(s)):c||(h=u.createElement(T.e,{settings:{theme:Object(C._)()}},this._getDeferredContextualMenu(this._getContextualMenuProps(s)))));var p=this.props.skipRole?void 0:"navigation",d=this._isMegaMenuEnhancementFlightEnabled()?this._onMegaMenuMouseLeave:this._onNavMenuDismiss;return u.createElement("div",{className:this._classNames.root,onMouseLeave:!a.e.isActivated("14829911-0e8d-4963-864d-e5f8d0f35149","11/12/2019","Mega menu hover off close")&&this.state.lastTriggeringItem!==P&&this._useMegaMenu?d:void 0,ref:this._resolveRef("_horizontalNavRegion"),role:p,"aria-label":this.props.ariaLabel},u.createElement(f.e,{direction:l.e.horizontal},u.createElement("div",{className:"ms-HorizontalNavItems",role:"menubar"},this._renderHorizontalNavItems(c&&h),this._renderOverflow(),this._renderEditLink())),!c&&s&&h)};t.prototype._asyncFetch=function(e){var t=this;if(!parent)return Promise.resolve();(this.props.getViewNavDataSource?this.props.getViewNavDataSource():Promise.resolve(new g.e(this.props.pageContext,"GlobalNavigationSwitchableProvider"))).then(function(t){return t.getMenuState({useCache:!0,depth:1,menuNodeKey:e})}).then(function(n){n&&n.links&&t._UpdateRenderedItemsWithSubmenuItems(e,n.links)},function(){t._qosEvent.verbose("HorizontalNav: FetchGlobalNavFailed")})};Object.defineProperty(t.prototype,"_useMegaMenu",{get:function(){var e=!1;this.props.ignoreChromeOptions||void 0===this.props.chromeOptions?e=this.props.useMegaMenu:this.props.chromeOptions&&(e=this.props.chromeOptions.nav.megaMenuEnabled);return e},enumerable:!0,configurable:!0});t.prototype._getDeferredContextualMenu=function(e){var t={modulePath:"office-ui-fabric-react/lib/ContextualMenu",moduleLoader:{load:function(){return n.e("107").then(n.bind(null,324)).then(function(e){return e.ContextualMenu})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredMegaMenu=function(e){var t={modulePath:"../MegaMenu/MegaMenuCallout",moduleLoader:{load:function(){return n.e("108").then(n.bind(null,1688)).then(function(e){return e.MegaMenuCallout})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredShimmer=function(e){var t={modulePath:"office-ui-fabric-react/lib/Shimmer",moduleLoader:{load:function(){return n.e("56").then(n.bind(null,1165)).then(function(e){return e.Shimmer})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredShimmerElementsGroup=function(e){var t={modulePath:"office-ui-fabric-react/lib/Shimmer",moduleLoader:{load:function(){return n.e("56").then(n.bind(null,1165)).then(function(e){return e.ShimmerElementsGroup})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getContextualMenuProps=function(e){return{className:"ms-HorizontalNav",labelElementId:this._instanceIdPrefix+P,items:this._getContextualItemProps(e),target:this.state.contextMenuRef,onDismiss:this._onNavMenuDismiss,gapSpace:10,isBeakVisible:!1,directionalHint:m.e.bottomLeftEdge,shouldFocusOnMount:!0}};t.prototype._getMegaMenuProps=function(e){var t=this;return{layoutProps:{maxColumnCount:4,showDivider:!0,gridSpacingFromEdge:this._isMegaMenuEnhancementFlightEnabled()?8:void 0,enforceGridWidth:!0},onDismiss:this._onNavMenuDismiss,onItemClick:function(){t._isLinkPropagateKSActive()||t._onNavMenuDismiss()},target:this.state.contextMenuRef,shouldFocusOnMount:0===this.state.lastTriggeringAction,pageContext:this.props.pageContext,theme:Object(C._)(),sections:e.map(function(e){return{heading:{name:e.name,url:e.url,target:e.target,onClick:e.onClick},items:e.links&&t._getContextualItemProps(e.links),theme:Object(C._)()}}),navigationSource:this.props.navigationSource}};t.prototype.measureLayout=function(){this._updateItemMeasurements();this._updateRenderedItems()};t.prototype._getContextualItemProps=function(e,n){var r=this;void 0===n&&(n=0);return e.filter(function(e){return!!e&&"1033"!==e.key}).map(function(e){var i,s=F(e),o=(function(e){return!!e&&e.hasChildLinks})(e),u=[];o&&u.push({key:"shimmerItem",text:"shimmer",data:e.key,onRender:r._renderShimmer});var a=g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank",f=e.onClick?function(t){e.onClick(t,e);if(!r._isLinkPropagateKSActive())return!0}:function(e){if(!r._isLinkPropagateKSActive())return!0};i={key:H(e),name:e.name,split:s||o,target:a,href:s||o||t._isHeader(e.url)?void 0:e.url,onClick:f,subMenuProps:s?{items:r._getContextualItemProps(e.links,n+1)}:o?{items:u}:void 0};!s&&!o||t._isHeader(e.url)||(i.onClick=function(){r._isLinkPropagateKSActive()&&window.open(e.url,a);e.forceAnchor&&e.onClick&&e.onClick()});return i})};t.prototype._renderHorizontalNavItems=function(e){var t=this,n=this.state.renderedItems,r=this._isMegaMenuEnhancementFlightEnabled()&&this._useMegaMenu;if(n&&0!==n.length)return n.map(function(n){var i,s=H(n),o=r?t._onMainItemHoverMegaMenu.bind(t,n):t._boundMainItemHover[s]||t._onMainItemHover.bind(t,n),f=r?t._onNavMenuDismiss:t._onMouseLeave,l=k.format(t.props.splitButtonAriaLabel,n.name);a.e.isActivated("70ce4e23-8db2-4c57-840b-639317332050","7/23/20","compute Selected link includes its children")?i=!!t.props.hasSelectedState&&t._isLinkSelected(n):(i=!!t.props.hasSelectedState&&(!t._foundSelectedLink&&t._isLinkSelected(n)))&&(t._foundSelectedLink=!0);return u.createElement("span",{className:"ms-HorizontalNavItem",key:s,ref:t._resolvedElement(s),role:"menuitem"},t._shouldRenderAsAnchor(n)?t._renderAnchorLink(n,s,o,f,i):t._renderButtonLink(n,s,o,f,i),F(n)?u.createElement("button",{className:Object(c.e)("ms-HorizontalNavItem-splitbutton",t._classNames.splitButton,{"ms-HorizontalNavItem-splitbutton-width":!t._chevronSpacingHardcodedKSActive()}),onClick:t._onItemClick.bind(t,n),onMouseEnter:o,onMouseLeave:t._onMouseLeave,"aria-label":l,"aria-haspopup":!0,onKeyDown:t._handleKeyPress.bind(t,n)},u.createElement(b.e,{iconName:"ChevronDown",className:Object(c.e)("ms-HorizontalNav-chevronDown",t._classNames.chevron)})):null,t.state.contextMenuItems===n.links&&e&&e)})};t.prototype._renderAnchorLink=function(e,t,n,r,i){return u.createElement("a",{className:Object(c.e)("ms-HorizontalNavItem-link",{"is-selected":i},{"is-not-selected":!i},this._classNames.link,i?this._classNames.linkSelected:this._classNames.linkUnselected),href:e.url,title:this._isMegaMenuEnhancementFlightEnabled()?void 0:e.title||e.name,"aria-label":e.ariaLabel,onMouseEnter:n,onMouseLeave:r,onKeyDown:this._handleKeyPress.bind(this,e),onClick:e.onClick?this._boundItemClick[t]:void 0,"aria-haspopup":F(e),role:"menuitem",target:g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank",rel:"noopener","aria-current":i,"data-navigationcomponent":Object(M.t)(this.props.navigationSource)},e.name)};t.prototype._shouldRenderAsAnchor=function(e){return(e.forceAnchor||void 0===e.forceAnchor)&&!t._isHeader(e.url)};t.prototype._renderButtonLink=function(e,n,r,i,s){var o=t._isHeader(e.url);return u.createElement("button",{className:Object(c.e)("ms-HorizontalNavItem-link",{"is-selected":s},{"is-header":o},this._classNames.link,s?this._classNames.linkSelected:this._classNames.linkUnselected),title:this._isMegaMenuEnhancementFlightEnabled()?void 0:e.title||e.name,"aria-label":e.ariaLabel,onClick:this._boundItemClick[n]||this._onItemClick.bind(this,e),onMouseEnter:r,onMouseLeave:i,onKeyDown:this._handleKeyPress.bind(this,e),"aria-haspopup":F(e),disabled:o,"aria-current":s,role:"menuitem","data-navigationcomponent":Object(M.t)(this.props.navigationSource)},e.name)};t.prototype._renderOverflow=function(){var e=this.state.overflowItems;return e&&e.length?u.createElement("div",{className:"ms-HorizontalNavItem",key:P,ref:this._resolveRef("_overflowElementRef"),"data-automationid":"HorizontalNav-overflow"},u.createElement("button",{id:this._instanceIdPrefix+P,"aria-label":this.props.moreOptionsAriaLabel,className:Object(c.e)("ms-HorizontalNavItem-link",this._classNames.link,this._classNames.overflowButton),onClick:this._onOverflowClick,"aria-haspopup":!0,onKeyDown:this._handleKeyPress.bind(this,P),role:"menuitem"},u.createElement(b.e,{iconName:"More",className:"ms-HorizontalNavItem-overflow"}))):null};t.prototype._renderEditLink=function(){var e=this.props,t=e.editLink,n=e.isEditMode,r="portals"===window.teamsCustomAppType;return!t||n||r?null:u.createElement("div",{className:"ms-HorizontalNavItem",ref:this._resolveRef("_editLinkElementRef"),"data-automationid":"HorizontalNav-edit"},u.createElement("button",{id:this._instanceIdPrefix+"EditLink",className:Object(c.e)("ms-HorizontalNavItem-link",this._classNames.link,this._classNames.editButton),onClick:this._onEditClick,"aria-label":t.ariaLabel?t.ariaLabel:t.name},t.name))};t.prototype._updateItemMeasurements=function(){this._currentOverflowWidth=this._overflowElementRef||this.props.overflowItems&&this.props.overflowItems.length?32.67:0;-1===this._editLinkWidth&&this.props.editLink&&this._editLinkElementRef&&(this._editLinkWidth=this._getElementWidth(this._editLinkElementRef,this._getElementMargin(this._editLinkElementRef)));this._navItemWidths||(this._navItemWidths={});for(var e=0,t=this.state.items;e<t.length;e++){var n=H(t[e]),r=this._horizontalNavItemsRef[n];void 0===this._navItemMargin&&(this._navItemMargin=this._getElementMargin(r));this._navItemWidths[n]||(this._navItemWidths[n]=this._getElementWidth(r,this._navItemMargin))}};t.prototype._getElementWidth=function(e,t){return e?e.getBoundingClientRect().width+t:0};t.prototype._getElementMargin=function(e){return parseInt(Object(h.e)()?window.getComputedStyle(e).marginLeft:window.getComputedStyle(e).marginRight,10)};t.prototype._updateRenderedItems=function(){this._horizontalNavRegion&&this._UpdateRenderedItemsCore(this.state.items)};t.prototype._UpdateRenderedItemsCore=function(e){for(var t=Object(s.__spreadArrays)(e),n=this._horizontalNavRegion.clientWidth-this._currentOverflowWidth-this._editLinkWidth,r=this.props.overflowItems||[],i=0,o=!1,u=0;u<t.length;u++){var a=H(t[u]),f=this._navItemWidths[a];if(i+f>=n){u>0&&0===r.length&&n-i<32.67&&u--;r=t.splice(u).concat(r);o=!0;break}i+=f}o&&this.setState({renderedItems:t,overflowItems:r})};t.prototype._UpdateRenderedItemsWithSubmenuItems=function(e,t){var n=this.state.items;this._InsertItemsWithSubmenuItems(n,e,t);this._UpdateRenderedItemsCore(n)};t.prototype._InsertItemsWithSubmenuItems=function(e,t,n){if(!e||!parent||!n)return!1;for(var r=!1,i=0;i<e.length;i++){if(e[i].key===t){e[i].links=n;r=!0;break}if(e[i].links&&e[i].links.length>0&&this._InsertItemsWithSubmenuItems(e[i].links,t,n)){r=!0;break}}return r};t.prototype._onAnchorClick=function(e,t){this._foundSelectedLink=!1;e.onClick&&e.onClick(t,e)};t.prototype._onItemClick=function(e,n){this._foundSelectedLink=!1;this._navItemHoverTimerId&&this._async.clearTimeout(this._navItemHoverTimerId);n.stopPropagation();n.preventDefault();if(this.state.contextMenuItems||this.state.lastTriggeringItem===e){this.setState({lastTriggeringItem:null});this._onNavMenuDismiss()}else"I"!==n.target.tagName?e.onClick?e.onClick(n,e):t._isHeader(e.url)||window.open(e.url,g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank"):this._openSubMenu(e.links,n.currentTarget,e,2)};t.prototype._onMainItemHover=function(e,n){var r=this;this._navItemHovered=!0;t._isHeader(e.url)||(window.status=e.url);n.stopPropagation();n.preventDefault();var i=n.currentTarget;F(e)&&(this._navItemHoverTimerId=this._async.setTimeout(function(){if(r.state.contextMenuItems!==e.links){r.state.contextMenuItems&&r._onNavMenuDismiss();r._openSubMenu(e.links,i,e,1)}},500))};t.prototype._onMainItemHoverMegaMenu=function(e,n){this._navItemHovered=!0;t._isHeader(e.url)||(window.status=e.url);n.stopPropagation();n.preventDefault();if(F(e)&&this.state.contextMenuItems!==e.links){this.state.contextMenuItems&&this._onNavMenuDismiss();this._openSubMenu(e.links,n.currentTarget,e,1)}else F(e)||this._onNavMenuDismiss()};t.prototype._handleKeyPress=function(e,t){if(32===t.which||40===t.which||13===t.which&&t.target&&-1!==t.target.className.indexOf("ms-HorizontalNavItem-splitbutton")){t.stopPropagation();t.preventDefault();e===P?this._openSubMenu(this.state.overflowItems,t.target,e,0):this._openSubMenu(e.links,t.target,e,0)}};t.prototype._openSubMenu=function(e,n,r,i){N.e.raise(window,t.SUBMENU_OPEN_EVENT);if(-1!==n.className.indexOf("ms-HorizontalNavItem-splitbutton")||"i"===n.tagName&&r!==P){for(var s=n;s&&"span"!==s.tagName.toLowerCase();)s=s.parentElement;s&&s.children&&s.children.length>0&&(n=s.children[0])}this.setState({lastTriggeringItem:r,contextMenuItems:e,contextMenuRef:n,lastTriggeringAction:i})};t.prototype._isAudienceTargeted=function(){if(!this.props||!this.props.pageContext)return!1;var e=new y.e(this.props.pageContext);return y.e.isAudienceTargetedNavEnabled()&&this.props.pageContext&&this.props.isAudienceTargeted&&e.isAudienceTargetedNavEnabledBasedOnWebProperty()};t.prototype._applyInitialAudienceTargeting=function(){var e=this;new y.e(this.props.pageContext).getCurrentUserMemberships().then(function(t){e._audienceMemberships=t;e._isMounted?e.setState(e._getStateFromProps(e.props)):e.state=e._getStateFromProps(e.props)}).catch(function(){e.setState(e._getStateFromProps(e.props))})};t.prototype._getStateFromProps=function(e){var t=e.overflowItems,n=e.isEditMode,r=this._isAudienceTargeted()?y.e.filterLinksWithMemberships(e.items,this._audienceMemberships):e.items;this._boundItemClick={};this._boundMainItemHover={};for(var i=0,s=r;i<s.length;i++){var o=s[i],u=H(o);this._boundItemClick[u]=this._shouldRenderAsAnchor(o)?this._onAnchorClick.bind(this,o):this._onItemClick.bind(this,o);this._boundMainItemHover[u]=this._onMainItemHover.bind(this,o)}return{renderedItems:r,overflowItems:t||[],contextMenuItems:null,isEditMode:n,selectedKey:void 0,items:r}};t.prototype._isLinkSelected=function(e){if(a.e.isActivated("70ce4e23-8db2-4c57-840b-639317332050","7/23/20","compute Selected link includes its children")){if(void 0!==this.props.selectedKey)return e.key===this.props.selectedKey;if(void 0!==this.state.selectedKey&&e.key===this.state.selectedKey)return!0;if("undefined"==typeof window)return!1;if(t._isHeader(e.url))return!1;(D=D||document.createElement("a")).href=e.url||"";var n=I()?D.href:D.href.toLowerCase(),r=I()?n+"/SitePages/Home.aspx":(n+"/SitePages/Home.aspx").toLowerCase(),i=I()?location.href:location.href.toLowerCase();if(i===n||i===r)return!0;var s=I()?location.protocol+"//"+location.host+location.pathname:(location.protocol+"//"+location.host+location.pathname).toLowerCase();if(s===n||s===r)return!0;if(location.hash){if(location.hash===e.url)return!0;D.href=location.hash.substring(1);return D.href===n}return!1}B=this.props.selectedKey||this.state.selectedKey;return R(e)};t.prototype._hasItemWidthChanged=function(e,t){return e.length!==t.length||e.map(function(e,n){var r=t[n];return e.name!==r.name||1==((e.links||[]).length^(r.links||[]).length)}).reduce(function(e,t){return e||t},!1)};t.prototype._fixNavEditExperienceKSActivated=function(){return a.e.isActivated("30b9a746-134f-4465-8f2c-f38c2440159a","03/02/2020","fix nav edit experience")};t.prototype._isMegaMenuEnhancementFlightEnabled=function(){return d.n.isFeatureEnabled({ODB:1811})};t.prototype._chevronSpacingHardcodedKSActive=function(){return a.e.isActivated("9ab54c9f-d74c-4739-82ad-0cc1696009e5","4/10/2020","hardcode the widths of horizontalNav chevron icons")};t.prototype._overflowStateChangedKSActive=function(){return a.e.isActivated("34034F80-F8DD-4FB2-99B2-A2931D4FC65F","4/22/2020","update item measurements when horizontal nav overflow changes")};t.prototype._isLinkPropagateKSActive=function(){return a.e.isActivated("41af9ff5-1e9b-4dc4-b737-57205c04759a","7/24/2020","allow link propagation for MegaMenu and ContextualMenu links")};t.prototype._isOnDemandMegaMenuDisabled=function(){return!(void 0===this.props.chromeOptions||void 0===this.props.chromeOptions.footer||this.props.chromeOptions.footer.hidden)||void 0===this.props.pageContext||0===Object(E.e)(90019,this.props.pageContext)};t.SUBMENU_OPEN_EVENT="submenu_open";t.MENU_WIDTH=200;t.MENU_ITEM_SIDE_MARGIN=8;t.MENU_ITEM_HEIGHT=32;return t})(p.e);function F(e){return!!(e&&e.links&&e.links.length)}function I(){return a.e.isActivated("8a8d92e8-6c30-46d8-aa0b-7c6e761cc1ee","5/1/2020","make the selected url logic case insensitive")}function q(e){return e.key===B||!!F(e)&&e.links.some(q)}function R(e){if(void 0!==B)return q(e);if("undefined"==typeof window)return!1;if(j._isHeader(e.url))return!!F(e)&&e.links.some(R);(D=D||document.createElement("a")).href=e.url||"";var t=I()?D.href:D.href.toLowerCase(),n=I()?t+"/SitePages/Home.aspx":(t+"/SitePages/Home.aspx").toLowerCase(),r=I()?location.href:location.href.toLowerCase();if(r===t||r===n)return!0;var i=I()?location.protocol+"//"+location.host+location.pathname:(location.protocol+"//"+location.host+location.pathname).toLowerCase();if(i===t||i===n)return!0;if(location.hash){if(location.hash===e.url)return!0;D.href=location.hash.substring(1);if(D.href===t)return!0}return!!F(e)&&e.links.some(R)}n.d(t,"HorizontalNav",function(){return U});var U=Object(i.e)(j,function(e){var t=e.theme,n=t.palette,r=t.semanticColors;return{root:"ms-HorizontalNav",link:[Object(s.__assign)(Object(s.__assign)({color:r.bodySubtext},t.fonts.small),{selectors:{":hover":{color:n.themePrimary},"&.is-header":{cursor:"auto",color:r.bodySubtext}}})],linkUnselected:{border:"none"},linkSelected:Object(s.__assign)({color:r.bodyText,borderBottom:"2px solid "+n.themePrimary},Object(o.e)(t).semibold),splitButton:{selectors:{":hover":{color:n.themePrimary}}},chevron:{color:r.bodySubtext},editButton:["ms-HorizontalNavItem-Edit",{border:"none",color:n.themePrimary,selectors:{":hover":{color:n.themeDarker,textDecoration:Object(o.t)()&&"underline"}}}],overflowButton:{border:"none"}}})}}]);
var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_chat_start"),(window.suiteux_shell_webpackJsonp_main=window.suiteux_shell_webpackJsonp_main||[]).push([["chat"],{364:function(t,e){var n,i,a=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:r}catch(t){i=r}}();var c,u=[],l=!1,p=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):p=-1,u.length&&d())}function d(){if(!l){var t=s(h);l=!0;for(var e=u.length;e;){for(c=u,u=[];++p<e;)c&&c[p].run();p=-1,e=u.length}c=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new f(t,e)),1!==u.length||l||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(t){return[]},a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},557:function(t,e,n){var i=n(558);"string"==typeof i&&(i=[[t.i,i,""]]);n(30)(i,{});i.locals&&(t.exports=i.locals)},558:function(t,e,n){(e=t.exports=n(29)(!1)).push([t.i,"._3h4sI7nX01-RHWxPYubeSU{display:inline-block;font-size:19px;vertical-align:middle}",""]),e.locals={icon:"_3h4sI7nX01-RHWxPYubeSU"}},559:function(t,e,n){var i=n(560);"string"==typeof i&&(i=[[t.i,i,""]]);n(30)(i,{});i.locals&&(t.exports=i.locals)},560:function(t,e,n){(e=t.exports=n(29)(!1)).push([t.i,".bMv2Khh1xMvmSgdvstP6F{bottom:0;right:0;padding-right:20px;position:absolute;display:flex;z-index:1000001;align-items:flex-end;max-width:calc(100% - 320px);-webkit-box-align:end}.bMv2Khh1xMvmSgdvstP6F .conversation{display:initial}.bMv2Khh1xMvmSgdvstP6F iframe{margin-right:10px}",""]),e.locals={wrapperStyle:"bMv2Khh1xMvmSgdvstP6F"}},561:function(t,e,n){var i=n(562);"string"==typeof i&&(i=[[t.i,i,""]]);n(30)(i,{});i.locals&&(t.exports=i.locals)},562:function(t,e,n){(e=t.exports=n(29)(!1)).push([t.i,"._3621pkmF-lKp4k2Fzdaqy{position:absolute;z-index:1000000;background-color:#fff;width:320px;box-sizing:border-box;outline:none;overflow-y:auto;visibility:visible;pointer-events:auto;box-shadow:0 2px 4px 0 rgba(0,0,0,.22);overflow-y:hidden;min-width:320px;max-width:320px;top:50px;height:450px;outline:0;display:block;visibility:hidden;z-index:1000001;-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-timing-function:ease;animation-timing-function:ease}._3sQksgj9I49rwkKr35v0Z0{-webkit-animation-name:slideInFrames;animation-name:slideInFrames;visibility:visible}@-webkit-keyframes slideInFrames{0%{opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes slideInFrames{0%{opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.BZqRf1M4uMYyXzdFfjHyN{box-shadow:0 2px 4px 0 rgba(0,0,0,.22);overflow-y:hidden}._8OxoRyxtoXn9ILQI2XSEE{height:450px;width:320px}",""]),e.locals={chatWindowWidth:"320",chatPopup:"_3621pkmF-lKp4k2Fzdaqy",popupSlideIn:"_3sQksgj9I49rwkKr35v0Z0",callout:"BZqRf1M4uMYyXzdFfjHyN",recentsWrapper:"_8OxoRyxtoXn9ILQI2XSEE"}},563:function(t,e,n){(function(t){// Copyright Joyent, Inc. and other Node contributors.
// distribute, sublicense, and/or sell copies of the Software, and to permit
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
var i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},i=0;i<e.length;i++)n[e[i]]=Object.getOwnPropertyDescriptor(t,e[i]);return n},a=/%[sdj%]/g;e.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,o=i.length,r=String(t).replace(a,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}})),c=i[n];n<o;c=i[++n])m(c)||!C(c)?r+=" "+c:r+=" "+s(c);return r},e.deprecate=function(n,i){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,i).apply(this,arguments)};var a=!1;return function(){if(!a){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation,a=!0}return n.apply(this,arguments)}};var o,r={};function s(t,n){var i={seen:[],stylize:u};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),f(n)?i.showHidden=n:n&&e._extend(i,n),g(i.showHidden)&&(i.showHidden=!1),g(i.depth)&&(i.depth=2),g(i.colors)&&(i.colors=!1),g(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=c),l(i,t,i.depth)}function c(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function u(t,e){return t}function l(t,n,i){if(t.customInspect&&n&&P(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var a=n.inspect(i,t);return y(a)||(a=l(t,a,i)),a}var o=function(t,e){if(g(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(b(e))return t.stylize(""+e,"number");if(f(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(o)return o;var r=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(r);if(t.showHidden&&(r=Object.getOwnPropertyNames(n)),I(n)&&(r.indexOf("message")>=0||r.indexOf("description")>=0))return p(n);if(0===r.length){if(P(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(v(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(I(n))return p(n)}var u,C="",S=!1,E=["{","}"];(d(n)&&(S=!0,E=["[","]"]),P(n))&&(C=" [Function"+(n.name?": "+n.name:"")+"]");return v(n)&&(C=" "+RegExp.prototype.toString.call(n)),w(n)&&(C=" "+Date.prototype.toUTCString.call(n)),I(n)&&(C=" "+p(n)),0!==r.length||S&&0!=n.length?i<0?v(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=S?function(t,e,n,i,a){for(var o=[],r=0,s=e.length;r<s;++r)O(e,String(r))?o.push(h(t,e,n,i,String(r),!0)):o.push("");return a.forEach((function(a){a.match(/^\d+$/)||o.push(h(t,e,n,i,a,!0))})),o}(t,n,i,s,r):r.map((function(e){return h(t,n,i,s,e,S)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,C,E)):E[0]+C+E[1]}function p(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,i,a,o){var r,s,c;if((c=Object.getOwnPropertyDescriptor(e,a)||{value:e[a]}).get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),O(i,a)||(r="["+a+"]"),s||(t.seen.indexOf(c.value)<0?(s=m(n)?l(t,c.value,null):l(t,c.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),g(r)){if(o&&a.match(/^\d+$/))return s;(r=JSON.stringify(""+a)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=t.stylize(r,"name")):(r=r.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),r=t.stylize(r,"string"))}return r+": "+s}function d(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function m(t){return null===t}function b(t){return"number"==typeof t}function y(t){return"string"==typeof t}function g(t){return void 0===t}function v(t){return C(t)&&"[object RegExp]"===S(t)}function C(t){return"object"==typeof t&&null!==t}function w(t){return C(t)&&"[object Date]"===S(t)}function I(t){return C(t)&&("[object Error]"===S(t)||t instanceof Error)}function P(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}e.debuglog=function(n){if(g(o)&&(o=Object({NODE_ENV:"production",__DEV__:!1,BUILD_BUILDNUMBER:"20200810.1"}).NODE_DEBUG||""),n=n.toUpperCase(),!r[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){t.pid;r[n]=function(){e.format.apply(e,arguments)}}else r[n]=function(){};return r[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=f,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=b,e.isString=y,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=g,e.isRegExp=v,e.isObject=C,e.isDate=w,e.isError=I,e.isFunction=P,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(564);function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){},e.inherits=n(565),e._extend=function(t,e){if(!e||!C(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t};var E="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function j(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(E&&t[E]){var e;if("function"!=typeof(e=t[E]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,E,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,i=new Promise((function(t,i){e=t,n=i})),a=[],o=0;o<arguments.length;o++)a.push(arguments[o]);a.push((function(t,i){t?n(t):e(i)}));try{t.apply(this,a)}catch(t){n(t)}return i}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),E&&Object.defineProperty(e,E,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},e.promisify.custom=E,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);var a=n.pop();if("function"!=typeof a)throw new TypeError("The last argument must be of type Function");var o=this,r=function(){return a.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(r,null,e)}),(function(e){t.nextTick(j,e,r)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,i(e)),n}}).call(this,n(364))},564:function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},565:function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},667:function(t,e,n){"use strict";n.r(e),n.d(e,"ChatHeaderButtonConnector",(function(){return X})),n.d(e,"ChatIconConnector",(function(){return Z})),n.d(e,"initializeChatComponent",(function(){return J}));var i,a=n(3),o=n(24),r=n(14),s=n(2),c=n(27),u=n(0),l=n(127),p=n(1),h=n(16),d=n(17),f=n(63),m=n(557),b=n(15),y=n(8),g=n(9),v=function(t){var e=t instanceof MouseEvent;if(t instanceof KeyboardEvent)switch(t.which){case 40:e=t.altKey;break;case 13:case 32:e=!0}e&&function(t){t.preventDefault(),window.open(i),Object(p.f)().click("ChatButton","NavBar",null,null,"Default chat web page")}(t)};var C=function(t){function e(e){var n=t.call(this,e)||this;return n.onMouseChange=function(t){return n.setState({isHovered:t})},n.state={isHovered:!1},i=n.props.chatWebLink,n}return Object(u.__extends)(e,t),e.prototype.render=function(){if(!this.props.chatEnabled)return null;var t=this.props.isConsumerShell?"SkypeLogo":"OfficeChat",e=Object(d.a)();return a.createElement("button",{type:"button",id:h.a,className:Object(s.y)(b.button,e.headerButton),"aria-disabled":"false",title:y.a.Chat,"aria-label":y.a.Chat,role:"button",onMouseEnter:this.onMouseChange.bind(this,!0),onMouseLeave:this.onMouseChange.bind(this,!1)},a.createElement(s.f,{fontIconCss:"ms-Icon--"+t,fontSize:g.f.toString(),className:Object(s.y)(m.icon),isAriaHidden:!0}),a.createElement(s.r,{unseenItemCount:this.props.unreadBadgeValue,isParentHovered:this.state.isHovered,badgeStyles:Object(s.y)(b.headerButtonBadgePosition)}))},e.prototype.componentDidMount=function(){Object(s.t)([h.a],f.a.CLICK+" "+f.a.KEYDOWN,v)},e}(a.Component),w=n(95),I=n(559);var P=function(){var t=Object(g.b)(Object(s.y)(w.a.ChatWrapper,I.wrapperStyle),"chat_wrapper_pane");return document.body.appendChild(t),t},S=n(150),O=n(561),E=function(t){function e(e){var n=t.call(this,e)||this;return n.populateRecentsContent=function(t){t&&(n.props.isChatRecentsPaneInitialized?Object(S.d)(t,n.props.isTeamsChatActivated):n.initializeRecents(t))},n.initializeRecents=function(t){n.props.isChatAPIInitialized?Object(S.a)(t,n.props.onRecentsReady,n.props.isTeamsChatActivated):window.addEventListener(w.b.ChatAPIReady,(function(){n.onChatAPIReady(t)}))},n.onChatAPIReady=function(t){window.removeEventListener(w.b.ChatAPIReady,(function(){n.onChatAPIReady(t)})),Object(S.a)(t,n.props.onRecentsReady,n.props.isTeamsChatActivated)},n.onAnimationEnd=function(){n.chatPopUp&&n.chatPopUp.focus()},n.handleKeydown=function(t){switch(t.keyCode){case 27:t.stopPropagation(),t.preventDefault(),n.props.onDismiss(t),n.chatHeaderButton.focus()}},n.state={popupPosition:null},n}return Object(u.__extends)(e,t),e.prototype.calculatePopupPosition=function(){var t,e=parseInt(O.chatWindowWidth),n=this.chatHeaderButton&&this.chatHeaderButton.getBoundingClientRect();if(n&&0!==n.x||(this.chatHeaderButton=document.getElementById(h.a),n=this.chatHeaderButton&&this.chatHeaderButton.getBoundingClientRect()),n&&n.x>0){var i=n.left+.5*n.width-e/2;t=i+e>this.chatHeaderButton.offsetParent.clientWidth+this.chatHeaderButton.offsetWidth?{right:10}:i<0?{left:10}:{left:i}}else t=this.props.isRtl?{left:10}:{right:10};this.props.isThinHeader&&(t=Object(u.__assign)(Object(u.__assign)({},t),{top:this.props.isThinHeader?48:50})),this.setState({popupPosition:t})},e.prototype.render=function(){var t,e=Object(d.a)();return a.createElement(s.h,{onDismiss:this.props.onDismiss,ariaLabel:y.a.ChatOpened,role:"region",className:Object(s.y)(O.chatPopup,(t={},t[O.popupSlideIn]=this.props.isChatRecentsPaneOpen,t)),popupPosition:this.state.popupPosition,id:"chat_popup",onAnimationEnd:this.onAnimationEnd,isVisible:this.props.isChatRecentsPaneOpen,isPersistant:!0},a.createElement("div",{"data-style":"o365shell",className:Object(s.y)(w.a.ChatRecents,O.recentsWrapper,e.neutral.lighterAlt.background),ref:this.populateRecentsContent,id:"chat_recent_pane"}))},e.prototype.componentDidUpdate=function(t){!t.isChatRecentsPaneOpen&&this.props.isChatRecentsPaneOpen&&this.calculatePopupPosition()},e.prototype.componentDidMount=function(){window.addEventListener(s.e.RESIZE,this.props.onDismiss),window.addEventListener(s.e.SCROLL,this.props.onDismiss),this.chatPopUp||(this.chatPopUp=document.getElementById("chat_popup"),this.chatPopUp.addEventListener(s.e.KEYDOWN,this.handleKeydown))},e.prototype.componentWillUnmount=function(){window.removeEventListener(s.e.RESIZE,this.props.onDismiss),window.removeEventListener(s.e.SCROLL,this.props.onDismiss),this.chatPopUp.removeEventListener(s.e.KEYDOWN,this.handleKeydown)},e}(a.Component),j=n(103),A=n(23);function _(t){return{type:A.i,isRecentsOpen:t}}function R(t){return{type:j.b,isRecentsInitialized:t}}var x,k,D,T,L,z=Object(r.b)((function(t){return{isChatAPIInitialized:t.chatState.isChatAPIInitialized,isChatRecentsPaneInitialized:t.chatState.isChatRecentsPaneInitialized,isChatRecentsPaneOpen:t.chatState.isChatRecentsPaneOpen,isThinHeader:Object(p.g)().isThinHeader,isTeamsChatActivated:t.chatState.isTeamsChatActivated,isRtl:t.userState&&t.userState.isRtl}}),(function(t){return{onRecentsReady:function(){t(R(!0))},onDismiss:function(e){var n=document.getElementById(h.a);e instanceof MouseEvent&&e.target&&n&&n.contains(e.target)||t(_(!1))}}}))(E),B=n(183),U=document.getElementById(h.b),H=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.myPresenceStatusUpdate=function(t){if(e.props.userPresenceStatusItems){var n=Object(l.b)(t,e.props.userPresenceStatusItems);e.props.userPresenceStatusUpdate(n)}e.presenceStatusKey=t},e.onPresenceStatusChanged=function(t){var n=e.props.presenceStatus,i=Object(l.b)(t,e.props.userPresenceStatusItems);Object(S.e)(i,(function(){Object(p.f)().exception("Chat API setUserPresenceStatus failed",6,null),e.props.userPresenceStatusUpdate(n)}))},e.onChatClickHandler=function(t){var n=t instanceof MouseEvent;if(t instanceof KeyboardEvent)switch(t.which){case 40:n=t.altKey;break;case 13:case 32:t.preventDefault(),n=!0}n&&e.chatClicked(t)},e.onStartChat=function(){e.props.onRecentsOpen(!1,h.a),Object(p.f)().impression("ChatWindowOpened","Chat")},e}return Object(u.__extends)(e,t),e.prototype.render=function(){return this.props.chatEnabled&&this.props.isChatAPIInitialized?a.createElement(z,null):null},e.prototype.componentDidMount=function(){e.chatLoading||!this.props.chatEnabled||this.props.isChatAPIInitialized||this.beginChatInitialization()},e.prototype.componentDidUpdate=function(){e.chatLoading||!this.props.chatEnabled||this.props.isChatAPIInitialized||this.beginChatInitialization()},e.prototype.beginChatInitialization=function(){var t=this;e.chatLoading=!0,this.props.isConsumerShell?(x=function(){t.onChatCoreReady()},k=function(){t.onChatAPIReady()},window.addEventListener(w.b.ChatCoreReady,x),window.addEventListener(w.b.ChatAPIReady,k),this.appendChatAPIDownloadScript()):(D=function(){t.props.onTeamsChatActivated(!0),t.onChatCoreReady(),window.removeEventListener(B.b.TeamsChatAPIReady,D)},window.addEventListener(B.b.TeamsChatAPIReady,D),this.appendTeamsChatDownloadScript())},e.prototype.onChatCoreReady=function(){var t=this,e=this.getInitParams();!this.props.isTeamsChatActivated&&swc&&e?(window.removeEventListener(w.b.ChatCoreReady,x),swc.init(null,e).catch((function(e){window.removeEventListener(w.b.ChatAPIReady,k),t.handleAPIInitializationError(e)}))):TeamsClient?TeamsClient.SDK.create({chatsParentElement:P(),hostCtx:this.props.workloadId,loginHint:this.props.upn}).then((function(t){return TeamsClient.client=t,TeamsClient.client.notifications.get()})).then((function(e){e.subscribe((function(e){e.type===B.a.UnreadCounterUpdate&&t.props.onUnreadConversationUpdate(e.data)})),t.onChatAPIInitialized(!0)})).catch((function(e){t.handleAPIInitializationError(e)})):(window.removeEventListener(w.b.ChatAPIReady,k),this.handleAPIInitializationError())},e.prototype.onChatAPIReady=function(){return Object(u.__awaiter)(this,void 0,void 0,(function(){return Object(u.__generator)(this,(function(t){return window.removeEventListener(w.b.ChatAPIReady,k),this.initializeChat(),[2]}))}))},e.prototype.initializeChat=function(){return Object(u.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(u.__generator)(this,(function(e){switch(e.label){case 0:return this.registerSwcChatEvents(),[4,swc.create(w.c.Messaging,S.c,P()).then((function(){return swc.getPresence()})).then((function(e){return e.subscribeToMyStatus(t.myPresenceStatusUpdate),e.getStatusList()})).then((function(e){Object(s.gb)(e)&&(t.props.onUserPresenceStatusListUpdate(e),t.presenceStatusKey?(t.myPresenceStatusUpdate(t.presenceStatusKey),t.presenceStatusKey=void 0):Object(p.f)().tag("Presence_API_getStatusList_Invalid",6))})).catch((function(t){Object(p.f)().exception("Presence_API_getStatusList_Failed",6,t)})).then((function(){return Object(u.__awaiter)(t,void 0,void 0,(function(){var t=this;return Object(u.__generator)(this,(function(e){switch(e.label){case 0:return swc.getKeyboard?[4,swc.getKeyboard().then((function(e){e.onKeyDown((function(e){"Escape"===e.key&&t.props.isChatRecentsPaneOpen&&t.dismissChatRecentsPane()}))})).catch((function(t){Object(p.f)().exception("get_keyboard_API_Failed",6,t)}))]:[3,2];case 1:e.sent(),e.label=2;case 2:return Object(p.f)().impression("Chat_Button","Chat",0,void 0,"successful"),this.onChatAPIInitialized(!0),[2]}}))}))}))];case 1:return e.sent(),[2]}}))}))},e.prototype.registerSwcChatEvents=function(){swc.API.registerEvent(w.b.ApiUnreadConversationUpdate,this.props.onUnreadConversationUpdate),swc.API.registerEvent(w.b.ApiStartChat,this.onStartChat),swc.API.registerEvent(w.b.ApiOnCallStart,(function(){Object(p.f)().impression("CallStart","Chat")})),swc.API.registerEvent(w.b.ApiOnRecentItemSelected,(function(){Object(p.f)().click("ChatRecentItem","Chat")})),swc.API.registerEvent(w.b.ApiRecentsShown,this.startChatLoadingTime),swc.API.registerEvent(w.b.ApiRecentItemsLoaded,this.logChatLoadingTime)},e.prototype.handleAPIInitializationError=function(t){Object(p.f)().exception("Chat_API_Initialization_Failed",6,t),e.chatLoading=!1,this.onChatAPIInitialized(!1),this.props.responsiveEnabled||U&&this.props.isConsumerShell&&(U.style.display="block")},e.prototype.getInitParams=function(){return{toLoadUnreadConversationsCount:!0,locale:this.props.locale,correlationId:this.props.correlationId,loginHint:this.props.upn}},e.prototype.onChatAPIInitialized=function(t){var n=this;if(this.props.onChatAPIInitialized(t),t&&!this.props.responsiveEnabled){var i=document.getElementById(h.a);i&&(Object(s.T)(i,s.e.CLICK+" "+s.e.KEYDOWN,v),Object(s.t)(i,s.e.CLICK+" "+s.e.KEYDOWN,this.onChatClickHandler),U.style.display="block")}var a=Object(p.c)();a.subscribe("ThemeChanged",(function(){var t=Object(p.i)().getThemeState().isDarkMode?"dark":Object(p.i)().getCurrentThemeId();n.props.isTeamsChatActivated||swc.setTheme(t)}),!0),a.subscribe("PresenceStatusChanged",this.onPresenceStatusChanged,!1),this.showCurrentPresence(),e.chatLoading=!1},e.prototype.showCurrentPresence=function(){var t=this;!this.props.isTeamsChatActivated&&swc&&swc.getPresence().then((function(e){e.getMyStatus().then((function(e){e?t.myPresenceStatusUpdate(e):Object(p.f)().tag("Presence_API_getMyStatus_Undefined",6)})).catch((function(t){Object(p.f)().exception("Presence_API_getMyStatus_Failed",6,t)}))})).catch((function(t){Object(p.f)().exception("Presence_API_Initialization_Failed",6,t)}))},e.prototype.chatClicked=function(t){t.preventDefault(),Object(p.f)().click("ChatButton","NavBar",null,null,"Chat recents list open "+!this.props.isChatRecentsPaneOpen),this.props.onRecentsOpen(!this.props.isChatRecentsPaneOpen,h.a)},e.prototype.dismissChatRecentsPane=function(){this.props.onRecentsOpen(!1,h.a);var t=document.getElementById(h.a);t&&t.focus()},e.prototype.appendChatAPIDownloadScript=function(){var t=this;T=function(){t.onChatAPIDownloadScriptFailed()};var e=document.createElement("script");e.type="text/javascript",e.setAttribute("data-style","o365shell"),e.setAttribute("data-disable-autostart","true"),e.setAttribute("data-platform-id",this.props.workloadId),e.setAttribute("data-auth-type",this.props.isConsumerShell?"msa":"aad"),e.src=this.props.chatSDKUrl,e.onerror=T,document.head.appendChild(e)},e.prototype.appendTeamsChatDownloadScript=function(){var t=document.createElement("script");t.dataset.loginHint=this.props.upn;var e=null;window.URLSearchParams&&(e=new URLSearchParams(window.location.search)),t.src=e&&e.has("teams-embed-sdk-url")?e.get("teams-embed-sdk-url"):"https://teams.microsoft.com/embed-client/loader.js",document.body.appendChild(t)},e.prototype.onChatAPIDownloadScriptFailed=function(){Object(p.f)().exception("Chat API download script failed",6,null),this.props.onChatAPIInitialized(!1),this.props.responsiveEnabled||this.props.isConsumerShell&&(U.style.display="block")},e.prototype.startChatLoadingTime=function(){L=Date.now()},e.prototype.logChatLoadingTime=function(){L&&(Object(p.f)().timer("Chat_FirstTimeChatListShown",Date.now()-L),swc.API.unregisterEvent(w.b.ApiRecentItemsLoaded,this.logChatLoadingTime),swc.API.unregisterEvent(w.b.ApiRecentsShown,this.startChatLoadingTime))},e.chatLoading=!1,e}(a.Component),M=n(563),K=Object(r.b)((function(t){var e=t.shellInitDataState;return{disableToasts:e.renderSettings.disableToasts,locale:t.shellInitDataState.navBarData.CultureName,isConsumerShell:t.shellInitDataState.clientData.IsConsumerShell,correlationId:t.shellInitDataState.clientData.SHSID,responsiveEnabled:null!=t.shellInitDataState.layout,chatEnabled:t.chatState.chatEnabled,chatSDKUrl:t.chatState.webChatSDKUrl,isChatAPIInitialized:t.chatState.isChatAPIInitialized,isChatRecentsPaneOpen:t.chatState.isChatRecentsPaneOpen,isTeamsChatActivated:t.chatState.isTeamsChatActivated,workloadId:e.clientData.WorkloadId,presenceStatus:t.meControlState.userPresenceStatus,userPresenceStatusItems:t.meControlState.userPresenceStatusItems,upn:t.userState&&t.userState.upn}}),(function(t){return{onChatAPIInitialized:function(e){var n;t((n=e,{type:j.a,isChatAPIInitialized:n}))},onRecentsOpen:function(e,n){t(_(e)),t(Object(s.db)(n))},onUnreadConversationUpdate:function(e){var n;Object(M.isNumber)(e)&&t((n=e,{type:j.d,unreadBadgeValue:n}))},userPresenceStatusUpdate:function(e){t(Object(c.h)(e))},onUserPresenceStatusListUpdate:function(e){t(Object(c.i)(e))},onTeamsChatActivated:function(e){t(function(t){return{type:j.c,isTeamsChatActivated:t}}(e))}}}))(H),F=n(62),N=n(47),W=n(56),V=Object(r.b)((function(t,e){return Object(u.__assign)(Object(u.__assign)({},e),{unseenItemCount:t.chatState.unreadBadgeValue})}))(s.r),Y=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isHovered:!1},n}return Object(u.__extends)(e,t),e.prototype.componentDidMount=function(){this.props.isAvailable&&Object(p.f)().perfMarker("ChatTimeToInteractive")},e.prototype.render=function(){var t=this;if(!this.props.chatEnabled)return null;var e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:y.a.Chat,affordanceMenuItemText:y.a.Chat,iconID:this.props.isConsumerShell?"SkypeLogo":"OfficeChat",iconFontSize:g.f.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onHoverStateChanged:function(e){t.setState({isHovered:e})},onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?a.createElement(N.b,Object(u.__assign)({},e),a.createElement(V,{unseenItemCount:0,isParentHovered:this.state.isHovered,badgeStyles:b.headerButtonBadgePosition})):a.createElement(N.a,Object(u.__assign)({},e),a.createElement(V,{unseenItemCount:0,isParentHovered:this.state.isHovered,badgeStyles:W.affordanceContextMenuItemBadgePosition}))},e}(a.Component);var X=Object(r.b)((function(t,e){var n=function(t){var e=!1,n=!1;t.chatState.chatEnabled&&null!==t.chatState.isChatAPIInitialized&&(t.chatState.isChatAPIInitialized?e=!0:t.userState.isConsumer&&(e=!0,n=!0));return{showButton:e,useButtonAsLink:n}}(t);return{isAvailable:n.showButton,id:e&&e.id,isActive:t.chatState&&t.chatState.isChatRecentsPaneOpen,useButtonAsLink:n.useButtonAsLink,chatWebLink:t.chatState&&t.chatState.chatWebLink,chatEnabled:t.chatState&&t.chatState.chatEnabled,isConsumerShell:t.shellInitDataState&&t.shellInitDataState.clientData.IsConsumerShell,controlDimensionsChanged:e.controlDimensionsChanged,isChatRecentsPaneInitialized:t.chatState.isChatRecentsPaneInitialized}}),(function(t){return{onClick:function(e,n){e.stopPropagation(),Object(p.f)().click("ChatButton","NavBar",null,null,"Active state: "+n.isActive+", Render context: "+n.renderContext+", Use Button as Link: "+n.useButtonAsLink),n.onClick&&n.onClick(e),n.useButtonAsLink?(e.preventDefault(),window.open(n.chatWebLink)):(n.isChatRecentsPaneInitialized||Object(S.b)((function(){t(R(!0))}),(function(e,n){t(_(e)),t(Object(s.db)(n))})),t(_(!n.isActive)),t(Object(s.db)(e.currentTarget&&e.currentTarget.id)))}}}),(function(t,e,n){var i=Object(u.__assign)(Object(u.__assign)({},n),t);return Object(u.__assign)(Object(u.__assign)(Object(u.__assign)({},i),e),{onClick:function(t){return e.onClick(t,i)},onDimensionsChanged:function(){return e.onDimensionsChanged(i)}})}))(Y),Z=Object(r.b)((function(t){return{unreadBadgeValue:t.chatState.unreadBadgeValue,chatEnabled:t.chatState.chatEnabled,chatWebLink:t.chatState.chatWebLink,isConsumerShell:t.shellInitDataState&&t.shellInitDataState.clientData.IsConsumerShell}}))(C);function J(){var t=document.createElement("div");document.getElementById(Object(p.g)().top).appendChild(t);var e=Object(F.a)();o.render(a.createElement(r.a,{store:e},a.createElement(K,null)),t)}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_chat_end"),shellPerformance.measure("shell_chat","shell_chat_start","shell_chat_end"));
//# sourceMappingURL=https://oneshellprcorp.blob.core.windows.net/oneshellpr/20200810.1/chat.map
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],Array(1172).concat([function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(4),i=n(454),s=new r.e("spSharedByMePage",{itemSet:Object(r.o)(i.t),after:Object(r.s)()})},,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1),s=n(1351),o=n(3041),u=n(2191),a=n(2238),f=n(25),l=n(279),c=n(3418),h=n(852),p=n(9),d=n(77),v=new p.e("dragLayerPreviewControl",{dragLayerPreviewRenderer:Object(d.e)()}),m=n(247),g=function(e){var t=e.draggedItem,n=t.dragSourceKey,r=t.itemKeys,s=void 0===r?[]:r,o=s[0]||n,u=s.length>0?s.length:n?1:0,a="",p=null;if(u<1)return null;a=Object(f.format)(Object(f.getLocalizedCountValue)(c.e.dragMoveItemsPreviewText,c.e.dragMoveItemsPreviewTextIntervals,u)||"",u);p=1===u?i.createElement(h.t,{itemKey:o,size:20,className:"dragPreviewIcon_c437410f"}):i.createElement(h.e,{type:l.e.genericFile,size:20,className:"dragPreviewIcon_c437410f"});return a?i.createElement("div",{className:"dragPreviewRoot_c437410f"},p||null,i.createElement("span",{className:"dragPreviewText_c437410f"},a)):null},y=i.memo(function(e){var t=e.draggedItem,n=i.useCallback(function(e){var n=e.itemCache;if(!t)return null;var r=t.dragSourceKey,s=t.itemKeys,o=s||[r],u=n.demandItemFacet(v,r),a=v.evaluate(u)(n,{itemKeys:o,dragLayerPreviewRenderer:g}).dragLayerPreviewRenderer;return i.createElement(a,{draggedItem:t})},[t?t.dragSourceKey:void 0]);return i.createElement(m.e,null,n)}),b=n(3419);n.d(t,"DropTargetHook",function(){return w});n.d(t,"DragSourceHook",function(){return E});n.d(t,"DragDropHook",function(){return S});var w=function(e){return i.createElement(o.e,null,i.createElement(u.e,Object(r.__assign)({},e)))};var E=function(e){var t=e.dragSourceKey,n=e.type;return i.createElement(o.e,null,i.createElement(a.t,Object(r.__assign)({},e)),e.showDefaultDragPreview?null:i.createElement(a.e,{dragSourceKey:t,type:n},i.createElement(y,null)))},S=i.memo(function(e){var t=e.dragDropKey,n=e.dragType;return i.createElement(o.e,null,i.createElement(b.e,Object(r.__assign)({},e)),e.showDefaultDragPreview?null:i.createElement(a.e,{dragSourceKey:t,type:n,as:x,getItemStyles:T},i.createElement(y,null)))}),x=i.forwardRef(function(e,t){return i.createElement(s.e,null,i.createElement("div",{className:e.className,ref:t},e.children))});function T(e,t,n,r,i){if(!(e&&t&&n&&r))return{display:"none"};var s={top:0,left:0};if(null!==i){var o=i.getBoundingClientRect();if(o){s.top=o.top;s.left=o.left}}var u=t||{x:0,y:0},a=u.x,f=u.y,l="translate("+a+"px, "+(f-=s.top)+"px)";return{transform:l,WebkitTransform:l}}}],Array(77),[function(e,t,n){"use strict";n.r(t);n.d(t,"spItemUploadItemsOperationHandler",function(){return y});var r=n(0),i=n(79),s=n(111),o=n(2623),u=n(22),a=n(88),f=n(1932),l=n(2),c=n(76),h=n(12),p=n(42),d=n(2970),v=n(317),m=n(57),g=n(3),y=Object(u.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,u=e.options.sourceEntries,y=i.e.deserialize(n),b=y.webAbsoluteUrl,w=y.listFullUrl,E=Object.keys(u)[0],S=u[E].progressItemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,x,T,N,C,k,L,A,O;return Object(r.__generator)(this,function(M){switch(M.label){case 0:t=i(Object(a.e)({sourceFile:f.t},E)).sourceFile;u=i(Object(m.e)({listItemUploader:g.xe})).listItemUploader,x=void 0===u?o.e:u;return[4,i(x(e))];case 1:T=M.sent().itemKey;N=new p.e;S&&t&&N.resolveItems({items:(L={},L[S]=Object(r.__assign)(Object(r.__assign)({},c.s.pack({itemKey:T})),Object(l.n)({progressSize:c.m},{progressSize:{current:t.size}})),L)});N.invalidateItems({items:(A={},A[n]=[h.t],A)});if(y.listFullUrl){C=new v.e(y.listFullUrl+"/Forms").path;if(y.rootFolder&&(y.rootFolder+"/").slice(0,C.length+1)===C+"/"){k=s.e.serialize({webAbsoluteUrl:b,listFullUrl:w});i(Object(d.e)({items:(O={},O[k]={childItemKey:T},O)}))}}i(N.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateFolderOperationHandler",function(){return C});n.d(t,"getCreateFolderUrl",function(){return k});var r=n(0),i=n(317),s=n(79),o=n(111),u=n(3),a=n(227),f=n(276),l=n(337),c=n(88),h=n(50),p=n(208),d=n(22),v=n(76),m=n(12),g=n(6),y=n(1282),b=n(248),w=n(38),E=-2147023080,S=-2130575282,x="-2130575257",T="-2130575245",N="-2130247139",C=Object(d.i)({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,d=e.options.folders;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,y,b,E,S,C,A,O,M,_,D;return Object(r.__generator)(this,function(P){switch(P.label){case 0:t=Object.keys(d)[0];y=s.e.deserialize(n);b=y.rootFolder||new i.e(y.listFullUrl).path;E=o.e.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl});S=e(Object(c.e)({list:u.we},E));C=k({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl,parentFolderPath:b,isDocLib:!!S&&!!S.list&&S.list.isDocumentLibrary,folderName:t});return[4,e(Object(a.t)({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl,url:C,method:"POST",qosName:"createFolder",telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=t.code,s=i&&(i.indexOf(x)>-1||i.indexOf(T)>-1||i.indexOf(N)>-1)?w.t.expectedFailure:w.t.failure;return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultType:s})}}return{eventData:n}}})).catch(function(e){if(e instanceof f.e&&e.message&&b){var t=b;"/"===t[0]&&(t=t.substr(1));"/"!==t[t.length-1]&&(t+="/");e.message=e.message.replace(t,"")}throw new l.e({innerError:e,facets:L(e)})})];case 1:P.sent();if(A=d[t].progressItemKey){O=b+"/"+t;M=s.e.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl,rootFolder:O});e(Object(h.e)({items:(_={},_[A]=Object(r.__assign)({},v.s.pack({itemKey:M})),_[M]=Object(r.__assign)(Object(r.__assign)({},u.G.pack(O)),g.A.pack({itemKey:n})),_)}))}e(Object(p.t)({items:(D={},D[n]=[m.t],D)}));return[2]}})})}});function k(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.parentFolderPath,i=e.isDocLib,s=void 0===i||i,o=e.folderName,u=Object(y.r)({webAbsoluteUrl:t,listOrItemFullUrl:n}),a=o?o.trim():"";return(u=s?(u=u.segment("folders")).methodWithAliases("AddUsingPath",{DecodedUrl:r+"/"+a,overwrite:!1}).oDataParameter("$Expand","ListItemAllFields/PermMask"):u.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:r}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:a||"Folder"+(Math.floor(100*Math.random())+1)})).toString()}function L(e){if(e instanceof f.e){switch((function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]})(e)){case E:case S:return b.p.pack({})}}}},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateDocumentOperationHandler",function(){return o});var r=n(0),i=n(22),s=n(2450);n.d(t,"getCreateDocumentUrl",function(){return s.e});n.d(t,"getRedirectUrlFromResponse",function(){return s.t});var o=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,n.e("389").then(n.bind(null,3696))];case 1:return[4,(0,t.sent().createDocumentsCore)(i,e)];case 2:t.sent();return[2]}})})}})}],Array(29),[function(e,t,n){"use strict";n.r(t);n.d(t,"fileHandlerGetItemsOperationHandler",function(){return b});n.d(t,"filehandlerPerExtensionGetItemsOperationHandler",function(){return w});n.d(t,"fetchFileHandlerData",function(){return E});var r=n(0),i=n(22),s=n(1615),o=n(96),u=n(2943),a=n(2051),f=n(1522),l=n(2104),c=n(212),h=n(156),p=n(161),d=n(57),v=n(317),m=n(359),g=n(33),y=n(676),b=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.t.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u;return Object(r.__generator)(this,function(r){t=e(Object(m.e)({name:"getFileHandlersOperation"}));u={endpoint:s};return[2,e(E(i)).then(function(r){if(r){Object(y.e)({driveAppsKey:i,data:r});e(Object(y.n)(r,n));u.fileHandlerRequestEndpoint=r.signature.endpoint;u.accessTokenObtained=!0;e(t({resultType:g.e.Success,extraData:u}))}}).catch(function(n){o.e.logError(n);e(t({resultType:g.e.Failure,extraData:u}));throw n})]})})}}),w=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.e.deserialize(n).endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:t=c.t.serialize({endpoint:i});return[4,e(Object(s.demandItems)(function(e){return e.demandItemFacet(h.t,t)}))];case 1:n.sent();return[2]}})})}});function E(e){var t=e.endpoint,n=e.driveId;return function(e){var r,i=e(Object(d.e)({getUserOneDriveEndpoint:p.o,useOneDriveEndpoint:p.y})),s=i.getUserOneDriveEndpoint,o=i.useOneDriveEndpoint,c=Object(a.n)({endpoint:t,driveId:n}),h=new u.e({},{dataRequestor:e(f.e).dataRequestor}),m=Promise.resolve(t);if(s&&o){var g=new v.e(t).authority;m=e(s.getUserOneDriveEndpoint(g))}return m.then(function(t){r=t;c=Object(a.n)({endpoint:r});return e(Object(l.e)(r,c))}).then(function(e){return h.getFileHandlerData({accessToken:e,endpoint:r,includePromotedApp:!0,driveId:n}).then(function(e){if(e){return{data:e,lastModified:Date.now(),signature:{endpoint:r,includePromotedApp:!0,driveId:n}}}})})}}},,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"getNeedsAttentionView",function(){return p});var r=n(0),i=n(401),s=n(514),o=n(23),u=n(302),a=n(88),f=n(3),l=n(111),c=n(143),h=n(756);function p(e,t,n){var p=l.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),d=n(Object(a.e)({list:f.we},p)),v=d&&d.list&&d.list.templateType&&Object(o.s)(d.list.templateType),m=v?"LinkTitle":"LinkFilename",g={},y=[];if(e)for(var b=0,w=e;b<w.length;b++){var E=w[b];if(E.contentTypeId&&E.requiredFields&&E.requiredLookups){for(var S={fieldName:"ContentTypeId",operator:"Eq",values:[E.contentTypeId]},x=s.e(S),T=[],N=E.requiredFields.split(","),C=E.requiredLookups.split(","),k=0;k<N.length;k++){var L=N[k],A="True"===C[k];void 0===g[L]&&(g[L]=A);var O={fieldName:L,lookupId:!!A||void 0,operator:"Eq",values:[""]};T.push(O)}var M=s.t(T,"Or");if(M){var _=s.t([x,M],"And");y.push(_)}}}0===y.length&&y.push(s.e({fieldName:"FileLeafRef",operator:"Eq",values:[""]}));var D=Object.keys(g),P=D.map(function(e){return g[e]}),H=Object(r.__spreadArrays)(["DocIcon",m,"Editor","Modified"],D,["FileDirRef"]),B=Object(r.__spreadArrays)([void 0,void 0,void 0,void 0],P,[void 0]),j=!!d&&!!d.list&&!!d.list.templateType&&d.list.templateType===o.n.webPageLibrary,F=new i.e("<View Scope='Recursive'/>");j&&c.e.isFeatureEnabled({ODB:1743})?F.title=u.e.PagesThatNeedAttention:F.title=v?u.e.ItemsThatNeedAttention:u.e.FilesThatNeedAttention;F.isReadOnly=!0;F.id=h.e;F.replaceFields(H,B);F.updateSort({fieldName:"ID",isAscending:!0});F.updateRowLimit({rowLimit:30,isPerPage:!0});var I=s.t(y,"Or");F.addFilters([I]);return F}},function(e,t,n){"use strict";n.r(t);n.d(t,"getListRootFolder",function(){return o});var r=n(0),i=n(227),s=n(1282);function o(e){var t=this,n=e.webAbsoluteUrl,o=e.listFullUrl,u=e.qosName;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=Object(s.e)({webAbsoluteUrl:n,listFullUrl:o}).segment("RootFolder");return[4,e(Object(i.r)({url:t.toString(),method:"GET",webAbsoluteUrl:n,listFullUrl:o,qosName:"rootFolder."+u,noRedirect:!0}))];case 1:return[2,r.sent()]}})})}}}],Array(214),[function(e,t,n){"use strict";var r=n(0),i=n(103),s=n(1931),o=n(2104),u=n(461),a=n(371),f=n(449),l=n(57),c=new(n(2).e)("graphDataRequestorConfiguration"),h=n(161),p=n(14),d=n(2614);n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});n.d(t,"n",function(){return g});n.d(t,"r",function(){return y});n.d(t,"i",function(){return b});n.d(t,"s",function(){return w});var v=Object(i.e)(function(e){var t=e(a.e),n=e(Object(l.e)({graphDataRequestorConfiguration:c,graphTokenProvider:d.e})),r=n.graphDataRequestorConfiguration,i=n.graphTokenProvider,o=r&&r.alwaysSendContentType;return{dataRequestor:new s.e({alwaysSendContentType:o},{apiEvent:f.e.withManager(t),sessionManagementProvider:i,isOffline:function(){return new p.n(function(t,n){try{var r=e(Object(u.n)()),i=void 0!==window.navigator.onLine&&!window.navigator.onLine;t(r||i)}catch(e){n(e)}})}}),hasTokenProvider:!!i&&!!i.getSessionToken}});function m(e,t){return"&orderby=folder,"+e+" "+(t?"asc":"desc")}function g(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,u=e.body,a=e.qosName,f=e.endpoint,c=e.headers,p=e.timeout,d=e.expectedErrors,m=e.driveUrl,g=e.parseResponse;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,y,b,w,E,S;return Object(r.__generator)(this,function(x){switch(x.label){case 0:t=e(v),i=t.dataRequestor,y=t.hasTokenProvider;b=void 0!==typeof u?JSON.stringify(u):void 0;return y?[3,2]:[4,e(Object(o.e)(f,m))];case 1:E=x.sent();return[3,3];case 2:E=void 0;x.label=3;case 3:w=E;S=e(Object(l.e)({clientName:h.t})).clientName;return[4,i.send({path:n,endpoint:f,driveUrl:m,requestType:s,apiName:a,accessToken:w,useAuthorizationHeaders:!0,postData:b,headers:S?Object(r.__assign)({"X-ClientService-ClientTag":S},c||{}):c,expectedErrors:d,timeout:p,parseResponse:g})];case 4:return[2,x.sent()]}})})}}function y(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,o=e.body,a=e.qosName,f=e.timeout,l=e.endpoint,c=e.headers,h=e.expectedErrors,p=e.driveUrl,d=e.parseResponse;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,v,m,y,b,w,E;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=void 0!==typeof o?JSON.stringify(o):"";i=(function(e,t,n){var r=void 0!==n?n:"";return e+"__"+t+"__"+r})(n,s,t);v=e(Object(u.n)());m=void 0!==window.navigator.onLine&&!window.navigator.onLine;y=v||m;return[4,e(Object(u.t)(i))];case 1:b=r.sent();if(y&&b)return[2,b];w=g({url:n,method:s,body:o,qosName:a,endpoint:l,headers:c,expectedErrors:h,timeout:f,driveUrl:p,parseResponse:d});if(!b)return[3,2];e(w).then(function(t){e(Object(u.r)(i,t))});return[2,b];case 2:return[4,e(w)];case 3:E=r.sent();return[4,e(Object(u.r)(i,E))];case 4:r.sent();return[2,E]}})})}}function b(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){return[2,!!(t=n(Object(l.e)({isODCEndpoint:h.l})).isODCEndpoint)&&t(e)]})})}}function w(e,t){return function(n){var r=n(Object(l.e)({supportsRandomAccess:h.m})).supportsRandomAccess;return!!r&&r(e,t)}}}],Array(92),[function(e,t,n){"use strict";n.r(t);n.d(t,"demandItems",function(){return u});var r=n(0),i=n(2417),s=n(318),o=1/0;function u(e,t){var n=this;void 0===t&&(t={});var a=t.cancelToken,f=t.flushOperationQueue,l=t.timeout,c=void 0===l?o:l,h=t.contextualControlHandlers;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:o={operation:u};l=Object(s.e)({timeout:c,errorProps:{message:"Timeout demanding items"}},a);r.label=1;case 1:r.trys.push([1,,3,4]);return[4,t(Object(i.e)(e,function(e){n={result:e}},{cancelToken:l.token,flushOperationQueue:f,contextualControlHandlers:h,owner:o}))];case 2:r.sent();return[3,4];case 3:l.dispose();return[7];case 4:if(!n)throw new Error("No result.");return[2,n.result]}})})}}}],Array(47),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("saveViewCore"),o=Object(i.i)({operationTypeFacet:s})}],Array(173),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(4),i=n(154),s=n(1007),o=new r.e("driveItemSet",{driveItemKey:Object(r.o)(i.e),sortBy:Object(r.s)(),isAscending:Object(r.n)(),extFilters:Object(r.t)(Object(r.s)()),filters:Object(r.t)(Object(r.o)(s.e)),groupBy:Object(r.s)()})}],Array(46),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("refreshItemsInSet"),o=Object(i.i)({operationTypeFacet:s})}],Array(47),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("entryBatch"),s=new r.e("sourceFile")}],Array(28),[function(e,t,n){"use strict";var r=n(0),i=n(183),s=n(6),o=n(12),u=n(154),a=n(1837),f=n(2630),l=n(2),c=new l.e("driveItemResponse"),h=n(600),p=n(2095),d=n(2110),v=n(140),m=n(54),g=n(2285),y=new l.e("vault"),b=n(879),w=n(2447),E=n(1408),S=function(e){var t=e.replace(".",""),n=Object.keys(E.e);for(var r in n)if(E.e.hasOwnProperty(n[r])){var i=n[r];if(E.e[i].indexOf(t)>-1)return i}},x=n(2632),T=n(2633),N=n(2631),C=n(208);n.d(t,"e",function(){return k});n.d(t,"t",function(){return L});function k(e){var t,n=e.driveItemKey,l=e.driveItem,E=e.endpoint,k=e.parentFolderItemKey,A=e.shouldReturnShareFacets,O=void 0===A||A,M=l.file,_=l.fileSystemInfo,D=l.name,P=l.parentReference,H=l.remoteItem,B=l.root,j=l.size,F=l.thumbnails,I=l.image,q=l.video,R=l.eTag,U=l.specialFolder,z=l.lastModifiedDateTime,W=void 0===z?_&&_.lastModifiedDateTime||H&&H.lastModifiedDateTime:z,X=l.createdDateTime||_&&_.createdDateTime||H&&H.createdDateTime,V=P&&P.driveId,$=P&&P.driveType||H&&H.parentReference&&H.parentReference.driveType,J="personal"===$,K=_&&_.lastAccessedDateTime||H&&H.fileSystemInfo&&H.fileSystemInfo.lastAccessedDateTime,Q=l.package||H&&H.package,G=F||H&&H.thumbnails,Y=I||H&&H.image,Z=q||H&&H.video,ee=l.shared||H&&H.shared,te={itemId:l.id,driveId:V,endpoint:E},ne=_&&_.systemPath,re=n||H&&H.parentReference&&{itemId:H.id,driveId:H.parentReference.driveId,endpoint:E}||te,ie=u.e.serialize(re),se=l.webDavUrl||H&&H.webDavUrl;t="business"!==$&&"documentLibrary"!==$&&"personal"!==$||!B?D||H&&H.name||"":d.e.files;var oe=l.folder||H&&H.folder,ue=j||H&&H.size,ae=oe&&oe.childCount,fe=L(t,!!oe),le=fe.extension&&S(fe.extension),ce=l.sharepointIds||H&&H.sharepointIds,he=l.localItem,pe=!oe&&(l.webUrl||H&&H.webUrl);return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.e.pack(re)),s.l.pack(t)),void 0!==ue?s.p.pack(ue):{}),_||l.folder||M||H&&H.folder?Object(r.__assign)({},s.d.pack(oe?{}:void 0)):{}),pe?s.L.pack(pe):{}),b.n.pack(ne)),se?s.i.pack(se):{}),s.a.pack(W?new Date(W).getTime():void 0)),s.o.pack(X?new Date(X).getTime():void 0)),K?Object(r.__assign)({},s.s.pack(new Date(K).getTime())):{}),i.n.pack(Q&&"oneNote"===Q.type?{}:void 0)),G?Object(r.__assign)(Object(r.__assign)({},f.e.pack(G)),N.e.pack(!0)):{}),Object(C.e)().forFacet(v.d).thenInvalidate(ie,f.e).pack()),c.pack(l)),R?s.c.pack(R):{}),Y&&Y.width&&Y.height?v.a.pack({width:Y.width,height:Y.height}):{}),Y&&!Z?v.p.pack({}):{}),Z?v.m.pack({}):{}),o.t.pack({itemKey:a.e.serialize({driveItemKey:re,sortBy:"",isAscending:!0})})),s.n.pack({itemKey:h.e.serialize({driveItemKey:re})})),s.A.pack(k?{itemKey:k}:void 0)),!J&&se?Object(r.__assign)({},s.O.pack((function(e){var t=e.split("/");return t.length>2?decodeURI(t[t.length-2]):void 0})(se))):{}),g.e.pack($)),J?Object(r.__assign)({},y.pack(l.vault)):{}),s.h.pack(fe)),O?Object(r.__assign)(Object(r.__assign)({},s.E.pack(!!ee)),p.e.pack(ee)):{}),he?b.e.pack(he):{}),"number"==typeof ae?m.e.pack(ae):{}),b.t.pack(M&&M.mimeType)),le?w.e.pack(le):{}),ce?x.e.pack(ce):{}),U?T.e.pack(U.name):{})}function L(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}}],Array(65),[function(e,t,n){"use strict";var r=n(1),i=n(3664),s=n(2257),o=n(2872),u=n(1243),a=n(854),f=n(3689),l=n(1256);n.d(t,"e",function(){return c});var c=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,h=void 0!==c&&c,p=e.yesText,d=void 0===p?l.e.yes:p,v=e.noText,m=void 0===v?l.e.no:v,g=h?u.e:a.e,y=h?a.e:u.e;return r.createElement(i.e,{dialogContentProps:{type:s.e.close},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},r.createElement(f.e,{className:"confirmTextLabel_e964ecde"},e.prompt),r.createElement(o.e,null,r.createElement(g,{"data-automationid":"confirmbutton",onClick:t},d),r.createElement(y,{"data-automationid":"cancelbutton",onClick:n,componentRef:function(e){e&&e.focus()}},m)))}}],Array(19),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(9),i=n(77),s=new r.e("itemTileFolderCoverControl",{folderCoverAs:Object(i.e)()}),o=new r.e("itemTileControl",{tileAs:Object(i.e)(),folderCoverControlHandler:Object(r.n)(s)})},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"i",function(){return i});n.d(t,"r",function(){return s});n.d(t,"e",function(){return o});n.d(t,"n",function(){return u});function r(e){var t=e.itemId,n=void 0===t?"":t;return u(e)+"/items/"+encodeURIComponent(n)}function i(e){var t=e.name;return u(e)+"/special/"+encodeURIComponent(t)}function s(e){return e.endpoint+"/shares/u!"+e.shareId+"/driveItem"}function o(e){return u(e)+"/commands"}function u(e){var t=e.endpoint,n=e.driveId;return"me"===n?t+"/me/drive":t+"/"+(n?"drives/"+encodeURIComponent(n):"drive")}}],Array(43),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("shared")},function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(4),i=new r.e("uploadProgress",{sourceEntryKey:Object(r.s)()});function s(e){return i.serialize({sourceEntryKey:e})}},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(1021),s=n(57),o=n(359),u=n(33),a=n(115),f=n(2614);function l(e,t,n){var l=this;return function(c){return Object(r.__awaiter)(l,void 0,void 0,function(){var l,h,p,d,v,m,g,y,b,w,E,S,x=this;return Object(r.__generator)(this,function(T){switch(T.label){case 0:l=c(Object(s.e)({graphDataSourceConfiguration:i.e,graphTokenProviderConfiguration:f.e})),h=l.graphDataSourceConfiguration,p=l.graphTokenProviderConfiguration;d=h&&h.ensureAuthToken;v=n&&h&&h.ensureAuthTokenWithAction;m=p&&p.getSessionToken;if(!(y=m?function(){return Object(r.__awaiter)(x,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,m({endpoint:t,driveUrl:n,path:n||t})];case 1:return[2,e.sent().accessToken]}})})}:v?function(){return Object(r.__awaiter)(x,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,c(v(e,t,n))];case 1:return[2,r.sent()]}})})}:d?function(){return Object(r.__awaiter)(x,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,d(e,t)];case 1:return[2,n.sent()]}})})}:void 0))return[3,4];b=c(Object(o.e)({name:"graphDataSource.getAuthToken"}));T.label=1;case 1:T.trys.push([1,3,,4]);return[4,y()];case 2:g=T.sent();c(b({resultType:u.e.Success}));return[3,4];case 3:w=T.sent();E=u.e.Failure;S=void 0;if(w instanceof a.e){w.isExpected&&(E=u.e.ExpectedFailure);S=w.code}else S=w instanceof Error?w.name+"("+w.message+")":"UnknownAuthError";c(b({resultType:E,resultCode:S,error:w&&JSON.stringify(w)}));throw w;case 4:return[2,g]}})})}}function c(e,t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,i(l(["Files.ReadWrite.All"],e,t))];case 1:(n=r.sent())&&(s={accessToken:n});return[2,s]}})})}}}],Array(75),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(4),i=new r.e("userByEmail",{email:Object(r.s)(),endpoint:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Publish=0]="Publish";e[e.Republish=1]="Republish";e[e.PostNews=2]="PostNews";e[e.UpdateNews=3]="UpdateNews";e[e.SubmitForApproval=4]="SubmitForApproval";e[e.CancelApproval=5]="CancelApproval";e[e.SchedulePublish=6]="SchedulePublish"})(r||(r={}))}],Array(76),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(1),i=n(3664),s=n(2872),o=n(1243),u=n(1908),a=function(e){var t=e.title,n=e.prompt,a=e.cancelText,f=e.onCancel;return r.createElement(i.e,{onDismiss:f,hidden:!1,title:t,maxWidth:e.maxWidth},r.createElement(u.e,null,n),r.createElement(s.e,null,r.createElement(o.e,{onClick:f,componentRef:function(e){e&&e.focus()}},a)))}}],Array(17),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(103),i=Object(r.e)(function(e){return{}})},,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return h});n.d(t,"r",function(){return p});n.d(t,"n",function(){return d});n.d(t,"e",function(){return m});var r=n(0),i=n(227),s=n(57),o=n(1282),u=n(359),a=n(33),f=n(3),l=n(461),c=n(115);n(2625);function h(e){return function(t){var n=t(Object(s.e)({spHomeDataSourceConfiguration:f.St})).spHomeDataSourceConfiguration,r=n&&n.contextAcquiresAuthToken;return t(Object(i.r)({webAbsoluteUrl:e.tenantRootUrl,listFullUrl:e.tenantRootUrl,method:"GET",url:v(e),qosName:"getSPHomeContext",parseResponse:function(e){var t=JSON.parse(e).d;return{payloadHeader:t.Payload,resource:t.Urls&&t.Urls.results&&t.Urls.results.length>0&&t.Urls.results[0]||"",accessToken:t.Token&&t.Token.access_token||""}},noRedirect:!0,skipAuth:r,crossSiteCollectionCall:r,needsRequestDigest:!r,ignoreDiskCacheWhenOnline:!0}))}}function p(e,t,n){var i=this;void 0===n&&(n=8);return function(o){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,u,a,l,c,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=o(Object(s.e)({spFrequentSitesConfiguration:f.wt,enableFilesWeightedFrequentSitesConfiguration:f.T})),u=i.spFrequentSitesConfiguration,a=i.enableFilesWeightedFrequentSitesConfiguration;return u&&u.getExternalData?[4,u.getExternalData()]:[3,2];case 1:if(l=r.sent())return[2,l];r.label=2;case 2:return!t&&u&&u.getCacheContext?[4,u.getCacheContext()]:[3,4];case 3:(c=r.sent())&&(t=JSON.stringify(c));r.label=4;case 4:return[4,o(h({tenantRootUrl:e}))];case 5:p=r.sent();return[2,o(m({path:"api/v1/sites/feed?acronyms=true&start=0&count="+n,method:"GET",qosName:"getSPHomeFrequentSites",context:p,clientType:a?"ODBWeb":void 0,cacheContext:t}))]}})})}}function d(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(t=n(Object(s.e)({spFollowedSitesConfiguration:f.bt})).spFollowedSitesConfiguration)&&t.getExternalData?[4,t.getExternalData()]:[3,2];case 1:if(i=r.sent())return[2,i];r.label=2;case 2:return[4,n(h({tenantRootUrl:e}))];case 3:o=r.sent();return[2,n(m({path:"api/v1/sites/followed?acronyms=true&fillsitedata=true&mostRecentFirst=true&start=0&count=36",method:"GET",qosName:"getSPHomeFollowedSites",context:o}))]}})})}}function v(e){var t=e.tenantRootUrl;return Object(o.n)({webAbsoluteUrl:t}).segment("sphomeservice").segment("context").oDataParameter("$expand","Token,Payload").toString()}function m(e){var t=this,n=e.method,s=e.path,o=e.context,f=e.qosName,h=e.clientType,p=e.contentType,d=void 0===p?"application/json;odata=verbose":p,v=e.body,m=e.cacheContext,g=f?"getData."+f:"getData";return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,p,y,b,w,E,S,x,T=this;return Object(r.__generator)(this,function(N){switch(N.label){case 0:t=new Headers;return(p=o.accessToken)?[3,2]:[4,e(Object(i.e)({url:o.resource}))];case 1:p=N.sent();N.label=2;case 2:(f=p)&&t.set("Authorization","Bearer "+f);o.payloadHeader&&t.set("SPHome-ApiContext",o.payloadHeader);m&&t.set("SPHome-CacheContext",m);t.set("SPHome-ClientType",h||"ODSPDocLibsWeb");t.set("Content-Type",d);y={headers:t,credentials:"omit",method:n,mode:"cors",cache:"default",body:v};b=e(Object(u.e)({name:g}));w=o.resource+"/"+s+"__"+n;return[4,e(Object(l.t)(w))];case 3:E=N.sent();S=fetch(o.resource+"/"+s,y).then(function(t){return Object(r.__awaiter)(T,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!t.ok)return[3,2];e(b({resultType:a.e.Success}));return 204===t.status?[2,{}]:[4,t.json()];case 1:n=r.sent();e(Object(l.r)(w,n));return[2,n];case 2:throw new c.e({code:""+t.status,message:t.statusText})}})})}).catch(function(t){e(b({resultType:a.e.Failure,resultCode:t instanceof c.e?t.code:t.name,error:t&&JSON.stringify(t)}));throw t});return(x=E)?[3,5]:[4,S];case 4:x=N.sent();N.label=5;case 5:return[2,x]}})})}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("driveType")},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(4),i=n(154),s=new r.e("searchItemSet",{driveItemKey:Object(r.o)(i.e),searchTerm:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});n.d(t,"i",function(){return g});n.d(t,"r",function(){return y});n.d(t,"n",function(){return b});var r,i=n(3),s=n(6),o=n(53),u=n(891),a=n(2181),f=n(79),l=n(111),c=n(2971),h=n(1054),p=n(920),d="0x0101009D1CB255DA76424F860D91F20E6C4118";(function(e){e[e.publish=0]="publish";e[e.schedule=1]="schedule"})(r||(r={}));function v(e,t){var n,r,a;if(!t)return!1;var h=e.demandItem({firstItemKey:f.e,permissions:i.ze,checkoutInfo:s.y,needsPublishing:i.De},t),d=h.firstItemKey,v=h.permissions,m=h.checkoutInfo,g=h.needsPublishing;if(!d)return!1;var b=e.demandItemFacet(i.we,l.e.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}));return Boolean(g&&o.e.hasItemPermission({permissions:v},o.e.editListItems)&&(null===(n=b)||void 0===n?void 0:n.enableMinorVersions)&&(null===(r=b)||void 0===r?void 0:r.isDocumentLibrary)&&!(null===(a=m)||void 0===a?void 0:a.byOther)&&!p.e(e,t)&&!(function(e,t){var n=t.itemKey,r=t.listFacets,s=e.demandItem({moderationStatusType:i.Ae},n).moderationStatusType;if(r&&r.isModerated)return"number"==typeof s&&s!==u.e.draft&&s!==u.e.denied&&s!==u.e.pending;var o=y(e,n);return 0===o.minor&&0!==o.major})(e,{itemKey:t,listFacets:b})&&!c.t(e,{itemKey:t,includeOneNote:!0}))}function m(e){return e?""+512*(Math.floor(Number(e)/512)+1):""}function g(e){return!!e&&0===e.indexOf(d)}function y(e,t){var n=e.demandItem({uiVersion:i.Rt},t).uiVersion;return Object(h.t)(n)}function b(e,t){var n,r=e.demandItem({firstItemKey:f.e,moderationStatusType:i.Ae},t),s=r.firstItemKey,o=r.moderationStatusType;return s?(null===(n=e.demandItemFacet(i.we,l.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})))||void 0===n?void 0:n.isModerated)?o===u.e.pending?a.e.CancelApproval:a.e.SubmitForApproval:p.t(e,t)?a.e.SchedulePublish:0===y(e,t).major?a.e.Publish:a.e.Republish:a.e.Publish}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(79),s=n(3),o=n(1615),u=n(26);function a(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=n(Object(u.e)(function(t){return t.demandItemFacet(i.e,e)}));return[4,n(Object(o.demandItems)(function(t){return t.demandItem({listItemId:s.Se},e)}))];case 1:a=r.sent().listItemId;if(!t)throw new Error("Cannot get spItemKeyFacet for itemKey: "+e);if(!(f=a||t.itemId))throw new Error("Cannot find itemId for itemKey: "+e);return[2,{key:t,itemId:f}]}})})}}}],Array(86),[function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(2),o=n(749),u=n(99),a=n(2647),f=n(8),l=n(30),c=n(16),h=n(48),p=n(893),d=n(163),v=n(2388),m=n(6),g=n(88),y=n(587),b=n(2980),w=n(50),E=new d.e("newDocument"),S=Object(y.e)()(v.e),x=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onItemOpened=function(){n.setState({fileCreated:!1,isItemOpened:!0})};n.state={newDocumentKey:E.serializeNext()};return n}t.prototype.render=function(){var e=this,t=this.state,n=t.newDocumentKey,s=t.fileCreated,o=t.isItemOpened,u=this.props,a=u.itemCacheDispatch,f=u.itemKey,c=u.parentFolderDriveItemUrl,h=u.action,d=Object(r.__rest)(u,["itemCacheDispatch","itemKey","parentFolderDriveItemUrl","action"]),v=h.availableOn,y=v&&v.file&&v.file.extensions&&v.file.extensions[0]&&v.file.extensions[0].replace(".",""),b=!!y&&!!h.handler,E=void 0;if(b&&y){var x=!h.handler.isPromoted;x&&!c||(E=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,a(Object(p.e)({items:(e={},e[f]={newDocumentKey:n,extension:y},e)}))];case 1:t.sent();x&&c&&a((i={newDocumentKey:n,parentFolderDriveItemUrl:c},function(e){var t,n=i.newDocumentKey,s=i.parentFolderDriveItemUrl,o=e(Object(g.e)({fileName:m.l},n));if(!o||!o.fileName)throw"FileHandler create action: fail to get file name of the new document";var u=s+":/"+o.fileName+":";e(Object(w.e)({items:(t={},t[n]=Object(r.__assign)({},m.j.pack(u)),t)}))}));this.setState({fileCreated:!0,isItemOpened:!1});return[2]}var i})})})}return s?o?null:i.createElement(S,Object(r.__assign)({},d,{onComplete:this._onItemOpened,isAvailable:!0,itemKeys:[n],action:h})):i.createElement(l.e,Object(r.__assign)({},d,{isAvailable:b,onExecute:E}))};return t})(i.Component),T=Object(c.i)()(Object(f.t)(function(e,t){var n=t.itemKey,i=t.action,s=e.demandItemFacet(b.e,n),o=b.e.evaluate(s)(e,{itemKey:n}).driveItemFullUrl,u=i.handler,a=u.appId,f=u.isPromoted?"PromotedFileHandlerCreate":"FileHandlerCreate",l={appId:a};return Object(r.__assign)(Object(r.__assign)({},Object(h.e)(e,{itemKey:n,engagement:{name:f,isIntentional:!0,extraData:l}})),{parentFolderDriveItemUrl:o||""})})(x));var N=Object(c.s)()(Object(f.t)(function(e,t){var n=t.itemKeys,i=t.action,s=i.availableOn,o=s.allowMultiSelect,u=void 0!==o&&o,a=n.length,f=u&&a>0||1===a;f&&(f=n.every(function(t){var n=e.demandItem({fileName:m.h,isFolder:m.d},t),r=n&&n.fileName,i=r&&r.extension||"",o=n&&n.isFolder||!1;return Object(v.t)(s,i,Boolean(o))}));var l=i.handler,c=l.appId,p=l.isPromoted?"PromotedFileHandlerCustom":"FileHandlerCustom",d={appId:c};return Object(r.__assign)({isAvailable:f},Object(h.e)(e,{itemKey:n[0],engagement:{name:p,isIntentional:!0,extraData:d}}))})(v.e)),C=n(3374),k=n(25),L=n(12),A=n(65),O=n(156),M="fileHandlerCommandIcon_1aaa825b",_=n(1072),D=n(2642);n.d(t,"e",function(){return I});n.d(t,"t",function(){return q});var P=new s.e("fileHandlerOpenCommand").id,H=new s.e("fileHandlerCreateCommand").id,B=new s.e("fileHandlerCustomCommand").id,j=new s.e("fileHandlerAppCommand").id,F=new s.e("fileHandlerActionsCommand").id,I=function(e,t){var n=t.itemKey,r=t.collapseCustomCommands,i=e.demandItem({actions:O.t,version:O.a},n),s=i.actions,o=i.version;if(o&&4===o&&s){var u=function(t){var n=s&&s[t],r=e.demandItemFacet(L.e,n);return r&&r.itemKeys||[]};return{new:U(e,{actionKeys:u("create"),type:"create"})||[],open:U(e,{actionKeys:u("open"),type:"open"})||[],custom:U(e,{actionKeys:u("custom"),type:"custom",collapseCustomCommands:r})||[]}}},q=function(e,t,n){var r=n?t:e,i=n?e:t,s=r,o={};r.forEach(function(e){o[e.key]=!0});i.forEach(function(e){o[e.key]||s.push(e)});return s};function R(e,t){var n,r,s,f,l,c=t.itemKey,h=t.type,p=t.CustomAction,d=void 0,v=void 0;if("app"===h){d=c;if(!(D=c&&e.demandItem({displayName:m.l,appIcon:O.n},c)))return;s=j+"-"+c;f="itemsScopefileHandlerAppCommand";n=D.displayName;D.appIcon&&D.appIcon.url&&(r={iconType:o.e.Image,className:M,imageProps:{src:D.appIcon&&D.appIcon.url||"",title:D.displayName||"",imageFit:u.t.contain,className:M}})}else{var g=e.demandItem({displayName:m.l,handlerKey:O.o,availableOn:O.e,icon:O.i,isPromoted:O.s},c),y=g.displayName,b=g.handlerKey,w=g.availableOn,E=g.icon;v=g.isPromoted;var S=b&&e.demandItemFacet(O.n,b),x="open"===h&&S||E;x&&x.url&&(r={iconType:o.e.Image,className:M,imageProps:{src:x&&x.url,title:x&&x.displayName,imageFit:u.t.contain,className:M}});var L=Object(_.e)(e,{itemKey:c});n=y;switch(h){case"open":if(!n&&b){var D;n=(D=c&&e.demandItem({displayName:m.l},b))&&D.displayName&&k.format(C.e.openWithCommand,D.displayName)}s=P;f="itemsScopefileHandlerOpenCommand";l=p?i.createElement(p,{action:L}):i.createElement(a.e,{action:L});break;case"create":n||(n=E&&E.displayName||w&&w.file&&w.file.extensions&&k.format(C.e.createFileWithExtension,w.file.extensions[0])||"");s=H;f="itemsScopefileHandlerCreateCommand";l=i.createElement(A.e,null,i.createElement(T,{action:L}));break;case"custom":s=B;f="itemsScopefileHandlerCustomCommand";y&&(f=y.toLowerCase().replace(/\s+(.)/g,function(e,t){return t.toUpperCase()})+"Command");l=p?i.createElement(p,{action:L}):i.createElement(N,{action:L})}s+="-"+c;d=b}if(s&&n)return{key:s,automationId:f,name:n,iconProps:r,action:l,handlerKey:d,isPromoted:v,fileHandlerType:h}}function U(e,t){var n=t.actionKeys,i=t.type,s=t.collapseCustomCommands,o=void 0===s||s,u=[];if("open"===i){var f=e.demandItemFacet(D.n,n[0]),l=D.n.evaluate(f)(e,{openActionAs:a.e}).openActionAs;n.forEach(function(t){var n=R(e,{itemKey:t,type:i,CustomAction:l});n&&u.push(n)})}else if("create"===i)n.forEach(function(t){var n=R(e,{itemKey:t,type:i});n&&u.push(n)});else if("custom"===i){f=e.demandItemFacet(D.t,n[0]);var c=D.t.evaluate(f)(e,{customActionAs:N}).customActionAs,h=(function(e,t){var n=t.actionKeys,i=t.collapseCustomCommands,s=t.CustomAction,o=void 0,u=[],a={},f=function(t){return R(e,{itemKey:t,type:"custom",CustomAction:s})},l=function(t,n){var r=R(e,{itemKey:t,type:"app"});r&&n&&n.length>0&&(r.subMenuProps={items:n});return r};if(i){for(var c=0,h=n;c<h.length;c++){var p=h[c],d=f(p);if(d){var v=d.handlerKey||"";if(o){if(!o.subMenuProps){var m=Object(r.__assign)({},o),g=Object.keys(a)[0];if(E=l(g)){o=E;if(v===g){E.subMenuProps={items:[m,d]};continue}}}var y=Object.keys(a).length;if(void 0!==a[v]){var b=o.subMenuProps;if(1===y)b&&b.items.push(d);else{var w=a[v];if(b){var E;(E=b.items[w]).subMenuProps&&E.subMenuProps.items.push(d)}}}else{var S=l(v,[d]);if(!S)continue;if(1===y){var x=Object(r.__assign)({},o);o={key:""+F,automationId:"itemsScopefileHandlerActionsCommand",name:C.e.fileHandlerRootActionsMenu,iconProps:{iconName:"SetAction",ariaLabel:C.e.fileHandlerRootActionsMenuAriaLabel,className:M},subMenuProps:{items:[x,S]}};a[v]=1}else{o.subMenuProps&&o.subMenuProps.items.push(S);a[v]=y}}}else{o=d;a[v]=0}}}o&&(u=[o])}else for(var T=0,N=function(e){var t=f(e);if(!t)return"continue";var n=t.handlerKey||"",i=l(n,[t]),s=!1;if(i){Object.keys(a).forEach(function(e){if(n===e){s=!0;var i=u[a[e]];i.subMenuProps&&(i.subMenuProps={items:Object(r.__spreadArrays)(i.subMenuProps.items,[t])})}});if(!s){a[n]=T;T++;u.push(i)}}else{a[n]=T;T++;u.push(t)}},k=0,L=n;k<L.length;k++){p=L[k];N(p)}return u})(e,{actionKeys:n,collapseCustomCommands:o,CustomAction:c});h&&u.push.apply(u,h)}return u}},,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(8),o=n(16),u=n(30),a=n(3664),f=n(2872),l=n(1243),c=n(3986),h=n(986),p=n(2642),d=n(88),v=n(6),m=n(2989),g=n(1522),y=n(2104);function b(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.appId,i=e.itemKeys,s=e.getPreAuthUrl,o=e.driveUrl;if(!s)return[2,i.map(function(e){return n(Object(d.e)({vroomUrl:v.j},e)).vroomUrl||""})];u=i.map(function(e){return n(Object(d.e)({fullUrl:v.i},e)).fullUrl||""});return[4,n(Object(y.e)(o,o))];case 1:a=r.sent();return[2,new m.e({},{dataRequestor:n(g.e).dataRequestor}).getPreAuthUrls({appId:t,items:u,accessToken:a,driveUrl:o})]}})})}}var w=n(167),E=n(3375),S=n(154),x=n(2051),T=n(24);n.d(t,"e",function(){return C});n.d(t,"t",function(){return k});var N=Object(s.i)(function(e,t){var n,s=t.itemKeys,o=t.action,d=t.isAvailable,v=t.itemKey,m=o.handler,g=m.appId,y=m.isPromoted,N="",C=v||(1===s.length?s[0]:""),k=e.demandItem({controlHandler:p.e,driveItemKey:S.e},C),L=k.controlHandler,A=k.driveItemKey;(N=A&&Object(x.n)(A)||"").indexOf("/v2.1")>-1&&(N=N.replace("/v2.1","/v2.0"));var O=p.e.evaluate(L)(e,{itemKey:C}).sharedPostData;n=O;var M=e.dispatch;if(!(d&&o.url&&n&&N))return null;var _=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t,i;return Object(r.__generator)(this,function(u){switch(u.label){case 0:e=window.open("","_blank");return[4,M(b({appId:g,itemKeys:s,getPreAuthUrl:!y,driveUrl:N})).catch(function(){})];case 1:if((t=u.sent())&&t.length>0&&e&&e.document){e.opener=null;i=JSON.stringify(t||[]);Object(h.e)({url:o.url,postdata:Object(r.__assign)(Object(r.__assign)({},n),{appId:g,items:i}),document:e.document})}else e&&e.close();return[2]}})})},D=y?Object(T.o)(function(e){var t=e.resolve,n=e.reject,s=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){n(new w.e);return[2]})})};return i.createElement(a.e,{dialogContentProps:{title:E.e.consentDialogTitle,onDismiss:s},hidden:!1},i.createElement("p",null,E.e.consentDialogMessage),i.createElement(f.e,null,i.createElement(l.e,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:t();return[4,_()];case 1:e.sent();return[2]}})})}},E.e.consentDialogContinueButton),i.createElement(c.e,{onClick:s},E.e.consentDialogCancelButton)))}):_;return i.createElement(u.e,Object(r.__assign)({isAvailable:d,onExecute:D},t))}),C=Object(o.e)()(N);function k(e,t,n){var r=e.file,i=e.folder,s=e.file&&e.file.extensions||void 0;return!0===n?!!i:!(!r||!t)&&(!s||-1!==s.indexOf(t.toLowerCase())||-1!==s.indexOf("*")||-1!==s.indexOf(".*"))}}],Array(28),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(66),s=n(329),o=n(26),u=n(415),a=n(9),f=n(167),l=n(311);function c(e,t,n){var h=this;void 0===n&&(n={});var p=n.cancelToken,d=n.flushOperationQueue,v=n.contextualControlHandlers,m=void 0===v?a.t:v,g=n.owner;return function(n,a){return Object(r.__awaiter)(h,void 0,void 0,function(){var h,v,y,b,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:h=n(s.t);v=n(l.e);y={selector:e,operation:c,owner:g};E.label=1;case 1:E.trys.push([1,,6,7]);b=function(){var s,l,c,g,b,w;return Object(r.__generator)(this,function(r){switch(r.label){case 0:s=h.evaluate({selector:e,controlHandlers:m,owner:y,state:a()}),l=s.result,c=s.demands,g=s.dependencies;return(b=t(l))?[4,b]:[3,2];case 1:r.sent();r.label=2;case 2:w={items:c,flushOperationQueue:d};v.recordLastAccesses(g,Date.now());if(!n(Object(o.e)(function(e){return Object(u.t)(e,w)})))return[2,{value:void 0}];v.registerDemands(y,g);p&&p.throwIfCanceled();return[4,Object(f.r)(n(Object(i.t)(w)),p)];case 3:r.sent();return[2]}})};E.label=2;case 2:return[5,b()];case 3:if("object"==typeof(w=E.sent()))return[2,w.value];E.label=4;case 4:return[3,2];case 5:return[3,7];case 6:v.removeDemands(y);return[7];case 7:return[2]}})})}}},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(309);function i(e){switch(e){case r.e.Word:return".docx";case r.e.Excel:case r.e.ExcelSurvey:case r.e.ExcelForm:return".xlsx";case r.e.PowerPoint:return".pptx";case r.e.OneNote:return"";case r.e.Text:return".txt";case r.e.Visio:return".vsdx";case r.e.Bohemia:return".b";case r.e.Prague:return".prague"}}function s(e,t){var n="";switch(e){case r.e.Word:n=t.CreateWord;break;case r.e.Excel:n=t.CreateExcel;break;case r.e.PowerPoint:n=t.CreatePowerPoint;break;case r.e.OneNote:n=t.CreateOneNote;break;case r.e.ExcelSurvey:n=t.CreateExcelSurvey;break;case r.e.Text:n=t.CreateText;break;case r.e.ExcelForm:n=t.CreateFormForExcel;break;case r.e.Visio:n=t.CreateVisio;break;case r.e.Bohemia:n=t.CreateBohemia;break;case r.e.Prague:n=t.CreatePrague}return n}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(9),i=new r.e("progressListGroupControl",{}),s=new r.e("progressListControl",{groupControlHandler:Object(r.n)(i)})},,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});var r=n(0),i=n(2),s=n(337),o=n(119),u=new i.e("moveCopyItems"),a=new o.e("moveCopyItems"),f=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(s.e)},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(2),i=n(71),s=new r.e("pinSite"),o=Object(i.i)({operationTypeFacet:s});t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("officeApp")},function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r="root",i="/drive/root:",s=30},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"n",function(){return u});n.d(t,"e",function(){return a});var r=n(2),i=n(119),s=n(71),o=new r.e("removeFromOneDrive"),u=new i.e("removeFromOneDrive"),a=Object(s.i)({operationTypeFacet:o})},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(2543),i=n(309),s=n(2421),o=n(1282);function u(e){var t=e.responseText,n=e.documentType,i=e.fileName,s="",o="";if(null!=t){var u=JSON.parse(t);if(null!==u&&null!==u.d&&null!==u.d.CreateDocumentAndGetEditLink){o=u.d.CreateDocumentAndGetEditLink;s=Object(r.t)(o,n,i||"",!1)}else try{o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"";s=Object(r.t)(o,n,i||"",!1)}catch(e){}}return{originalEditLink:o,redirectUrl:s}}function a(e){var t=i.e.Visio,n=e.webAbsoluteUrl,r=e.listFullUrl,u=e.parentFolderPath,a=e.templateUrl,f=e.docName,l=e.docType;if(null!==l&&l>=i.e.Word&&l<=t&&l!==i.e.Text){if(l!==i.e.OneNote||f){if(f){f+=Object(s.t)(l)}}else f="Notebook"+Math.floor(100*Math.random())+1;f||(f="");l===i.e.ExcelForm&&(l=i.e.ExcelSurvey);return Object(o.e)({webAbsoluteUrl:n,listFullUrl:r}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:f,folderPath:u,documentTemplateType:l,templateUrl:a||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r,i=n(25),s=n(3370);(function(e){e[e.InvalidStart=0]="InvalidStart";e[e.InvalidEnd=1]="InvalidEnd";e[e.InvalidCharacters=2]="InvalidCharacters";e[e.Empty=3]="Empty"})(r||(r={}));function o(e){return function(t){return(function(e,t){switch(e){case r.InvalidCharacters:return i.format(s.e.invalidNameError,t.invalidCharacters);case r.InvalidStart:return i.format(s.e.invalidNameStartError,t.cannotStartWith);case r.InvalidEnd:return i.format(s.e.invalidNameEndError,t.cannotEndWith);case r.Empty:return s.e.emptyNameError;case void 0:return}})((function(e,t){var n=e.trim();return 0===n.length?r.Empty:t.invalidCharactersRegex.test(n)?r.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(n)?r.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(n)?r.InvalidEnd:void 0})(t,e),e)}}var u=o({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),a=o({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(227),i=n(1282),s=n(23),o=n(401);function u(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){return{serverView:t,view:f(t,!1,e.listTemplate)}})},noRedirect:!0}))}}function a(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewDataById",parseResponse:function(e){var t=JSON.parse(e).d;return{serverView:t,view:f(t,!0)}},noRedirect:!0}))}}function f(e,t,n){if(e.ViewType&&e.Id){var r=o.e.isAppView(e),i=e.Hidden&&!r,u=n===s.t.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!i&&!u){var a=new o.e(e);if(a.viewType)return a}}}var l=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function c(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,s=Object(i.e)({webAbsoluteUrl:t,listFullUrl:n});return(s=r?s.method("Views",r):s.segment("Views")).oDataParameter("$select",l).toString()}},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r,i=n(2),s=n(71);(function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter";e[e.saveColumnFormatter=1]="saveColumnFormatter";e[e.previewViewFormatter=2]="previewViewFormatter";e[e.saveViewFormatter=3]="saveViewFormatter"})(r||(r={}));var o=new i.e("updateFormatter"),u=Object(s.i)({operationTypeFacet:o})},function(e,t,n){"use strict";n.d(t,"n",function(){return s});n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(2),i=n(119),s=new r.e("removeItemsFromSharedList"),o=new i.e("removeItemsFromSharedList"),u=Object(i.s)({operationTypeFacet:s,progressKeyFacet:o})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1),s=n(2),o=n(357),u=n(919),a={key:new s.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:i.createElement(u.t,null),facets:Object(r.__assign)({},o.e.pack(!0))}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1),s=n(2),o=n(357),u=n(897),a={key:new s.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:i.createElement(u.n,null),facets:Object(r.__assign)({},o.e.pack(!0))}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return b});n.d(t,"t",function(){return w});var r=n(0),i=n(1),s=n(16),o=n(30),u=n(50),a=n(12),f=n(79),l=n(80),c=n(178),h=n(3),p=n(401),d=n(24),v=n(363),m=n(208),g=n(48),y=n(8),b=Object(y.i)(function(e,t){var n=t.itemKey,s=t.itemSetKey,y=t.viewId,b=t.currentDerivedView,w=e.demandItemFacet(f.e,n);if(!w)return null;var E=w.webAbsoluteUrl,S=w.listFullUrl,x=e.demandItemFacet(l.e,s),T=l.e.serialize({webAbsoluteUrl:E,listFullUrl:S,rootFolder:x&&x.rootFolder||"",viewKey:{viewId:y}}),N=b&&c.e.serialize({viewId:b.id}),C=e.isItemFacetResolved(h.it,N)?e.demandItemFacet(h.it,N):void 0,k=Object(g.e)(e,{itemKey:n,engagement:{name:"SwitchView",isIntentional:!0}}),L=e.dispatch,A=Object(d.i)(e,i.createElement(v.e,{itemKey:T}));return i.createElement(d.n,{action:A},function(e){var t=e.isAvailable,s=e.execute;return i.createElement(o.e,Object(r.__assign)({isAvailable:t,isToggled:b?y===b.id:""===y,onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(f){switch(f.label){case 0:L(Object(u.e)({items:Object(r.__assign)(Object(r.__assign)({},N?(t={},t[N]=Object(r.__assign)(Object(r.__assign)({},h.st.pack(!1)),C&&b&&b.isDirty()?Object(r.__assign)({},h.p.pack(new p.e(C))):{}),t):{}),n?(i={},i[T]=Object(r.__assign)({},a.i.pack({itemKey:n})),i):{})}));N&&b&&b.isDirty()&&L(Object(m.t)({items:(o={},o[N]=[h.it,h.p],o)}));return[4,s(e)];case 1:f.sent();return[2]}})})}},k))})}),w=Object(s.e)()(b)},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(9).e)("saveViewActionControl")}],Array(81),[function(e,t,n){"use strict";var r=n(1),i=n(268),s=n(2),o=n(6),u=n(363),a=n(16),f=n(8),l=Object(f.i)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.A,n),s=i&&i.itemKey;return r.createElement(u.e,{itemKey:s})}),c=Object(a.i)()(l);n.d(t,"e",function(){return h});var h={key:new s.e("NavigateUpShortcut").id,automationId:"NavigateUpShortcut",shortcutProps:{keySequences:["AltUp"],content:i.e.altUpDesc},action:r.createElement(c,null)}},,function(e,t,n){"use strict";var r=n(1),i=n(247),s=n(24),o=n(1356),u=n(577),a=n(6),f=n(266),l=n(408),c=n(531);n.d(t,"e",function(){return h});var h=function(e){var t=e.itemKey,n=e.action;return r.createElement(i.e,null,function(i){var h,p=i.itemCache;if(e.children)h=e.children;else{var d=p.demandItemFacet(a.l,t);h=d}var v=Object(f.e)(p),m=(n||!(function(e,t){var n=Object(l.e)(e,{itemKey:t.itemKey1}),r=Object(l.e)(e,{itemKey:t.itemKey2});return Object(c.e)(e,{itemKey:n})===Object(c.e)(e,{itemKey:r})})(p,{itemKey1:t,itemKey2:v}))&&t?r.createElement(u.e,{itemKey:t}):null;return r.createElement(s.n,{action:m},function(e){var t=e.isAvailable,n=e.execute,i=t?function(){n().catch(function(){})}:void 0;return i?r.createElement(o.e,{onClick:i},h):r.createElement("span",null,h)})})}},function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(3280),o=n(2),u=n(357),a=n(845),f=n(16),l=n(30),c=n(607),h=n(8),p=n(3),d=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.canOpenInOffice?i.createElement(l.e,null):i.createElement(c.t,null)};return t})(i.PureComponent);var v=Object(h.t)(function(e,t){var n=t.itemKey;return{canOpenInOffice:!!e.demandItem({appMap:p.Ie},n).appMap}})(d),m=Object(f.s)()(Object(f.r)()(v)),g=n(2456),y=n(2455);n.d(t,"t",function(){return b});n.d(t,"e",function(){return w});var b={key:a.e.key,automationId:a.e.automationId,name:a.e.name,subMenuProps:{items:[y.e,g.e],contextualMenuItemAs:s.t},facets:Object(r.__assign)({},u.e.pack(!0))},w={key:new o.e("fallbackOpen").id,automationId:"fallbackOpen",name:a.e.name,action:i.createElement(m,null),facets:Object(r.__assign)({},u.e.pack(!0))}},,function(e,t,n){"use strict";var r=n(147),i=n(1),s=n(1086),o=n(6),u=n(24),a=n(577),f=n(317),l=n(8);var c=n(214),h=n(49),p=n(639),d=n(640),v=n(629),m=n(630),g=n(628);n.d(t,"e",function(){return y});var y=Object(p.e)({key:c.r,name:r.e.Name,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:h.r},[d.e,g.e,function(e,t){var n=t.itemKey,r=t.renderer,c=e.demandItemFacet(o.A,n),h=c&&e.demandItemFacet(o.L,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new f.e(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?Object(l.s)(e,i.createElement(a.e,{itemKey:c.itemKey})):null;return{renderer:function(e,t,n){var o=r?r(e,t,n):null;return i.createElement(i.Fragment,null,o?i.createElement(i.Fragment,{key:"content"},o):null,d?i.createElement(u.n,{key:"path",action:d},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return i.createElement(s.e,{displayPathSegments:p,parentLink:h,onClick:n})}):null)}}},v.e,m.e])},function(e,t,n){"use strict";var r=n(1),i=n(302),s=n(2),o=n(592),u=n(403),a=n(27),f=n(0),l=n(16),c=n(8),h=n(30),p=n(79),d=n(390),v=n(111),m=n(3),g=n(23),y=n(948),b=n(507),w=n(53),E=n(48),S=n(51),x=function(){return Object(f.__awaiter)(void 0,void 0,void 0,function(){return Object(f.__generator)(this,function(e){return[2]})})},T=Object(l.s)()(Object(l.r)()(Object(c.t)(function(e,t){var n=t.itemKey,r=t.isEditForm,i=!1,s=x;if(Object(S.e)(e,{enableEditOrViewItemCommandConfiguration:m.x}).enableEditOrViewItemCommandConfiguration){var o=e.demandItem({key:p.e,itemId:m.Se,contentTypeId:m.c,permissions:m.ze},n),u=o.key,a=o.itemId,l=o.contentTypeId,c=o.permissions;if(u&&a&&(!r||c&&w.t.hasItemPermission({permissions:c},w.t.editListItems))){var h=u&&e.demandItemFacet(m.Mt,d.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));if(h&&!h.isAnonymousGuestUser){var T=e.demandItem({list:m.we,listFormUrls:m.Ee},v.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),N=T.list,C=T.listFormUrls,k=C?r?C.editFormUrl:C.displayFormUrl:void 0;if(N&&C&&N.templateType&&N.templateType!==g.n.mySiteDocumentLibrary&&k){var L=Object(y.e)(k,u.rootFolder||new b.e(u.listFullUrl).path,a,l);i=!0;s=function(){return Object(f.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(f.__generator)(this,function(t){(e=window.open(L,"_blank"))&&e.focus();return[2]})})}}}}}return Object(f.__assign)({isAvailable:i,onExecute:s},Object(E.e)(e,{itemKey:n,engagement:{name:r?"OpenItemEditForm":"OpenItemDisplayForm",isIntentional:!0}}))})(h.e))),N=n(2985),C=n(522),k=n(945),L=n(526);n.d(t,"t",function(){return A});n.d(t,"e",function(){return M});var A={key:new s.e("ViewItem").id,name:a.e.Open,action:r.createElement(T,null)},O={key:new s.e("EditItem").id,name:i.e.Edit,action:r.createElement(N.e,null),iconProps:{iconName:"Edit"}};function M(e){return[k.e,Object(L.e)(e),O,u.n,u.t,o.e,C.e]}}],Array(39),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(1),i=n(1085),s=n(142),o=n(84),u=0;function a(e){var t=e.isDefault,n=void 0!==t&&t,o=r.useState(""+ ++u)[0],a=r.useContext(i.e),l=r.useRef(),c=l.current||n&&a.keyboardManager||(l.current=new i.t({isDefault:!1,id:o,parent:a.keyboardManager})),h=f(c),p=h.isActive,d=h.isChildActive;r.useEffect(function(){return function(){if(!n){c.setIsActive(!1);c.dispose()}}},[]);var v=r.useMemo(function(){return{keyboardManager:c}},[c]);return r.createElement("div",{"data-keyboard-zone-id":o},r.createElement(i.e.Provider,{value:v},Object(s.t)(e.children,{isActive:p,isChildActive:d})))}function f(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],s=r.useState(function(){return e.hasActiveChildren()}),u=s[0],a=s[1];r.useEffect(function(){var t=new o.e(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:n,isChildActive:u}}},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(72),s=n(12),o=n(80),u=n(210),a=n(63),f=n(367),l=n(29);var c=Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("550").then(n.bind(null,3086))];case 1:return[2,e.sent().SortActionExecutor]}})})},function(e,t){var n=t.sortFieldKey,i=t.itemSetKey,s=t.isAscending,u=e.demandItemFacet(o.e,i);if(!u)return!1;var c=Object(a.e)(e).itemsScopeItemKey;if(!c)return!1;var h=o.e.serialize(Object(r.__assign)(Object(r.__assign)({},u),{sortFieldKey:n,sortAscending:s})),p=e.demandItemFacet(f.e,h),d=f.e.evaluate(p)(e,{itemKey:h,itemsScopeItemKey:c,isAvailable:!0}),v=d.itemKey;if(!d.isAvailable)return!1;var m=e.demandItemFacet(l.n,c),g=m&&m.itemKey;return!!v&&v!==g},function(e,t){var n=t.sortFieldKey,r=t.itemSetKey,i=t.isAscending,a=e.demandItemFacet(o.e,r);if(!a)return!1;var f=e.demandItemFacet(s.o,r),l=f&&e.demandItemFacet(u.e,f.columnKey),c=l&&l.internalName||a.sortFieldKey,h=f?f.isAscending:a.sortAscending;return c===n&&h===i})},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphTokenProvider")},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=n(119),s=new r.e("assignItemToGroup"),o=new i.e("assignToGroup")},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return C});var r=n(0),i=n(79),s=n(111),o=n(3687),u=n(227),a=n(3),f=n(197),l=n(875),c=n(88),h=n(1932),p=n(50),d=n(2),v=n(76),m=n(1282),g=n(26),y=n(14),b=n(167),w=n(248),E=n(2959),S=n(1781),x=n(1545),T=n(6),N=n(23);function C(e){var t=this,n=e.itemKey,x=e.options.sourceEntries,C=i.e.deserialize(n),L=C.webAbsoluteUrl,A=C.listFullUrl,O=Object.keys(x)[0],M=x[O],_=M.progressItemKey,D=M.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,x,M,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te;return Object(r.__generator)(this,function(ne){switch(ne.label){case 0:t=e(Object(u.n)({webAbsoluteUrl:L,listFullUrl:A})),x=t.dataRequestor,M=t.hasDigest;if(!t.hasTokenProvider)return[3,1];H=void 0;return[3,3];case 1:return[4,e(Object(u.e)({url:L||A,disallowCookies:!M}))];case 2:H=ne.sent();ne.label=3;case 3:P=H;B=e(Object(c.e)({sourceFile:h.t},O)).sourceFile;j=e(Object(c.e)({folderPath:a.G},n)).folderPath,F=void 0===j?C.rootFolder:j;if(!B)throw new Error("No source file for upload.");if(!F)throw new Error("No path information for target folder.");I=Object(m.r)({webAbsoluteUrl:L,listOrItemFullUrl:A});q=new f.e(void 0);R=q.debounce(function(t){var n;_&&e(Object(p.e)({items:(n={},n[_]=Object(d.n)({progressSize:v.m},{progressSize:{current:t}}),n)}))},300,{leading:!1});U=e(Object(g.e)(function(e){return e.demandItemFacet(a.we,s.e.serialize({webAbsoluteUrl:L,listFullUrl:A}))}));z=U&&U.contentTypesEnabled&&U.templateType!==N.t.mySiteDocumentLibrary;(W=new o.e({authToken:P,dataRequestor:x,parentItemKey:"",targetItemKey:"",fileUpload:B,iconName:"",serverRelativeItemUrl:F,webApiUrl:I,onProgress:R,expandAllItemFields:z})).nameConflictBehavior="replace"===D?1:0;_&&e(Object(p.e)({items:(ee={},ee[_]=Object(r.__assign)({},v.m.pack({total:B.size,current:0})),ee)}));X=W.start();V=e(Object(g.e)(function(e){return e.demandItemFacet(v.i,_)}));$=V?V.token.subscribe(function(){W.abort()}):void 0;ne.label=4;case 4:ne.trys.push([4,6,7,8]);return[4,X];case 5:ne.sent();return[3,8];case 6:J=ne.sent();W.abort();if(y.n.isCanceled(J))throw new b.e;if(J instanceof S.e)throw new l.e({facets:k(J),innerError:J});if(Object(E.t)(J))throw new l.e({facets:Object(r.__assign)(Object(r.__assign)({},"-2130575257"===J.code?Object(r.__assign)({},w.n.pack({supportsRename:!1})):Object(r.__assign)({},w.d.pack({}))),a.dt.pack(J)),message:Object(E.e)(J)});throw J;case 7:$&&$();W.dispose();return[7];case 8:K=W.item;Q=K.properties;G=Q&&Q.ID||K.id;Y=Q&&Q.uniqueId;Z=i.e.serialize({webAbsoluteUrl:L,listFullUrl:A,itemId:G});e(Object(p.e)({items:(te={},te[Z]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},T.l.pack(K.displayName)),Y?a.Ut.pack(Y):{}),T.A.pack({itemKey:n})),te)}));return[2,{itemKey:Z}]}})})}}function k(e){switch(e.errorType){case x.e.conflict:return Object(r.__assign)({},w.n.pack({supportsRename:!1}));case x.e.accessDenied:return Object(r.__assign)({},w.e.pack({}));case x.e.disconnected:return Object(r.__assign)({},w.h.pack({}));case x.e.emptyFileOrFolder:case x.e.emptyFileOrFolderForDocLib:return Object(r.__assign)({},w.r.pack({}));case x.e.folderUploadNotSupported:return Object(r.__assign)({},w.o.pack({}));case x.e.invalidName:return Object(r.__assign)({},w.a.pack({}));case x.e.lockMismatch:return Object(r.__assign)({},w.l.pack({}));case x.e.malwareDetected:return Object(r.__assign)({},w.c.pack({}));case x.e.overQuota:return Object(r.__assign)({},w.p.pack({}));case x.e.targetFolderMissing:return Object(r.__assign)({},w.v.pack({}));case x.e.throttled:return Object(r.__assign)({},w.m.pack({}));case x.e.versionMismatch:return Object(r.__assign)({},w.g.pack({}))}return Object(r.__assign)({},w.d.pack({}))}},function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointItemByFullUrlAddon",function(){return O});var r=n(0),i=n(22),s=n(71),o=n(42),u=n(317),a=n(44),f=n(463),l=n(1087),c=n(15),h=n(1023),p=n(111),d=n(50),v=n(165),m=n(833),g=n(79),y=n(80),b=n(390),w=n(3),E=n(6),S=n(12),x=n(267),T=n(236),N=n(509),C=n(88),k=n(255),L=n(314),A=n(271),O=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(d.t)({keyFacet:h.e,facets:[g.e,E.l,E.h,w.Ut,E.d,w.G,S.t,w.ke,k.e,k.t,w.ze,E.i]}));e(Object(s.o)(h.e,v.e)(Object(i.i)({maxParallelOperationCount:8})(M)));return[2]})})}});function M(e){var t=this,n=e.itemKey,i=h.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,d,v,E,k,O,M,_,D,P,H,B,j,F,I,q,R,U,z;return Object(r.__generator)(this,function(W){switch(W.label){case 0:t=new o.e;s=!1;d=new u.e(i.itemFullUrl);v=e((function(e,t,n){return function(r){var i,s,o=e.itemFullUrl,a=new u.e(o);s=c.e.isActivated("ca2adcfe-ec7f-4e6b-a8ca-7023c151d026","1/8/2020","Adding more fields to GetListDataAsStream")?["File_x0020_Type","FileRef","FileLeafRef"]:["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"];i=[a.path];var f=r(Object(C.e)({contentTypeId:w.c},h.e.serialize(e)));if(t&&t.length>0&&f&&f.contentTypeId)for(var l=0,p=t;l<p.length;l++){var d=p[l];if(d.contentTypeId===f.contentTypeId&&d.Fields)for(var v=0,m=d.Fields.split(",");v<m.length;v++){var g=m[v];"Modified_x0020_By"===g?s.push("Editor"):"Created_x0020_By"===g?s.push("Author"):s.push(g)}}var y=Object(N.r)({itemRefs:i,recurseInFolders:!0,pageSize:1,fieldNames:s});return{webAbsoluteUrl:"",listFullUrl:o,currentPageContext:void 0,qosName:n,viewXml:y,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}})(i,void 0,"getSPItemByFullUrl"));return[4,e(Object(x.e)(v))];case 1:E=W.sent();k=E.WebUrl||m.i(decodeURIComponent(E.HttpRoot||""))||d.authority;O=""+new u.e(k).authority+(E.ListUrl||decodeURIComponent(E.listUrlDir||""));M={webAbsoluteUrl:k,listFullUrl:O,rootFolder:""};_=e(Object(T.t)({serverData:E,itemSetKey:M,currentPageContext:v.currentPageContext,contentTypes:void 0,isItemSetRequest:s})),D=_.itemResolver,P=_.childKeys,H=_.pageContext;B=P[0];j=y.e.serialize(M);B&&t.mapKeys({mappings:(U={},U[B]=h.e.serialize(i),U)});if(H){F=b.e.serialize({webAbsoluteUrl:k,listFullUrl:O});e(Object(C.e)({pageContext:w.Mt},F)).pageContext||e(Object(f.e)({itemKey:F,options:{pageContext:H}}))}t.merge(D);if(g.e.matches(B)){I=g.e.deserialize(B);(q=Object(L.t)(I))&&t.merge(e(Object(L.e)({parentKey:q,serverData:E})).itemResolver)}R=p.e.serialize({webAbsoluteUrl:k,listFullUrl:O});t.resolveItems({items:(z={},z[g.e.serialize(M)]=Object(r.__assign)({},S.t.pack({itemKey:j})),z[n]=Object(r.__assign)({},a.i.pack(g.e)),z[R]=Object(r.__assign)({},Object(l.e)(E,H)),z)});e(t.execute());e(Object(A.e)({itemSetKey:j,serverData:E,isItemSetRequest:s}));return[2]}})})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});var r=50,i=8,s=2},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(4),i=new r.e("commands",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"i",function(){return a});n.d(t,"s",function(){return f});n.d(t,"o",function(){return l});n.d(t,"u",function(){return c});n.d(t,"a",function(){return h});n.d(t,"f",function(){return p});var r=n(2),i=new r.e("addToOneDrive"),s=new r.e("createFolder"),o=new r.e("createLink"),u=new r.e("delete"),a=new r.e("download"),f=new r.e("invite"),l=new r.e("move"),c=new r.e("officeLens"),h=new r.e("rename"),p=new r.e("upload")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphThumbnailSet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasThumbnailAuthTokenFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharepointIds")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("specialFolder")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(4),i=new r.e("topCollaboratorSetKeyFacet",{endpoint:Object(r.s)()})},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(119),s=new r.e("updateCheckoutState"),o=new i.e("checkout");Object(i.s)({operationTypeFacet:s,progressKeyFacet:o})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(119),s=new r.e("updatePublishState"),o=new i.e("publish")},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});n.d(t,"n",function(){return f});var r=n(2),i=n(71),s=n(119),o=n(4),u=new r.e("editPinnedItem"),a=new o.e("editPinnedItemProgressItem",{itemKey:Object(o.s)(),editType:Object(o.i)()}),f=new s.e("editPinnedItemProgress",function(e,t){var n=Object.keys(t.itemEditTypeMap)[0],r=t.itemEditTypeMap[n].editType;return a.serialize({itemKey:n,editType:r})});Object(i.i)({operationTypeFacet:u})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("bulkUpdateListItems"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("modifyView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("modifyFieldProperties"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});var r=n(9),i=new r.e("fileHandlerActionControl"),s=new r.e("fileHandlerCustomActionControl"),o=new r.e("fileHandlerOpenActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){for(var t=e,n="",r=0,i=void 0,s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|s)||(o="=",s%1);n+=o.charAt(63&r>>8-s%1*8)){if((i=t.charCodeAt(s+=.75))>255)throw new Error("Unable to obtain default share URL: btoa failed");r=r<<8|i}return n}},function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"e",function(){return h});n.d(t,"r",function(){return p});n.d(t,"n",function(){return v});n.d(t,"i",function(){return m});var r=n(1),i=n(2984),s=n(2645),o=n(2),u=n(302),a=n(2987),f=n(2985),l=new o.e("moreCommands").id,c={key:new o.e("CheckOutItem").id,automationId:"checkOutItemCommand",name:s.e.CheckOut,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"checkOut"})},h={key:new o.e("CheckInItem").id,automationId:"checkInItemCommand",name:s.e.CheckIn,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"checkIn"})},p={key:new o.e("UndoCheckOutItem").id,automationId:"undoCheckoutItemCommand",name:s.e.UndoCheckOut,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"undoCheckOut"})},d={key:new o.e("ViewDocumentProperties").id,name:u.e.ViewProperties,action:r.createElement(f.e,{interactiveSave:!0})},v={key:l,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:[d,c,h,p]}};function m(e){var t=e.listFacets,n=Object(a.e)({listFacets:t}),r=!!t&&!t.isDocumentLibrary;return{key:l,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:r?[n]:[d,c,h,p,n]}}}},,function(e,t,n){"use strict";n.d(t,"e",function(){return O});var r=n(0),i=n(1),s=n(8),o=n(30),u=n(75),a=n(16),f=n(167),l=n(80),c=n(111),h=n(3),p=n(48),d=n(2639),v=n(2971),m=n(53),g=n(891),y=n(51),b=n(58),w=n(47),E=n(23),S=n(607),x=n(6),T=n(24),N=n(108),C={ODB:1499},k=Object(N.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("387")]).then(n.bind(null,3692))];case 1:return[2,e.sent().ApproveRejectDialog]}})})}),L=Object(s.i)(function(e,t){var n=t.onContinue,s=t.onCancel,o=t.resolve,u=t.reject,a=Object(r.__rest)(t,["onContinue","onCancel","resolve","reject"]);return i.createElement(k,Object(r.__assign)({},a,{onContinue:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return n?[4,n(e)]:[3,2];case 1:t.sent();t.label=2;case 2:o();return[2]}})})},onCancel:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return s?[4,s()]:[3,2];case 1:e.sent();e.label=2;case 2:u(new f.e);return[2]}})})}}))}),A=Object(s.i)(function(e,t){var n=t.itemKeys,s=Object(u.e)(e);if(!s)return null;var a=e.demandItem({setKey:l.e},s).setKey;if(!a||!n||!n.length)return null;var f=Object(y.e)(e,{enbableApproveRejectConfiguration:h.w}).enbableApproveRejectConfiguration,N=Object(w.e)(e,n[0]);if(!f||!Object(b.e)(e,{feature:C,pageContext:N}))return null;var k=!0,A=e.demandItemFacet(h.we,c.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}));if(A&&A.templateType===E.n.webPageLibrary&&n.length>1)return null;for(var O,M,_=!0,D=!0,P=!1,H={},B=0,j=n;B<j.length;B++){var F=j[B];if(!v.e(e,{itemKey:F,listFacets:A}))return null;var I=e.demandItem({permissions:h.ze,moderationStatusType:h.Ae,moderationComments:h.Le},F),q=I.permissions,R=I.moderationStatusType,U=I.moderationComments;if(A&&!A.isDocumentLibrary&&!m.t.hasItemPermission({permissions:q},m.t.layoutsPage))return null;if(void 0!==R){var z=H[g.e[R]];H[g.e[R]]=z?z+1:1}void 0===O?O=U:O!==U&&(_=!1);void 0===M?M=R:M!==R&&(D=!1);R===g.e.draft&&(P=!0);if(!(k=v.t(e,{itemKey:F,includeOneNote:!0})||R===g.e.pending||!!A&&!A.enableMinorVersions))return null}if(A&&A.templateType===E.n.webPageLibrary){if(k){return(F=t.itemKeys?t.itemKeys[0]:void 0)?i.createElement(S.e,{itemKey:t.itemKeys?t.itemKeys[0]:"",engagement:{name:"ApproveReject",isIntentional:!0}}):null}return null}var W,X=D&&M===g.e.draft&&!!A&&!!A.enableMinorVersions,V=P,$=e.dispatch,J=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(r){t=[{FieldName:"_ModerationStatus",FieldValue:e.status.toString()}];void 0!==e.comment&&t.push({FieldName:"_ModerationComments",FieldValue:e.comment});return[2,$(Object(d.e)({items:(i={},i[s]={itemKeys:n,formValues:t,qosName:"BulkApproveReject"},i)}))]})})},K=n.length,Q=K>1?"BulkApproveReject":"ApproveReject";1===K&&(W=e.demandItemFacet(x.l,n[0]));var G=Object(T.o)(function(e){return i.createElement(L,Object(r.__assign)({},e,{onContinue:J,hideApproveRejectOptions:X,showDraftOption:V,initialComment:_?O:void 0,initialStatus:D?M:void 0,itemCount:n.length,itemName:W,initialStatusMapForBulkEdit:H}))});return i.createElement(o.e,Object(r.__assign)({isAvailable:k,onExecute:G},Object(p.e)(e,{itemKey:n[0],engagement:{name:Q,isIntentional:!0}})))}),O=Object(a.s)()(A)},function(e,t,n){"use strict";n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});var r=n(0),i=n(8),s=n(2388),o=n(16),u=n(6),a=n(48),f=Object(i.t)(function(e,t){var n=t.itemKey,i=t.action,o=!1;if(n){var f=e.demandItem({fileName:u.h,isFolder:u.d},n),l=f&&f.fileName,c=l&&l.extension||"",h=f&&f.isFolder||!1;o=Object(s.t)(i.availableOn,c,Boolean(h))}var p=i.handler,d=p.appId,v=p.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",m={appId:d};return Object(r.__assign)({isAvailable:o,itemKeys:n?[n]:[]},Object(a.e)(e,{itemKey:n,engagement:{name:v,isIntentional:!0,extraData:m}}))})(s.e),l=Object(o.s)()(Object(o.r)()(f))},,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(80),i=n(178);function s(e,t){var n=t.itemSetKey,s=e.demandItemFacet(r.e,n);return s&&s.viewKey&&i.e.serialize(s.viewKey)}},,function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=new r.e("shortcutExistedAlready"),s=new r.e("nestedDescendantShortcutExists"),o=new r.e("nestedAscendantShortcutExists")}],Array(217),[function(e,t,n){"use strict";var r=n(1),i=n(0),s=n(786),o=n(16),u=n(75),a=n(8),f=n(12),l=n(1070),c=n(6),h=n(3),p=n(53),d=n(48),v=n(108),m=n(63),g=n(24),y=n(30),b=Object(a.t)()(Object(v.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("545")]).then(n.bind(null,3992))];case 1:return[2,e.sent().EditPinnedItemExecutor]}})})})),w=Object(a.i)(function(e,t){var n=t.itemKey,o=t.editType,a=Object(m.e)(e).itemsScopeItemKey,v=(function(e,t){var n=Object(u.e)(e),r=e.demandItemFacet(s.e,n);if(r)return s.e.serialize(r);return})(e),w=e.demandItem({isMalwareDetected:c.N,permissions:h.ze},n),E=w.isMalwareDetected,S=w.permissions,x=!E&&!!n&&Object(l.e)(e,t)&&!!v&&!!S&&p.e.hasItemPermission({permissions:S},p.e.manageLists)&&(function(e,t){var n=t.pinnedItemSetKey,r=t.editType,i=e.demandItemFacet(f.e,n),s=i?i.itemKeys:[],o=s.indexOf(t.itemKey),u=o>-1?0!==r:0===r;u&&(2===r?u=0!==o:3===r&&(u=o!==s.length-1));return u})(e,{itemKey:t.itemKey,pinnedItemSetKey:v,editType:o}),T=a?Object(g.o)(function(e){return r.createElement(b,Object(i.__assign)({},e,t,{itemsScopeItemKey:a,pinnedItemSetKey:v}))}):void 0;return r.createElement(y.e,Object(i.__assign)({isAvailable:x,onExecute:T},Object(d.e)(e,{itemKey:n,engagement:{name:"EditPinnedItem",isIntentional:!0}})))}),E=Object(o.s)()(Object(o.r)()(w));var S=n(521),x=n(2648),T=n(2),N=Object(T.t)("pinItem"),C=Object(T.t)("moveLeftPinnedItem"),k=Object(T.t)("moveRightPinnedItem"),L=Object(T.t)("removePinnedItem"),A=Object(T.t)("editPinnedItem");n.d(t,"t",function(){return O});n.d(t,"e",function(){return P});var O={key:N,automationId:"pinItemCommand",name:x.e.pinToTop,iconProps:{iconName:"Pin"},action:r.createElement(E,{editType:0})},M={key:C,automationId:"moveLeftPinnedItemCommand",name:x.e.moveLeftPinnedItem,iconProps:{iconName:S.e.isRightToLeft?"Forward":"Back"},action:r.createElement(E,{editType:2})},_={key:k,automationId:"moveRightPinnedItemCommand",name:x.e.moveRightPinnedItem,iconProps:{iconName:S.e.isRightToLeft?"Back":"Forward"},action:r.createElement(E,{editType:3})},D={key:L,automationId:"removePinnedItemCommand",name:x.e.unpinFromTop,iconProps:{iconName:"UnPin"},action:r.createElement(E,{editType:1})},P={key:A,automationId:"editPinnedItemCommand",name:x.e.editPin,iconProps:{iconName:"Pinned"},subMenuProps:{items:[M,_,D]}}},,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(3),o=n(80),u=n(178),a=n(390),f=n(1049),l=n(8),c=n(12),h=n(50),p=n(167),d=n(6),v=n(30),m=n(247),g=n(24),y=n(363),b=n(48),w=n(58),E=new(n(9).e)("filterActionControl"),S=n(28),x=n(1616),T=n(267),N=n(15),C=n(108);n.d(t,"e",function(){return M});var k={ODB:1352},L=Object(C.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("204")]).then(n.bind(null,3996))];case 1:return[2,e.sent().FilterPanel]}})})}),A=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.itemSetKey,f=t.filterableSet,l=t.internalName,p=t.filterOptionSet,d=t.fieldType,S=t.checkedFilterKeys;return i.createElement(m.e,null,function(t){var m=t.itemCache,x=t.dispatch;if(!(l&&f&&p&&d))return i.createElement(g.n,null);var T,C=m.demandItemFacet(c.i,n),L=m.demandItemFacet(o.e,n),A=L&&L.viewKey&&u.e.serialize(L.viewKey);L&&(T=m.demandItemFacet(s.Mt,a.e.serialize({webAbsoluteUrl:L.webAbsoluteUrl,listFullUrl:L.listFullUrl})));for(var O=!(T&&Object(N.t)(T).isActivated("8E2ACEEF-1A9C-46FC-9D2D-9E95937355D1","07/07/2020","Include filter display value in filter params for datetime column")||"DateTime"!==d),M=[],_=[],D={},P=0,H=p;P<H.length;P++){var B=H[P];D[B.value]=B}for(var j=0,F=S;j<F.length;j++){var I=F[j];if(D[I]){M.push(D[I].value);_.push(D[I].display)}}var q,R=f.getFilteredItemSetKey({filterField:l,filterValues:M,filterType:d,useLookupId:!1,filterDisplays:O?_:void 0}),U=m.demandItemFacet(o.e,R),z=Object(w.e)(m,{feature:k,pageContext:T});if(z){var W=m.demandItemFacet(E,n),X=E.evaluate(W)(m,{viewKey:A}).onFilter;q=X}var V=Object(b.e)(m,{itemKey:n,engagement:{name:"ApplyFilters",isIntentional:!0}});return i.createElement(g.n,{action:i.createElement(y.e,{itemKey:R})},function(t){var n=t.isAvailable,o=t.execute;return i.createElement(v.e,Object(r.__assign)({isAvailable:n,onExecute:function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,n,i;return Object(r.__generator)(this,function(u){switch(u.label){case 0:if(z&&q){e=U&&U.filterParams;x(q({filterParams:e}))}x(Object(h.e)({items:Object(r.__assign)((n={},n[R]=Object(r.__assign)({},c.i.pack(C)),n),A?(i={},i[A]=Object(r.__assign)({},s.st.pack(!0)),i):{})}));return[4,o(t)];case 1:u.sent();return[2]}})})}},V))})})};return t})(i.PureComponent),O=Object(l.t)(function(e,t){var n=t.columnKey,l=t.itemSetKey,h=e.demandItem({fieldType:s.K,mappedColumnFieldType:s.Ce,internalName:s.ue},n),p=h.fieldType,d=h.mappedColumnFieldType,v=h.internalName,m=e.demandItem({deserializedSetKey:o.e,filterableSet:s.mt,filterOptionSets:c.n},l),g=m.deserializedSetKey,y=m.filterableSet,b=m.filterOptionSets,w=g&&e.demandItemFacet(s.Mt,a.e.serialize({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl})),E=g&&e.demandItemFacet(s.Pt,f.e.serialize({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl})),C=e.demandItemFacet(s.Q,b&&b[n]),k=e.isItemFacetResolved(s.Q,b&&b[n]),L=y&&C&&y.appliedFilters&&v&&y.appliedFilters[v]?y.appliedFilters[v].values:[],O=g&&g.viewKey&&u.e.serialize(g.viewKey),M=O&&e.demandItemFacet(s.p,O),_=e.dispatch,D="User"===p||"UserMulti"===p||d===S.e.Text||d===S.e.Title?{pageContextForPicker:w,peoplePickerDataSource:E,getFilterSuggestions:function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o;return Object(r.__generator)(this,function(r){i=[];if(M&&g){s=!w||!Object(N.t)(w).isActivated("74450E1A-074B-45F1-82F4-FB3FBE834B78","10/15/2019","Use contains to get filter suggestion");o=s?x.a(M.getEffectiveViewXml(),e,t,n):x.u(M.getEffectiveViewXml(),e,t,n);return[2,_(Object(T.e)({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl,currentPageContext:w,qosName:"FilterPanel.GetFilterSuggesitons",viewXml:o,rootFolder:g.rootFolder})).then(function(t){if(t.ListData&&t.ListData.Row){var n={};t.ListData.Row.forEach(function(t){var r=t[e],s={display:r,value:r};if(!n.hasOwnProperty(s.value)){n[s.value]=s;i.push(s)}})}return i})]}return[2,i]})})}}:void 0;return{filterOptionSet:C||[],mappedColumnFieldType:void 0!==d?d:S.e.Text,fieldInternalName:v||"",applyFiltersAction:function(e){return i.createElement(A,Object(r.__assign)({},e,{itemSetKey:l,filterableSet:y,fieldType:p,internalName:v}))},isLoading:!k,checkedFilterValues:L,filterPickerProps:D}})(L),M=Object(l.i)(function(e,t){var n=t.columnKey,s=t.itemSetKey,a=t.isToggled,f=e.demandItemFacet(d.l,n),l=e.demandItemFacet(E,s),c=e.demandItemFacet(o.e,s),h=c&&c.viewKey&&u.e.serialize(c.viewKey),m=E.evaluate(l)(e,{viewKey:h,isAvailable:!0}).isAvailable,y=Object(g.o)(function(e){return i.createElement(O,{onClose:function(){e.reject(new p.e)},onComplete:function(){e.resolve()},columnName:f||"",columnKey:n,itemSetKey:s})});return i.createElement(v.e,Object(r.__assign)({isAvailable:m,isToggled:a,onExecute:y},Object(b.e)(e,{itemKey:s,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))})},,,,,,,function(e,t,n){"use strict";var r,i=n(71),s=n(119),o=n(0),u=n(25),a=n(3355),f=n(2618),l=n(22),c=n(11),h=n(511),p=n(289),d=n(12),v=n(76),m=n(6),g=((r={})[v.r.started]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupStartedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[v.r.completed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupCompletedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[v.r.failed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupFailedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[v.r.canceled]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupFailedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r),y=Object(l.t)(function(){return function(e){e(Object(c.r)(f.t,h.e)(Object(c.t)()(w)));e(Object(c.r)(f.t,p.n)(Object(c.t)()(b)))}});function b(){return function(e){return function(e,t){return{reportMode:p.e.pin}}}}function w(){return function(e){return E}}function E(e,t){var n=t.itemKey,r=Object(s.i)(e,t),i=r.phase,u=r.count,a=g,l=e.demandItemFacet(d.e,n),c=l&&l.itemKeys,h="",p="";if(c&&c.length>0){var v=e.demandItemFacet(f.e,c[0]),y=v&&v.groupKey;y&&(h=e.demandItemFacet(m.l,y)||"");p=a[i](u,h)}else{var b=e.demandItemFacet(f.t,n);if(b){var w=b.taskKey,E=w&&e.demandItemFacet(m.l,w);E&&(p=E)}}return Object(o.__assign)({},p&&"item"!==t.format?{title:p}:{})}n.d(t,"e",function(){return S});n.d(t,"t",function(){return x});var S=Object(i.i)({operationTypeFacet:f.e}),x=Object(s.s)({operationTypeFacet:f.e,progressKeyFacet:f.t,initializeBatch:function(){return y}})},function(e,t,n){"use strict";var r,i,s=n(0),o=n(786),u=n(79),a=n(1282);(function(e){e[e.pin=0]="pin";e[e.unpin=1]="unpin";e[e.movePrevious=2]="movePrevious";e[e.moveNext=3]="moveNext"})(r||(r={}));(function(e){e[e.success=0]="success";e[e.folderDoesNotExist=1]="folderDoesNotExist";e[e.itemDoesNotExist=2]="itemDoesNotExist";e[e.tooManyItems=3]="tooManyItems";e[e.itemNotInSpotlight=4]="itemNotInSpotlight";e[e.invalidArgument=5]="invalidArgument";e[e.serverError=6]="serverError";e[e.invalidServerJSON=7]="invalidServerJSON";e[e.unknownServerResult=8]="unknownServerResult"})(i||(i={}));var f=n(227),l=n(317),c=n(653),h=n(22),p=n(12),d=n(50),v=n(3),m=n(26),g=n(2288),y=n(35),b=n(208),w=n(6);n.d(t,"t",function(){return E});n.d(t,"e",function(){return S});n.d(t,"n",function(){return x});var E=3,S=(function(e){Object(s.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.resultType,i=void 0===r?8:r;n.resultType=i;return n}return t})(c.e),x=Object(h.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.itemEditTypeMap;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,c,h,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;return Object(s.__generator)(this,function(R){switch(R.label){case 0:r=Object.keys(n)[0];i=n[r].editType;return[4,e(Object(g.e)(r))];case 1:c=R.sent(),h=c.key,x=c.itemId;T=e(Object(m.e)(function(e){return e.demandItem({deserializedPinnedItemSetKey:o.e,pinnedItems:p.e},t)})),N=T.deserializedPinnedItemSetKey,C=T.pinnedItems;N||(N=o.e.deserialize(t));if(!h||!N||!x)throw new S({resultType:5});if(!(h&&N&&x))return[3,3];k="";"";N.viewKey&&(k=N.viewKey.viewId);L=N.parentItemKey.rootFolder||new l.e(N.parentItemKey.listFullUrl).path;A=void 0;(O=C&&C.itemKeys||[])&&(M=O.indexOf(r))>-1&&(2===i&&M>=2?A=O[M-2]:3===i&&M<O.length-1&&(A=O[M+1]));_=void 0;A&&(_=e(Object(m.e)(function(e){return e.demandItemFacet(v.Se,A)})));D={webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,itemId:x,editType:i,viewId:k,rootFolder:L,afterItemId:_};t&&(P=(function(e,t,n,r){var i=r.editType,s=[];(0===i||void 0===n&&1!==i)&&s.push(e);for(var o=0,u=t;o<u.length;o++){var a=u[o];a!==e&&s.push(a);a===n&&s.push(e)}return s})(r,O,A,D)).length<=E&&e(Object(d.e)({items:Object(s.__assign)((I={},I[t]=Object(s.__assign)({},p.e.pack({itemKeys:P})),I),Object(y.e)(P,function(){return Object(s.__assign)({},Object(b.e)().forFacet(w.f).thenInvalidate(t,p.e).pack())}))}));return(H=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,i=e.editType,s=e.itemId,o=e.afterItemId,u=e.rootFolder,f=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n});r&&(f=f.methodWithAliases("GetView",{viewGuid:r}));if(1!==i){var l=o?parseInt(o,10):-1;isNaN(l)&&(l=-1);f=f.methodWithAliases("AddToSpotlight",{itemId:s,folderPath:u||"",afterItemId:l})}else f=f.methodWithAliases("RemoveFromSpotlight",{itemId:s,folderPath:u||""});return f.toString()})(D))?[4,e(Object(f.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,url:H,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3];case 2:B=R.sent();if(0!==(j=(function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}})(B)).resultType){F=(function(e,t){var n=[];if(e.order)for(var r=0,i=e.order;r<i.length;r++){var o=i[r];n.push(u.e.serialize(Object(s.__assign)(Object(s.__assign)({},t),{itemId:o.toString()})))}return n})(j,h);e(Object(d.e)({items:Object(s.__assign)((q={},q[t]=Object(s.__assign)({},p.e.pack({itemKeys:F})),q),Object(y.e)(F,function(){return Object(s.__assign)({},Object(b.e)().forFacet(w.f).thenInvalidate(t,p.e).pack())}))}));throw new S({resultType:j.resultType})}R.label=3;case 3:return[2]}})})}})}],Array(48),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(9).e)("itemAutoRefreshControl")}],Array(21),[function(e,t,n){"use strict";n.r(t);n.d(t,"spProjectedUploadedItemSetAddon",function(){return v});var r=n(11),i=n(51),s=n(80),o=n(79),u=n(12),a=n(1010),f=n(6),l=n(3),c=n(3278),h=n(1059),p=n(22),d=Object(r.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys,h=Object(i.e)(e,{isProjectedUploadedItemSetEnabled:l.j}).isProjectedUploadedItemSetEnabled;if(void 0!==h&&h){var p=e.demandItemFacet(s.e,n);if(p){var d=(function(e,t,n){var r=[],i=a.e.serialize({itemSetKey:t}),s=e.demandItemFacet(u.e,i);e.demandItemFacet(c.e,a.e.serialize({itemSetKey:t}));if(!s||s.itemKeys&&0===s.itemKeys.length)return;for(var l={},h={},p=0,d=s.itemKeys;p<d.length;p++){var v=d[p];r.push(v);var m=e.demandItemFacet(o.e,v);if(m){m.itemId&&(l[m.itemId]=!0);m.rootFolder&&(h[m.rootFolder]=!0)}l[v]=!0}if(n)for(var g=0,y=n;g<y.length;g++){var b=y[g],w=e.demandItemFacet(o.e,b);if(w){if(e.demandItemFacet(f.d,b)){if(w.rootFolder&&w.rootFolder in h)continue}else if(w.itemId&&w.itemId in l)continue}r.push(b)}return r})(e,p,r);return d?{itemKeys:d}:{}}}return{}}}}),v=Object(p.t)(function(){return function(e){e(Object(r.r)(s.e,h.e)(Object(r.t)()(d)))}})},,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e){return!!e&&("status"in e||!(!e.message||"object"!=typeof e.message))}function i(e){return e&&e.message&&("object"==typeof e.message?e.message.value:e.message.toString())||""}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharedBy")},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(4),i=new r.e("SharedByPersonKeyFacet",{displayName:Object(r.s)(),email:Object(r.s)()}),s=new r.e("dateSharedGroupKeyFacet",{relativeTime:Object(r.s)(),sharedDateTime:Object(r.s)()}),o=new r.e("relativeTimeGroupKeyFacet",{relativeTime:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(22),s=n(42),o=n(596),u=n(2051),a=n(1522),f=n(3275),l=n(1009),c=n(231),h=n(208),p=n(3274),d=n(2180),v=n(154),m=n(6),g=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=o.e.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,s=o.e.deserialize(t.itemKey).driveItemKey,u=s.endpoint,a=s.driveId;return!!i&&!!a&&i===a&&r===u}})(function(e){var t=this,n=e.items;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,p,d,g,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V;return Object(r.__generator)(this,function($){switch($.label){case 0:t=Object.keys(n);i=t[0];p=o.e.deserialize(i);d=p.driveItemKey,g=d.endpoint,E=d.driveId;if(!g)throw new Error("No endpoint to determine activity items.");S=t.map(function(e){return o.e.deserialize(e).driveItemKey.itemId});x=Object(u.n)({endpoint:(J=g,J.replace("2.1","2.0")),driveId:E});T=x+"/ExtendedActivitiesForItems";N={driveItems:S,badgeOnly:!0};return[4,e(Object(a.n)({url:T,method:"POST",body:N,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:g}))];case 1:if((C=$.sent()).value){k=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(C.value);L=0;A=0;O=0;M=0;_=new s.e;for(D=0,P=t;D<P.length;D++){H=P[D];L++;B=o.e.deserialize(H);j=B.driveItemKey.itemId;F=j&&k[j];I=v.e.serialize(B.driveItemKey);q=void 0;if(F){R=new f.e;U=R.processResponse({item:{name:j||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:T},response:{value:F,"@odata.nextLink":""}}).activities;z=y(U);if(W=b(U)){O++;A++;if(!z){M++;X=w(W,H).itemResolver;_.merge(X);q=W}}}_.resolveItems({items:(V={},V[H]=Object(r.__assign)({},l.e.pack(q)),V[I]=Object(r.__assign)({},Object(h.e)().forFacet(m.e).thenInvalidate(H,l.e).pack()),V)})}e(_.execute());e(Object(c.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:L,activityFieldEligibleItemCount:A,activityFieldActiveItemCount:O,activityFieldBadgedItemCount:M,activityFieldBadgedPercent:L?Math.round(M/L*100):0},isIntentional:!1}))}return[2]}var J})})}});function y(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function b(e){var t=e[0],n={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(n[l.id]=!0)}for(var o=Object(r.__assign)(Object(r.__assign)({},t),{actors:Object(r.__spreadArrays)(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!n[l.id]){o.actors.push(l);n[l.id]=!0}}return o||t}function w(e,t){var n=new s.e,i=o.e.deserialize(t).driveItemKey,u=(function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(r.__spreadArrays)(t,n,i);s&&o.push(s);return o})(e);if(u.length>0){var a=(function(e,t){for(var n=new s.e,r=0,i=e;r<i.length;r++){var o=E(i[r],t).itemResolver;n.merge(o)}return{itemResolver:n}})(u,i).itemResolver;n.merge(a)}return{itemResolver:n}}function E(e,t){var n=new s.e,r={itemKey:v.e.serialize(t),userKey:d.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}},i=Object(p.t)(r).itemResolver;n.merge(i);return{itemResolver:n}}},function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"e",function(){return h});var r=n(0),i=n(11),s=n(75),o=n(31),u=n(154),a=n(1837),f=n(12),l=n(50),c=Object(i.t)()(function(){return function(e){return function(e,t){var n=Object(s.e)(e),i=(function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var s=e.demandItemFacet(a.e,i),o=e.demandItemFacet(u.e,n);if(s&&o){var f=o.endpoint,l=o.driveId,c=o.itemId;return Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}return})(e,{folderItemKey:t.itemKey,currentItemSetKey:n}),o=i&&h(e,{parentItemKey:u.e.serialize(i.driveItemKey),stageItem:t.stageItem});return Object(r.__assign)(Object(r.__assign)({},i?{itemKey:a.e.serialize(i)}:{}),o?{stageItem:o}:{})}}});function h(e,t){var n=this,i=t.parentItemKey,s=t.stageItem;if(i)return s?Object(o.t)(function(e){var t=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(u){switch(u.label){case 0:e(Object(l.e)({items:(n={},n[o]=Object(r.__assign)({},f.i.pack({itemKey:i})),n)}));return[4,e(s({currentItemKey:o,itemsScopeItemKey:t}))];case 1:u.sent();return[2]}})})}}):void 0}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n(79),n(1023);var r=n(317),i=function(e){return""+(""+new r.e(e).authority)+new r.e(e).segments.slice(0,-1).join("/")}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("saveUploadedTemplateToView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(3),i=n(6),s=n(53),o=n(183);function u(e,t){var n=t.itemKey,r=t.includeOneNote,s=e.demandItem({folder:i.d,oneNote:o.n},n),u=s.folder,a=s.oneNote;return r?!!u||!!a:!!u&&!a}function a(e,t){var n=t.itemKey,o=t.listFacets,u=!!o&&!!o.isModerated;if(u){var a=e.demandItem({permissions:r.ze,checkoutInfo:i.y},n),f=a.permissions,l=a.checkoutInfo;u=!!(!l||!l.byOther&&!l.byYou)&&!!f&&s.e.hasItemPermission({permissions:f},s.e.editListItems)&&s.e.hasItemPermission({permissions:f},s.e.approveItems)}return u}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("updateItemRating"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("updateItemLikes"),o=Object(i.i)({operationTypeFacet:s})},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("createView"),o=Object(i.i)({operationTypeFacet:s})},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("createFreshView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("updateView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("modifyColumnAggregateType"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(9).e)("getDriveItemFullUrlControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(9).e)("getDefaultShareLinkActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("updateItem")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(9).e)("permissionInviteActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n(1),s=n(3),o=n(53),u=n(6),a=n(183),f=n(8),l=n(79),c=n(390),h=n(111),p=n(23),d=n(108),v=n(24),m=n(195),g=n(48),y=n(75),b=n(30),w=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("542").then(n.bind(null,3697))];case 1:return[2,e.sent().CheckOutItemWizard]}})})}),E=Object(f.i)(function(e,t){var n=t.checkInOutType,f=Object(y.e)(e),d=Object(m.e)(e);if(!d.length)return null;var E=e.demandItem({firstItemKey:l.e},d[0]).firstItemKey;if(!E)return null;var S=E&&e.demandItemFacet(s.Mt,c.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl}));if(S&&(S.isAnonymousGuestUser||S.isEmailAuthenticationGuestUser))return null;for(var x=e.demandItemFacet(s.we,h.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl})),T=!!x&&x.templateType===p.t.mySiteDocumentLibrary,N=!!x&&!!x.enableMinorVersions,C=!1,k=0,L=d;k<L.length;k++){var A=L[k],O=e.demandItemFacet(u.d,A),M=e.demandItemFacet(a.n,A);if(A&&!O&&!M){var _=e.demandItem({isCheckedOut:u.y,isBFile:s.ae},A),D=_.isCheckedOut,P=_.isBFile,H=e.demandItemFacet(s.ze,A),B=o.e.hasItemPermission({permissions:H},o.e.editListItems),j=o.e.hasItemPermission({permissions:H},o.e.cancelCheckout);"checkOut"===n?C=!P&&!T&&!(D&&(D.byYou||D.byOther))&&B:"checkIn"!==n&&"undoCheckOut"!==n||!D||(C=B&&(!!D.byYou||j&&!!D.byOther))}if(!C)break}var F=d?Object(v.o)(function(e){return i.createElement(w,Object(r.__assign)({},e,{itemSetKey:f,itemKeys:d,checkInOutType:n,enableMinorVersions:N}))}):void 0;return i.createElement(b.e,Object(r.__assign)({isAvailable:C,onExecute:F},Object(g.e)(e,{itemKey:d[0],engagement:{name:n,isIntentional:!0,extraData:{isBulk:d.length>1}}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n(1),s=n(53),o=n(108),u=n(2986),a=n(58),f=n(8),l=n(24),c=n(195),h=n(3),p=n(47),d=n(48),v=n(30),m=n(79),g=n(111),y=n(23),b={ODB:1568},w=Object(o.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("214")]).then(n.bind(null,3466))];case 1:return[2,e.sent().EditItemWizard]}})})}),E=Object(f.i)(function(e,t){var n=Object(c.e)(e),o=1===n.length?n[0]:void 0,f=e.demandItemFacet(u.e,o),E=u.e.evaluate(f)(e,{itemKey:o}).getPropertiesForm,S=e.demandItemFacet(h.ze,o),x=o&&Object(p.e)(e,o),T=e.demandItemFacet(m.e,o),N=T&&e.demandItemFacet(h.we,g.e.serialize(T)),C=N&&N.templateType===y.t.mySiteDocumentLibrary,k=!!x&&Object(a.e)(e,{feature:b,pageContext:x})&&!!E&&!!S&&!C&&s.t.hasItemPermission({permissions:S},s.t.editListItems),L=o&&E?Object(l.o)(function(e){return i.createElement(w,Object(r.__assign)({},e,{itemKey:o,interactiveSave:t.interactiveSave,getPropertiesForm:E}))}):void 0;return i.createElement(v.e,Object(r.__assign)({isAvailable:k,onExecute:L},Object(d.e)(e,{itemKey:o,engagement:{name:"EditItem",isIntentional:!0}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(9).e)("itemPropertiesFormControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(1),i=n(2),s=n(302),o=n(2646),u=n(23),a=new i.e("ApproveReject").id;function f(e){var t=e.listFacets,n=t&&t.templateType===u.n.webPageLibrary&&t.isModerated?s.e.ReviewApprovals:s.e.ApproveReject;return{key:a,automationId:"approveRejectCommand",iconProps:{iconName:"DocumentApproval"},name:n,action:r.createElement(o.e,null)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(1),s=n(357),o=n(845),u=n(3280),a=n(2455),f=n(2456),l={key:o.e.key,automationId:o.e.automationId,subMenuProps:{items:[a.e,f.e]},onRender:function(e){return i.createElement(u.e,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},s.e.pack(!0))}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(23),i=n(317),s=n(212),o=n(2375);function u(e,t){var n,u=t.pageContext,a=t.listFacets,f=t.isODB,l=t.key;if(u&&(a&&a.templateType===r.t.documentLibrary||f)){var c=new i.e(l.webAbsoluteUrl||l.listFullUrl).authority+"/_api/v2.0",h=s.t.serialize({endpoint:c});n=Object(o.e)(e,{itemKey:h})}return{fileHandlerCommands:n}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("editNewMenu").id},function(e,t,n){"use strict";n.d(t,"e",function(){return p});n.d(t,"t",function(){return d});var r=n(0),i=n(1),s=n(1042),o=n(785),u=n(3),a=n(1408),f=n(50),l=n(22),c=n(387),h=n(309),p=Object(l.i)()(function(e){var t=this,n=e.itemKey,a=s.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(s){e(Object(f.e)({items:(t={},t[n]=Object(r.__assign)({},u.t.pack(function(){return i.createElement(c.e,{documentType:d(a.templateUrl),templateItemKey:o.e.serialize({listKey:a.listKey,templateUrl:a.templateUrl})})})),t)}));return[2]})})}});function d(e){var t=h.e.Word;if(e){var n=e.lastIndexOf(".");if(n){var r=e.substr(n+1).toLowerCase();switch(a.t[r]){case a.i:t=h.e.OneNote;break;case a.s:t=h.e.PowerPoint;break;case a.n:t=h.e.Excel;break;case a.o:t=h.e.Visio}}}return t}},function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(64),s=n(3248),o=n(211),u=n(111),a=n(79),f=n(47),l=n(952),c=n(3),h=n(23),p=n(3279),d=n(2991),v=new i.e("newCommands",function(e,t){var n=t.itemKey,i=e.demandItemFacet(u.e,n);if(i){var v=a.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{rootFolder:""})),m=e.demandItemFacet(a.e,v);if(m){var g=Object(f.e)(e,v),y=e.demandItemFacet(c.we,n);if(g&&y){var b=y.templateType===h.t.mySiteDocumentLibrary,w=e.demandItemFacet(c.He,n),E=Object(l.t)(e,v,m),S=Object(p.e)(e,{key:m,listFacets:y,listKey:i,pageContext:g}),x=S.contentTypes,T=S.contentTypeCommands,N=Object(d.e)(e,{isODB:b,key:m,listFacets:y,pageContext:g}).fileHandlerCommands,C=o.e;return Object(s.e)(e,{contentTypes:x,newCommandMenu:C,fileHandlerCommands:N,isCreateFolderAvailable:E,newDocumentTemplates:w,contentTypeCommands:T,listKey:i}).allCommands}}}})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(71),s=new r.e("saveTemplatesToView"),o=Object(i.i)({operationTypeFacet:s})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(9).e)("removeFromShardListActionControl")},,function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(0),i=n(1),s=n(8),o=n(48),u=n(30),a=n(16),f=n(184),l=n(264),c=n(2276),h=n(84),p=n(2103),d=n(58),v=n(47),m={ODB:1024},g=Object(s.i)(function(e,t){var n=t.itemKey,s="undo"===t.undoRedoActionType,a=Object(v.e)(e,n),g=Object(d.e)(e,{feature:m,pageContext:a});if(g){g=Object(f.e)(e)===l.e}var y=e.dispatch;return i.createElement(u.e,Object(r.__assign)({isAvailable:g,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){e=y(c.e);h.e.raise(e,s?p.e.undoChangeEventName:p.e.redoChangeEventName);return[2]})})}},Object(o.e)(e,{itemKey:n,engagement:{name:s?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))}),y=Object(a.n)()(g)},,function(e,t,n){"use strict";n.r(t);n.d(t,"QuickEditActionExecutor",function(){return S});var r=n(0),i=n(1),s=n(30),o=n(247),u=n(24),a=n(48),f=n(460),l=n(264),c=n(80),h=n(787),p=n(178),d=n(3),v=n(157),m=n(50),g=n(15),y=n(2434),b=n(184),w=n(63),E=g.e.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),S=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return i.createElement(o.e,null,function(n){var o=n.itemCache,g=n.dispatch,S=Object(a.e)(o,{itemKey:t,engagement:{name:"QuickEdit",isIntentional:!0}}),x=o.demandItem({deserizalizeKey:c.e},t).deserizalizeKey,T=x&&x.viewKey,N=x&&h.e.serialize({listKey:{webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl},viewKey:T}),C=T&&p.e.serialize(T),k=Object(w.e)(o).itemsScopeItemKey,L=Object(b.e)(o,{itemsScopeItemKey:k});return i.createElement(u.n,{action:i.createElement(f.e,{layoutType:l.e})},function(t){var n=t.execute;return i.createElement(s.e,Object(r.__assign)({isAvailable:!0,onExecute:function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:if(!E){y.t();y.e("quickEdit.layoutManager.start")}N&&g(Object(m.e)({items:(e={},e[N]=Object(r.__assign)({},d.l.pack(new v.e)),e)}));C&&g(Object(m.e)({items:(i={},i[C]=Object(r.__assign)({},d.Ze.pack(L)),i)}));return[4,n(t)];case 1:s.sent();E||y.e("quickEdit.layoutManager.end");return[2]}})})}},S))})})};return t})(i.PureComponent)},,,,function(e,t,n){"use strict";n.d(t,"n",function(){return f});n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(337),i=n(248),s=n(2652),o=n(1522),u=n(1658),a=n(154);function f(e,t){var n=t+"/me/drive";return Object(o.n)({url:n,qosName:e,method:"GET",endpoint:t})}function l(e,t,n,r,i){var s=i.replace("v2.0","v2.1")+"/drives/"+t+"/root/children",u={name:e,remoteItem:{sharepointIds:{listId:n.listId,listItemUniqueId:n.listItemUniqueId,siteId:n.siteId,siteUrl:n.siteUrl,webId:n.webId}},"@microsoft.graph.conflictBehavior":"rename"};return Object(o.n)({url:s,qosName:r,method:"POST",body:u,endpoint:i})}function c(e,t,n){var o=Object(u.t)(e,function(r,o){var u=e.response,f=u&&u.error;if(f){var l=f["@error.fixItItemIds"],c=f["@error.fixItWebUrl"],h=f["@error.fixItItemName"],p=[];if(l&&t&&n)for(var d=0,v=l;d<v.length;d++){var m=v[d],g=a.e.serialize({endpoint:t,driveId:n,itemId:m});p.push(g)}switch(r){case"unauthenticated":case 401:return i.t.pack({});case"itemNotFound":case 404:return i.s.pack({});case"accessDenied":case 403:return i.e.pack({});case"shortcutAlreadyExists":return s.n.pack({existShortcutUrl:c,existShortcutName:h});case"nestedDescendantShortcutExists":return s.t.pack({nestDescendantItemKeys:p});case"nestedAscendantShortcutExists":return s.e.pack({existShortcutUrl:c,existShortcutName:h});default:return i.h.pack({})}}});throw new r.e({innerError:e,facets:o})}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_3eae80fd",i="socialBarPanel_3eae80fd",s="socialBarPanelContent_3eae80fd",o="socialBarPanelPersona_3eae80fd",u="socialBarPanelPersonaDescription_3eae80fd",a="analyticsStatsLink_3eae80fd"}],Array(31),[function(e,t,n){"use strict";n.r(t);n.d(t,"CreateViewAction",function(){return b});var r=n(0),i=n(1),s=n(8),o=n(80),u=n(111),a=n(390),f=n(3),l=n(75),c=n(2460),h=n(48),p=n(24),d=n(30),v=n(108),m=n(63),g=n(510),y=Object(v.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("52")]).then(n.bind(null,3090))];case 1:return[2,e.sent().FreshViewCreator]}})})}),b=Object(s.i)(function(e,t){var n=t.isEditing,s=t.currentViewKey,v=Object(l.e)(e),b=Object(m.e)(e).itemsScopeItemKey,w=e.demandItemFacet(o.e,v),E=e.demandItemFacet(c.e,v),S=e.demandItemFacet(f.p,s),x=c.e.evaluate(E)(e,{viewKey:s}).onViewSaved;if(!v||!b)return null;var T=!1;if(w&&S){var N=u.e.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl}),C=e.demandItemFacet(f.we,N);T=!!(C&&S&&"POWER"!==S.viewType&&C.permissions&&(C.permissions.managePersonalViews||C.permissions.manageLists))}var k=w?e.demandItemFacet(f.Mt,a.e.serialize({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl})):void 0,L=Object(p.o)(function(e){return i.createElement(g.e,{itemsScopeItemKey:b},i.createElement(y,Object(r.__assign)({},e,t,{pageContext:k,itemSetKey:v,onViewSaved:x})))},{scope:"global"});return i.createElement(d.e,Object(r.__assign)({isAvailable:T,onExecute:L},Object(h.e)(e,{itemKey:v,engagement:{name:n?"EditView":"CreateNewView",isIntentional:!0}})))})}],Array(195),[function(e,t,n){"use strict";var r=n(0),i=n(22),s=n(71),o=n(50),u=n(165),a=n(778),f=n(1046),l=n(1047),c=n(677),h=n(1045),p=n(777),d=n(6),v=n(12),m=n(3),g=n(2284),y=n(42);function b(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){switch(u.label){case 0:t=h.e.deserialize(e.itemKey).tenantRootUrl;i=new y.e;return[4,n(Object(g.t)({tenantRootUrl:t}))];case 1:s=u.sent();i.resolveItems({items:(o={},o[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},m.Tt.pack(s.resource)),m.xt.pack(s.payloadHeader)),o)});n(i.execute());return[2]}})})}}var w=n(54),E=n(2626),S=n(2961);function x(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a;return Object(r.__generator)(this,function(c){t=p.e.deserialize(e.itemKey).tenantRootUrl;i=new y.e;s=l.e.serialize({tenantRootUrl:t});o=f.e.serialize({tenantRootUrl:t});u=[s,o];i.resolveItems({items:(a={},a[s]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},w.s.pack(!0)),d.l.pack(E.e.frequent)),m.Ue.pack({itemKey:e.itemKey})),a[o]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},w.s.pack(!0)),d.l.pack(E.e.followed)),m.Ue.pack({itemKey:e.itemKey})),a[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d.l.pack(S.e.SharedLibrariesHeader)),w.s.pack(!0)),v.e.pack({itemKeys:u})),a)});n(i.execute());return[2]})})}}var T=n(1052),N=n(2625),C=n(208),k=n(57);function L(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,f,h,g;return Object(r.__generator)(this,function(b){switch(b.label){case 0:t=l.e.deserialize(e.itemKey).tenantRootUrl;i=new y.e;return[4,n(A(t))];case 1:s=b.sent();o=[];u=p.e.serialize({tenantRootUrl:t});f=void 0;h=void 0;s&&s.Items&&s.Items.forEach(function(t,n){var l,p=a.e.serialize({webAbsoluteUrl:t.Url}),g=c.e.serialize({webAbsoluteUrl:t.Url}),y=t.ItemReference||{},b=y.SiteId,w=void 0===b?void 0:b,E=y.WebId,S=void 0===E?void 0:E,x=y.GroupId,N=void 0===x?void 0:x,k=T.e.serialize({rootItemKey:u,itemKey:p});f=s.Items[n-1]&&s.Items[n-1].PinOrder;h=s.Items[n+1]&&s.Items[n+1].PinOrder;i.resolveItems({items:(l={},l[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d.l.pack(t.Title)),m.e.pack(t.Acronym)),m.i.pack(t.BannerColor)),m.s.pack(t.BannerImageUrl)),m.ve.pack(!0)),d.d.pack({})),m.ut.pack(t.Weight)),a.e.pack({webAbsoluteUrl:t.Url})),m.ot.pack(w)),m.$t.pack(S)),m.re.pack(N)),v.t.pack({itemKey:g})),l[k]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},m.Ge.pack(f)),m.Xe.pack(t.PinOrder)),m.Fe.pack(h)),Object(C.e)().forFacet(m.Xe).thenInvalidate(e.itemKey,v.e).pack()),l[g]=Object(r.__assign)({},v.i.pack({itemKey:p})),l)});o.push(p)});i.resolveItems({items:(g={},g[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d.l.pack(E.e.frequent)),v.e.pack({itemKeys:o})),m.Ue.pack({itemKey:u})),g)});n(i.execute());return[2]}})})}}function A(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=i(Object(k.e)({enableSitePinningConfiguration:m.z,enableSPHomeServiceConfiguration:m.I})),s=t.enableSitePinningConfiguration;return!1!==t.enableSPHomeServiceConfiguration?[3,3]:[4,n.e("32").then(n.bind(null,3459))];case 1:o=r.sent().getFrequentSitesData;return[4,i(o(e))];case 2:return[2,r.sent()];case 3:u=s?N.t:N.e;return[4,i(Object(g.r)(e,void 0,u))];case 4:return[2,r.sent()]}})})}}function O(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){t=a.e.deserialize(e.itemKey).webAbsoluteUrl;i=new y.e;s=c.e.serialize({webAbsoluteUrl:t});i.resolveItems({items:(o={},o[e.itemKey]=Object(r.__assign)({},v.t.pack({itemKey:s})),o)});n(i.execute());return[2]})})}}var M=n(79),_=n(80),D=n(131),P=n(461),H=n(951),B=n(123),j=n(1282),F=n(227);function I(e){var t=e.webAbsoluteUrl,n=e.isMediaQuery;return function(e){var r=e(Object(k.e)({spHostPageWebAbsoluteUrl:m.Nt,spSitesListsDataWebAbsoluteUrl:m.Ft})),i=r.spHostPageWebAbsoluteUrl,s=r.spSitesListsDataWebAbsoluteUrl,o=new B.e(t).authority,u=i||s,a=u&&new B.e(u).authority,f=n&&o===a,l=Object(j.n)({webAbsoluteUrl:a||o}).segment(f?"SP.Web.GetDocumentAndMediaLibaries":"SP.Web.GetDocumentLibraries").parameter("webFullUrl",t);return e(Object(F.r)({webAbsoluteUrl:a||o,method:"POST",url:l.toString(),qosName:f?"getDocumentAndMediaLibraries":"getDocumentLibraries",noRedirect:!0}))}}function q(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,f,l,h,p,m,g,b,w,E,S,x,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:t=c.e.deserialize(e.itemKey),i=t.webAbsoluteUrl,s=t.types;o=a.e.serialize({webAbsoluteUrl:i});u=new y.e;return[4,n(I({webAbsoluteUrl:i,isMediaQuery:!!s&&s.indexOf("media")>-1}))];case 1:f=N.sent();l=[];for(h=0,p=f.d.GetDocumentLibraries.results;h<p.length;h++){m=p[h];g=new D.t({context:{webAbsoluteUrl:i}});b=g.getUrlParts({webUrl:i,listUrl:m.AbsoluteUrl,path:m.AbsoluteUrl});w={webAbsoluteUrl:i,listFullUrl:b.fullListUrl||"",rootFolder:""};E=M.e.serialize(w);S=_.e.serialize({webAbsoluteUrl:i,listFullUrl:b.fullListUrl||"",rootFolder:""});u.merge(n(Object(H.e)({itemKey:E,spItem:w})).itemResolver);u.resolveItems({items:(x={},x[E]=Object(r.__assign)({},d.l.pack(m.Title)),x[S]=Object(r.__assign)({},v.i.pack({itemKey:E})),x)});l.push(E)}u.resolveItems({items:(T={},T[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.e.pack({itemKeys:l})),Object(C.e)().forFacet(v.e).thenInvalidate(P.e).pack()),a.e.pack({webAbsoluteUrl:i})),v.i.pack({itemKey:o})),T)});n(u.execute());return[2]}})})}}var R=n(148),U=n(590),z=n(11),W=n(878),X=Object(z.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=t.handlers,s=e.demandItemFacet(c.e,n);if(i&&s){for(var o=[],u=0,a=i;u<a.length;u++){var f=a[u];".JPEG"===Object(W.e)(f)&&o.push("media")}return o.length<1?{}:{itemKey:c.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{types:o}))}}return{}}}});n.d(t,"e",function(){return $});var V=Object(R.t)(Object(R.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("48")]).then(n.bind(null,3798))},{chunkName:"addon-sharepointhome-deferred"}),"getSPFollowedSitesItemSet"),$=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(o.t)({keyFacet:a.e,facets:[d.l,v.t]}));e(Object(o.t)({keyFacet:f.e,facets:[f.e,v.e]}));e(Object(o.t)({keyFacet:l.e,facets:[l.e,v.e]}));e(Object(o.t)({keyFacet:c.e,facets:[c.e,v.e,v.t]}));e(Object(s.o)(h.e,u.e)(Object(i.i)({maxParallelOperationCount:4})(b)));e(Object(s.o)(p.e,u.e)(Object(i.i)()(x)));e(Object(s.o)(l.e,u.e)(Object(i.i)()(L)));e(Object(s.o)(a.e,u.e)(Object(i.i)({maxParallelOperationCount:4})(O)));e(Object(s.o)(c.e,u.e)(Object(i.i)({maxParallelOperationCount:8})(q)));e(Object(z.r)(c.e,U.e)(X));e(Object(s.o)(f.e,u.e)(Object(i.r)(V)));return[2]})})}})},,,,function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(192),o=n(111),u=n(756),a=n(178),f=n(1029),l=n(3),c=n(6),h=n(93),p=n(2),d=n(108),v=n(23),m="needsAttentionIconOverlay_a23ec69d",g="needsAttentionIcon_a23ec69d",y=n(302),b=n(25),w=n(515),E=n(15),S=n(58),x=n(460),T=n(610),N=n(16),C=n(51),k=n(72),L=n(184),A=n(63),O=n(264),M=n(80),_={ODB:1725},D={ODB:1553};function P(e,t){var n=Object(C.e)(e,{enableQuickEdit:l.F}).enableQuickEdit,r=Object(A.e)(e).itemsScopeItemKey,i=r&&Object(L.e)(e,{itemsScopeItemKey:r}),s=i&&i.id===O.e.id;return!!(n&&!!s&&Object(S.e)(e,{feature:_})&&Object(S.e)(e,{feature:D}))}var H=Object(N.n)()(Object(k.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("548").then(n.bind(null,3801))];case 1:return[2,e.sent().SwitchGridLayoutActionExecutor]}})})},P,function(e,t){var n=t.itemKey,r=t.viewType,i=e.demandItem({deserizalizedKey:M.e},n).deserizalizedKey,s=i&&i.viewKey&&a.e.serialize(i.viewKey),o=s&&e.demandItemFacet(l.Vt,s);return P(e)&&o===r})),B=n(430),j=n(8),F=n(390),I=n(48),q=n(30),R=n(298);var U=Object(j.i)(function(e,t){var n,s,u,a,f,c,p=t.viewKey,d=t.itemSetKey,v=void 0,m=d&&e.demandItemFacet(M.e,d),g=e.demandItemFacet(l.p,p);if(m&&g){var y=o.e.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}),b=e.demandItemFacet(l.we,y),w=e.demandItemFacet(l.Mt,F.e.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}));w&&b&&b.id&&g&&"POWER"!==g.viewType&&b.permissions&&g.canUserEdit(b.permissions)&&(v=(n={webAbsoluteUrl:m.webAbsoluteUrl,layoutsUrl:w.layoutsUrl,viewId:g.id,listId:b.id,sourceUrl:g.serverRelativeUrl||""},s=n.webAbsoluteUrl,u=n.layoutsUrl,a=n.viewId,f=n.listId,c=n.sourceUrl,s+"/"+u+"/ViewEdit.aspx?"+Object(R.e)({View:h.e.normalizeUpper(a,!0),List:h.e.normalizeUpper(f,!0),Source:c})))}var E=!!v;return i.createElement(q.e,Object(r.__assign)({isAvailable:E,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){window.open(v);return[2]})})}},Object(I.e)(e,{itemKey:d,engagement:{name:"CustomizeView",isIntentional:!0}})))});n.d(t,"e",function(){return ne});var z=[{ODB:1776}],W={ODB:1484},X={iconName:void 0,styles:{root:{display:"none!important"}}},V=new p.e("switchView").id,$=new p.e("needsAttentionView").id,J=new p.e("setDefaultView").id,K=new p.e("customizeView").id,Q=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3654))];case 1:return[2,e.sent().SwitchViewAction]}})})}),G=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3654))];case 1:return[2,e.sent().SetDefaultViewAction]}})})}),Y=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3654))];case 1:return[2,e.sent().SaveViewAction]}})})}),Z=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3040))];case 1:return[2,e.sent().CreateViewAction]}})})}),ee={key:new p.e("switchToFixedGridLayoutCommand").id,automationId:"switchToFixedGridLayoutCommand",name:y.e.fixedHeight,action:i.createElement(H,{viewType:"GRIDFIXED"}),iconProps:{iconName:"ViewList"}},te={key:new p.e("switchToDynamicGridLayoutCommand").id,automationId:"switchToDynamicGridLayoutCommand",name:y.e.dynamicHeight,action:i.createElement(H,{viewType:"GRID"}),iconProps:{iconName:"DynamicList"}};function ne(e,t){var n=t.viewKeys,d=t.webAbsoluteUrl,N=t.listViewSetKey,C=t.itemSetKey,k=t.currentViewKey,L=o.e.serialize({webAbsoluteUrl:N.webAbsoluteUrl,listFullUrl:N.listFullUrl}),A=Object(S.e)(e,{feature:W})&&z.some(function(t){return Object(S.e)(e,{feature:t})}),O=e.demandItemFacet(l.we,L),M=!!O&&!!O.templateType&&Object(v.s)(O.templateType),_=!!O&&!!O.templateType&&O.templateType===v.n.webPageLibrary,D=!1,P=y.e.Views,H=e.demandItem({showViewModifiedIndicator:l.st,currentDerivedView:l.p,currentViewBasicInfo:l.Wt},k),j=H.showViewModifiedIndicator,F=H.currentDerivedView,I=H.currentViewBasicInfo;O&&F&&"POWER"!==F.viewType&&O.permissions&&F.canUserEdit(O.permissions)&&(D=!0);F&&F.title?P=F.title:I&&I.Title&&(P=I.Title);D&&(j||F&&F.isDirty())&&(P=b.format(y.e.ViewModifiedIndicator,P));var q=n.map(function(t){var n=e.demandItemFacet(l.it,t),r=e.demandItemFacet(l.Wt,t);return n&&!n.Hidden?re(n,d,C,F):r?re(r,d,C,F):void 0}).filter(function(e){return!!e}),R=(function(e,t){var n=e.demandItemFacet(l._e,t);return!(!n||!e.demandItemFacet(c.C,n))})(e,C),V=(function(e,t){var n,r=t.isPagesLib,s=t.isList,o=t.itemsNeedAttention,a=t.currentDerivedView,f=t.itemSetKey,l=u.e;n=r&&Object(S.e)(e,{feature:{ODB:1743}})?y.e.PagesThatNeedAttention:s?y.e.ItemsThatNeedAttention:y.e.FilesThatNeedAttention;return{key:$,automationId:"needsAttentionViewCommand",name:n,iconProps:o?{iconName:"error",styles:{root:g}}:X,action:i.createElement(Q,{viewId:l,currentDerivedView:a,itemSetKey:f})}})(e,{isList:M,isPagesLib:_,itemsNeedAttention:R,itemSetKey:C,currentDerivedView:F}),ne=(function(e,t,n){var r=o.e.serialize({webAbsoluteUrl:t,listFullUrl:n}),i=e.demandItemFacet(l.h,r),s=[];i&&i.length&&i.forEach(function(t){var n=e.demandItemFacet(l.At,t),r=n&&n.requiredFields&&n.requiredFields.split(",");r&&r.length>0&&(s=s.concat(r))});return s.length>0})(e,d,N.listFullUrl),oe=F?(function(e){var t=e.isCreateNewViewEnabled,n=e.currentDerivedView,s=e.listViewSetKey,o=e.itemSetKey,u=e.allowEditCurrentView,l=a.e.serialize({viewId:n.id}),c=f.e.serialize(s),h=u||t&&"MODERNCALENDAR"===n.viewType;return Object(r.__spreadArrays)(t?[{key:se,automationId:"createViewCommand",name:y.e.CreateNewView,iconProps:X,action:i.createElement(Z,{listViewSetKey:c,currentViewKey:l,isEditing:!1})}]:[],[{key:ie,automationId:"saveCommand",name:y.e.SaveViewAs,iconProps:X,action:i.createElement(Y,{listViewSetKey:c,currentViewKey:l})},{key:J,automationId:"setDefaultViewCommand",name:y.e.SetDefaultView,iconProps:X,action:i.createElement(G,{currentDerivedView:n,listViewSetKey:s})}],h?[{key:K,automationId:"customizeViewCommand",name:y.e.CustomizeView,iconProps:X,action:"MODERNCALENDAR"===n.viewType?i.createElement(Z,{listViewSetKey:c,currentViewKey:l,isEditing:!0}):i.createElement(U,{viewKey:l,itemSetKey:o})}]:[])})({listViewSetKey:N,isCreateNewViewEnabled:A,currentDerivedView:F,itemSetKey:C,allowEditCurrentView:D}):[],ue="MODERNCALENDAR"===e.demandItemFacet(l.Vt,k)?[{key:new p.e("calendarMonth").id,isPermanent:!1,automationId:"calendarMonthCommand",name:y.e.calendarMonthTitle,title:y.e.calendarMonthDesc,action:i.createElement(x.e,{layoutType:T.e}),iconProps:{iconName:"calendar"}}]:[],ae=[];if(w.e.subMenuProps){var fe=e.demandItemFacet(l.Xt,k),le=fe&&fe.viewFormatter,ce=le&&le.isTileDesignerTemplateApplied(),he=le&&le.getTileProps(),pe=!!(he&&he.formatter&&he.formatter);if(M&&(ce||Object(S.e)(e,{feature:{ODB:1396}})&&!pe))for(var de=0,ve=w.e.subMenuProps.items;de<ve.length;de++){var me=ve[de];me.key!==B.r?ae.push(me):ae.push(Object(r.__assign)(Object(r.__assign)({},me),{name:y.e.GalleryLayout,title:y.e.GalleryLayoutCommandTooltip}))}else ae=w.e.subMenuProps.items}var ge=Object(r.__spreadArrays)(ae,ue,[{name:"-",key:"divider_1",itemType:s.e.Divider}],ne?[V,{name:"-",key:"divider_1",itemType:s.e.Divider}]:[],[ee,te,{name:"-",key:"divider_1",itemType:s.e.Divider}],q,[{name:"-",key:"divider_1",itemType:s.e.Divider}],oe,[{name:"-",key:"divider_1",itemType:s.e.Divider}]),ye={name:P,key:w.e.key,automationId:w.e.automationId,iconProps:w.e.iconProps,title:y.e.SwitchViewsCommandTitle,ariaLabel:b.format(y.e.SwitchViewsCommandAriaLabel,P),postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,n=t&&t.filter(function(e){return e.checked})[0];return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),n?{iconProps:Object(r.__assign)(Object(r.__assign)({},n.iconProps),R?{styles:{root:m}}:{})}:{})},subMenuProps:{items:ge}};if(!E.e.isActivated("1F653F6B-43CA-48DE-9719-5E5D3A5B573B","06/07/2019","Create SwitchLayoutCommand cacheKey with current selected viewId")){var be=F?h.e.normalizeLower(F.id,!1):"";ye.cacheKey=w.e.key+"_viewId_"+be}return ye}function re(e,t,n,r){var s=h.e.normalizeLower(e.Id,!1);return{key:V+"-"+s,automationId:"switchViewCommand_"+s,name:e.Title,iconProps:X,action:i.createElement(Q,{viewId:s,currentDerivedView:r,itemSetKey:n})}}var ie=new p.e("saveView").id,se=new p.e("createView").id},,,,,,,,function(e,t,n){"use strict";var r,i=n(0),s=n(588),o=n(391),u={Folder:"NewFolder",Word:"NewDOC",Excel:"NewXSL",PowerPoint:"NewPPT",OneNote:"NewONE",ExcelSurvey:"NewXSLSurvey",FormForExcel:"NewXSLForm",Visio:"NewVSDX"},a=((r={})[s.e.key]=u.Folder,r[o.o.key]=u.Word,r[o.e.key]=u.Excel,r[o.i.key]=u.PowerPoint,r[o.r.key]=u.OneNote,r[o.t.key]=u.ExcelSurvey,r[o.n.key]=u.FormForExcel,r[o.s.key]=u.Visio,r);var f=n(15),l=n(211),c=n(3282),h=n(2992);var p=n(192),d=n(1),v=n(387),m=n(2),g=n(273),y=n(578),b=n(1470),w=n(65),E=n(2993),S=n(785),x=function(e){var t=e.template,n=e.listKey;if(!t.url)throw new Error("Cannot create a command for a template without a URL.");var r,i,s=t.url,o=S.e.serialize({listKey:n,templateUrl:s});return{key:new m.e("createDocumentFromTemplate").id,automationId:"createDocumentFromTemplate",name:t.title,action:d.createElement(w.e,null,d.createElement(v.e,{documentType:Object(E.t)(s),templateItemKey:o})),iconProps:Object(g.e)({extension:(r=s,i=Object(y.t)(r,!0),Object(b.t)(i)),size:16})}};var T=n(2375);n.d(t,"e",function(){return N});function N(e,t){var n=t.contentTypes,r=t.newCommandMenu,d=t.fileHandlerCommands,v=t.isCreateFolderAvailable,m=t.newDocumentTemplates,g=t.contentTypeCommands,y=t.listKey,b={},w={},E=(function(){var e;return(e={})[u.Folder]=s.e,e[u.Word]=o.o,e[u.Excel]=o.e,e[u.PowerPoint]=o.i,e[u.OneNote]=o.r,e[u.ExcelSurvey]=o.t,e[u.FormForExcel]=o.n,e[u.Visio]=o.s,e})(),S={},N=[],C=[];if(!f.e.isActivated("7FE1672F-3DCA-41A7-8CAF-C5B376315694","11/19/2018","Build New menu with newDocumentTemplates")&&m&&m.length){if(g)for(var k=0,L=g;k<L.length;k++){(M=L[k]).name&&(b[M.name]=M)}if(n)for(var A=0,O=n;A<O.length;A++){var M;b[(M=O[A]).displayName]&&M.contentTypeId&&(w[M.contentTypeId]=b[M.displayName])}var _=r.subMenuProps&&r.subMenuProps.items;if(_)for(var D=0,P=_;D<P.length;D++){(I=P[D]).name&&(E[I.name]=I);I.automationId&&(E[I.automationId]=I)}for(var H=void 0,B=0,j=m;B<j.length;B++){var F=j[B];F.isContentType&&F.contentTypeId&&(S[F.contentTypeId]=!0);var I=void 0;F.isUpload&&y?I=x({template:F,listKey:y}):F.isContentType&&F.contentTypeId&&w[F.contentTypeId]?I=w[F.contentTypeId]:E[F.title]?I=E[F.title]:F.templateId&&E[F.templateId]&&(I=E[F.templateId]);if(I){var q=F.templateId||a[I.key];q===u.Folder&&(H=!0);C.push(Object(i.__assign)(Object(i.__assign)({},F),{templateId:q,command:I}));if(F.visible){N.push(I);E[F.title]&&E[F.title].key===s.e.key&&N.push({name:"-",key:"divider_1",itemType:p.e.Divider})}}}!H&&v&&s.e.name&&C.unshift({command:s.e,templateId:a[s.e.key],title:s.e.name,visible:!1});for(var R in w)if(w.hasOwnProperty(R)&&!S[R]){var U=w[R];U.name&&C.push({command:U,contentTypeId:R,isContentType:!0,templateId:R,title:U.name,visible:!0});N.push(U)}}else{C=(function(e,t){var n=t.isCreateFolderAvailable,r=t.contentTypeCommands,i=void 0===r?[]:r,o=t.contentTypes,u=[];n&&s.e.name&&u.push({command:s.e,templateId:a[s.e.key],title:s.e.name,visible:!0});var f=!(!i||!i.length),p={};if(o)for(var d=0,v=o;d<v.length;d++){var m=v[d];m.contentTypeId&&(p[m.displayName]=m.contentTypeId)}if(f)for(var g=0,y=i;g<y.length;g++){if((x=y[g]).name){var b=p[x.name];u.push({command:x,contentTypeId:b,isContentType:!0,templateId:b,title:x.name||"",visible:!0})}}var w=l.e.subMenuProps&&l.e.subMenuProps.items;if(w)for(var E=0,S=w;E<S.length;E++){var x;(x=S[E]).name&&-1===[s.e.key,"divider_1","divider_2",c.e.key,h.e].indexOf(x.key)&&u.push({command:x,templateId:a[x.key],title:x.name,visible:!f})}return u})(0,{isCreateFolderAvailable:v,contentTypeCommands:g,contentTypes:n});g&&g.length?N.push.apply(N,Object(i.__spreadArrays)([s.e,{name:"-",key:"divider_1",itemType:p.e.Divider}],g)):N=r.subMenuProps?Object(i.__spreadArrays)(r.subMenuProps.items):[]}d&&d.new&&(N=Object(T.t)(N,d.new));return{visibleNewCommands:Object(i.__assign)(Object(i.__assign)({},l.e),{subMenuProps:{items:N}}),allCommands:C}}}],Array(21),[function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(1244),o=n(3664),u=n(2257),a=n(1245),f=n(303);n.d(t,"e",function(){return l});var l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(r.__rest)(t,["url","heightOffset"])),c=this.state.isIFrameLoaded;return i.createElement(o.e,Object(r.__assign)({className:"IFrameDialog_2772e31d",hidden:!this.state.isOpen,type:u.e.close},l),i.createElement(s.e,null,!c&&i.createElement(a.e,{size:f.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:c?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(i.Component)},,,,function(e,t,n){"use strict";var r=n(0),i=n(1961),s=n(208),o=n(6),u=n(12),a=n(42),f=n(596),l=n(4),c=new l.e("userById",{id:Object(l.s)(),endpoint:Object(l.s)()}),h=n(249),p=n(2963),d=n(2180),v=n(856);n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});function m(e){var t,n=e.itemKey,l=e.driveItemKey,h=e.parentFolderItemKey,m=e.setItemKey,y=e.driveItemResponse,b=e.endpoint,w=e.getDriveItemFacets,E=void 0===w?i.e:w,S=new a.e,x=f.e.serialize({driveItemKey:l}),T=m?Object(s.e)().forFacet(o.l).thenInvalidate(m,u.e).forFacet(o.f).thenInvalidate(m,u.e).forFacet(o.A).thenInvalidate(m,u.e).pack():void 0,N=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},E({driveItemKey:l,driveItem:y,endpoint:b,parentFolderItemKey:h})),o.e.pack({itemKey:x})),T);S.resolveItems({items:(t={},t[n]=N,t)});if(y.lastModifiedBy){if(A=y.lastModifiedBy.user){var C=A.id&&c.serialize({id:A.id,endpoint:b});if(C=A.email&&d.e.serialize({email:A.email,endpoint:b})){var k=g({itemKey:n,personFacet:o.k,userKey:C,user:A}).itemResolver;S.merge(k)}}}if(y.createdBy){var L=void 0;if((A=y.createdBy.user)&&A.email&&(L=d.e.serialize({email:A.email,endpoint:b}))){k=g({itemKey:n,personFacet:v.r,userKey:L,user:A}).itemResolver;S.merge(k)}}if(y.remoteItem&&y.remoteItem.shared&&y.remoteItem.shared.sharedBy&&y.remoteItem.shared.sharedBy.user){var A,O=void 0;if((A=y.remoteItem.shared.sharedBy.user).email&&(O=d.e.serialize({email:A.email,endpoint:b}))){k=g({itemKey:n,personFacet:p.e,userKey:O,user:A}).itemResolver;S.merge(k)}}return{itemResolver:S}}function g(e){var t,n,i=e.itemKey,s=e.personFacet,u=e.userKey,f=e.user,l=new a.e;l.resolveItems({items:Object(r.__assign)((t={},t[u]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},o.l.pack(f.displayName)),h.e.pack(f.email)),h.n.pack(f.id)),t),s&&(n={},n[i]=Object(r.__assign)({},s.pack({itemKey:u,displayValue:f.displayName})),n))});return{itemResolver:l}}},,,,function(e,t,n){"use strict";var r=n(0),i=n(1010),s=n(80),o=n(22),u=n(42),a=n(208),f=n(2),l=n(12),c=n(26),h=n(79),p=n(119),d=n(51),v=n(2096),m=n(76),g=n(50),y=n(3);n.d(t,"e",function(){return b});n.d(t,"t",function(){return w});var b=new f.e("projection");var w=Object(o.i)()(function(e){var t=this,n=i.e.deserialize(e.itemKey).itemSetKey;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,w;return Object(r.__generator)(this,function(E){t=s.e.serialize(n);(f=new u.e).resolveItems({items:(w={},w[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},b.pack({})),Object(a.e)().forFacet(b).thenInvalidate(function(){return function(){o((function(e){var t=this,n=e.itemSetKey,o=s.e.deserialize(n),u=i.e.serialize({itemSetKey:o});return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){e(Object(c.e)(function(e){var t=Object(d.e)(e,{isProjectedUploadedItemSetEnabled:y.j}).isProjectedUploadedItemSetEnabled;if(void 0!==t&&t){var n=h.e.serialize(o),r=e.demandItemFacet(y.n,n);if(r&&Object.keys(r).length>0)return!1;for(var i=e.demandItemFacet(l.e,p.a),s=0,u=i&&i.itemKeys||[];s<u.length;s++){var a=u[s];if(e.demandItemFacet(v.t,a)){var f=e.demandItemFacet(m.o,a),c=e.demandItemFacet(h.e,f&&f.itemKey);if(c&&c.rootFolder===o.rootFolder)return!1}}}return!0}))&&e(Object(g.e)({items:(t={},t[u]=Object(r.__assign)({},l.e.pack({itemKeys:[]})),t)}));return[2]})})}})({itemSetKey:t}))}}).pack()),w[t]=Object(a.e)().forFacet(l.e).thenInvalidate(e.itemKey,b).pack(),w)});o(f.execute());return[2]})})}})},function(e,t,n){"use strict";var r=n(79),i=n(1042),s=n(1043),o=n(3),u=n(946),a=n(131),f=n(2990);function l(e,t,n,r,i,s,o){return{key:n+r,name:r,action:t(o),iconProps:h(e,s,i)}}function c(e,t,n,r,i,s,o,u){return{key:n+r.displayName,name:r.displayName,action:t(r.contentTypeId||""),iconProps:h(e,s,i)}}function h(e,t,n){return t?{iconName:t}:{iconName:"CustomIcon",style:{backgroundImage:"url("+(n?e+n:n)+")",width:"16px",height:"16px",backgroundRepeat:"no-repeat"}}}function p(e,t,n,r,i,s){return Object(f.e)(e,t,l.bind(void 0,t.webAbsoluteUrl,r),c.bind(void 0,t.webAbsoluteUrl,i),n,s)}n.d(t,"e",function(){return d});function d(e,t){var n,f=t.key,l=t.listKey,c=t.listFacets,h=t.pageContext,d=[],v=r.e.serialize(f),m=e.demandItemFacet(o.h,v);if(m&&m.length){m.forEach(function(t){var n=e.demandItemFacet(o.yt,t);n&&d.push(n)});if(!Object(u.e)(d,c)&&h){var g=new a.t({context:{webAbsoluteUrl:f.webAbsoluteUrl,listUrl:f.listFullUrl}}).getUrlParts({path:f.rootFolder});n=p(d,h,g,function(t){return f&&e.demandItemFacet(o.t,i.e.serialize({listKey:l,templateUrl:t}))},function(t){return f&&e.demandItemFacet(o.t,s.e.serialize({listKey:l,contentTypeId:t}))},c)}}return{contentTypes:d,contentTypeCommands:n}}},function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(716),o=n(1275),u=n(3),a=n(2635),f="iconContainer_7b761c77",l="menuItemIconContainer_7b761c77",c="logoFillIcon_7b761c77",h="logoIcon_7b761c77",p=n(16),d=n(8),v=n(6),m=n(2456),g=n(2455),y=n(2);n.d(t,"t",function(){return w});n.d(t,"e",function(){return E});var b=new y.e("fileHandlerOpenCommand").id,w=Object(p.s)()(Object(p.r)()(Object(d.t)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:u.Ie},n).appMap,s=r.name;r.key===m.e.key?s=s||(i?Object(a.i)(i,!0):a.e.Open):r.key===g.e.key&&(s=s||(i?Object(a.r)(i,!0):a.e.OpenInBrowser));return{name:s}})(function(e){return i.createElement("div",{className:"contextualMenuItemLinkContent_7b761c77"},i.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_7b761c77"},e.name))}))),E=Object(p.s)()(Object(p.r)()(Object(d.t)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:u.Ie,fileName:v.h},n),o=s.appMap,f=s.fileName,l={};if(i&&i.items){var c=i.items[0];c&&-1!==c.key.indexOf(b)&&c.iconProps&&(l=c.iconProps)}var h=!!f&&!!f.extension&&".pdf"===f.extension.toLowerCase(),p=o&&Object(a.n)(o),d={iconName:o?Object(a.t)(o):h?"PDF":"OpenFile"},y=void 0;i&&i.items&&(y=i.items.map(function(e){return e.key===m.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:d,name:e.name||o&&Object(a.i)(o,!0)||a.e.Open,onRenderIcon:p?S.bind(void 0,p,!0):void 0}):e.key===g.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:d,name:e.name||o&&Object(a.r)(o,!0)||(h?a.e.OpenInBrowser:a.e.Open),onRenderIcon:p?S.bind(void 0,p,!0):void 0}):e}));return{iconProps:l||d,onRenderIcon:p?S.bind(void 0,p,!1):void 0,text:a.e.Open,menuProps:y?Object(r.__assign)(Object(r.__assign)({},i),{items:y}):i}})(o.e)));function S(e,t){return e?i.createElement("span",{className:t?l:f},i.createElement(s.e,{iconName:e.logoFill16,className:c}),i.createElement(s.e,{iconName:e.logo16,className:h})):null}},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(3),s=n(227),o=n(3369),u=n(144),a=n(1282);function f(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.fieldInternalName,i=e.viewId,s=e.rootFolder,f=e.excludeFieldFilteringHtml,l=e.filterParams,c=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n}).segment("RenderListFilterData").parameter("FieldInternalName",r||"");i&&(c=c.parameter("ViewId",i));s&&(c=c.parameter("RootFolder",{raw:Object(o.e)(s)}));f&&(c=c.parameter("ExcludeFieldFilteringHtml",!0));if(l){var h=u.default.getFilterParams(l,!0);c=c.rawParameter(h)}return c.toString()}var l=n(1711),c=n(1039),h=n(79),p=n(390),d=n(210),v=n(28),m=n(22),g=n(88),y=n(42),b=n(57),w=n(93);n.d(t,"getSPFilterOptionSetHandler",function(){return E});var E=Object(m.i)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,o=c.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,c,m;return Object(r.__generator)(this,function(E){switch(E.label){case 0:t=e((function(e){var t=e.itemSetKey,n=e.fieldKey;return function(e){var r=e(Object(b.e)({spDataSourceConfiguration:i.pt})).spDataSourceConfiguration,s=r&&r.ensureAuthToken,o=h.e.serialize(t),u=e(Object(g.e)({folderPath:i.G},o)),a=e(Object(g.e)({internalName:i.ue,mappedColumnFieldType:i.Ce,isCalculated:i.fe},d.e.serialize(n))),f=u&&u.folderPath,l=a&&a.internalName&&a.internalName,c=a&&a.mappedColumnFieldType===v.e.Taxonomy,m=a&&a.isCalculated,y=p.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),E=e(Object(g.e)({pageContext:i.Mt},y)).pageContext,S=t.viewKey&&t.viewKey.viewId,x=S===w.e.Empty?E&&E.viewId:S;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:f,ensureAuthToken:s,fieldInternalName:l,isCalculatedField:m,filterParams:t.filterParams,excludeFieldFilteringHtml:c,viewId:x}}})({itemSetKey:o.itemSetKey,fieldKey:o.fieldKey}));return[4,e((S=t,function(e){return e(Object(s.t)({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl,method:"POST",url:f(S),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:u=E.sent();a=l.e.getFilterData(u,t.fieldInternalName||"",t.isCalculatedField);(c=new y.e).resolveItems({items:(m={},m[n]=Object(r.__assign)({},i.Q.pack(a)),m)});e(c.execute());return[2]}var S})})}})},function(e,t,n){"use strict";var r=n(1),i=n(65),s=n(2),o=n(302),u=n(0),a=n(646),f=n(199),l=n(470),c=n(266),h=n(19),p=n(79),d=n(111),v=n(319),m=n(410),g=n(3),y=n(23),b=n(53),w=n(507),E=n(8),S=n(15).e.isActivated("EADE19B8-AD86-4CA2-9B13-E049A2AD37AA","07/28/2020","Use currentItemKey to check permissions"),x=Object(f.t)(function(){return{type:"file"}})(a.e),T=Object(E.t)(function(){return{fileSelector:x}})(l.e),N=Object(E.i)(function(e,t){var n=t.engagement,i=Object(c.e)(e);return i?r.createElement(v.e,{controlHandlers:Object(u.__assign)({},m.e.pack(C))},r.createElement(T,{itemKey:i,engagement:Object(h.p)({name:"UploadTemplate",isIntentional:!0},n)})):null});function C(e,t){var n=Object(c.e)(e),r=e.demandItemFacet(p.e,n);if(!r)return{isAvailable:!1};var i=r.listFullUrl;if(!i)return{isAvailable:!1};var s=new w.e(i+"/Forms").path,o=p.e.serialize(Object(u.__assign)(Object(u.__assign)({},r),{rootFolder:""})),a=p.e.serialize(Object(u.__assign)(Object(u.__assign)({},r),{rootFolder:s})),f=S?o:n,l=e.demandItemFacet(g.ze,f);return{targetItemKey:a,isAvailable:b.t.hasItemPermission({permissions:l},b.t.manageLists)&&k(e,r)}}function k(e,t){var n=t&&e.demandItemFacet(g.we,d.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}));return!!n&&!!n.isDocumentLibrary&&n.templateType!==y.t.webPageLibrary}n.d(t,"t",function(){return L});n.d(t,"e",function(){return A});var L={key:new s.e("UploadTemplate").id,automationId:"UploadTemplate",name:o.e.UploadTemplate,action:r.createElement(i.e,null,r.createElement(N,{engagement:{name:"UploadTemplate"}}))},A={key:new s.e("AddTemplate").id,automationId:"AddTemplate",name:o.e.AddTemplate,iconProps:{iconName:"Add"},action:r.createElement(i.e,null,r.createElement(N,{engagement:{name:"AddTemplate"}}))}}],Array(90),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointBasicItemDataAddonDeferred",function(){return s});var r=n(22),i=n(2624),s=Object(r.t)(function(){return function(e){e(i.sharePointItemByFullUrlAddon)}})}],Array(277),[function(e,t,n){"use strict";n.r(t);var r,i=n(0),s=n(22),o=n(71),u=n(875),a=n(165),f=n(893),l=n(1033),c=n(79),h=n(786),p=n(1029),d=n(80),v=n(1011),m=n(1030),g=n(779),y=n(1044),b=n(776),w=n(2638),E=n(2636),S=n(2637),x=n(2972),T=n(2973),N=n(2618),C=n(2640),k=n(1663),L=n(2975),A=n(2977),O=n(2978),M=n(11),_=n(741),D=n(2);(function(e){e[e.preview=0]="preview";e[e.save=1]="save"})(r||(r={}));var P=new D.e("updateColumnFormatter"),H=(Object(o.i)({operationTypeFacet:P}),n(3236)),B=n(782),j=n(1050),F=n(1051),I=n(777),q=n(42),R=n(12),U=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=j.e.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(i.__generator)(this,function(o){(t=new q.e).resolveItems({items:(s={},s[n]=Object(i.__assign)({},R.e.pack({itemKeys:[F.e.serialize({tenantRootUrl:r}),I.e.serialize({tenantRootUrl:r})]})),s)});e(t.execute());return[2]})})}});var z=n(1615),W=n(26),X=n(183),V=n(20),$=n(390),J=n(3),K=n(6),Q=n(2110),G=n(304),Y=n(306),Z=n(589),ee=n(216),te=n(161),ne=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=F.e.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(C){switch(C.label){case 0:t=new q.e;return[4,e(Object(z.demandItems)(function(e){var t=B.e.serialize({tenantRootUrl:r});return e.demandItemFacet(c.e,t,{suppressGetItems:!1})}))];case 1:return(s=C.sent())?[4,e(Object(z.demandItems)(function(e){return e.demandItemFacet(J.Mt,$.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))}))]:[2];case 2:o=C.sent();u=e(Object(W.e)(function(e){return{isSavedForLaterEnabled:e.demandItemFacet(V.c,V.n),isSharedWithMeEnabled:!!e.demandItemFacet(te.f,V.n)}})),a=u.isSavedForLaterEnabled,f=u.isSharedWithMeEnabled;l={};h=o&&o.userDisplayName;p=c.e.serialize(s);l[p]={icon:"FabricFolder",displayName:ee.e.files};d=G.e.serialize({endpoint:r+"/_api/v2.0"});l[d]={icon:"History",displayName:Q.e.recentTitle};v=Y.e.serialize({endpoint:r+"/_api/v2.0"});l[v]={icon:"SingleBookmark",displayName:Q.e.saved};m=Z.e.serialize({endpoint:""+r});l[m]={icon:"People",displayName:Q.e.sharedWithMe};g=Object(i.__spreadArrays)([p,d],f?[m]:[],a?[v]:[]);for(y=0,b=g;y<b.length;y++){w=b[y];E=l[w],S=E.icon,x=E.displayName;t.resolveItems({items:(T={},T[w]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},X.t.pack(S)),K.l.pack(x)),K.d.pack({})),T)})}t.resolveItems({items:(N={},N[n]=Object(i.__assign)(Object(i.__assign)({},R.e.pack({itemKeys:g})),K.l.pack(h)),N)});e(t.execute());return[2]}})})}});var re=n(1052),ie=n(2284),se=n(298),oe=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=this,n=Object.keys(e.options),r=e.itemKey,s=n[0],o=e.options[s],u=o.type,a=o.reorderPinInfo,f=re.e.serialize({itemKey:s,rootItemKey:r});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,o,l,c,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=e(Object(W.e)(function(e){return e.demandItem({siteId:J.ot,webId:J.$t,groupId:J.re},s)})),n=t.siteId,o=t.webId,l=t.groupId;c=new q.e;h=(function(e,t){switch(e){case"pin":return ae();case"unpin":return;case"reorderPin":if(t){var n=t.nextPinOrder,r=t.prevPinOrder;if(n||r)return r?n?(r+n)/2:r/2:ae()}return;default:return}})(u,a);c.resolveItems({items:(d={},d[f]=Object(i.__assign)({},J.Xe.pack(h)),d)});e(c.execute());return(p=I.e.deserialize(r).tenantRootUrl)?[4,e(ue(p,{siteId:n||"",webId:o||"",groupId:l},u,a))]:[3,2];case 1:m.sent();(c=new q.e).invalidateItems({items:(v={},v[f]=[J.Xe],v)});e(c.execute());m.label=2;case 2:return[2]}})})}});function ue(e,t,n,r){var s=this;return function(o){return Object(i.__awaiter)(s,void 0,void 0,function(){var s,u,a,f,l;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if("pin"===n){s="api/v1/sites/pinned/add";u="pinSite"}else if("unpin"===n){s="api/v1/sites/pinned/remove";u="unpinSite"}else{if("reorderPin"!==n)return[2];if(!r)return[2];a=Object(se.e)({PreviousPinOrder:r.prevPinOrder||"",NextPinOrder:r.nextPinOrder||""},void 0,!0);s="api/v1/sites/pinned/update?"+a;u="reorderSite"}return[4,o(Object(ie.t)({tenantRootUrl:e}))];case 1:f=i.sent();l="";t&&(l=JSON.stringify({Title:t.title,Acronym:t.acronym,BannerColor:t.color,Url:t.url,Type:"Site",ItemReference:{Type:t.groupId?"GroupReference":"SiteReference",SiteId:t.siteId,WebId:t.webId,GroupId:t.groupId}}));return[4,o(Object(ie.e)({path:s,method:"POST",qosName:u,context:f,body:l}))];case 2:i.sent();return[2]}})})}}function ae(e){void 0===e&&(e=new Date);return 621355968e9+1e4*e.getTime()}var fe=n(2446),le=n(337),ce=n(227),he=n(44),pe=n(1282),de=n(248),ve=n(951),me=n(57),ge=n(2051),ye=n(123),be=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=B.e.deserialize(n).tenantRootUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=n(Object(me.e)({spPageFallbackWebAbsoluteUrl:J.Dt})).spPageFallbackWebAbsoluteUrl;s=t||r;o=Object(pe.n)({webAbsoluteUrl:s}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,n(Object(ce.t)({url:o.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:s,noRedirect:!0}))];case 1:if(!((u=m.sent())&&u.d&&u.d.mySite))throw new le.e({facets:Object(i.__assign)({},de.f.pack({}))});a=u.d.mySite.replace(/\/$/,"");f={webAbsoluteUrl:a,listFullUrl:a+"/Documents",rootFolder:""};l=c.e.serialize(f);(h=new q.e).mapKeys({mappings:(d={},d[e.itemKey]=l,d)});p=new ye.e(a).authority+"/_api/v2.0";void 0;"root";h.merge(n(Object(ve.e)({itemKey:l,spItem:f,driveUrl:Object(ge.n)({endpoint:p,driveId:void 0}),driveItemUrl:Object(ge.t)({endpoint:p,driveId:void 0,itemId:"root"})})).itemResolver);h.resolveItems({items:(v={},v[l]=Object(i.__assign)({},he.i.pack(c.e)),v)});n(h.execute());return[2]}})})}});var we=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.o)(B.e,a.e)(be));e(Object(o.o)(j.e,a.e)(U));e(Object(o.o)(F.e,a.e)(ne));e(Object(o.o)(I.e,fe.t)(oe));return[2]})})}}),Ee=n(1048),Se=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=Ee.e.deserialize(n).tenantRootUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=b.e.serialize({webAbsoluteUrl:r});return[4,n(Object(z.demandItems)(function(e){return e.demandItemFacet(J.qe,t)}))];case 1:s=m.sent();o=n(Object(W.e)(function(e){return e.demandItemFacet(V.S,V.n)}));u=!s;f=o&&o.language||"en-US";l=Object(se.e)({Locale:f,v:2,msajax:1,cv:2});a=u?r+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+l:Object(pe.n)({webAbsoluteUrl:r}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:f});return[4,n(Object(ce.t)({url:a.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 2:c=m.sent();h=u?c:JSON.parse(c.d.GetSuiteNavData);p=!(!h.NavBarData||!h.NavBarData.AdminLink)||void 0;(d=new q.e).resolveItems({items:(v={},v[e.itemKey]=Object(i.__assign)({},J.It.pack(p)),v)});n(d.execute());return[2]}})})}});var xe=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.o)(Ee.e,a.e)(Se));return[2]})})}}),Te=n(2453),Ne=n(50),Ce=n(763),ke=n(125),Le=n(582),Ae=n(58),Oe={ODB:1855},Me=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.formatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(h){switch(h.label){case 0:r=Object.keys(n)[0];s=n[r],o=s.updateType,u=s.formatter;return 0!==o?[3,1]:[2,e(Object(Ne.e)({items:(l={},l[r]=Object(i.__assign)({},J.d.pack(u)),l)}))];case 1:return 2!==o?[3,4]:[4,e(Object(z.demandItems)(function(e){e.demandItemFacet(ke.e,ke.t.serialize({}))}))];case 2:h.sent();a=void 0;f=!1;return[4,e(Object(z.demandItems)(function(e){a=Object(Le.t)(e,{mapping:{fieldData:J.X},itemSetKey:t}).map(function(e){return e.fieldData});f=Object(Ae.e)(e,{feature:Oe})}))];case 3:h.sent();return[2,e(Object(Ne.e)({items:(c={},c[r]=Object(i.__assign)({},J.Xt.pack(Object(Ce.e)({formatter:u,fields:a,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:f}}))),c)}))];case 4:return[2]}})})}}),_e=n(2641),De=n(88),Pe=n(316),He=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.fields;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(p){r=Object.keys(n)[0];s=n[r],o=s.displayName,u=s.fieldDescription,a=s.showInFiltersPane;if((f=e(Object(De.e)({setKey:d.e},t)).setKey)&&r&&(l=e(Object(De.e)({id:J.J},r)).id)){c={__metadata:{type:"SP.Field"},Title:o,SchemaXml:u,ShowInFiltersPane:a};h=Object(pe.e)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}).method("Fields",l).toString();return[2,e(Object(ce.t)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,url:h,qosName:"modifyFieldProperties",body:JSON.stringify(c),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(Object(Ne.e)({items:(t={},t[r]=Object(i.__assign)(Object(i.__assign)({},void 0!==a?Pe.n.pack(a):{}),void 0!==o?K.l.pack(o):{}),t)}))})]}return[2]})})}}),Be=n(155),je=n(756),Fe=n(267),Ie=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.e.deserialize(n),s={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,rootFolder:"",viewKey:{viewId:je.e}};return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(Be.n)({itemSetKey:s}));return[4,e(Object(Be.t)({itemSetKey:s,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:r=i.sent();i.label=2;case 2:i.trys.push([2,5,,7]);return[4,e(Object(Fe.e)(r))];case 3:o=i.sent();return[4,e(qe(o,n))];case 4:i.sent();return[3,7];case 5:i.sent();return[4,e(qe(void 0,n))];case 6:i.sent();return[3,7];case 7:return[2]}})})}});function qe(e,t){var n=this;return function(r){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,s,o,u;return Object(i.__generator)(this,function(a){n=!1;(s=e&&e.ListData&&e.ListData.Row)&&s.length>0&&s[0]&&(n=!0);(o=new q.e).resolveItems({items:(u={},u[t]=Object(i.__assign)({},K.C.pack(n||void 0)),u)});r(o.execute());return[2]})})}}var Re=n(3281),Ue=n(38),ze=n(93),We=n(1696),Xe=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;return Object(i.__generator)(this,function(M){switch(M.label){case 0:r=void 0;o=void 0;for(u=0,a=Object.keys(t);u<a.length;u++){m=a[u];f=n(Object(De.e)({key:c.e,folderPath:J.G},m));l=e.items[m];if(f&&f.key&&f.folderPath){if(!r){o=f.key.listFullUrl;r={webAbsoluteUrl:f.key.webAbsoluteUrl,items:[],checkInOutType:l.checkInOutType,checkInText:l.checkInText,checkInVersionType:l.checkInVersionType};o=f.key.listFullUrl}r.items.push({key:m,itemFullUrl:f.folderPath})}}if(!(h=r)||!h.items.length)return[3,4];p=h.items.length>1;d=void 0;d="checkIn"===h.checkInOutType?p?"batchCheckInItems":"CheckInItem":"checkOut"===h.checkInOutType?p?"batchCheckOutItems":"CheckOutItem":p?"batchUndoCheckOutItems":"UndoCheckOutItem";v="checkOut"===h.checkInOutType;if(p)return[3,2];m=h.items[0].key;g=Ve(h.webAbsoluteUrl,h.items[0].itemFullUrl,h.checkInOutType,h.checkInText,h.checkInVersionType);return[4,n(Object(ce.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:g,method:"POST",qosName:d}))];case 1:M.sent();n(Object(Ne.e)({items:(A={},A[m]=Object(i.__assign)({},K.y.pack({byYou:!!v,byOther:void 0})),A)}));return[3,4];case 2:y=ze.e.generate();b="multipart/mixed; boundary=batch_"+y;return[4,n(Object(ce.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:We.t.getBatchOperationUrl(h.webAbsoluteUrl),body:$e(h,y),method:"POST",additionalHeaders:void 0,contentType:b,parseResponse:function(e){return We.t.processBatchResponse(e,h.items)},qosName:"batch",telemetryHandler:function(e){var t=e.response,n=e.eventData;return t&&n.resultType===Ue.t.success?{eventData:Object(i.__assign)(Object(i.__assign)({},n),{resultType:t.hasError?Ue.t.failure:Ue.t.success})}:{eventData:n}}}))];case 3:if((w=M.sent()).hasError){N={items:{}};for(C=0,k=w.items;C<k.length;C++)(L=k[C]).error&&L.key&&(N.items[L.key]=new le.e({message:L.error.message}));throw new s.e(N)}E=new q.e;for(S=0,x=h.items;S<x.length;S++){T=x[S];E.resolveItems({items:(O={},O[T.key]=Object(i.__assign)({},K.y.pack({byYou:!!v,byOther:void 0})),O)})}n(E.execute());M.label=4;case 4:return[2]}})})}});function Ve(e,t,n,r,i){var s;s="checkIn"===n?"CheckIn":"undoCheckOut"===n?"UndoCheckOut":"CheckOut";var o=Object(pe.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(o="checkIn"===n?o.methodWithAliases("CheckIn",{comment:r,checkintype:i||0}):o.segment(s)).toString()}function $e(e,t){var n=e.items,r=We.t.defaultBatchRequestPostData,i=n.map(function(t){return Ve(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText,e.checkInVersionType)});return We.t.getBatchContentExtended(t,i,"POST",r)}var Je=n(2181),Ke=n(2287),Qe=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(C){switch(C.label){case 0:r=void 0;s=void 0;o="";u=!0;for(a=0,f=Object.keys(t);a<f.length;a++){S=f[a];l=n(Object(De.e)({key:c.e,folderPath:J.G},S));h=n(Object(De.e)({key:c.e,uiVersion:J.Rt,contentTypeId:J.c},S)),p=h.uiVersion,d=h.contentTypeId;o=Ke.t(p);u=Ke.i(d);v=e.items[S];m=n(Object(De.e)({listItemId:J.Se},S)).listItemId;if(l&&l.key&&l.folderPath){if(!r){s=l.key.listFullUrl;r={webAbsoluteUrl:l.key.webAbsoluteUrl,items:[],publishActionType:v.publishActionType,publishText:v.publishText};s=l.key.listFullUrl}r.items.push({key:S,itemFullUrl:l.folderPath,listItemId:m})}}if(!(g=r)||!g.items.length)return[3,4];y=g.publishActionType===Je.e.SchedulePublish;b=y?"ScheduleItem":"PublishItem";w=0;C.label=1;case 1:if(!(w<g.items.length))return[3,4];E=g.items[w];S=E.key;x=u&&g.publishActionType!==Je.e.CancelApproval;T=x?(function(e,t,n){return e+"/_api/sitepages/pages("+t+")/"+(n?"schedulepublish":"publish")})(g.webAbsoluteUrl,E.listItemId,y):(function(e,t,n){var r="Publish";n&&n===Je.e.CancelApproval&&(r="UnPublish");var i=Object(pe.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(i=i.segment(r)).toString()})(g.webAbsoluteUrl,g.items[0].itemFullUrl,g.publishActionType);return[4,n(Object(ce.t)({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:s,url:T,body:!y&&x?'{"__metadata":{"type":"SP.Publishing.SitePage"}}':"",method:"POST",qosName:b}))];case 2:C.sent();""!==o&&n(Object(Ne.e)({items:(N={},N[S]=Object(i.__assign)({},J.Rt.pack(o)),N)}));C.label=3;case 3:w++;return[3,1];case 4:return[2]}})})}});var Ge=n(111),Ye=n(208),Ze=n(2288),et=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Ze.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=Ge.e.serialize({webAbsoluteUrl:u,listFullUrl:a});return(l=e(Object(W.e)(function(e){return e.demandItemFacet(J.we,f)})))&&l.id&&o?[4,e(Object(ce.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(pe.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:l.id,itemID:o,rating:n.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:i.sent();e(Object(Ye.t)({items:(c={},c[t]=[K.l],c)}));i.label=3;case 3:return[2]}})})}}),tt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Ze.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=Ge.e.serialize({webAbsoluteUrl:u,listFullUrl:a});return(l=e(Object(W.e)(function(e){return e.demandItemFacet(J.we,f)})))&&l.id&&o?[4,e(Object(ce.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(pe.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:l.id,itemID:o,like:n.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:i.sent();e(Object(Ye.t)({items:(c={},c[t]=[K.l],c)}));i.label=3;case 3:return[2]}})})}}),nt=n(317),rt=n(131),it=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=e.options,s=r.newDocumentKey,o=r.extension;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,u,a,f;return Object(i.__generator)(this,function(l){switch(l.label){case 0:t=c.e.deserialize(n);r=t.rootFolder||new nt.e(t.listFullUrl).path;u=new rt.t({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}});a=u.getUrlParts({path:r});f=a.fullItemUrl;return[4,e(Object(ce.t)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:st({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:a.listRelativeItemUrl||"",extension:o}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var r,o,u=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!u)throw"Fail to create custom document";var a=f+"/"+u;e(Object(Ne.e)({items:(r={},r[s]=Object(i.__assign)(Object(i.__assign)({},K.l.pack(u)),K.i.pack(a)),r)}));e(Object(Ye.t)({items:(o={},o[n]=[R.t],o)}))})];case 1:l.sent();return[2]}})})}});function st(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.extension,i=e.parentFolderPath;if(!r)throw new Error("document extension is not valid");return Object(pe.e)({webAbsoluteUrl:t,listFullUrl:n}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:i,extension:r}).toString()}var ot=n(2885),ut=n(178),at=n(401),ft=n(1831),lt=n(456);function ct(e){var t=e.sourceView,n=e.deserializedItemSetKey,r=e.appliedFilters,i=new at.e(t.getEffectiveViewXml());n.sortFieldKey&&i.updateSort({fieldName:n.sortFieldKey,isAscending:n.sortAscending},{overwriteAll:!0});n.groupByFieldKey&&i.updateGroupBy({group1:{fieldName:n.groupByFieldKey,isAscending:!0}});if(r)for(var s in r)if(r.hasOwnProperty(s)){var o=r[s];ft.updateFilter(i,o)}try{var u=Object(lt.e)(t.id,!0);if(u){i.updateColumnWidths(u);Object(lt.t)(t.id)}}catch(e){}return i}var ht=n(2976),pt=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(k){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.sourceView,a=o.isPublic,f=o.itemSetKey,l=o.progressItemKey;if(u&&r){c=e(Object(De.e)({deserializedItemSetKey:d.e,filterableSet:J.mt,childItems:R.e,parentItem:R.i,schema:R.s},f)),h=c.deserializedItemSetKey,v=c.filterableSet,m=c.childItems,g=c.parentItem,y=c.schema;(b=h?ct({sourceView:u,deserializedItemSetKey:h,appliedFilters:v&&v.appliedFilters}):u).prepareForSaving();w=Object(pe.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).segment("Views").segment("Add");T=u.getEffectiveAggregatesFieldXml();N=u.viewType;return[2,e(Object(ce.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:w.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:u.getEffectiveFieldNames()},Query:b.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!a,RowLimit:u.rowLimit},N&&ht.e.indexOf(N)>=0?{ViewType2:N}:{})}),qosName:"addView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;S={viewId:ze.e.normalizeLower(o.Id,!1)};E=new at.e(t.d);Object(lt.n)(E);var u=new q.e;u.resolveItems({items:(n={},n[ut.e.serialize(S)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},ut.e.pack(S)),J.it.pack(o)),J.p.pack(E)),J.st.pack(!1)),n)});if(h){x=d.e.serialize(Object(i.__assign)(Object(i.__assign)({},h),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:S}));u.resolveItems({items:(r={},r[x]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},m?R.e.pack(m):{}),g?R.i.pack(g):{}),y?R.s.pack(y):{}),r)})}l&&u.resolveItems({items:(s={},s[l]=Object(i.__assign)({},ut.e.pack(S)),s)});return e(u.execute())}).then(function(){var n,r;if(u.scope||T){var s={};u.scope&&(s.scope=u.scope);e(Object(me.e)({enableModernColumnTotalsSettings:J._})).enableModernColumnTotalsSettings&&T&&(s.aggregations=T);return e(Object(C.e)({items:(n={},n[t]={views:(r={},r[E.id]=Object(i.__assign)({},s),r)},n)}))}}).then(function(){var n,r;return e(Object(Ye.t)({items:Object(i.__assign)((n={},n[t]=[R.e],n),T?(r={},r[ut.e.serialize(S)]=[J.at],r):{})}))})]}return[2]})})}}),dt=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N,C,k,L;return Object(i.__generator)(this,function(A){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.isPublic,a=o.viewType,f=o.viewFields,l=o.viewStyles,c=o.viewData,h=o.queryXml,v=o.rowLimit,m=o.itemSetKey,g=o.progressItemKey;if(r){y=e(Object(De.e)({deserializedItemSetKey:d.e,childItems:R.e,parentItem:R.i,schema:R.s},m)),b=y.deserializedItemSetKey,w=y.childItems,E=y.parentItem,S=y.schema;x=Object(pe.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});T=x.segment("Views").segment("Add");return[2,e(Object(ce.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:T.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:f}},ht.e.indexOf(a)>=0?{ViewType2:a}:{}),{ViewData:c,CalendarViewStyles:l,Query:h,Paged:!0,PersonalView:!u,RowLimit:v})}),qosName:"addView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;C=ze.e.normalizeLower(o.Id,!1);k={viewId:C};N=new at.e(o);Object(lt.n)(N);var u=new q.e;u.resolveItems({items:(n={},n[ut.e.serialize(k)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},ut.e.pack(k)),J.it.pack(o)),J.p.pack(N)),J.st.pack(!1)),n)});if(b){L=d.e.serialize(Object(i.__assign)(Object(i.__assign)({},b),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:k}));u.resolveItems({items:(r={},r[L]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},w?R.e.pack(w):{}),E?R.i.pack(E):{}),S?R.s.pack(S):{}),r)})}g&&u.resolveItems({items:(s={},s[g]=Object(i.__assign)({},ut.e.pack(k)),s)});return e(u.execute())}).then(function(){var n;return e(Object(Ye.t)({items:(n={},n[t]=[R.e],n)}))})]}return[2]})})}}),vt=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a;return Object(i.__generator)(this,function(i){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s].viewXml;if(r){u=Object(pe.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});a=u.method("Views",s).method("SetViewXml");return[2,e(Object(ce.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:a.toString(),method:"POST",body:JSON.stringify({viewXml:o}),qosName:"saveViewXML"}))]}return[2]})})}}),mt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.views,r=p.e.deserialize(t),s=Object.keys(n)[0];return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var o,u,a;return Object(i.__generator)(this,function(f){if(r&&s){o=n[s];u=Object(pe.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).method("Views",s);a={__metadata:{type:"SP.View"},DefaultView:o.isDefault,Title:o.title};"number"==typeof o.scope&&(a.Scope=o.scope);if(o.aggregations){a.Aggregations=o.aggregations;a.AggregationsStatus="On"}return[2,e(Object(ce.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:u.toString(),method:"POST",body:JSON.stringify(a),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var n,r,u=e(Object(De.e)({childItems:R.e},t)).childItems;if(u){for(var a=new q.e,f=ut.e.serialize({viewId:s}),l=void 0,c=void 0,h=void 0,p=0,d=u.itemKeys;p<d.length;p++){var v=d[p],m=e(Object(De.e)({view:J.p},v)).view;if(m){if(m.isDefault){l=m;c=v}v===f&&(h=m)}}if("boolean"==typeof o.isDefault){if(o.isDefault&&l&&c){l.isDefault=!1;a.resolveItems({items:(n={},n[c]=Object(i.__assign)({},J.p.pack(l)),n)})}if(h&&f){h.isDefault=o.isDefault;a.resolveItems({items:(r={},r[f]=Object(i.__assign)({},J.p.pack(h)),r)})}}return e(a.execute())}})]}return[2]})})}}),gt=n(1034),yt=n(249),bt={key:gt.e,displayName:K.l,email:yt.e,picture:yt.t},wt=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=m.e.deserialize(n),s=r&&r.spItem,o=s.webAbsoluteUrl,u=s.listFullUrl,a=s.itemId;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:t=a&&Object(pe.e)({webAbsoluteUrl:o,listFullUrl:u}).method("GetItemById",a).segment("likedByInformation");r=new q.e;return(f=t)?[4,e(Object(ce.r)({url:t.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:o,listFullUrl:u}))]:[3,2];case 1:f=p.sent();p.label=2;case 2:l=[];(c=(s=f)&&s.d&&s.d.likedBy&&s.d.likedBy.results)&&c.forEach(function(e){var t,n=e.email,i=gt.e.serialize({id:String(n)});r.resolveItems({items:(t={},t[i]=Object(D.n)(bt,{key:{id:String(n)},displayName:e.name,email:n,picture:n}),t)});l.push(i)});r.resolveItems({items:(h={},h[n]=Object(i.__assign)({},K.x.pack({personKeys:l})),h)});e(r.execute());return[2]}})})}});var Et=n(2452),St=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.views,s=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=p.e.deserialize(t);o=Object.keys(r)[0];if(!n||!o)return[3,4];u=r[o],a=u.itemSetKey,f=u.shouldSaveViewFieldsOnly,l=u.newDocumentTemplatesJsonString,c=u.shouldSaveAggregationsOnly;h=e(Object(De.e)({deserializedViewKey:ut.e,currentDerivedView:J.p},o)),v=h.deserializedViewKey,m=h.currentDerivedView;g=v&&v.viewId;if(!m||!g)return[3,4];y=void 0;return f||l||c?[4,e(Object(Et.e)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,viewId:g}))]:[3,2];case 1:if((b=i.sent())&&b.view){y=b.view;f?y.replaceFields(m.getEffectiveFieldNames()):l?y.updateNewDocumentTemplates(l):c&&y.replaceAggregates(m.getEffectiveAggregatesData())}return[3,3];case 2:w=e(Object(De.e)({deserializedItemSetKey:d.e,filterableSet:J.mt},a)),E=w.deserializedItemSetKey,S=w.filterableSet;if(E){y=ct({sourceView:m,deserializedItemSetKey:E,appliedFilters:S&&S.appliedFilters});(x=e(Object(De.e)({viewType:J.Vt},o)).viewType)&&y.updateViewType(x)}i.label=3;case 3:if(y){y.prepareForSaving();if(m.isDirty()||y.isDirty()){T=Object(pe.e)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}).method("Views",g).method("SetViewXml");return[2,e(Object(ce.t)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,url:T.toString(),method:"POST",body:JSON.stringify({viewXml:y.getEffectiveViewXml()}),qosName:s||"saveView"}))]}}i.label=4;case 4:return[2]}})})}}),xt=n(96),Tt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N,C,L;return Object(i.__generator)(this,function(A){switch(A.label){case 0:if(!(r=e(Object(De.e)({setKey:d.e},t)).setKey))return[3,3];s=Object.keys(n)[0];o=n[s],u=o.modifyType,a=o.targetIndex;if(!(f=r.viewKey?ut.e.serialize(r.viewKey):void 0))return[3,3];if(!(l=e(Object(De.e)({currentDerivedView:J.p},f)).currentDerivedView))return[3,3];c=l.getEffectiveFieldNames();if(!(h=e(Object(De.e)({internalName:J.ue},s)).internalName))return[3,3];if((v=c.indexOf(h))<0||1===u&&0===v||2===u&&v===c.length-1)return[2];m=l.isDirty();switch(u){case 0:l.updateField(h);break;case 1:l.updateField(h,v-1);break;case 2:l.updateField(h,v+1);break;case 3:l.updateField(h,a)}g={ODB:1318};y=e(Object(W.e)(function(e){return e.demandItemFacet(J.Mt,$.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}))}));b=e(Object(W.e)(function(e){return{isAutoSaveEnabled:Object(Ae.e)(e,{feature:g,pageContext:y}),list:e.demandItemFacet(J.we,Ge.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}))}})),w=b.isAutoSaveEnabled,E=b.list;S=!1;return w&&E&&E.permissions&&E.permissions.manageLists?[4,e(Object(k.e)({items:(T={},T[p.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})]={views:(N={},N[f]={shouldSaveViewFieldsOnly:!0},N),qosName:"autoSaveModifyColumn"},T)})).then(function(){m||(l.baseViewXml=l.getEffectiveViewXml());S=!0},function(e){xt.e.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:h,modifyType:u,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:A.sent();A.label=2;case 2:x=new q.e;w&&S||x.resolveItems({items:(C={},C[f]=Object(i.__assign)({},J.st.pack(!0)),C)});x.invalidateItems({items:(L={},L[t]=[R.e],L[f]=[J.p],L)});e(x.execute());A.label=3;case 3:return[2]}})})}}),Nt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,s,o,u;return Object(i.__generator)(this,function(a){n=Object.keys(t)[0];r=t[n],s=r.updateType,o=r.formatter;return 0===s?[2,e(Object(Ne.e)({items:(u={},u[n]=Object(i.__assign)({},J.d.pack(o)),u)}))]:[2]})})}}),Ct=n(2884),kt=n(2623),Lt=n(1932),At=n(76),Ot=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,r=e.options.sourceEntries,s=v.e.deserialize(n),o=s&&s.itemSetKey,u=o.webAbsoluteUrl,a=o.listFullUrl,f=o.rootFolder,l=c.e.serialize({webAbsoluteUrl:u,listFullUrl:a,rootFolder:f}),h=Object.keys(r)[0],p=r[h].progressItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,c;return Object(i.__generator)(this,function(d){switch(d.label){case 0:t=e(Object(De.e)({sourceFile:Lt.t},h)).sourceFile;s=e(Object(me.e)({listItemUploader:J.xe})).listItemUploader,o=void 0===s?kt.e:s;return[4,e(o({itemKey:l,options:{sourceEntries:r}}))];case 1:u=d.sent().itemKey;d.label=2;case 2:d.trys.push([2,4,,5]);return[4,e(Object(Ct.e)({items:(a={},a[u]={groupKey:n},a)}))];case 3:d.sent();return[3,5];case 4:d.sent();return[3,5];case 5:e(Object(Ye.t)({items:(f={},f[l]=[R.t],f)}));p&&t&&e(Object(Ne.e)({items:(c={},c[p]=Object(i.__assign)(Object(i.__assign)({},At.s.pack({itemKey:u})),Object(D.n)({progressSize:At.m},{progressSize:{current:t.size}})),c)}));return[2]}})})}});var Mt=n(15),_t=n(1053),Dt=Object(s.i)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,r=p.e.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,u,a,f,l,c,h,d,v,m,g,y;return Object(i.__generator)(this,function(b){switch(b.label){case 0:t=[];u=new q.e;a=e(Object(De.e)({pageContext:J.Mt},$.e.serialize({webAbsoluteUrl:s,listFullUrl:o}))).pageContext;f=Ge.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});l=e(Object(De.e)({list:J.we},f));c=e(Object(me.e)({localeConfiguration:V.S})).localeConfiguration;return[4,e(Object(Et.t)({webAbsoluteUrl:s,listFullUrl:o,listTemplate:l.list&&l.list.templateType,preferredLanguage:c&&c.language}))];case 1:h=b.sent();d={};v=void 0;m=a&&Object(Mt.t)(a);h.filter(function(e){return!!e.view}).map(function(n){var r,a=n.serverView,f=n.view,l={viewId:f.id},c=ut.e.serialize(l);if(f.isDefault){v=c;var h=f.getDomParts().newDocumentTemplates;h&&h.textContent&&u.merge(Object(_t.e)({webAbsoluteUrl:s,listFullUrl:o,newDocumentTemplatesString:h.textContent}).itemResolver)}d[c]=f;Object(lt.n)(f);var p=e(Object(W.e)(function(e){if(e.isItemFacetResolved(J.p,c))return e.demandItemFacet(J.p,c)})),g=!!m&&!m.isActivated("E9B1A0B8-5A6E-4292-8EF8-68446FEF4A7D","4/20/2020","Skip resolve currentDerived when it is not changed")&&!!p&&p.getEffectiveViewXml().replace(/ \/>/g,"/>")===f.getEffectiveViewXml().replace(/ \/>/g,"/>");u.resolveItems({items:(r={},r[c]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},ut.e.pack(l)),J.it.pack(a)),g?{}:J.p.pack(f)),J.st.pack(!1)),J.Vt.pack(f.viewType)),r)});t.push(c)});t.sort(function(e,t){return d[e].compareTo(d[t])});u.resolveItems({items:(g={},g[n]=Object(i.__assign)(Object(i.__assign)({},p.e.pack(r)),R.e.pack({itemKeys:t})),g)});v&&u.resolveItems({items:(y={},y[f]=Object(i.__assign)({},J.g.pack({viewKey:v})),y)});e(u.execute());return[2]}})})}});var Pt=n(679),Ht=n(620),Bt=n(241),jt=n(432),Ft=n(201),It=n(54),qt=n(274),Rt=n(1017),Ut=n(23),zt=n(789),Wt=n(75),Xt=n(1018),Vt=Object(s.i)()(function(e){var t=e.itemKey,n=g.e.deserialize(t),r=n.webAbsoluteUrl,s=n.listFullUrl;return function(e){var n,o=e(Object(Rt.t)({webAbsoluteUrl:r,listFullUrl:s}));if(o.listTemplate===Ut.t.mySiteDocumentLibrary){var u=new q.e;u.resolveItems({items:(n={},n[t]=Object(i.__assign)({},R.e.pack(void 0)),n)});e(u.execute());return Promise.resolve()}return e(Object(Rt.e)(r,s,o)).then(function(n){return e(Object(Xt.e)({customActionSetKey:t,customActions:n,context:o}))}).then(function(t){return e(t.execute())})}}),$t=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=y.e.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.isSPFXandCustomActionsAvailable,a=r.targetCustomActionSetKey,f=r.itemsScopeItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,l,c,h,p,d,m,g,y,b;return Object(i.__generator)(this,function(w){switch(w.label){case 0:t=new q.e;r=Ge.e.serialize({webAbsoluteUrl:s,listFullUrl:o});l=e(Object(W.e)(zt.e));c=function(){var n;t.resolveItems({items:(n={},n[r]=Ft.o.pack(void 0),n)});e(t.execute())};if(!u&&!l){c();return[2]}return(p=l)?[4,l()]:[3,2];case 1:p=w.sent();w.label=2;case 2:d=!1;if(!(h=p))return[3,7];m=h.createListViewAdapter();t.resolveItems({items:(b={},b[r]=Object(i.__assign)({},m?Ft.o.pack(m):{}),b)});g=e(Object(De.e)({rawCustomActions:J.et},a)).rawCustomActions;return[4,Jt({setKey:n,actions:g||[],listViewAdapter:m})];case 3:y=w.sent().itemResolver;t.merge(y);return[4,e(Object(z.demandItems)(function(e){var n=Object(Wt.e)(e,f);if(n&&m){var r=e.demandItemFacet(R.e,n),u=r&&r.itemKeys,a=function(n){var r,s=e.isItemFacetResolved(J.rt,n)?e.demandItemFacet(J.rt,n):void 0;if(s&&m){var o=m.createRowAdapter({values:s});t.resolveItems({items:(r={},r[n]=Object(i.__assign)({},o?Ft.u.pack(o):{}),r)})}else if(e.demandItemFacet(v.e,n)){var u=e.isItemFacetResolved(R.e,n)?e.demandItemFacet(R.e,n):void 0;if(u)for(var f=0,l=u.itemKeys;f<l.length;f++){var c=l[f];a(c)}}};if(u)for(var l=0,c=u;l<c.length;l++){var h=c[l];a(h)}var p=e.demandItemFacet(R.s,n),g=p&&p.columnKeys||[];if(g&&m)for(var y=function(n){var r,i=e.demandItem({fieldId:J.J,internalName:J.ue,realFieldName:J.tt,fieldType:J.$,isRequired:Bt.r,displayName:K.l,clientSideComponentId:Ft.e,clientSideComponentProperties:Ft.t},n),u=i.fieldId,a=i.internalName,f=i.realFieldName,l=i.fieldType,c=i.isRequired,h=i.displayName,p=i.clientSideComponentId,v=i.clientSideComponentProperties;if(u&&a){d=!0;var g={listKey:{webAbsoluteUrl:s,listFullUrl:o},internalName:a},y={id:u,internalName:f||a,fieldType:l||"Text",isRequired:c||!1,isVisible:!0,displayName:h||"",clientSideComponentId:p||ze.e.Empty,clientSideComponentProperties:v||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+a+",\n                      componentId: "+p+", error: "+e.message)}},b=m.addColumnAdapter(y);if(p&&p!==ze.e.Empty){var w=Ht.e.serialize(g);t.resolveItems({items:(r={},r[w]=Ft.n.pack(b),r[n]=Ft.r.pack(w),r)})}}},b=0,w=g;b<w.length;b++){y(w[b])}}}))];case 4:w.sent();return d?[4,m.loadFieldCustomizers()]:[3,6];case 5:w.sent();w.label=6;case 6:return[3,8];case 7:c();w.label=8;case 8:e(t.execute());return[2]}})})}});function Jt(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:t=e.setKey,n=e.actions,r=e.listViewAdapter;s=new q.e;o=[];u=0;a=function(e){var t,n,a,f,l,c,h,p,d,v,m,g;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=[];if(!Object(qt.t)(e))return[3,5];n=e.children;a=0;f=0,l=n;i.label=1;case 1:if(!(f<l.length))return[3,5];c=l[f];h=c.id?c.id:c.text+u+"."+a;p=Pt.e.serialize({actionId:h});return Qt(c)&&r?[4,Kt({action:c,listViewAdapter:r})]:[3,3];case 2:d=i.sent(),g=d.actionKeys,m=d.itemResolver;s.merge(m);g.forEach(function(e){t.push(e)});i.label=3;case 3:t.push(p);a++;i.label=4;case 4:f++;return[3,1];case 5:return!Object(qt.t)(e)&&Qt(e)&&r?[4,Kt({action:e,listViewAdapter:r})]:[3,7];case 6:v=i.sent(),m=v.itemResolver,g=v.actionKeys;s.merge(m);o=o.concat(g);i.label=7;case 7:u++;return[2]}})};f=0,l=n;p.label=1;case 1:if(!(f<l.length))return[3,4];c=l[f];return[5,a(c)];case 2:p.sent();p.label=3;case 3:f++;return[3,1];case 4:s.resolveItems({items:(h={},h[t]=Object(i.__assign)(Object(i.__assign)({},It.s.pack(!0)),R.e.pack(0===o.length?void 0:{itemKeys:o})),h)});return[2,{itemResolver:s}]}})})}function Kt(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s,o,u,a;return Object(i.__generator)(this,function(f){switch(f.label){case 0:t=e.action,n=e.listViewAdapter;r=new q.e;s=[];o=t.clientSideComponentId&&t.clientSideComponentId.toString()||"";u=t.clientSideComponentProperties||"";return o&&o!==ze.e.Empty?[4,n.loadCommandSet(o,u).catch(function(){})]:[2,{itemResolver:r,actionKeys:[]}];case 1:(a=f.sent())&&a.commandAdapters&&a.commandAdapters.forEach(function(e){var n,o=t.clientSideComponentId+"."+e.commandId,u=Pt.e.serialize({actionId:o});r.resolveItems({items:(n={},n[u]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},K.l.pack(e.title)),K.L.pack(t.action)),jt.e.pack(t.allowMultiSelect)),jt.n.pack(t.isEnabled||!1)),jt.t.pack(e.iconUrl||t.iconUrl)),Ft.i.pack(e)),n)});s.push(u)});return[2,{itemResolver:r,actionKeys:s}]}})})}function Qt(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==ze.e.Empty)||!1}var Gt=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=b.e.deserialize(n).webAbsoluteUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l;return Object(i.__generator)(this,function(c){switch(c.label){case 0:t=Object(pe.n)({webAbsoluteUrl:r}).segments("ComponentContextInfo");return[4,n(Object(ce.t)({url:t.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:r,noRedirect:!0}))];case 1:s=c.sent();o=JSON.parse(s.d.SerializedData);u=o.isSPO,a=void 0===u||u;(f=new q.e).resolveItems({items:(l={},l[e.itemKey]=Object(i.__assign)(Object(i.__assign)({},J.qe.pack(a?void 0:{})),J.Mt.pack(o)),l)});n(f.execute());return[2]}})})}});var Yt=n(210),Zt=n(144),en=n(2639),tn=n(1884),nn=Object(s.n)()(function(e){var t=e.items,n=Object.keys(t),r=t[n[0]].groupKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(W.e)(function(e){return e.demandItemFacet(v.e,r)}));if(!(s=t&&t.itemSetKey&&d.e.serialize(t.itemSetKey))||n.length<1||!r)return[2];o=e(Object(De.e)({spGroupField:J.Et,groupValue:J.se,parentGroupKey:J.Ue,defaultCollapsed:It.t},r)),u=o.spGroupField,a=o.groupValue,f=o.parentGroupKey,l=o.defaultCollapsed;c=[];u&&u.internalName&&a&&c.push({FieldName:u.internalName,FieldValue:a});if(f&&f.itemKey){h=e(Object(De.e)({parentGroupField:J.Et,parentGroupValue:J.se},f.itemKey)),p=h.parentGroupField,m=h.parentGroupValue;p&&p.internalName&&m&&c.push({FieldName:p.internalName,FieldValue:m})}if(t&&t.itemSetKey&&t.itemSetKey.filterParams&&(g=Zt.default.getFilterList(t.itemSetKey.filterParams,void 0,!0)).length>0)for(y=0;y<g.length;y++){b=g[y];w=e(Object(De.e)({isReadOnly:J.he},Yt.e.serialize({listKey:t.itemSetKey,internalName:b.fieldName}))).isReadOnly;1===b.values.length&&!1===w&&c.push({FieldName:b.fieldName,FieldValue:b.values[0]})}return[4,e(Object(en.e)({items:(S={},S[s]={itemKeys:n,formValues:c,qosName:"AssignItemsToGroup"},S)}))];case 1:i.sent();E={};n.forEach(function(e){E[e]={}});return[4,e(Object(tn.e)({items:(x={},x[s]=E,x)}))];case 2:i.sent();e(l?Object(Ye.t)({items:(T={},T[r]=[R.e],T)}):Object(Ye.t)({items:(N={},N[s]=[R.e],N)}));return[2]}})})}}),rn=n(2981),sn=n(2643),on=Object(M.t)()(function(){return function(e){return un}});function un(e,t){var n=t.itemKey,r=e.demandItem({driveItem:c.e,canonicalLinkUrl:K.i},n),s=r.driveItem,o=r.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h,p;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.canonicalLinkUrl;if(t&&r)return[3,1];throw new Error("Unable to obtain default share URL");case 1:s=void 0;if(r){o=new nt.e(r);u=o.authority;for(a=0,f=o.segments;a<f.length;a++)""!==(l=f[a])&&(u=u+"/"+encodeURIComponent(l));c=Object(sn.e)(u.toString());s="u!"+c.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}h=new nt.e(t.webAbsoluteUrl).authority;return[4,n(Object(ce.t)({webAbsoluteUrl:h,listFullUrl:void 0,url:h+"/_api/v2.0/shares/"+s+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(p=i.sent()).value[0].link.webUrl,scope:p.value[0].link.scope}]}})})}})({driveItem:s,canonicalLinkUrl:o})}}}var an=n(2982),fn=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.bNewDocumentUpdate,s=n.checkInComment,o=n.formValues,u=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return o.length>0?[4,e(Object(Ze.e)(t))]:[3,3];case 1:n=i.sent(),a=n.key,f=n.itemId;l=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return Object(pe.e)({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).method("ValidateUpdateListItem").toString()})({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,itemId:f||a.itemId||""});(c={}).formValues=o;c.bNewDocumentUpdate=r;c.checkInComment=s;return[4,e(Object(ce.t)({body:JSON.stringify(c),listFullUrl:a.listFullUrl,method:"POST",qosName:u,url:l,webAbsoluteUrl:a.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=e.d.ValidateUpdateListItem.results[0];if(t.HasException)throw new Error(t.ErrorMessage||void 0)})];case 2:i.sent();i.label=3;case 3:return[2]}})})}});var ln=n(509),cn=n(47);var hn=n(236),pn=n(271),dn=Object(s.i)()(function(e){var t=e.itemKey;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f;return Object(i.__generator)(this,function(l){switch(l.label){case 0:r=d.e.deserialize(t);s=n(Object(Be.n)({itemSetKey:r}));o=Object.keys(e.options);return[4,n((h={itemSetKey:t,itemKeys:o},function(e){for(var t=h.itemSetKey,n=h.itemKeys,r=e(Object(W.e)(function(e){var n=e.demandItemFacet(d.e,t)||d.e.deserialize(t);return Object(i.__assign)(Object(i.__assign)({},n),{pageContext:Object(cn.e)(e,c.e.serialize(n))})})),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.pageContext,a=[],f=0,l=n;f<l.length;f++){var p=l[f],v=c.e.deserialize(p).itemId;v||(v=e(Object(De.e)({listItemId:J.Se},p)).listItemId);v&&a.push(v)}var m=e(Object(Le.e)({internalName:J.ue},t)),g=["Modified"];if(m)for(var y=0,b=m;y<b.length;y++){var w=b[y];w.internalName&&"Modified"!==w.internalName&&g.push(w.internalName)}return{webAbsoluteUrl:s,listFullUrl:o,currentPageContext:u,qosName:"refreshItemsInSet",viewXml:Object(ln.r)({itemIds:a,recurseInFolders:!0,pageSize:n.length,fieldNames:g.length>0?g:void 0}),postDataContext:{needsSchema:!0}}}))];case 1:u=l.sent();return[4,n(Object(Fe.e)(u))];case 2:a=l.sent();f=n(Object(hn.t)({serverData:a,itemSetKey:r,currentPageContext:u.currentPageContext,contentTypes:s,isItemSetRequest:!0})).itemResolver;n(f.execute());n(Object(pn.e)({itemSetKey:t,serverData:a,isItemSetRequest:!0}));return[2]}var h})})}}),vn=n(2983),mn=Object(M.t)()(function(){return function(e){return gn}});function gn(e,t){var n=t.itemKey,r=t.link,s=t.recipients,o=e.demandItem({driveItem:c.e},n).driveItem;return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.link,s=e.recipients;if(!t)return[3,2];void 0;u=Object(sn.e)(r);o="u!"+u.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");a=s.map(function(e){return{email:e}});f={recipients:a,roles:["read"]};l=new nt.e(t.webAbsoluteUrl).authority;return[4,n(Object(ce.t)({webAbsoluteUrl:l,listFullUrl:void 0,url:l+"/_api/v2.0/shares/"+o+"/permission/invite",body:JSON.stringify(f),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))];case 1:c=i.sent();h=c.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:h}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}})({driveItem:o,link:r,recipients:s})}}}var yn=n(2642),bn=Object(M.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(c.e,n);if(!r)return{};var i={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl},s=e.demandItemFacet(J.we,Ge.e.serialize(i)),o=e.demandItemFacet(J.Mt,$.e.serialize(i));if(!o)return{};var u=s&&s.templateType===Ut.t.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:o.currentUICultureName||o.currentCultureName||"en-US",client:u?"OneDrive":"SharePoint",domainHint:"organizations",userId:o.userLoginName}}}}});var wn=n(2980),En=n(154),Sn=n(255),xn=Object(M.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=void 0,i=e.demandItem({key:c.e,driveItemKey:En.e},n),s=i.key,o=i.driveItemKey;if(o)return{driveItemFullUrl:Object(ge.t)(o)};if(s){var u={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl},a=e.demandItem({listMediaFacets:Sn.t},Ge.e.serialize(u)).listMediaFacets;if(a&&a[".driveUrl"]){var f=a[".driveUrl"],l=s.rootFolder||"",h="";if(l){var p=new rt.t({context:{webAbsoluteUrl:s.webAbsoluteUrl,listUrl:s.listFullUrl}}).getUrlParts();p.serverRelativeListUrl&&"/"!==(h=l.replace(p.serverRelativeListUrl,"")).charAt(0)&&(h="/"+h)}return{driveItemFullUrl:r=f+"/items/root"+(h?":":"")+h}}}return{driveItemFullUrl:r}}}});var Tn=n(424),Nn=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.aggregateType,s=n.columnKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,l,c,h,v,m,g,y,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(n=e(Object(De.e)({setKey:d.e},t)).setKey))return[3,2];if(!(o=n.viewKey?ut.e.serialize(n.viewKey):void 0))return[3,2];if(!(u=e(Object(De.e)({currentDerivedView:J.p},o)).currentDerivedView))return[3,2];a=e(Object(De.e)({internalName:J.ue,fieldType:J.K,fieldFieldType:J.$},s)),f=a.internalName,l=a.fieldType,c=a.fieldFieldType;if(!f)return[3,2];h=e(Object(De.e)({spFolderAggregates:J.a},t)).spFolderAggregates;v=u.isDirty();if(!(m=h&&h[s]?h[s].aggregateFunctionType:void 0)&&0===r||m===Tn.e[r])return[2];g=0===r?void 0:Tn.e[r];u.updateColumnAggregateType(f,g);return[4,e(Object(k.e)({items:(y={},y[p.e.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl})]={views:(b={},b[o]={shouldSaveAggregationsOnly:!0},b),qosName:"SaveModifyColumnAggregateType"},y)})).then(function(){var n,r=u.getEffectiveViewXml(),i=new at.e(u.baseViewXml||"");i.replaceAggregates(u.getEffectiveAggregatesData());u.baseViewXml=i.getEffectiveViewXml();u.setDom(r);u.setIsDirty(v);var s=new q.e;s.invalidateItems({items:(n={},n[t]=[R.e],n[o]=[J.at],n)});e(s.execute())},function(e){xt.e.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:l,fieldFieldType:c,currentAggregateType:m||"None",newAggregateType:g||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});u.updateColumnAggregateType(f,m);u.setIsDirty(v);throw e})];case 1:i.sent();i.label=2;case 2:return[2]}})})}}),Cn=n(2979),kn=Object(s.i)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,s=n.bNewDocumentUpdate,o=n.checkInComment,u=n.formValues,a=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,f,l,c,h,p,v,m,g,y,b,w,E,S,x;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(u&&u.length&&r&&r.length))return[2];n=d.e.deserialize(t),f=n.viewKey,l=n.rootFolder,c=n.webAbsoluteUrl,h=n.listFullUrl;p=l||"";f&&(!(v=e(Object(De.e)({currentDerivedView:J.p},ut.e.serialize(f))).currentDerivedView)||1!==v.scope&&2!==v.scope||(p=""));m=[];g={};y=0,b=r;i.label=1;case 1:if(!(y<b.length))return[3,4];w=b[y];return[4,e(Object(Ze.e)(w))];case 2:E=i.sent().itemId;m.push(parseInt(E,10));g[E]=w;i.label=3;case 3:y++;return[3,1];case 4:S=Object(pe.e)({webAbsoluteUrl:c,listFullUrl:h}).method("BulkValidateUpdateListItems").toString();x={itemIds:m,formValues:u,folderPath:p,bNewDocumentUpdate:s,checkInComment:o};return[4,e(Object(ce.t)({body:JSON.stringify(x),listFullUrl:h,method:"POST",qosName:a,url:S,webAbsoluteUrl:c,noRedirect:!0})).then(function(n){for(var r,i="",s={},o=0,u=n.d.BulkValidateUpdateListItems.results;o<u.length;o++){var a=u[o];if(a.HasException)i=a.ErrorMessage+"\n"+i;else{g[a.ItemId]&&(s[g[a.ItemId]]={})}}Object.keys(s).length>0&&e(Object(tn.e)({items:(r={},r[t]=s,r)}));if(i)throw new Error(i)})];case 5:i.sent();return[2]}})})}}),Ln=n(1262),An=n(1263),On=n(1264),Mn=n(1058),_n=n(2454),Dn=n(217),Pn=n(299),Hn=n(507),Bn=Object(s.n)()(function(e){var t=e.items,n=t[Object.keys(t)[0]].itemSetKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,p,d,v,m;return Object(i.__generator)(this,function(i){switch(i.label){case 0:r=[];return[4,e(jn({itemSetKey:n}))];case 1:o=i.sent();u=function(t){var n=e(Object(W.e)(function(e){return e.demandItemFacet(K.i,t)}))||"",i={DecodedUrl:decodeURIComponent(n)};i&&r.push(i)};for(a=0,f=Object.keys(t);a<f.length;a++){l=f[a];u(l)}s=JSON.stringify({itemPaths:r});c="RemoveItemsFromSharedWithMeViewByPath";h=Object(pe.n)({webAbsoluteUrl:o}).segment("SP.Sharing.DocumentSharingManager."+c);return[4,e(Object(ce.t)({url:h.toString(),qosName:"RemoveFromSharedList",method:"POST",webAbsoluteUrl:o,body:s,noRedirect:!0}))];case 2:if((p=i.sent())&&p.d&&p.d[c]&&p.d[c].results){if((d=p.d[c].results).length<1)throw new le.e({message:Dn.e.DefaultTitle});d.forEach(function(e){if(!e.Success&&-3!==e.ErrorCode)throw new le.e({message:e.ErrorMessage||void 0})})}(v=new q.e).invalidateItems({items:(m={},m[n]=[R.e],m)});e(v.execute());return[2]}})})}});function jn(e){var t=this,n=e.itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:"";t=e(Object(W.e)(function(e){return e.demandItemFacet(Pn.e,n)}));r=t&&t.driveItemKey.endpoint||"";return[4,e(Object(z.demandItems)(function(e){return e.demandItemFacet(c.e,B.e.serialize({tenantRootUrl:new Hn.e(r).authority}))}))];case 1:s=i.sent();return[2,s&&s.webAbsoluteUrl||""]}})})}}var Fn=n(3663),In=n(3373);n.d(t,"spDataOnlyAddonDeferred",function(){return qn});n.d(t,"spItemUploadItemsOperationHandler",function(){return Ln.spItemUploadItemsOperationHandler});n.d(t,"spItemCreateFolderOperationHandler",function(){return An.spItemCreateFolderOperationHandler});n.d(t,"spItemCreateDocumentOperationHandler",function(){return On.spItemCreateDocumentOperationHandler});n.d(t,"getSPFilterOptionSetHandler",function(){return Re.getSPFilterOptionSetHandler});var qn=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.o)(l.e,a.e)(Ie));e(Object(o.o)(c.e,E.t)(Xe));e(Object(o.o)(c.e,S.t)(Qe));e(Object(o.o)(c.e,x.t)(et));e(Object(o.o)(c.e,T.t)(tt));e(Fn.sharePointBasicActionsAddonDeferred);e(Object(o.o)(c.e,f.t)(it));e(Object(o.o)(h.e,w.e)(ot.n));e(Object(o.o)(c.e,N.e)(nn));e(Object(o.o)(p.e,L.t)(pt));e(Object(o.o)(p.e,A.t)(dt));e(Object(o.o)(p.e,O.t)(vt));e(Object(o.o)(p.e,C.t)(mt));e(Object(o.o)(p.e,k.t)(St));e(Object(o.o)(d.e,_.t)(Tt));e(Object(o.o)(d.e,Cn.t)(Nn));e(Object(o.o)(d.e,P)(Nt));e(Object(o.o)(d.e,tn.t)(dn));e(Object(o.o)(d.e,en.t)(kn));e(Object(o.o)(v.e,u.t)(Ot));e(Object(o.o)(m.e,a.e)(wt));e(Object(o.o)(p.e,a.e)(Dt));e(Object(o.o)(g.e,a.e)(Vt));e(Object(o.o)(y.e,a.e)($t));e(Object(o.o)(b.e,a.e)(Gt));e(Object(o.o)(d.e,Te.t)(Me));e(Object(o.o)(d.e,_e.t)(He));e(Object(M.r)(c.e,yn.e)(bn));e(Object(M.r)(c.e,wn.e)(xn));e(In.sharePointBasicItemDataAddonDeferred);e(Mn.e);e(H.e);e(we);e(xe);e(Object(M.r)(c.e,rn.e)(on));e(Object(o.o)(c.e,an.e)(fn));e(Object(M.r)(c.e,vn.e)(mn));e(Object(o.o)(c.e,_n.n)(Bn));return[2]})})}})},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(22),s=n(71),o=n(11),u=n(154),a=n(892),f=n(864),l=n(886),c=n(875),h=n(530),p=n(748),d=n(747),v=n(410),m=n(518),g=n(529),y=n(2051),b=n(1522),w=n(76),E=n(12),S=n(1961),x=n(42),T=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.folders,i=u.e.deserialize(t),s=i.endpoint,o=i.driveId,a=i.itemId,f=Object.keys(n)[0],l=n[f].progressItemKey,c=Object(y.n)(i);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,h,p,d,v,m,g,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:n=Object(y.t)(i)+"/children";h={name:f,folder:{},"@microsoft.graph.conflictBehavior":"rename"};o&&a&&(h.parentReference={driveId:o,id:a});return[4,e(Object(b.n)({url:n,driveUrl:c,method:"POST",body:h,qosName:"createFolder",endpoint:s}))];case 1:p=N.sent();d=u.e.serialize({endpoint:s,driveId:o,itemId:p.id});v=new x.e;l&&v.resolveItems({items:(m={},m[l]=Object(r.__assign)({},w.s.pack({itemKey:d})),m)});v.invalidateItems({items:(g={},g[t]=[E.t],g)});v.resolveItems({items:(T={},T[d]=Object(r.__assign)({},Object(S.e)({driveItem:p,parentFolderItemKey:t,endpoint:s})),T)});e(v.execute());return[2]}})})}}),N=n(208),C=n(6),k=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=u.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=Object(y.t)(n);return[4,e(Object(b.n)({url:i,method:"DELETE",qosName:"deleteItem",endpoint:n.endpoint}))];case 1:r.sent();e(Object(N.t)({items:(s={},s[t]=[C.f],s)}));return[2]}})})}}),L=n(337),A=n(248),O=n(88),M=n(1658),_=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.names,i=u.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var s,o,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:s=Object.keys(n)[0];o=n[s],u=o.newName,a=o.newExtension;f=Object(y.t)(i);l=Object(y.n)(i);c=e(Object(O.e)({fileName:C.h},t)).fileName;h="string"==typeof a?a:c&&c.extension||"";return[4,e(Object(b.n)({url:f,driveUrl:l,method:"PATCH",body:{name:""+u+h},qosName:"renameItem",endpoint:i.endpoint})).then(function(n){var i,s,o=new x.e;o.invalidateItems({items:(i={},i[t]=[C.l],i)});o.resolveItems({items:(s={},s[t]=Object(r.__assign)(Object(r.__assign)({},C.l.pack(n.name)),C.h.pack(Object(S.t)(n.name||"",!!n.folder))),s)});e(o.execute())}).catch(function(e){if(e instanceof M.e&&e.status===L.t)throw new L.e({facets:Object(r.__assign)({},A.h.pack({})),innerError:e});throw e})];case 1:p.sent();return[2]}})})}}),D=n(3464),P=n(3462),H=n(3460),B=n(3463),j=n(3461),F=n(2104),I=n(197),q=n(103),R=n(26),U=n(1932),z=n(50),W=n(2),X=n(14),V=n(167),$=Object(q.e)(function(){return new H.e({},{})}),J=Object(q.e)(function(e){var t=e(b.e).dataRequestor,n=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t,{performanceNow:j.t})||this}return t})(j.e),i=new P.e({},{dataRequestor:t}),s=new B.e({},{activityBandwidthVerifierType:n,uploadService:i});return new D.e({},{uploadService:i,uploadStateMachine:s})}),K=0;function Q(e){var t=this,n=e.itemKey,i=e.options.sourceEntries,s=u.e.deserialize(n),o=s.endpoint,a=s.driveId,f=Object.keys(i)[0],l=i[f],c=l.progressItemKey,h=l.conflictResolution,p=void 0===h?"fail":h;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,h,d,v,m,g,b,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:if(!(t=e(Object(O.e)({sourceFile:U.t},f)).sourceFile))throw new Error("No source file for Graph upload.");i=Object(y.t)(s)+":";l=Object(y.n)(s);c&&e(Object(z.e)({items:(m={},m[c]=Object(r.__assign)({},w.m.pack({total:t.size,current:0})),m)}));return[4,e(G({progressItemKey:c,sourceFile:t,itemUrl:i,driveUrl:l,conflictResolution:p,endpoint:o}))];case 1:h=N.sent();d=u.e.serialize({endpoint:o,driveId:a,itemId:h.id});v=new x.e;c&&v.resolveItems({items:(g={},g[c]=Object(r.__assign)(Object(r.__assign)({},w.s.pack({itemKey:d})),Object(W.n)({progressSize:w.m},{progressSize:{current:t.size}})),g)});v.invalidateItems({items:(b={},b[n]=[E.t],b)});v.resolveItems({items:(T={},T[d]=Object(r.__assign)({},Object(S.e)({driveItem:h,parentFolderItemKey:n,endpoint:o})),T)});return[2,{itemResolver:v,driveItem:h,itemKey:d}]}})})}}function G(e){var t=this,n=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.driveUrl,u=e.endpoint,a=(function(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}})(e.conflictResolution);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,l,h,p,d,v,m,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:t=e(J);f=e($);return[4,e(Object(F.e)(u,o))];case 1:l=b.sent();h=new I.e;p=0;d=h.debounce(function(t){var r;if(t>p){n&&e(Object(z.e)({items:(r={},r[n]=Object(W.n)({progressSize:w.m},{progressSize:{current:t}}),r)}));p=t}},300,{leading:!1});v=e(Object(R.e)(function(e){return e.demandItemFacet(w.i,n)}));m=t.upload({conflictBehavior:a,qosData:{uploadId:""+ ++K},accessToken:l,fileName:i.name,content:i,itemUrl:s,onProgress:d,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return f.wait(e)},select:"*,sharepointIds"});g=v?v.token.subscribe(function(){m.cancel()}):void 0;b.label=2;case 2:b.trys.push([2,4,5,6]);return[4,m];case 3:return[2,b.sent()];case 4:y=b.sent();if(X.n.isCanceled(y))throw new V.e;throw new c.e({facets:Object(r.__assign)({},Object(M.t)(y,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return A.e.pack({});case"nameAlreadyExists":case 409:return A.n.pack({supportsRename:!0})}})||Object(W.n)({},{})),innerError:y});case 5:g&&g();h.dispose();return[7];case 6:return[2]}})})}}var Y=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n(Q(e))];case 1:t=r.sent().itemResolver;n(t.execute());return[2]}})})}});var Z=n(2095),ee=n(2629),te=n(2628),ne=n(64),re=n(183),ie=(new ne.e("addToOneDrive",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.e}))}),new ne.e("canCreateFolder",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.t}))})),se=(new ne.e("canCreateLink",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.n}))}),new ne.e("canDelete",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.r}))})),oe=new ne.e("canDownload",function(e,t){return!e.demandItemFacet(re.n,t.itemKey)&&fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.i}))}),ue=(new ne.e("canInvite",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.s}))}),new ne.e("canMove",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.o}))}),new ne.e("canUseOfficeLens",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.u}))}),new ne.e("canRename",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.a}))})),ae=new ne.e("canUpload",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.f}))});function fe(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(u.e,n);if(!i)return!1;var s=i.endpoint,o=i.driveId,a=e.demandItemFacet(r,te.e.serialize({endpoint:s,driveId:o}));return!!a&&!!a.roles&&(function(e,t){var n=t.itemKey,r=t.oneOfRequiredRoles,i=(function(e,t){if((function(e,t){var n=e.demandItemFacet(Z.e,t);return!n||!n.effectiveRoles||!n.owner})(e,t))return["read","write","owner"];var n=e.demandItemFacet(Z.e,t);if(n&&n.effectiveRoles)return n.effectiveRoles;return[]})(e,n);return(function(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1})(0,{oneOfRequiredRoles:r,effectiveRoles:i})})(e,{itemKey:n,oneOfRequiredRoles:a.roles})}var le=Object(o.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ie,n)}}}});var ce=n(2451),he=Object(o.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ue,n),validator:ce.e}}}});var pe=Object(o.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(se,n)}}}});var de=Object(o.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ae,n)}}}});var ve=Object(o.t)()(function(){return function(e){return me}});function me(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(C.d,n))return{};var i=e.demandItemFacet(u.e,n),s=i?Object(y.t)(i):void 0,o=i?Object(y.n)(i):void 0,a=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(oe,n),getDownloadData:s&&o?function(){return(function(e){var t=this,n=e.itemUrl,i=e.driveUrl,s=e.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,o(Object(b.n)({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:s}))];case 1:t=r.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((a=r.sent())instanceof M.e){f=Object(M.t)(a,function(e,t){switch(e){case"unauthenticated":case 401:return A.t.pack({});case"itemNotFound":case 404:return A.s.pack({});case"accessDenied":case 403:return A.e.pack({});default:return A.h.pack({})}});throw new L.e({innerError:a,facets:f})}throw a;case 3:return[2]}})})}})({itemUrl:s,driveUrl:o,endpoint:a})}:void 0}}var ge=Object(o.t)()(function(){return function(e){return ye}});function ye(e,t){var n=t.itemKey,i=e.demandItemFacet(u.e,n);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=e.driveItem))return[3,2];i=Object(y.t)(t)+"/invite";s=Object(y.n)(t);return[4,n(Object(b.r)({url:i,driveUrl:s,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:i})}}}var be=Object(o.t)()(function(){return function(){return function(){return{}}}});var we=Object(o.t)()(function(){return function(e){return Ee}});function Ee(e,t){var n=t.itemKey,i=t.link,s=t.recipients,o=e.demandItemFacet(u.e,n);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.driveItem,i=e.link,s=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");o=t.endpoint;a=btoa(i);u="u!"+a.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");f=s.map(function(e){return{email:e}});l={recipients:f,roles:["read"]};c=o.replace("v1.0","beta");h=c+"/shares/"+u+"/permission/grant";return[4,n(Object(b.r)({url:h,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:p=r.sent();d=p.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:d}]}})})}})({driveItem:o,link:i,recipients:s})}}}var Se=n(2981),xe=n(2983),Te=n(365),Ne=n(161),Ce=n(57),ke=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,i=n.isFollowed,s=n.progressItemKey,o=Te.e.deserialize(t),a=o.driveItemKey,f=a.itemId,l=void 0===f?"":f,c=Object(y.n)(a);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,f,h,p,d,v,m,g;return Object(r.__generator)(this,function(y){switch(y.label){case 0:t=e(Object(Ce.e)({saveForLaterGraphEndpoint:Ne.d})).saveForLaterGraphEndpoint;n=new x.e;f=Te.e.serialize(o);h=t||a.endpoint;s&&e(Object(z.e)({items:(v={},v[s]=Object(r.__assign)({},w.g.pack({itemKey:u.e.serialize(a)})),v)}));p=i?{url:h+"/drives/"+a.driveId+"/items/"+l+"/follow",method:"POST",qosName:"followItem"}:{url:h+"/drives/"+a.driveId+"/following/"+l,method:"DELETE",qosName:"unfollowItem"};y.label=1;case 1:y.trys.push([1,3,,4]);return[4,e(Object(b.n)({url:p.url,driveUrl:c,method:p.method,qosName:p.qosName,endpoint:h}))];case 2:y.sent();n.invalidateItems({items:(m={},m[f]=[C.b],m)});n.resolveItems({items:(g={},g[f]=Object(r.__assign)({},C.b.pack(i||void 0)),g)});e(n.execute());return[3,4];case 3:d=y.sent();throw new Error(d.message);case 4:return[2]}})})}}),Le=n(429),Ae=n(788),Oe=n(1837),Me=n(2286);function _e(e,t){return Me.e.serialize(Object(r.__assign)({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var De=Object(o.t)()(He),Pe=Object(o.t)()(He);function He(){return function(e){return function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(Oe.e,r);if(i)n=function(e){return i?_e(i,e):void 0};else{var s=e.demandItemFacet(Me.e,r);n=function(e){return s?_e(s,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}var Be=n(590),je=n(878),Fe=n(328),Ie=Object(o.t)()(function(){return function(e){return qe}});function qe(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(Oe.e,i),o=e.demandItemFacet(Me.e,i);if(n&&(s||o)){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a];if(l.key===Fe.o.key)u.push("photo");else if(l.key===Fe.u.key)u.push("video");else if(l.key===Fe.e.key)u.push("folder");else if(l.key===Fe.s.key)u.push("onenote");else if(l.key===Fe.r.key)u.push("!photo");else if(l.key===Fe.i.key)u.push("!video");else if(l.key===Fe.t.key)u.push("!folder");else if(l.key===Fe.n.key)u.push("!onenote");else{var c=Object(je.e)(l);c&&u.push(c)}}if(s)return{itemKey:Oe.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{extFilters:u}))}}return{}}var Re=n(2433),Ue=n(1615),ze=n(2448),We=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,i=Object.keys(n)[0];return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var s,o,a,f,l,c,h,p,d,v,m,g,w,S;return Object(r.__generator)(this,function(T){switch(T.label){case 0:if(!e(Object(R.e)(function(e){return e.demandItemFacet(u.e,i)})))throw new Error("Source item does not have a driveItem key");s=n[i],o=s.isMove,a=s.conflictBehavior,f=s.progressItemKey;l=u.e.deserialize(t);return[4,e(Object(Ue.demandItems)(function(e){return e.demandItemFacet(u.e,i)}))];case 1:if(!(c=T.sent()))throw new Error("Unable to get metadata for destination item.");h=Object(y.t)(c);p=Object(y.n)(c);d=c.endpoint;T.label=2;case 2:T.trys.push([2,4,,5]);return[4,e(Object(b.n)({url:h+(o?"":"/copy"),driveUrl:p,method:o?"PATCH":"POST",body:{parentReference:{id:l.itemId||ze.n,driveId:l.driveId||""},"@microsoft.graph.conflictBehavior":a},qosName:o?"moveItem":"copyItem",endpoint:d}))];case 3:v=T.sent();(m=new x.e).invalidateItems({items:(w={},w[i]=o?[C.A,C.f]:[],w[t]=[E.t],w)});f&&!o&&v.name&&m.resolveItems({items:(S={},S[f]=Object(r.__assign)({},C.l.pack(v.name)),S)});e(m.execute());return[3,5];case 4:if((g=T.sent())instanceof M.e&&g.status===L.t)throw new Re.e({innerError:g,facets:Object(r.__assign)({},A.u.pack(g.status))});throw g;case 5:return[2]}})})}}),Xe=n(916),Ve=Object(o.t)()(function(){return function(){return function(e,t){return{validator:ce.e}}}});var $e=n(78),Je=n(148),Ke=n(596),Qe=n(165),Ge=n(2967),Ye=n(120),Ze=n(601),et=n(2632),tt=n(299),nt=n(3005),rt=Object(i.i)()(function(e){var t=e.itemKey,n=e.options.itemSetKey;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!tt.e.matches(n))throw new L.e({code:"invalidItemSetForAddToOneDrive"});i=tt.e.deserialize(n).driveItemKey.endpoint;s=e(Object(R.e)(function(e){return e.demandItemFacet(C.h,t)}));o=e(Object(R.e)(function(e){return e.demandItemFacet(et.e,t)}));a=e(Object(R.e)(function(e){return e.demandItemFacet(u.e,t)}));if(!(i&&s&&a&&o))throw new L.e({code:"missingItemInfoForAddToOneDrive"});return[4,e(Object(nt.n)("GetDriveInfo",i))];case 1:f=r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,e(Object(nt.t)(s.name,f.id,o,"AddToOneDrive_SWM",i))];case 3:r.sent();return[3,5];case 4:if(!((l=r.sent())instanceof M.e))throw l;Object(nt.e)(l);return[3,5];case 5:return[2]}})})}});n.d(t,"graphAddonDataOnlyDeferred",function(){return st});var it=Object(Je.e)(function(){return Promise.resolve().then(n.bind(null,3863))},{chunkName:"addon-graph-deferredoperations"}),st=Object(i.t)(function(){return function(e){var t=e(Object(Ce.e)({useBatchedDeleteConfiguration:Ne.g})).useBatchedDeleteConfiguration;e(Object(Ye.e)(function(){e(Object(o.r)(Oe.e,Ae.e)(De));e(Object(o.r)(Me.e,Ae.e)(Pe));e(Object(o.r)(Oe.e,Be.e)(Ie));e(Object(s.o)(u.e,a.t)(T));e(t?Object(s.o)(u.e,f.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object($e.o)())];case 1:t.sent();return[4,it()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(s.o)(u.e,f.t)(k));e(Object(s.o)(u.e,l.t)(_));e(Object(s.o)(u.e,c.t)(Y));e(Object(s.o)(u.e,Re.t)(We));e(Object(s.o)(u.e,Ze.t)(rt));e(Object(o.r)(u.e,h.e)(le));e(Object(o.r)(u.e,Xe.e)(Ve));e(Object(o.r)(u.e,p.e)(he));e(Object(o.r)(u.e,d.e)(pe));e(Object(o.r)(u.e,v.e)(de));e(Object(o.r)(u.e,Se.e)(ge));e(Object(o.r)(u.e,xe.e)(we));e(Object(o.r)(u.e,m.e)(ve));e(Object(o.r)(u.e,g.e)(be));e(Object(s.o)(Te.e,Le.e)(ke));e(Object(s.o)(Ke.e,Qe.e)(Ge.e))}))}})},,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1),s=n(3270),o=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){t.props.resolve()};return t}t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,r=e.launchBehaviorType;if(n&&void 0!==r){if("dialog"===r)return i.createElement(s.e,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===r?window.open(n,"_self"):window.open(n,"_blank")}this.props.resolve();return null};return t})(i.PureComponent),u=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.targetUrl;e&&window.open(e,"_blank");this.props.resolve();return null};return t})(i.PureComponent),a=n(897),f=n(919),l=n(8),c=n(30),h=n(48),p=n(79),d=n(390),v=n(111),m=n(3),g=n(418),y=n(6),b=n(2643),w=n(58),E={ODB:670},S=Object(l.t)(function(e,t){var n=t.itemKey,i=e.demandItem({key:p.e,itemUrl:y.j},n),s=i.key,o=i.itemUrl,u="",a="",f="",l=!1,c=!1;if(s&&o){var S=e.demandItemFacet(m.Mt,d.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}));Object(w.e)(e,{feature:E,pageContext:S})&&(c=!0);var x=v.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}),T=e.demandItem({driveUrl:m.b},x).driveUrl;if(T){var N=Object(g.e)(T);if(N){u=N.driveId||"";var C=e.demandItemFacet(y.h,n);if(C){f=C.name;(N=Object(g.e)(o))&&(l=!!(a=N.itemId||""))}}}}var k,L=s?Object(b.e)("spo:"+s.webAbsoluteUrl):void 0;if(c){var A=e.demandItemFacet(y.i,n)||"";k="https://www.office.com/launch/fluid/content?drive="+u+"&item="+a+"&file="+encodeURIComponent(A)}else k="https://fluidpreview.office.net/p/"+L+"/"+u+"/"+a+"/"+encodeURIComponent(f);return Object(r.__assign)({isAvailable:l,onExecute:l?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){window.open(k);return[2]})})}:void 0},Object(h.e)(e,{itemKey:n,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(c.e),x=n(2459),T=n(1029),N=n(2640),C=Object(l.t)(function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey,s=!1,o=i&&v.e.serialize(i);if(i&&n){var u=e.demandItemFacet(m.we,o);s=!(!(u&&u.permissions&&u.permissions.manageLists&&n&&n.id)||n.isPersonal||n.isDefault)}return Object(r.__assign)({isAvailable:s},Object(h.e)(e,{itemKey:o,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey;return{onExecute:n?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(r){e(Object(N.e)({items:(t={},t[T.e.serialize(i)]={views:(s={},s[n.id]={isDefault:!0},s)},t)}));return[2]})})}:void 0}})(c.e),k=n(80),L=n(75),A=n(2975),O=n(167),M=n(2452),_=n(2461),D=n(25),P=n(163),H=n(88),B=n(587),j=n(178),F=n(108),I=n(265),q=n(109),R=n(63),U=n(12),z=n(1663),W=n(605),X=n(42),V=n(208),$=n(15),J=n(469),K=$.e.isActivated("93C218F9-D649-4531-939E-C60EAEA4509C","06/08/2020","Use switchViewAction after save existing view"),Q=new P.e("saveViewProgressBatch"),G=Object(F.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("303")]).then(n.bind(null,3822))];case 1:return[2,e.sent().SaveViewDialog]}})})});function Y(){return Q.serializeNext()}var Z=Object(B.e)()(x.t);function ee(e){var t=this,n=e.viewTitle,s=e.isPublicView,o=e.onViewSaved,u=e.currentViewKey,a=e.itemSetKey,f=e.itemsScopeItemKey,l=e.listViewSetKey,c=e.reject,h=e.resolve,p=i.useState(!0),d=p[0],v=p[1],g=i.useState(Y)[0],y=i.useState(),b=y[0],w=y[1],E=i.useState(),S=E[0],x=E[1],T=Object(q.t)(),N=Object(I.e)(function(){x(!0);o&&o();h()}),C=Object(I.e)(function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,n,i,s,p,d,y,b,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:t=e.viewTitle,n=e.isPublicView;i=T(Object(H.e)({currentDerivedView:m.p},u)).currentDerivedView;s=i&&i.title!==t;p=T(Object(H.e)({deserializedSetKey:k.e},a)).deserializedSetKey;return s&&p&&i?[4,T(Object(M.t)({webAbsoluteUrl:p.webAbsoluteUrl,listFullUrl:p.listFullUrl}))]:[3,3];case 1:if(S.sent().some(function(e){return e.serverView.Title===t}))throw new Error(D.format(_.e.SaveViewErrorCannotOverwrite,t));return[4,T(Object(A.e)({items:(b={},b[l]={views:(E={},E[t]={itemSetKey:a,isPublic:n,sourceView:i,progressItemKey:g},E)},b)}))];case 2:S.sent();if(d=T(Object(H.e)({createdViewKey:j.e},g)).createdViewKey){w(d.viewId);v(!1)}return[3,5];case 3:if(!f){c(new Error("Cannot save a view without a current ItemsScope"));return[2]}return[4,T((x={itemsScopeItemKey:f,listViewSetKey:l,itemSetKey:a,currentViewKey:u},function(e){var t,n,i=x.itemsScopeItemKey,s=x.listViewSetKey,o=x.itemSetKey,u=x.currentViewKey,a=e(Object(H.e)({childItems:U.e,parentItem:U.i,deserializedItemSetKey:k.e},o)),f=a.childItems,l=a.parentItem,c=a.deserializedItemSetKey;return e(Object(z.e)({items:(t={},t[s]={views:(n={},n[u]={itemSetKey:o},n)},t)})).then(function(){var t,n;if(c){var s=k.e.serialize(Object(r.__assign)(Object(r.__assign)({},c),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),o=e(Object(H.e)({filterOptionSets:U.n},s)).filterOptionSets;if(o&&c.filterParams){var a={};for(var h in o)o.hasOwnProperty(h)&&(a[o[h]]=!0);e(Object(W.e)({items:a}))}var p=new X.e;p.resolveItems({items:(t={},t[s]=Object(r.__assign)(Object(r.__assign)({},f?U.e.pack(f):{}),l?U.i.pack(l):{}),t[u]=Object(r.__assign)({},m.st.pack(!1)),t)});e(p.execute());e(Object(V.t)({items:(n={},n[u]=[m.it,m.p],n[s]=[U.e],n)}));K&&e(Object(J.e)({itemsScopeItemKey:i,currentItemKey:s}))}})}))];case 4:S.sent();if(K){o&&o();h()}else if(y=T(Object(H.e)({savedViewKey:j.e},u)).savedViewKey){w(y.viewId);v(!1)}S.label=5;case 5:return[2]}var x})})}),L=Object(I.e)(function(){c(new O.e)});return d?i.createElement(G,{viewTitle:n,isPublicView:s,onContinue:C,onCancel:L}):!S&&b?i.createElement(Z,{viewId:b,currentDerivedView:void 0,onComplete:N,itemSetKey:a}):null}var te=Object(l.i)(function(e,t){var n=Object(R.e)(e).itemsScopeItemKey;return i.createElement(ee,Object(r.__assign)({},t,{itemsScopeItemKey:n}))});var ne=n(2460),re=n(24),ie=n(510),se=Object(l.i)(function(e,t){var n=t.currentViewKey,s=Object(L.e)(e),o=Object(R.e)(e).itemsScopeItemKey,u=!1,a=e.demandItemFacet(k.e,s),f=e.demandItemFacet(m.p,n),l=e.demandItemFacet(ne.e,s),p=ne.e.evaluate(l)(e,{viewKey:n}).onViewSaved;if(a&&f){var d=v.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}),g=e.demandItemFacet(m.we,d);u=!!(g&&f&&"POWER"!==f.viewType&&g.permissions&&(g.permissions.managePersonalViews||g.permissions.manageLists))}if(!f||!s||!o)return null;var y=Object(re.o)(function(e){return i.createElement(ie.e,{itemsScopeItemKey:o},i.createElement(te,Object(r.__assign)({},e,t,{itemSetKey:s,viewTitle:f.title,isPublicView:!f.isPersonal,onViewSaved:p})))},{scope:"global"});return i.createElement(c.e,Object(r.__assign)({isAvailable:u,onExecute:y},Object(h.e)(e,{itemKey:s,engagement:{name:"SaveView",isIntentional:!0}})))}),oe=n(2877),ue=n(2601),ae=n(50),fe=n(363),le=new(n(9).e)("groupByActionControl"),ce=n(23),he=n(51),pe={ODB:1352},de=Object(l.i)(function(e,t){var n=t.groupByFieldKey,s=t.itemSetKey,o=e.demandItemFacet(k.e,s);if(!o)return i.createElement(re.n,null);var u=v.e.serialize(o),a=e.demandItemFacet(m.we,u),f=a&&a.templateType===ce.n.mySiteDocumentLibrary,g=Object(he.e)(e,{enableGroupByInOneDrive:m.C}).enableGroupByInOneDrive,y=o.groupByFieldKey===n,b=k.e.serialize(Object(r.__assign)(Object(r.__assign)({},o),{groupByFieldKey:y?void 0:n})),E=p.e.serialize(o),S=o.viewKey&&j.e.serialize(o.viewKey),x=e.demandItemFacet(le,s),T=le.evaluate(x)(e,{itemSetKey:s,viewKey:S,groupedItemSetKey:b,isAvailable:!f||!!g}),N=T.isAvailable,C=T.onGroupBy,L=e.demandItemFacet(m.Mt,d.e.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl})),A=Object(w.e)(e,{feature:pe,pageContext:L}),O=Object(h.e)(e,{itemKey:s,engagement:{name:"GroupBy",isIntentional:!0}}),M=e.dispatch,_=Object(l.s)(e,i.createElement(fe.e,{itemKey:b}));return i.createElement(re.n,{action:_},function(e){var t=e.isAvailable,n=e.execute;return i.createElement(c.e,Object(r.__assign)({isAvailable:t&&N,isToggled:y,onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){switch(u.label){case 0:if(A&&C){t=k.e.deserialize(b);i=t&&t.groupByFieldKey;M(C({groupByFieldKey:i}))}M(Object(ae.e)({items:Object(r.__assign)((s={},s[b]=Object(r.__assign)({},U.i.pack({itemKey:E})),s),S?(o={},o[S]=Object(r.__assign)({},m.st.pack(!0)),o):{})}));return[4,n(e)];case 1:u.sent();return[2]}})})}},O))})}),ve=n(741),me=n(3688),ge={ODB:1318},ye=!1,be=Object(l.t)(function(e,t){var n=t.itemSetKey,i=t.modifyType,s=t.columnKey,o=!1,u=e.demandItem({setKey:k.e,canModifySchema:m.u},n),a=u.setKey,f=u.canModifySchema,l=a&&a.viewKey?j.e.serialize(a.viewKey):void 0,c=e.demandItem({currentDerivedView:m.p},l).currentDerivedView,p=e.demandItemFacet(m.ue,s);if(a&&f&&c&&c.baseViewXml&&p)if(1===i||2===i){var g=c.getEffectiveFieldNames();if(g&&g.length){var y=g.indexOf(p),b=a.groupByFieldKey?1:0;o=1===i?y>b+1:y>=b&&y<g.length-1}}else o=!0;if(a){var E=e.demandItemFacet(m.Mt,d.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl})),S=e.demandItemFacet(m.we,v.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}));ye=Object(w.e)(e,{feature:ge,pageContext:E})&&!!(S&&S.permissions&&S.permissions.manageLists)}return Object(r.__assign)({isAvailable:o},Object(h.e)(e,{itemKey:n,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var n=t.itemSetKey,i=t.modifyType,s=t.columnKey,o=ye?me.modifyColumnWithProgress:ve.e;return{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,u;return Object(r.__generator)(this,function(r){e(o({items:(t={},t[n]={columnModifyTypeMap:(u={},u[s]={modifyType:i},u)},t)}));return[2]})})}}})(c.e),we=n(2979),Ee=n(424),Se=Object(l.t)(function(e,t){var n=t.itemSetKey,i=t.columnKey,s=t.aggregateType,o=e.demandItemFacet(m.a,n),u=o&&o[i]&&o[i].aggregateFunctionType||Ee.e[0],a=u===Ee.e[s]?void 0:Ee.e[s];return Object(r.__assign)({isAvailable:!0,isToggled:u===Ee.e[s]},a?Object(h.e)(e,{itemKey:n,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:a||"AggregateTypeNone",extraData:{PreviousAggregateType:u||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var n=t.itemSetKey,i=t.columnKey,s=t.aggregateType;return{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){e(Object(we.e)({items:(t={},t[n]={aggregateType:s,columnKey:i},t)}));return[2]})})}}})(c.e),xe=n(2646),Te=n(2647);n.d(t,"OpenAsHyperLinkExecutor",function(){return o});n.d(t,"OpenAsShortcutExecutor",function(){return u});n.d(t,"NewItemInOfficeClientAction",function(){return a.t});n.d(t,"ItemOpenInOfficeClientAction",function(){return a.e});n.d(t,"OpenInOfficeClientAction",function(){return a.n});n.d(t,"ItemOpenInOfficeOnlineAction",function(){return f.e});n.d(t,"OpenInOfficeOnlineAction",function(){return f.t});n.d(t,"OpenInBFileAction",function(){return S});n.d(t,"ItemSwitchViewAction",function(){return x.e});n.d(t,"SwitchViewAction",function(){return x.t});n.d(t,"SetDefaultViewAction",function(){return C});n.d(t,"SaveViewAction",function(){return se});n.d(t,"LaunchFilterPanelAction",function(){return oe.e});n.d(t,"SortAction",function(){return ue.e});n.d(t,"GroupByAction",function(){return de});n.d(t,"ModifyColumnAction",function(){return be});n.d(t,"ModifyColumnAggregateTypeAction",function(){return Se});n.d(t,"ApproveRejectAction",function(){return xe.e});n.d(t,"ItemFileHandlerOpenAction",function(){return Te.t});n.d(t,"FileHandlerOpenAction",function(){return Te.e})},,,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(22),i=n(71),s=n(11),o=n(769),u=n(79),a=n(864),f=n(0),l=Object(r.n)()(function(e){return function(t){return Object(f.__awaiter)(void 0,void 0,void 0,function(){return Object(f.__generator)(this,function(r){switch(r.label){case 0:return[4,n.e("306").then(n.bind(null,3799))];case 1:return[4,(0,r.sent().deleteItemsCore)(t,e)];case 2:r.sent();return[2]}})})}}),c=n(886),h=Object(r.i)({mergeForSameItemKey:!1})(function(e){return function(t){return Object(f.__awaiter)(void 0,void 0,void 0,function(){return Object(f.__generator)(this,function(r){switch(r.label){case 0:return[4,n.e("551").then(n.bind(null,3800))];case 1:return[4,(0,r.sent().renameItemCore)(t,e)];case 2:r.sent();return[2]}})})}}),p=n(748),d=n(390),v=n(111),m=n(3),g=n(53),y=n(3371),b=n(6),w=n(2451),E=Object(s.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItem({key:u.e,permissions:m.ze,isCheckedOut:b.y,isFolder:b.d,rowData:m.rt},n),i=r.key,s=r.permissions,o=r.isCheckedOut,a=r.isFolder,l=r.rowData,c=i&&e.demandItemFacet(m.Mt,d.e.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})),h=void 0,p=!1,E=w.e;if(c){h=l&&o&&!!o.byOther;p=!(e.demandItemFacet(m.Oe,n,{suppressGetItems:!0})||c.isAnonymousGuestUser)&&g.e.hasItemPermission({permissions:s},g.e.deleteListItems)&&g.e.hasItemPermission({permissions:s},g.e.editListItems);c.supportPercentStorePath&&c.supportPoundStorePath||(E=w.t)}var S={},x=i&&e.demandItemFacet(m.we,v.e.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl}));if(h){S.lockedWarningMessage=y.e.FileCheckedoutOrLockedWarning;S.title=y.e.FileCheckedoutOrLockedWarningTitle}else if(x&&x.isForceCheckout&&o&&!o.byYou&&!a){S.lockedWarningMessage=y.e.CheckoutRequired;S.title=y.e.Error}return Object(f.__assign)({isAvailable:p,validator:E,isFolder:!!a},S)}}});var S=n(518),x=n(1),T=n(227),N=n(915),C=n(23),k=n(2974),L=n(93),A=n(790),O=n(1282),M=n(368),_=n(183),D=n(51),P=n(317),H=n(298),B=n(102);function j(e){var t=e.defaultRender,n=Object(f.__rest)(e,["defaultRender"]);return t?x.createElement(t,Object(f.__assign)({},n,{preferOpenInBrowser:!0})):null}function F(e){var t=e.defaultRender,n=Object(f.__rest)(e,["defaultRender"]);return t?x.createElement(t,Object(f.__assign)({},n,{preferSameWindow:!0})):null}var I=Object(s.t)()(function(){return function(e){var t=new B.e;return function(e,n){var r=n.itemKeys,i=r[0],s=e.demandItemFacet(b.d,i),o=e.demandItemFacet(_.n,i);return 1!==r.length||s||o?r.length>0?(function(e,t){var n=t.itemKeys,r=e.demandItemFacet(u.e,n[0]);if(!r||!r.webAbsoluteUrl||!r.listFullUrl)return{};var i=r.webAbsoluteUrl,s=r.listFullUrl,o=v.e.serialize({webAbsoluteUrl:i,listFullUrl:s}),a=e.demandItem({listFacets:m.we,downloadZipApiUrl:A.e},o),l=a.listFacets,c=a.downloadZipApiUrl;if(!l||!c||l.templateType===C.t.webPageLibrary)return{};for(var h=[],p=Object(D.e)(e,{enableOAuthTokenInDownload:m.P}).enableOAuthTokenInDownload,d=void 0!==p&&p,y=!1,w=0,E=n;w<E.length;w++){var S=E[w],x=e.demandItem({name:b.l,size:b.p,itemUrl:b.j,folder:b.d,permissions:m.ze,itemComplianceStatus:M.e,isOneNote:_.n},S),k=x.name,O=x.size,H=x.itemUrl,B=x.folder,j=x.permissions,F=x.itemComplianceStatus;if(x.isOneNote)return{isAvailable:!1};var I=void 0,R=void 0,U=e.demandItemFacet(m.Oe,S,{suppressGetItems:!0});if(U){I=void 0;R=new P.e(U.siteUrl).authority+"/_api/v2.1/drives/"+U.driveId+"/items/"+U.itemId;y=!0}else{if(!H)return{};I=e.demandItemFacet(A.t,o);R=Object(N.n)(H,(I?I.accessToken:void 0)||"")}if(R){var z=!!B;3!==F&&4!==F&&g.e.hasItemPermission({permissions:j},g.e.openItems)&&h.push({name:k||"",size:O||0,docId:R,isFolder:z})}}if(0===h.length)return{};return{isAvailable:!0,getDownloadData:function(){return(function(e){var t=this,n=e.zipApiUrl,r=e.itemsData,i=e.useOAuthToken;return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(f.__generator)(this,function(u){switch(u.label){case 0:t=void 0;return i?[4,e(Object(T.e)({url:new P.e(n).authority}))]:[3,2];case 1:t=u.sent();u.label=2;case 2:s=r&&1===r.length?r[0].name+".zip":"OneDrive_"+ ++q+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";o=L.e.generate();return[2,{url:n,method:"POST",postData:{zipFileName:s,guid:o,provider:"spo",files:JSON.stringify({items:r}),oAuthToken:t||""}}]}})})}})({zipApiUrl:c,itemsData:h,useOAuthToken:d||y})}}})(e,{itemKeys:r}):{}:(function(e,t){var n=t.itemKey,r=t.platformDetection,i=e.demandItem({spItem:u.e,permissions:m.ze,folderPath:m.G,uniqueId:m.Ut,itemComplianceStatus:M.e,isBFile:m.ae},t.itemKey),s=i.spItem,o=i.permissions,a=i.folderPath,l=i.uniqueId,c=i.itemComplianceStatus,h=i.isBFile,p=e.demandItemFacet(b.N,t.itemKey),y=s&&d.e.serialize(s),w=e.demandItemFacet(m.Mt,y);if(!w||!s||h)return{};var E=s.webAbsoluteUrl,S=s.listFullUrl,x=v.e.serialize(s),N=e.demandItemFacet(m.we,x);if(N&&N.templateType===C.t.webPageLibrary)return{};if(3===c||4===c||!g.e.hasItemPermission({permissions:o},g.e.openItems))return{};var L=Object(D.e)(e,{spCookieDomainConfiguration:m.lt,enableMalwareDownloadInNewWindow:m.A}),A=L.spCookieDomainConfiguration,_=L.enableMalwareDownloadInNewWindow;if(p){if(!w.allowInfectedDownload)return{};var B=e.demandItemFacet(b.i,n);return B?_?{isAvailable:!0,downloader:j,getDownloadData:function(){return R({canconicalUrl:B})}}:A?new P.e(A).authority!==new P.e(B).authority?{}:Object(f.__assign)(Object(f.__assign)({isAvailable:!0},r.isIE?{downloader:F}:{}),{getDownloadData:function(){return R({canconicalUrl:B})}}):{}:{}}if(!a)return{};var I=w.layoutsUrl;if(!I)return{};return Object(f.__assign)(Object(f.__assign)({isAvailable:!0},r.isIE?{downloader:F}:{}),{getDownloadData:function(){return A&&l?(function(e){var t=this,n=e.webAbsoluteUrl,r=e.layoutsUrl,i=e.uniqueId;return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){return Object(f.__generator)(this,function(e){return[2,{url:n+"/"+r+"/download.aspx?"+Object(H.e)({UniqueId:i}),method:"GET"}]})})}})({webAbsoluteUrl:E,uniqueId:l,layoutsUrl:I}):(function(e){var t=this,n=e.webAbsoluteUrl,r=e.listFullUrl,i=e.folderPath;return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,l;return Object(f.__generator)(this,function(f){switch(f.label){case 0:t=e(Object(T.n)({webAbsoluteUrl:n,listFullUrl:r})),s=t.dataRequestor,o=t.hasDigest;if(!t.hasTokenProvider)return[3,1];a=void 0;return[3,3];case 1:return[4,e(Object(T.e)({url:n||r,disallowCookies:!o}))];case 2:a=f.sent();f.label=3;case 3:u=a;l=Object(O.r)({webAbsoluteUrl:n,listOrItemFullUrl:r});return[4,Object(k.e)({dataRequestor:s,authToken:u,serverRelativeItemUrl:i,webApiUrl:l})];case 4:return[2,{url:f.sent(),method:"GET"}]}})})}})({webAbsoluteUrl:E,listFullUrl:S,folderPath:a,layoutsUrl:I})}})})(e,{itemKey:i,platformDetection:t})}}});var q=0;function R(e){var t=this;return function(n){return Object(f.__awaiter)(t,void 0,void 0,function(){var t;return Object(f.__generator)(this,function(n){(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1");return[2,{url:t,method:"GET"}]})})}}var U=n(747),z=n(25),W=n(8),X=n(3372),V=Object(s.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.isBatchDelete,i=e.demandItemFacet(m.Oe,n,{suppressGetItems:!0}),s=e.demandItemFacet(m.ze,n,{suppressGetItems:!0}),o=g.e.hasItemPermission({permissions:s},g.e.deleteListItems);if(o&&i){o=!!Object(D.e)(e,{enableDeleteCommandForMountPointConfiguration:m.S}).enableDeleteCommandForMountPointConfiguration&&r}return{isAvailable:o,deleteWizard:$}}}});var $=Object(W.i)(function(e,t){var n,r,i,s,o,u=t.itemKeys,a=t.defaultRender,l=Object(f.__rest)(t,["itemKeys","defaultRender"]),c=void 0,h=Object(D.e)(e,{enableDeleteCommandForMountPointConfiguration:m.S}).enableDeleteCommandForMountPointConfiguration;if(1===u.length){var p=e.demandItemFacet(m.Me,u[0]);if(p){var d=p&&Object(z.formatToArray)(Object(z.getLocalizedCountValue)(X.e.deleteItemThatIsMountedDescription,X.e.deleteItemThatIsMountedIntervals,p)||"",p),v=l.deleteWizardStrings.confirmText;c=Object(f.__assign)(Object(f.__assign)({},l),{deleteWizardStrings:Object(f.__assign)(Object(f.__assign)({},l.deleteWizardStrings),{confirmTitle:X.e.deleteItemThatIsMountedTitle,confirmText:[d," ",v]})})}}else if(h){n=0;u.forEach(function(t){e.demandItemFacet(m.Oe,t,{suppressGetItems:!0})&&n++});if(n>0){var g=u.length-n;c=Object(f.__assign)(Object(f.__assign)({},l),{deleteWizardStrings:Object(f.__assign)(Object(f.__assign)({},l.deleteWizardStrings),{confirmTitle:X.e.deleteItems,confirmText:(r=n,i=g,s=1===r?X.e.deleteItemWithSingleMountPointText:X.e.deleteItemWithMultipleMountPointText,o=Object(z.format)(Object(z.getLocalizedCountValue)(s,X.e.deleteItemTextIntervals,i)||"",i,r),o)})})}}var y=c||l;return a?x.createElement(a,Object(f.__assign)({itemKeys:u},y)):null});var J=Object(s.t)()(function(){return function(e){return function(e,t){var n=t.itemKeys;if(!Object(D.e)(e,{enableDeleteCommandForMountPointConfiguration:m.S}).enableDeleteCommandForMountPointConfiguration)return{};for(var r=0,i=n;r<i.length;r++){var s=i[r];if(!e.demandItemFacet(m.Oe,s,{suppressGetItems:!0}))return{}}return{isAvailable:!1}}}});n.d(t,"sharePointBasicActionsAddonDeferred",function(){return K});var K=Object(r.t)(function(){return function(e){e(Object(i.o)(u.e,a.t)(l));e(Object(i.o)(u.e,c.t)(h));e(Object(s.r)(u.e,p.e)(E));e(Object(s.r)(u.e,S.e)(I));e(Object(s.r)(u.e,U.e)(V));e(Object(s.r)(u.e,o.e)(J))}})}],Array(24),[function(e,t,n){"use strict";n.r(t);var r,i=n(741),s=n(119),o=n(0),u=n(3393),a=n(22),f=n(11),l=n(511),c=n(289),h=n(2424),p=n(12),d=n(76),v=n(4),m=new v.e("modifyColumnProgressItem",{columnKey:Object(v.s)(),modifyType:Object(v.i)(),targetIndex:Object(v.i)()}),g=new s.e("modifyColumnProgress",function(e,t){var n=Object.keys(t.columnModifyTypeMap)[0],r=t.columnModifyTypeMap[n].modifyType,i=t.columnModifyTypeMap[n].targetIndex;return m.serialize({columnKey:n,modifyType:r,targetIndex:i})}),y=n(3),b=((r={})[d.r.started]=u.e.columnOperationStarted,r[d.r.completed]=u.e.columnOperationCompleted,r[d.r.failed]=u.e.columnOperationFailed,r),w=Object(a.t)(function(){return function(e){e(Object(f.r)(g,l.e)(Object(f.t)()(E)));e(Object(f.r)(g,c.n)(Object(f.t)()(S)));e(Object(f.r)(g,h.t)(Object(f.t)()(x)))}});function E(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.format,u=Object(s.i)(e,t).phase,a=void 0,f=e.demandItemFacet(p.e,r),l=f&&f.itemKeys;if(l&&l.length>0)n=(a=b)&&a[u];else if("item"===i){var c=e.demandItemFacet(g,r),h=c&&c.taskKey;if(h){var d=e.demandItemFacet(m,h),v=d&&d.columnKey;if(v){n=e.demandItemFacet(y.ue,v)}}}return Object(o.__assign)({},n?{title:n}:{})}}}function S(){return function(e){return function(e,t){return{reportMode:c.e.pin}}}}function x(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}n.d(t,"modifyColumnWithProgress",function(){return T});var T=Object(s.s)({operationTypeFacet:i.t,progressKeyFacet:g,initializeBatch:function(){return w}})},,function(e,t,n){"use strict";var r=n(1),i=n(302),s=n(2),o=Object(s.t)("quickEditRedo"),u=n(2999);n.d(t,"e",function(){return a});var a={key:o,automationId:"quickEditRedoCommand",name:i.e.quickEditRedo,iconProps:{iconName:"Redo"},action:r.createElement(u.e,{undoRedoActionType:"redo"})}},function(e,t,n){"use strict";var r=n(1),i=n(2999),s=n(302),o=n(2),u=Object(o.t)("quickEditUndo");n.d(t,"e",function(){return a});var a={key:u,automationId:"quickEditUndoCommand",name:s.e.quickEditUndo,iconProps:{iconName:"Undo"},action:r.createElement(i.e,{undoRedoActionType:"undo"})}},,,,,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(1356),o=n(2953),u=n(24),a=n(16),f=n(30),l=n(108),c=n(48),h=n(8),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("308")]).then(n.bind(null,3823))];case 1:return[2,e.sent().default]}})})}),d=Object(h.i)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.e)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(3008));n.d(t,"e",function(){return m});var m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)}],Array(44),[function(e,t,n){"use strict";n.r(t);n.d(t,"ItemAutoRefresh",function(){return a});n.d(t,"CurrentItemAutoRefresh",function(){return f});var r=n(1),i=n(16),s=n(8),o=n(2934);function u(e){var t=e.subscribe;r.useLayoutEffect(function(){return t()},[t]);return null}var a=Object(s.i)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.e,n),s=o.e.evaluate(i)(e,{itemKey:n,itemSubscriber:null}),a=s.isAvailable,f=s.itemSubscriber,l=s.subscribe;return a?f||(l?r.createElement(u,{subscribe:l}):null):null}),f=Object(i.n)()(a)}],Array(25),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointGraphAddon",function(){return x});var r=n(0),i=n(22),s=n(50),o=n(20),u=n(161),a=n(42),f=n(1023),l=n(79),c=n(782),h=n(44),p=n(19),d=n(2),v=n(2624),m=n(6),g=n(2969),y=n(3),b=n(57),w=n(317);function E(e){var t=e.itemKey,n=e.driveItem;return function(e){var i,s;e(v.sharePointItemByFullUrlAddon);var o=e(Object(b.e)({enableSharePointItemMapping:y.R})).enableSharePointItemMapping,u=void 0===o||o,c=new a.e,w=n.webDavUrl||n.remoteItem&&n.remoteItem.webDavUrl||n.webUrl,E=w&&decodeURIComponent(w);if(E){var S={itemFullUrl:E},x=Object(g.e)(E),T={itemFullUrl:x},N=f.e.serialize(S),C=f.e.serialize(T);c.mapKeys({mappings:(i={},i[N]=t,i)});c.resolveItems({items:(s={},s[N]=Object(r.__assign)(Object(r.__assign)({},u?Object(r.__assign)({},Object(d.n)({preferredKeyFacet:h.i},{preferredKeyFacet:new p.a(f.e,function(e){return e===l.e})})):{}),m.A.pack({itemKey:C})),s[C]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},m.d.pack({})),m.i.pack(x)),m.L.pack(encodeURI(x))),s)})}return{itemResolver:c}}}function S(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,Promise.resolve().then(n.bind(null,1615))];case 1:t=r.sent().demandItems;return[4,i(t(function(t){var n=c.e.serialize({tenantRootUrl:e});return t.demandItemFacet(l.e,n,{suppressGetItems:!1})}))];case 2:s=r.sent();o=s&&(s.webAbsoluteUrl||s.listFullUrl);if(!(u=o&&new w.e(o).authority))throw new Error("Unable to determine the endpoint for the user's OneDrive.");return[2,u+"/_api/v2.0"]}})})}}var x=Object(i.t)(function(){return function(e){var t;e(Object(s.e)({items:(t={},t[o.n]=Object(r.__assign)(Object(r.__assign)({},u.h.pack({process:E})),u.o.pack({getUserOneDriveEndpoint:S})),t)}))}})}],Array(88),[function(e,t,n){"use strict";n.r(t);n.d(t,"driveItemDeleteItemsBatchedOperationHandler",function(){return E});var r,i=n(0),s=n(337),o=n(22),u=n(318),a=n(35),f=n(76),l=n(50),c=n(208),h=n(6),p=n(154),d=n(2051),v=n(1522),m=n(248);(function(e){e.Completed="completed";e.Failed="failed";e.InProgress="inProgress"})(r||(r={}));var g=408,y=500,b=3e5,w=500,E=Object(o.n)({maxParallelOperationCount:4,timeout:b,areSameBatch:function(e,t){var n=p.e.deserialize(e.itemKey).driveId,r=p.e.deserialize(t.itemKey).driveId;return!!n&&!!r&&n===r}})(function(e){var t=this,n=e.items,E=Object.keys(n),S=E.map(function(e){return p.e.deserialize(e)});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,p,x,T,N,C,k;return Object(i.__generator)(this,function(L){switch(L.label){case 0:e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return Object(i.__assign)(Object(i.__assign)({},f.m.pack({total:1,current:0})),f.p.pack(!0))},function(e,t){return t.progressItemKey})}));t={value:S.map(function(e){return{id:e.itemId,deleted:{}}})};p="";x=Object(d.n)(S[0]);return[4,e(Object(v.n)({url:x+"/items",method:"PATCH",body:t,qosName:"deleteItems",endpoint:S[0].endpoint,parseResponse:function(e){p=e.getResponseHeader("Location")||""}}))];case 1:L.sent();T=0;N=!1;C=!1;Object(u.t)(b).then(function(){return C=!0});k=function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(v.n)({url:p,qosName:"getOperationStatus",endpoint:S[0].endpoint}))];case 1:t=i.sent();E.forEach(function(){e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return f.m.pack({total:1,current:t.percentageComplete/E.length})},function(e,t){return t.progressItemKey})}))});if(t.status!==r.Completed&&t.status!==r.Failed)return[3,2];N=!0;T=t.summary.failed;return[3,4];case 2:return[4,Object(u.t)(w)];case 3:i.sent();i.label=4;case 4:return[2]}})};L.label=2;case 2:return[5,k()];case 3:L.sent();L.label=4;case 4:if(!N&&!C)return[3,2];L.label=5;case 5:if(C)throw new s.e({facets:Object(i.__assign)({},m.u.pack(g))});e(Object(c.t)({items:Object(a.e)(E,function(){return[h.f]})}));if(T>0)throw new o.e({items:Object(a.e)(E.slice(0,T),function(){return new s.e({facets:Object(i.__assign)({},m.u.pack(y))})})});return[2]}})})}})}],Array(22),[function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(22),s=n(71),o=n(299),u=n(78),a=n(11),f=n(364),l=n(458),c=n(251),h=Object(r.__assign)(Object(r.__assign)({},l.e),{key:c.n,minWidth:32,maxWidth:32}),p=n(2547),d=n(821),v=n(942),m=n(49),g=n(2095),y=n(591),b=n(20),w=Object(m.i)({name:v.e.dateSharedColumnHeaderText,key:c.e,fieldName:"",minWidth:m.e.regularMin,maxWidth:m.e.regularMax,isCollapsable:!0,sortProps:m.t},y.e)(function(e,t){var n=e.demandItemFacet(g.e,t),r=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(b.S,b.n);return i&&i.language||window.navigator.language?{text:Object(d.r)(new Date(r),!1)}:{dateValue:r}}),E=n(523),S=n(249),x=n(2963),T=n(2180),N=n(2634),C=n(1),k=n(860),L=n(716),A=n(25),O=n(1267),M=n(3366),_=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,r=C.createElement(L.e,{className:"topCollaboratorIcon_acb4229a",iconName:"TeamFavorite"}),i=C.createElement("span",{className:"topCollaboratorUserName_acb4229a"},t),s=C.createElement("div",{className:"topCollaboratorTooltip_acb4229a"},A.formatToArray(M.e.topCollaboratorWith,i));return C.createElement("div",{className:"topCollaPlaceHolder_acb4229a"},n?null:t?C.createElement(O.e,{content:s},r):r)};return t})(k.e),D=n(12),P=Object(m.i)({name:v.e.sharedByColumnHeaderText,key:c.i,fieldName:"",minWidth:m.e.regularMin,maxWidth:m.e.regularMax,isCollapsable:!0,sortProps:m.r,headerClassName:"columnHeader_acb4229a"},E.e)(function(e,t){var n=e.demandItem({shareByPerson:x.e},t).shareByPerson,r=n&&n.itemKey,i=!1;if(r&&T.e.matches(r)){var s=T.e.deserialize(r).email,o=e.demandItemFacet(D.e,N.e.serialize({endpoint:"https://graph.microsoft.com/beta"}));o&&(i=o.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(S.e,t);return!!n&&n===s}))}return r?{people:[{itemKey:r}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return C.createElement("div",{className:"userWithTopCollaborator_acb4229a"},C.createElement(_,{userName:r.title,isPlaceholder:!i}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(S.e,t)}),H=Object(a.t)()(function(){return function(e){return j}});var B=[h,p.e,w,P];function j(e,t){return{columns:B}}var F=n(6),I=n(879),q=n(50),R=n(165),U=n(154),z=n(2051),W=n(1522),X=n(1961),V=n(3274),$=n(2448),J=n(4),K=new J.e("driveItem",{endpoint:Object(J.s)(),driveId:Object(J.s)({shouldNormalizeToEmpty:!0}),canonicalUrl:Object(J.s)()}),Q=n(317);function G(e){var t,n,i,s,o=e.driveItemResponse,u=e.endpoint,a=e.getDriveItemFacets,f=void 0===a?X.e:a,l=o.remoteItem,c=l&&l.parentReference,h=o.parentReference,p=h||c,d=p&&p.driveId,v=p&&p.id,m="personal"===(p&&p.driveType),g=!!o.root;if(l){s=l.id;c&&(d=c.driveId)}else s=m&&o.root?$.n:o.id;var y={endpoint:u,driveId:d,itemId:s},b=U.e.serialize(y),w=o&&(o.webDavUrl||o.webUrl),E=m&&p&&p.path===$.e?$.n:v||void 0,S=p&&E?U.e.serialize({endpoint:u,driveId:p.driveId||d,itemId:E}):void 0,x=[],T="";if(w){var N=new Q.e(w);x.push.apply(x,N.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));x.unshift(N.authority);T=x.join("/")}p&&!g&&!E&&T&&(S=K.serialize({endpoint:u,driveId:p.driveId,canonicalUrl:T}));var C=Object(V.e)(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:b,driveItemKey:y,parentFolderItemKey:S})).itemResolver;C.resolveItems({items:Object(r.__assign)({},S&&(t={},t[S]=Object(r.__assign)({},T?F.L.pack(T):{}),t))});if(l&&c){var k=U.e.serialize({endpoint:u,driveId:h&&h.driveId,itemId:o.id}),L=U.e.serialize({endpoint:u,driveId:c.driveId,itemId:l.id});C.mapKeys({mappings:(n={},n[k]=L,n)});C.resolveItems({items:(i={},i[L]=Object(r.__assign)({},f({driveItem:o,endpoint:u})),i)})}return{itemResolver:C,actualDriveItemKey:y,actualItemKey:b}}var Y=n(39),Z=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=U.e.deserialize(n),s=i.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:t=Object(z.n)(i);return[4,o(Object(W.r)({url:Object(z.t)(i)+"?$expand=thumbnails",driveUrl:t,qosName:"getItem",endpoint:s}))];case 1:u=p.sent();a=G({driveItemResponse:u,endpoint:s}),f=a.itemResolver,l=a.actualItemKey;f.resolveItems({items:(c={},c[e.itemKey]=Object(r.__assign)({},Y.n.pack(U.e)),c)});f.mapKeys({mappings:(h={},h[l]=n,h)});o(f.execute());return[2]}})})}});var ee=n(600),te=n(856),ne=n(3698),re=n(2965),ie=n(603),se=n(1993),oe=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=ee.e.deserialize(n).driveItemKey,s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h=this;return Object(r.__generator)(this,function(p){t={Caller:"HoverCard"};o="GetItemAnalytics_addon-graph";u=Object(r.__awaiter)(h,void 0,void 0,function(){var u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:return[4,e(Object(W.r)({url:(d=Object(z.t)(i),v=ue(d),m="$expand=analytics($expand=allTime($expand=activities))",g="$select=*,id,reactions,trending",y=g+"&"+m+",insights($expand=keyPoints)",b=v+"?"+y,b),qosName:o+"_GetAnalyticsSections",endpoint:s,timeout:6e3,headers:t,driveUrl:ue(Object(z.n)(i))}))];case 1:u=p.sent();a=Object(ne.t)(u);if(f=a.createdBy){l=T.e.serialize({email:f.email,endpoint:s});e(Object(q.e)({items:(c={},c[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack(f.displayName)),S.e.pack(f.email)),S.t.pack(f.image)),S.n.pack(f.id)),c[n]=Object(r.__assign)({},te.r.pack({itemKey:l,displayValue:f.displayName})),c)}))}e(Object(q.e)({items:(h={},h[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},te.h.pack(a.viewCount)),te.p.pack(a.viewerCount)),te.o.pack(a.isTrending)),te.e.pack(a.activities)),te.f.pack(a.likeCount)),te.t.pack(a.commentCount)),te.a.pack(a.lifeCycleStatus)),te.u.pack(a.keyPointsData)),te.s.pack(a.incompleteData)),te.i.pack(a.createdDateTime)),h)}));return[2]}var d,v,m,g,y,b})});a=[u];f=Object(r.__awaiter)(h,void 0,void 0,function(){var u,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return[4,e(Object(W.r)({url:(h=Object(z.t)(i),p=ue(h),p+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:o+"_GetRecommendedActionsAndConversations",endpoint:s,timeout:6e3,headers:t,driveUrl:ue(Object(z.n)(i))}))];case 1:u=c.sent();a=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(u);f=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:re.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(u);e(Object(q.e)({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)({},te.l.pack(a)),te.n.pack(f)),l)}));return[2]}var h,p})});a.push(f);if(Object(se.t)()){l=Object(r.__awaiter)(h,void 0,void 0,function(){var u,a;return Object(r.__generator)(this,function(f){switch(f.label){case 0:return[4,e(Object(W.r)({url:(l=Object(z.t)(i),c=ue(l),c+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'"),driveUrl:ue(Object(z.n)(i)),qosName:o+"_GetShareWithPeople",endpoint:s,timeout:6e3,headers:t}))];case 1:u=f.sent();e(Object(q.e)({items:(a={},a[n]=Object(r.__assign)({},te.c.pack(u.value)),a)}));return[2]}var l,c})});a.push(l)}else e(Object(q.e)({items:(c={},c[n]=Object(r.__assign)({},te.c.pack([])),c)}));return[2,Object(ie.e)(a)]})})}});function ue(e){return e.replace("2.0","2.1")}var ae=new J.e("specialDriveItem",{endpoint:Object(J.s)(),driveId:Object(J.s)({shouldNormalizeToEmpty:!0}),name:Object(J.s)()}),fe=n(1837),le=n(42),ce=n(44),he=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=ae.deserialize(n),s=i.driveId,o=i.endpoint,u=Object(z.n)(i);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,c,h,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:return[4,e(Object(W.n)({url:Object(z.i)(i),driveUrl:u,qosName:"getItem",endpoint:o}))];case 1:t=m.sent();a=new le.e;f=t&&t.parentReference;l=f&&f.driveId;c={endpoint:o,driveId:l||s,itemId:t.id};h=U.e.serialize(c);p=f&&f.id?U.e.serialize({endpoint:o,driveId:l,itemId:f.id}):void 0;a.resolveItems({items:(d={},d[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(X.e)({driveItem:t,endpoint:o,parentFolderItemKey:p})),ce.i.pack(U.e)),D.t.pack({itemKey:fe.e.serialize({driveItemKey:c,sortBy:"",isAscending:!0})})),d)});a.mapKeys({mappings:(v={},v[h]=n,v)});e(a.execute());return[2]}})})}});var pe=new J.e("driveItemPage",{endpoint:Object(J.s)(),setItemKey:Object(J.s)(),token:Object(J.s)()}),de=n(208),ve=n(213),me=n(57),ge=n(161);function ye(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}function be(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}function we(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:void 0===n?!r:n&&!r}}var Ee=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=pe.deserialize(n),s=i.setItemKey,o=i.endpoint,u=i.token,a=J.e.get(s).deserialize(s),f=a.extFilters,l=a.driveItemKey,c=Object(z.n)(l);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,a,l,h,p,d,v,m,g,y,b,w,E,S,x;return Object(r.__generator)(this,function(T){switch(T.label){case 0:return[4,e(Object(W.n)({endpoint:o,url:u,driveUrl:c,qosName:"getChildrenPage"}))];case 1:t=T.sent();i=f&&f.length>0?we(f):void 0;a=new le.e;l=[];h=0,p=t.value;T.label=2;case 2:if(!(h<p.length))return[3,5];d=p[h];if(!!i&&i(d))return[3,4];v=d&&(d.parentReference||d.remoteItem&&d.remoteItem.parentReference);m=v&&v.driveId;g=U.e.serialize({itemId:d.id,driveId:m,endpoint:o});y=v?U.e.serialize({itemId:v.id,driveId:m,endpoint:o}):void 0;l.push(g);a.resolveItems({items:(x={},x[g]=Object(r.__assign)(Object(r.__assign)({},Object(X.e)({driveItem:d,endpoint:o,parentFolderItemKey:y})),Object(de.e)().forFacet(F.l).thenInvalidate(n,D.e).forFacet(F.f).thenInvalidate(n,D.e).pack()),x)});return(b=e(Object(me.e)({processDriveItemFromSharePoint:ge.h})).processDriveItemFromSharePoint)?[4,e(b.process({itemKey:g,driveItem:d}))]:[3,4];case 3:w=T.sent().itemResolver;a.merge(w);T.label=4;case 4:h++;return[3,2];case 5:if(E=t["@odata.nextLink"]){S=pe.serialize({setItemKey:s,endpoint:o,token:E});a.merge(Object(ve.t)({itemKey:S}).itemResolver);l.push(S)}a.merge(Object(ve.e)({itemKey:n,itemSetKey:s,childItemKeys:l}).itemResolver);e(a.execute());return[2]}})})}});var Se=n(589),xe=n(2110),Te=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Se.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(u){(t=new le.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},D.t.pack({itemKey:o.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0})})),F.l.pack(xe.e.sharedWithMe)),F.d.pack({})),F.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var Ne=n(461),Ce=n(359),ke=n(33),Le=n(26),Ae=n(54);var Oe=n(173),Me=n(59);function _e(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.parentItemResponse,u=e.mapItemSetKey,a=n.deserialize(t),f=i.serialize(a.driveItemKey),l=a.driveItemKey.endpoint;return function(n){var i;Me.n(Oe.e.processData.start);var a=n((function(e){return function(t){var n,i,s,o,u=e.itemKey,a=e.parentItemKey,f=e.itemSetKeyFacet,l=e.filterChildItems,c=e.onProcessResponse,h=e.groupChildItems,p=e.response,d=e.skip,v=void 0===d?0:d,m=e.enableRandomAccess,g=void 0!==m&&m,y=e.totalChildCount,b=e.getDriveItemFacets,w=f.deserialize(u),E=w.driveItemKey.endpoint,S=new le.e,x=t(Object(Ce.e)({name:"remoteItemsMissingParentRef"})),T="number"==typeof p["@odata.count"]?p["@odata.count"]:y||p.value.length,N=p["@odata.nextLink"],C=!!N,k=t(Object(Le.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(D.e,u),prevChildKeys:e.demandItemFacet(D.e,u)}})),L=k.childItemsFacetResolved,A=k.prevChildKeys,O=A&&A.itemKeys;g&&(L&&O?o=O.slice(0):"number"==typeof T&&(o=new Array(T+(C&&T<=p.value.length?1:0))));o||(o=new Array(p.value.length+(C?1:0)));for(var M=v,_=0,P=0,H=p.value;P<H.length;P++){var B=H[P],j=l&&l(B),F=B.remoteItem,I=!(B.remoteItem&&B.remoteItem.parentReference&&B.remoteItem.parentReference.driveId),q=F&&I;q&&_++;if(j||q){o.splice(M,1);T--}else{var R=B.webDavUrl||B.remoteItem&&B.remoteItem.webDavUrl||B.webUrl,U=t(Object(me.e)({graphEndpoint:ge.u,graphRecentEndpoint:ge.a})),z=U.graphEndpoint,W=U.graphRecentEndpoint,X=E.indexOf("/_api/v2.0")>-1||E.indexOf("/_api/v2.1")>-1,V=z||W;if(R&&X){var $=R&&decodeURIComponent(R);E=V?new Q.e($).authority+"/_api/v2.0":""+new Q.e($).authority+new Q.e(E).path}var J=G({setItemKey:u,driveItemResponse:B,endpoint:E,getDriveItemFacets:b}),K=J.itemResolver,Y=J.actualItemKey,Z=J.actualDriveItemKey;o[M]=Y;S.merge(K);if(c){var ee=c({itemKey:u,driveItemKey:Z,item:B});ee&&S.merge(ee.itemResolver)}var te=t(Object(me.e)({processDriveItemFromSharePoint:ge.h})).processDriveItemFromSharePoint;if(te&&(X||V)){var ne=t(te.process({itemKey:Y,driveItem:B})).itemResolver;S.merge(ne)}M++}}t(x(Object(r.__assign)({resultType:_<1?ke.e.Success:ke.e.Failure},_>0?{extraData:{count:_}}:{})));if(C){var re=pe.serialize({setItemKey:u,endpoint:E,token:N});S.merge(Object(ve.t)({itemKey:re}).itemResolver);o[M]=re}if(h){var ie=h(w);ie&&S.merge(ie.itemResolver)}else S.resolveItems({items:(n={},n[u]=Object(r.__assign)({},D.e.pack({itemKeys:o})),n)});T!==y&&S.resolveItems({items:(i={},i[a]=Object(r.__assign)({},Ae.e.pack(T)),i)});S.resolveItems({items:(s={},s[u]=Object(r.__assign)(Object(r.__assign)({},D.i.pack({itemKey:a})),Object(de.e)().forFacet(D.e).thenInvalidate(Ne.e).pack()),s)});return{itemResolver:S}}})(Object(r.__assign)(Object(r.__assign)({},e),{response:s,parentItemKey:f}))).itemResolver;if(u){var c=u().itemResolver;a.merge(c)}if(o){var h=G({setItemKey:t,driveItemResponse:o,endpoint:l}).itemResolver;a.merge(h)}a.resolveItems({items:(i={},i[f]=Object(r.__assign)({},Object(de.e)().forFacet(D.t).thenInvalidate(e.itemKey,D.e).pack()),i)});Me.n(Oe.e.processData.end);return{itemResolver:a}}}function De(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,l=i.deserialize(n),c=l.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:t=Object(z.n)(l.driveItemKey);return[4,n(Object(W.r)({url:s(l),driveUrl:t,qosName:"getChildren"+(u?"."+u:""),endpoint:c,headers:e.additionalHeaders,expectedErrors:f}))];case 1:i=v.sent();h=Object(r.__spreadArrays)(i.value);p=a?a(h):i.value;d=o?o(p):p;return[4,n(_e(Object(r.__assign)(Object(r.__assign)({},e),{childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:d})})))];case 2:return[2,{itemResolver:v.sent().itemResolver}]}})})}}var Pe=n(164),He=n(578),Be=n(1470),je=n(200);function Fe(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}var Ie=n(1617),qe={fileType:"fileName",sharedByUser:"sharedByName",dateModified:"dateModified"};var Re=new Map([["code",Pe.e.text],["csv",Pe.e.excel],["docx",Pe.e.word],["dotx",Pe.e.word],["one",Pe.e.onenote],["onepkg",Pe.e.onenote],["onetoc",Pe.e.onenote],["pdf",Pe.e.pdf],["photo",Pe.e.media],["potx",Pe.e.powerpoint],["ppsx",Pe.e.powerpoint],["pptx",Pe.e.powerpoint],["rtf",Pe.e.text],["txt",Pe.e.text],["video",Pe.e.media],["xlsx",Pe.e.excel],["xltx",Pe.e.excel],["zip",Pe.e.zip]]);function Ue(e,t){var n,r,i=(n=e,r=Object(He.t)(n,!0),Object(Be.t)(r)),s=Re.get(i);return!!s&&Object(Pe.t)(t.filters,s)}function ze(e,t){void 0===t&&(t=[]);return t.every(function(t){var n,r=!(t.type===qe.sharedByUser)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values),i=!(t.type===qe.fileType)||(function(e,t){return!!e.name&&Ue(e.name,t)})(e,Object(je.t)(t.values)),s=!(t.type===qe.dateModified)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case Ie.e.today:return n;case Ie.e.yesterday:return Fe(n,1);case Ie.e.last7Days:return Fe(n,7);case Ie.e.last30Days:return Fe(n,30);case Ie.e.last3Months:return Fe(n,90);default:return new Date(0)}})((n=t.values).length<1?Ie.e.none:-1===Object.keys(Ie.e).indexOf(n[0])?Ie.e.none:Ie.e[n[0]]));return r&&i&&s})}var We=n(214);function Xe(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function Ve(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function $e(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function Je(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function Ke(e,t,n,i){return(function(e,t){return Object(r.__spreadArrays)(e).sort(t)})(e,function(e,r){var s=e.folder,o=r.folder;return n&&s&&!o?-1:n&&!s&&o?1:i(e,r,t)})}var Qe=n(2966),Ge=n(3363),Ye=n(407),Ze=n(29),et=n(3364);function tt(e){if(o.e.matches(e)){var t=o.e.deserialize(e).groupBy;if(t===c.t[c.i])return(function(e){var t={};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedBy,u=o&&o.user,a=U.e.serialize(r);if(u&&u.email){var f=Qe.n.serialize({displayName:u.displayName,email:u.email});if(n=f,t.hasOwnProperty(n))t[f].push(a);else{t[f]=[];t[f].push(a)}}}},groupChildItems:function(n){for(var i,s,o=new le.e,u=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!Qe.n.matches(i))return e;var s=Qe.n.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return Qe.n.serialize(e)})})(Object.keys(t)),a=[],f=0,l=u;f<l.length;f++){var c=l[f];if(Qe.n.matches(c)){var h=Qe.n.deserialize(c);o.resolveItems({items:(i={},i[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack(h.displayName)),Ae.s.pack(!0)),D.e.pack({itemKeys:t[c]})),i)});a.push(c)}}o.resolveItems({items:(s={},s[e]=Object(r.__assign)(Object(r.__assign)({},D.e.pack({itemKeys:a})),Ze.e.pack(!0)),s)});return{itemResolver:o}}}})(e);if(t===c.t[c.e])return(function(e){var t={};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedDateTime,u=U.e.serialize(r);if(o){var a=(function(e,t){if(!e)return Ge.e.older;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Ye.e.today;n.setDate(n.getDate()-1);if(e>=n)return Ye.e.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return Ge.e.thisWeek;n.setDate(n.getDate()-7);if(e>n)return Ge.e.lastWeek;var r=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth()-1,1);if(e>=i&&e<r)return Ge.e.lastMonth;n.setDate(n.getDate()-7);if(e>n)return Ge.e.twoWeeksAgo;n.setDate(n.getDate()-7);if(e>n)return Ge.e.threeWeeksAgo;if(e>=r)return Ge.e.thisMonth;var s=t.getFullYear()===e.getFullYear(),o=et.e[e.getMonth()];if(s)return o;return A.format(Ye.e.MonthAndYear,o,e.getFullYear())})(new Date(o),new Date),f=Qe.e.serialize({relativeTime:a,sharedDateTime:o});if(n=f,t.hasOwnProperty(n))t[f].push(u);else{t[f]=[];t[f].push(u)}}}},groupChildItems:function(n){for(var i,s,o=new le.e,u=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!Qe.e.matches(i))return e;var s=Qe.e.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return Qe.e.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},i=0,s=n;i<s.length;i++){var o=s[i];if(Qe.e.matches(o)){var u=Qe.e.deserialize(o).relativeTime,a=Qe.t.serialize({relativeTime:u});if(r(a))for(var f=e[o],l=0,c=f;l<c.length;l++){var h=c[l];t[a].push(h)}else{t[a]=[];f=e[o];for(var p=0,d=f;p<d.length;p++){h=d[p];t[a].push(h)}}}}return t})(t),a=[],f=0,l=Object.keys(u);f<l.length;f++){var c=l[f];if(Qe.t.matches(c)){var h=Qe.t.deserialize(c).relativeTime;o.resolveItems({items:(i={},i[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack(h)),Ae.s.pack(!0)),D.e.pack({itemKeys:u[c]})),i)});a.push(c)}}o.resolveItems({items:(s={},s[e]=Object(r.__assign)(Object(r.__assign)({},D.e.pack({itemKeys:a})),Ze.e.pack(!0)),s)});return{itemResolver:o}}}})(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}var nt=Object(i.i)()(function(e){var t=this,n=o.e.deserialize(e.itemKey),i=n.filters,s=n.sortBy,u=n.isAscending;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,h,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:t=tt(e.itemKey),a=t.onProcessResponse,f=t.groupChildItems;l=o.e.deserialize(e.itemKey);h=l.driveItemKey.endpoint;p=n(Object(me.e)({graphSharedWithMeEndpoint:ge.f})).graphSharedWithMeEndpoint;h=p||h;return[4,n(Object(W.i)(h))];case 1:d=m.sent();return[4,n(De(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedWithMe",itemSetKeyFacet:o.e,parentItemKeyFacet:Se.e,getUrl:function(e){return d?h+"/drive/view.sharedWithMe?allowExternal=true":h+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!ze(e,i)},sortChildItems:function(e){return(function(e,t,n,r){void 0===r&&(r=!1);var i=c.t[c.e],s=c.t[c.i],o=c.t[We.t],u=c.t[c.r],a=c.t[We.r];switch(t){case i:return Ke(e,n,r,Ve);case s:return Ke(e,n,r,Je);case o:case a:return Ke(e,n,r,$e);case u:return Ke(e,n,r,Xe);default:return e}})(e,s,u,!0)},onProcessResponse:a,groupChildItems:f})))];case 2:v=m.sent().itemResolver;n(v.execute());return[2]}})})}});var rt=new J.e("sharedByMeRootItem",{endpoint:Object(J.s)()}),it=new J.e("sharedByMeItemSet",{driveItemKey:Object(J.o)(U.e)}),st=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=rt.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(o){(t=new le.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},D.t.pack({itemKey:it.serialize({driveItemKey:i})})),F.l.pack(xe.e.sharedByMe)),F.d.pack({})),F.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var ot=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,n(De(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:it,parentItemKeyFacet:rt,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=i.sent().itemResolver;n(t.execute());return[2]}})})}});var ut=n(452),at=n(304),ft=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=at.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(r.__generator)(this,function(u){t=e(Object(me.e)({groupBy:ge.p})).groupBy;(s=new le.e).resolveItems({items:(o={},o[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},D.t.pack({itemKey:ut.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0,groupBy:t||""})})),F.l.pack(xe.e.recentTitle)),F.d.pack({})),F.A.pack(void 0)),o)});e(s.execute());return[2]})})}});var lt=n(595),ct=n(306),ht=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=ct.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(o){(t=new le.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},D.t.pack({itemKey:lt.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0})})),F.l.pack(xe.e.saved)),F.d.pack({})),F.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var pt,dt=n(110),vt=new J.e("recentGroup",{relativeTime:Object(J.s)()}),mt=864e5,gt=7;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(pt||(pt={}));function yt(e){var t=new Date;return(function(e,t){return bt(t,e)})(e,t)?pt.today:(function(e,t){return bt(new Date(t.getTime()-mt),e)})(e,t)?pt.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*mt;return e.getTime()>n})(e,t)?pt.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+gt)*mt;return e.getTime()>n})(e,t)?pt.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-2*gt*mt;return e.getTime()>n})(e,t)?pt.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-3*gt*mt;return e.getTime()>n})(e,t)?pt.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?pt.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?pt.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?pt.twoMonthsAgo:""}function bt(e,t){return e.toDateString()===t.toDateString()}var wt=["January","February","March","April","May","June","July","August","September","October","November","December"],Et=n(2631);var St=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},xt=Object(i.i)()(function(e){var t=this,n=ut.e.deserialize(e.itemKey),i=n.filters,s=void 0===i?[]:i,o=n.groupBy,u=void 0===o?"":o,a=n.driveItemKey.endpoint,f=Object(je.e)({extFilters:Object(je.t)(s),allowedMediaTypes:[Pe.e.photo,Pe.e.video],fileTypeIconMap:dt.e}),l=Object(je.e)({extFilters:Object(je.t)(s),allowedMediaTypes:[Pe.e.photo],fileTypeIconMap:dt.e}),c=Object(je.e)({extFilters:Object(je.t)(s),allowedMediaTypes:[Pe.e.video],fileTypeIconMap:dt.e});return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,P,H,B,j;return Object(r.__generator)(this,function(I){switch(I.label){case 0:t=i(Object(me.e)({graphRecentEndpoint:ge.a})).graphRecentEndpoint;a=t||a;o=ut.e.serialize(Object(r.__assign)(Object(r.__assign)({},n),{driveItemKey:{endpoint:a}}));h=vt.serialize({relativeTime:"today"});p=vt.serialize({relativeTime:"yesterday"});d=vt.serialize({relativeTime:"thisWeek"});v=vt.serialize({relativeTime:"lastWeek"});m=vt.serialize({relativeTime:"twoWeeksAgo"});g=vt.serialize({relativeTime:"threeWeeksAgo"});y=vt.serialize({relativeTime:"lastMonth"});b=vt.serialize({relativeTime:"twoMonthsAgo"});w=[];E=[];S=[];x=[];T=[];N=[];C=[];k=[];L="";A="date"===u;O=function(e){var t,n=e.driveItemKey,i=e.item,s=new le.e;if(i&&n){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=U.e.serialize(n);if(A&&a){var l=new Date(a);switch(yt(l)){case pt.today:w.push(f);break;case pt.yesterday:E.push(f);break;case pt.thisWeek:S.push(f);break;case pt.lastWeek:x.push(f);break;case pt.twoWeeksAgo:T.push(f);break;case pt.threeWeeksAgo:N.push(f);break;case pt.lastMonth:C.push(f);break;case pt.twoMonthsAgo:k.push(f);L=wt[l.getMonth()]}}s.resolveItems({items:(t={},t[f]=Object(r.__assign)({},F.d.pack(void 0)),t)});return{itemResolver:s}}};M=!f&&A?function(t){var n,i,s=new le.e;s.resolveItems({items:(n={},n[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack("Today")),Ae.s.pack(!0)),D.e.pack({itemKeys:w})),n[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack("Yesterday")),Ae.s.pack(!0)),D.e.pack({itemKeys:E})),n[d]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack("This Week")),Ae.s.pack(!0)),D.e.pack({itemKeys:S})),n[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack("Last Week")),Ae.s.pack(!0)),D.e.pack({itemKeys:x})),n[m]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack("Two Weeks Ago")),Ae.s.pack(!0)),D.e.pack({itemKeys:T})),n[g]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack("Three Weeks Ago")),Ae.s.pack(!0)),D.e.pack({itemKeys:N})),n[y]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack("Last Month")),Ae.s.pack(!0)),D.e.pack({itemKeys:C})),n[b]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.l.pack(L)),Ae.s.pack(!0)),D.e.pack({itemKeys:k})),n)});var o=[];w.length>0&&o.push(h);E.length>0&&o.push(p);S.length>0&&o.push(d);x.length>0&&o.push(v);T.length>0&&o.push(m);N.length>0&&o.push(g);C.length>0&&o.push(y);k.length>0&&o.push(b);s.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)({},D.e.pack({itemKeys:o})),i)});return{itemResolver:s}}:void 0;return[4,i(Object(W.i)(a))];case 1:_=I.sent();P=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,i(De(Object(r.__assign)(Object(r.__assign)({},e),{qosName:f?"recentMedia":_?"ODC-recent":"recent",itemKey:o,itemSetKeyFacet:ut.e,parentItemKeyFacet:at.e,getUrl:function(e){var t=a+"/"+(a.indexOf("/v2.")>-1?"drives/me":"me/drive")+"/recent?";if(_)t=a+"/drive/view.recent?";else if(f){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||n.length>0?"&$filter="+(0===n.length?ye(t):0===t.length?be(n):be(Object(r.__spreadArrays)([ye(t)],n))):""})(s)},getDriveItemFacets:function(e){var t=Object(X.e)(e),n=e.driveItem,i=n.thumbnails,s=n.remoteItem,o=i||s&&s.thumbnails;return Object(r.__assign)(Object(r.__assign)({},t),o?Object(r.__assign)({},Et.e.pack(!1)):{})},expectedErrors:P,preprocessResponse:function(e){l?e=St(e,"image"):c&&(e=St(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:f?{Prefer:"ApiVersion=2.1,NoPreAuthThumbnailUrls"}:{Prefer:"ApiVersion=2.1;ODC,returnparentresource,returnowner"},onProcessResponse:O,groupChildItems:M})))];case 2:H=I.sent().itemResolver;f&&H.resolveItems({items:(B={},B[e.itemKey]=Object(r.__assign)({},Ae.u.pack({})),B)});H.mapKeys({mappings:(j={},j[o]=e.itemKey,j)});i(H.execute());return[2]}})})}});var Tt=n(365);function Nt(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}var Ct=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:t=n(Object(me.e)({saveForLaterGraphEndpoint:ge.d})).saveForLaterGraphEndpoint;i=e.itemKey;s=lt.e.deserialize(i);o=s.driveItemKey.endpoint;u=n(Object(me.e)({getUserOneDriveEndpoint:ge.o})).getUserOneDriveEndpoint;a=new Q.e(o).authority;return(f=t)?[3,3]:(l=u)?[4,n(u.getUserOneDriveEndpoint(a))]:[3,2];case 1:l=d.sent();d.label=2;case 2:f=l;d.label=3;case 3:o=f||o;c=lt.e.serialize({driveItemKey:{endpoint:o},sortBy:"",isAscending:!0});h=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,n(De(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:c,qosName:"savedForLater",itemSetKeyFacet:lt.e,parentItemKeyFacet:ct.e,getUrl:function(e){if(t){return o+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return o+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(e){var t,n,i=e.itemKey,s=e.driveItemKey,o=e.item,u=new le.e;if(s&&o){var a=U.e.serialize(s),f=Tt.e.serialize({driveItemKey:s}),l=o&&(o.webDavUrl||o.webUrl);u.resolveItems({items:(t={},t[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},F.v.pack({itemKey:f})),F.i.pack(l)),F.p.pack(o.size)),t[f]=Object(r.__assign)(Object(r.__assign)({},F.b.pack(!0)),Object(de.e)().forFacet(F.b).thenInvalidate(i,D.e).pack()),t)});u.invalidateItems({items:(n={},n[i]=[D.e],n)})}return{itemResolver:u}},filterChildItems:Nt,getDriveItemFacets:function(e){var t=e.driveItem,n=t.root,i=t.remoteItem,s=t.name,o=n?xe.e.files:s||i&&i.name||"",u=!t.webDavUrl,a=t.followed&&t.followed.followedDateTime;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(X.e)(Object(r.__assign)(Object(r.__assign)({},e),{shouldReturnShareFacets:!1}))),F.h.pack(Object(X.t)(o,u))),a?F.u.pack(new Date(a).getTime()):{}),F.d.pack(u?{}:void 0))},mapItemSetKey:function(){var t,n=new le.e;n.mapKeys({mappings:(t={},t[e.itemKey]=c,t)});return{itemResolver:n}},expectedErrors:h})))];case 4:p=d.sent().itemResolver;n(p.execute());return[2]}})})}});var kt=n(2967),Lt=n(1615),At=Object(i.n)()(function(e){var t=this,n=e.items;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:return[4,e(Object(Le.e)(function(e){return e.demandItemFacet(b.c,b.n)}))];case 1:if(!E.sent())return[2];t=Object.keys(n);i=t[0];s=Tt.e.deserialize(i);if(!(o=s.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");u=lt.e.serialize({driveItemKey:{endpoint:o},sortBy:"",isAscending:!0});return[4,e(Object(Lt.demandItems)(function(e){return e.demandItemFacet(D.e,u)}))];case 2:a=E.sent();f=a&&a.itemKeys||[];l=new le.e;c={};for(h=0,p=f;h<p.length;h++){g=p[h];c[g]=!0}for(d=0,v=t;d<v.length;d++){m=v[d];g=Tt.e.deserialize(m).driveItemKey;y=!!c[U.e.serialize(g)];l.resolveItems({items:(w={},w[m]=Object(r.__assign)(Object(r.__assign)({},F.b.pack(y||void 0)),Object(de.e)().forFacet(F.b).thenInvalidate(u,D.e).pack()),w)})}e(l.execute());return[2]}})})}});var Ot=n(2286),Mt=new J.e("searchRootItem",{endpoint:Object(J.s)()}),_t=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(De(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"search",itemSetKeyFacet:Ot.e,parentItemKeyFacet:Mt,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return Object(z.t)(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:i=s.sent().itemResolver;n(i.execute());return[2]}})})}});var Dt=n(2285);function Pt(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return Object(r.__generator)(this,function(O){switch(O.label){case 0:t=e.itemKey,i=e.top,s=e.skip;o=fe.e.deserialize(t);u=o.driveItemKey,a=o.extFilters;f=U.e.serialize(o.driveItemKey);l=o.driveItemKey.endpoint,c=o.sortBy,h=o.isAscending;p=Object(z.n)(o.driveItemKey);return[4,n(Object(Le.e)(function(e){return{isParentItemResolved:e.isItemFacetResolved(U.e,f),totalChildCount:e.isItemFacetResolved(Ae.e,f)?e.demandItemFacet(Ae.e,f):void 0,driveType:e.isItemFacetResolved(Dt.e,f)?e.demandItemFacet(Dt.e,f):void 0}}))];case 1:d=O.sent(),v=d.isParentItemResolved,m=d.totalChildCount,g=d.driveType;y=Promise.resolve(void 0);v||(y=n(Object(W.r)({url:Object(z.t)(u),driveUrl:p,qosName:"getItem",endpoint:l})));b=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"}];w=Object(z.t)(u);E=s?"&skiptoken="+(s+1)+"/"+m+"&skip="+s:"";S=c&&void 0!==h?Object(W.t)(c,h):"";x=(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("folder"===u)!o&&t.push("folder ne null");else if("."!==u[0]);else{t=[];n=[]}}return t.length>0||n.length>0?"&$filter="+(0===n.length?ye(t):0===t.length?be(n):be(Object(r.__spreadArrays)([ye(t)],n))):""})(a);T=n(Object(W.r)({url:w+"/children?$top="+i+E+S+"&$expand=thumbnails&select=*,webDavUrl"+x,driveUrl:p,qosName:"getChildren.folder",endpoint:l,expectedErrors:b}));N=[T,y];return[4,Promise.all(N)];case 2:C=O.sent(),k=C[0];if(L=C[1]){L.folder&&(m=L.folder.childCount);L.parentReference&&L.parentReference.driveType&&(g=L.parentReference.driveType)}A=n(Object(W.s)(l,g));return[4,n(_e({itemKey:t,itemSetKeyFacet:fe.e,parentItemKeyFacet:U.e,parentItemResponse:L,childItemsResponse:k,filterChildItems:a&&a.length>0?we(a):void 0,skip:s,enableRandomAccess:A,totalChildCount:m,onProcessResponse:function(e){var t,n=new le.e;n.resolveItems({items:(t={},t[e.itemKey]=Object(r.__assign)({},Y.n.pack(U.e)),t)});return{itemResolver:n}}}))];case 3:return[2,O.sent().itemResolver]}})})}}var Ht=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=n(Object(me.e)({pageSize:ge.r})).pageSize;return[4,n(Pt(Object(r.__assign)(Object(r.__assign)({},e),{skip:Bt,top:t||$.t})))];case 1:i=s.sent();Me.n(Oe.e.resolveData.start);n(i.execute());Me.n(Oe.e.resolveData.end);return[2]}})})}}),Bt=0;var jt=n(120),Ft=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(jt.e)(function(){e(Object(q.t)({keyFacet:fe.e,facets:[fe.e,D.e]}));e(Object(s.o)(fe.e,R.e)(Ht))}));return[2]})})}}),It=n(596),qt=n(2629),Rt=n(2628),Ut=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=e.itemKey;i=Rt.e.deserialize(t);s=i.endpoint;o=Object(z.n)(i);return[4,n(zt({url:Object(z.e)(i),driveUrl:o,qosName:"commands",endpoint:s}))];case 1:u=l.sent();(a=new le.e).resolveItems({items:(f={},f[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},qt.e.pack(u.addToOneDrive)),qt.t.pack(u.createFolder)),qt.n.pack(u.createLink)),qt.r.pack(u.delete)),qt.i.pack(u.download)),qt.s.pack(u.invite)),qt.o.pack(u.move)),qt.u.pack(u.officeLens)),qt.a.pack(u.rename)),qt.f.pack(u.upload)),f)});n(a.execute());return[2]}})})}});function zt(e){var t=this;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var Wt=n(2968),Xt=n(367),Vt=n(590),$t=n(878),Jt=n(328),Kt=Object(a.t)()(function(){return function(e){return Qt}});function Qt(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(ut.e,i);if(n&&s){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===Jt.o.key)o.push("photo");else if(f.key===Jt.u.key)o.push("video");else if(f.key===Jt.e.key)o.push("folder");else if(f.key===Jt.s.key)o.push("onenote");else if(f.key===Jt.r.key)o.push("!photo");else if(f.key===Jt.i.key)o.push("!video");else if(f.key===Jt.t.key)o.push("!folder");else if(f.key===Jt.n.key)o.push("!onenote");else{var l=Object($t.e)(f);l&&o.push(l)}}return{itemKey:ut.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{filters:o}))}}return{}}var Gt=n(411),Yt=n(958),Zt=n(252),en=Object(a.t)()(nn),tn=Object(a.t)()(nn);function nn(){return function(e){return function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(ut.e,n);if(r&&r.filters&&Object(je.e)({extFilters:Object(je.t)(r.filters),allowedMediaTypes:[Pe.e.photo,Pe.e.video],fileTypeIconMap:dt.e}))return{defaultLayout:Zt.e,isLayoutResolved:!0}}return{}}}}var rn=n(272),sn=new J.e("sharesItem",{endpoint:Object(J.s)(),shareId:Object(J.s)()}),on=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=sn.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return[4,e(Object(W.n)({url:Object(z.r)(i)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:s,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:t=d.sent();o=new le.e;u=t&&t.parentReference;a=u&&u.driveId;f={endpoint:s,driveId:a,itemId:t.id};l=U.e.serialize(f);c=u&&u.id?U.e.serialize({endpoint:s,driveId:a,itemId:u.id}):void 0;o.resolveItems({items:(h={},h[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(X.e)({driveItem:t,endpoint:s,parentFolderItemKey:c})),ce.i.pack(U.e)),D.t.pack({itemKey:fe.e.serialize({driveItemKey:f,sortBy:"",isAscending:!0})})),h)});o.mapKeys({mappings:(p={},p[l]=n,p)});e(o.execute());return[2]}})})}});var un=n(1057),an=new J.e("driveItemVirtualizedPage",{endpoint:Object(J.s)(),setItemKey:Object(J.s)(),skip:Object(J.i)(),top:Object(J.i)()}),fn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=an.deserialize(n),s=i.setItemKey,o=i.top,u=i.skip;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,n(Pt(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:s,skip:u,top:o})))];case 1:t=i.sent();n(t.execute());return[2]}})})}});var ln=n(148),cn=Object(ln.e)(function(){return Promise.resolve().then(n.bind(null,3652))},{chunkName:"graphaddondeferred"}),hn=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(jt.e)(function(){e(Object(q.t)({keyFacet:U.e,facets:[U.e,F.l,F.p,F.d,F.L,F.a,D.t,F.A,F.i,F.c,I.n]}));e(Object(q.t)({keyFacet:pe,facets:[pe,D.e,D.r]}));e(Object(q.t)({keyFacet:Se.e,facets:[Se.e,F.l,F.p,F.d,F.L,F.i,F.a,D.t,F.A,I.n]}));e(Object(q.t)({keyFacet:o.e,facets:[o.e,D.e]}));e(Object(q.t)({keyFacet:rt,facets:[rt,F.l,F.p,F.d,F.L,F.i,F.a,D.t,F.A,I.n]}));e(Object(q.t)({keyFacet:it,facets:[it,D.e]}));e(Object(q.t)({keyFacet:at.e,facets:[at.e,F.l,F.p,F.d,F.L,F.a,D.t,F.A,I.n]}));e(Object(q.t)({keyFacet:ut.e,facets:[ut.e,D.e]}));e(Object(q.t)({keyFacet:ct.e,facets:[ct.e,F.l,F.p,F.d,F.L,F.a,D.t,F.A]}));e(Object(q.t)({keyFacet:Rt.e,facets:[qt.e,qt.t,qt.n,qt.r,qt.i,qt.s,qt.o,qt.u,qt.a,qt.f]}));e(Ft);e(Object(s.o)(U.e,R.e)(Z));e(Object(s.o)(an,R.e)(fn));e(Object(s.o)(ee.e,R.e)(oe));e(Object(s.o)(ae,R.e)(he));e(Object(s.o)(sn,R.e)(on));e(Object(s.o)(pe,R.e)(Ee));e(Object(s.o)(Se.e,R.e)(Te));e(Object(s.o)(o.e,R.e)(nt));e(Object(s.o)(rt,R.e)(st));e(Object(s.o)(it,R.e)(ot));e(Object(s.o)(at.e,R.e)(ft));e(Object(s.o)(ct.e,R.e)(ht));e(Object(s.o)(ut.e,R.e)(xt));e(Object(s.o)(lt.e,R.e)(Ct));e(Object(s.o)(Ot.e,R.e)(_t));e(Object(q.t)({keyFacet:Tt.e,facets:[F.b]}));e(Object(s.o)(Tt.e,R.e)(At));e(Object(s.o)(It.e,R.e)(kt.e));e(Object(s.o)(Rt.e,R.e)(Ut));e(Object(a.r)(U.e,Xt.e)(Wt.t));e(Object(a.r)(ut.e,Vt.e)(Kt));e(Object(a.r)(ut.e,Gt.e)(en));e(Object(a.r)(ut.e,Yt.e)(tn));e(un.e)}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,cn()];case 3:if(!(t=r.sent().graphAddonDataOnlyDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(rn.e)({error:n}));return[3,5];case 5:return[2]}})})}}),pn=n(1084),dn=n(75),vn=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(ge.v,b.n),i=Object(dn.e)(e);return e.demandItemFacet(o.e,i)&&!r?{isAvailable:!1}:"personal"!==e.demandItemFacet(Dt.e,n)?{hoverCard:pn.e}:{}}}});var mn=n(2630),gn=new J.e("thumbnailToken",{endpoint:Object(J.s)(),driveId:Object(J.s)({shouldNormalizeToEmpty:!0})}),yn=n(2),bn=new yn.e("thumbnailAccessToken"),wn=n(298),En=Object(a.t)()(function(){return function(e){return Sn}});function Sn(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(U.e,n);if(!i)return{};var s=e.demandItemFacet(Et.e,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,i=(function(e){return e&&(t=e,t&&"number"==typeof t.length)?e[0]:e;var t})(e.demandItemFacet(mn.e,n));if(i&&i.large)return{url:Nn(i.large.url,r),width:0,height:0}})(e,{itemKey:n,driveItem:i,desiredSize:r}):(function(e,t){var n=t.itemKey,r=t.driveItem,i=t.desiredSize;if(r.endpoint.indexOf("/_api/v2.")>-1){var s=e.demandItemFacet(F.i,n),o=e.demandItemFacet(F.c,n,{suppressGetItems:!0})||"";if(s){var u=new Q.e(r.endpoint).authority+"/_api/v2.1",a=gn.serialize({endpoint:u,driveId:r.driveId}),f=e.demandItemFacet(bn,a);if(f){var l=Object(z.t)({endpoint:u,driveId:r.driveId,itemId:r.itemId}),c=Math.ceil(i.width),h=Math.ceil(i.height);return{url:l+"/thumbnails/0/c"+c+"x"+h+"/content?"+Object(wn.e)({prefer:"noredirect,closestavailablesize",cb:o,access_token:f}),width:0,height:0}}}}})(e,{itemKey:n,driveItem:i,desiredSize:r});return s?{thumbnail:s}:{}}var xn=/width=[0-9]*/,Tn=/height=[0-9]*/;function Nn(e,t){var n="number"==typeof t.width?Math.ceil(t.width):t.width,r="number"==typeof t.height?Math.ceil(t.height):t.height,i=""+(n||"");xn.test(e)?e=e.replace(xn,"width="+i):e+=(e.indexOf("?")>-1?"&":"?")+"width="+i;var s=""+(r||"");Tn.test(e)?e=e.replace(Tn,"height="+s):e+=(e.indexOf("?")>-1?"&":"?")+"height="+s;return e}var Cn=n(374),kn=n(872),Ln=n(737),An=Object(a.t)()(function(){return function(){return function(e,t){var n=t.setItemKey,r=e.demandItemFacet(fe.e,n);if(!n||!r)return{};var i=r.driveItemKey.endpoint,s=U.e.serialize(r.driveItemKey),o=e.demandItemFacet(Dt.e,s),u=e.demandItemFacet(ge.r,b.n)||$.t,a=e.demandItemFacet(ge.m,b.n);if(a&&a(i,o)){return{totalItemCount:e.demandItemFacet(Ae.e,s),getPageKey:function(e,t){return an.serialize({setItemKey:n,endpoint:r.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:u}}return{}}}});var On=n(372),Mn=n(759),_n=n(698),Dn=n(797),Pn=n(740),Hn=Object(a.t)()(function(){return function(e){return jn}});var Bn=[l.e,On.e,Mn.e,Pn.e,_n.e,Dn.e];function jn(e,t){return{columns:Bn}}var Fn=n(538),In=Object(i.t)(function(){return function(e){e(Object(a.r)(U.e,Fn.e)(Object(a.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(u.o)())];case 1:t.sent();return[4,n.e("539").then(n.bind(null,3394))];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})})))}}),qn=n(258),Rn=n(51),Un=Object(a.t)()(function(){return function(e){return zn}});function zn(e,t){return(function(e,t,n){var i=n.itemSetKey,s=n.handler,o=s.columnKey,u=s.isAscending,a=e.demandItemFacet(t,i);if(!a)return{};var f=e.demandItemFacet(Dt.e,U.e.serialize(Object(r.__assign)({},a.driveItemKey)));if(!f||"business"===f||"documentLibrary"===f)return{};if(!a.sortBy&&o===On.e.key&&!0===u)return{newItemSetKey:i};var l=Object(Rn.e)(e,{customColumnKeysToFieldNamesConfiguration:ge.n}).customColumnKeysToFieldNamesConfiguration,h=Object(r.__assign)(Object(r.__assign)({},c.t),l),p=h?h[o]:void 0;if(!p)return{};return{newItemSetKey:t.serialize(Object(r.__assign)(Object(r.__assign)({},a),{sortBy:p,isAscending:u}))}})(e,fe.e,t)}var Wn=n(421),Xn=Object(a.t)()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}});var Vn=n(2104),$n=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=gn.deserialize(n),s=i.endpoint,o=i.driveId;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=Object(z.n)({endpoint:s,driveId:o});return[4,e(Object(Vn.e)(s,t))];case 1:i=l.sent();u=i&&i.accessToken;(a=new le.e).resolveItems({items:(f={},f[n]=Object(r.__assign)({},bn.pack(u)),f)});e(a.execute());return[2]}})})}});var Jn=n(8),Kn=n(279),Qn=n(2633),Gn=Object(a.t)()(function(){return function(e){return function(e,t){return{fileTypeIconAs:Yn}}}});var Yn=Object(Jn.i)(function(e,t){var n=t.defaultRender,i=Object(r.__rest)(t,["defaultRender"]),s=i.isFolder,o=i.itemKey,u=i.type,a=u;if(s&&void 0===u){var f=e.demandItemFacet(Qn.e,o);void 0!==f&&("desktop"===f?a=Kn.e.desktopFolder:"documents"===f?a=Kn.e.documentsFolder:"pictures"===f&&(a=Kn.e.picturesFolder))}return n?C.createElement(n,Object(r.__assign)({},i,{type:a})):null}),Zn=n(525),er=n(2047),tr=n(176),nr=Object(a.t)()(function(){return function(e){return function(e,t){return{folderCoverControlHandler:function(t,n){var r=n.signalData;if(r&&r.signal)return{};var i=e.demandItem({specialFolder:Qn.e},n.itemKey).specialFolder;if(!i)return{};var s=(function(e){var t=null;"desktop"===e?t=C.createElement(tr.r,null):"documents"===e?t=C.createElement(tr.i,null):"pictures"===e&&(t=C.createElement(tr.h,null));return{signal:t,key:e||""}})(i);return s&&s.signal?{signalData:s}:{}}}}}});var rr=n(845),ir=n(357),sr=n(1275),or=n(2447),ur=n(2635),ar="iconContainer_1d84ea90",fr="menuItemIconContainer_1d84ea90",lr="logoFillIcon_1d84ea90",cr="logoIcon_1d84ea90",hr=n(16),pr=n(1222),dr=n(30),vr=n(48),mr=new(n(9).e)("openInOfficeOnlineActionControl"),gr=Object(Jn.t)(function(e,t){var n=t.itemKey,i=e.demandItem({openUrl:F.L,appFacet:or.e,isMalwareDetected:F.N},n),s=i.openUrl,o=i.appFacet,u=i.isMalwareDetected,a=e.dispatch,f=!u&&!!o&&!!s,l=e.demandItemFacet(mr,n);return Object(r.__assign)({isAvailable:f,onExecute:s?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){e=(new Date).getTime().toString();t=pr.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",s);a(Object(Le.e)(function(e){return mr.evaluate(l)(e,{itemKey:n,forceInSameWindow:!1})})).forceInSameWindow?window.location.href=t:window.open(t);return[2]})})}:void 0},Object(vr.e)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(dr.e),yr=Object(hr.s)()(Object(hr.r)()(gr)),br={key:new yn.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:C.createElement(yr,null),facets:Object(r.__assign)({},ir.e.pack(!0))},wr=new yn.e("fileHandlerOpenCommand").id,Er=(Object(hr.s)()(Object(hr.r)()(Object(Jn.t)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:or.e},n).appMap,s=r.name;r.key===br.key&&(s=s||(i?Object(ur.r)(i,!0):ur.e.OpenInBrowser));return{name:s}})(function(e){return C.createElement("div",{className:"contextualMenuItemLinkContent_1d84ea90"},C.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_1d84ea90"},e.name))}))),Object(hr.s)()(Object(hr.r)()(Object(Jn.t)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:or.e,fileName:F.h},n),o=s.appMap,u=s.fileName,a={};if(i&&i.items){var f=i.items[0];f&&-1!==f.key.indexOf(wr)&&f.iconProps&&(a=f.iconProps)}var l=!!u&&!!u.extension&&".pdf"===u.extension.toLowerCase(),c=o&&Object(ur.n)(o),h={iconName:o?Object(ur.t)(o):l?"PDF":"OpenFile"},p=void 0;i&&i.items&&(p=i.items.map(function(e){return e.key===br.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(ur.r)(o,!0)||(l?ur.e.OpenInBrowser:ur.e.Open),onRenderIcon:c?Sr.bind(void 0,c,!0):void 0}):e}));return{iconProps:a||h,onRenderIcon:c?Sr.bind(void 0,c,!1):void 0,text:ur.e.Open,menuProps:p?Object(r.__assign)(Object(r.__assign)({},i),{items:p}):i}})(sr.e))));function Sr(e,t){return e?C.createElement("span",{className:t?fr:ar},C.createElement(L.e,{iconName:e.logoFill16,className:lr}),C.createElement(L.e,{iconName:e.logo16,className:cr})):null}var xr={key:rr.e.key,automationId:rr.e.automationId,subMenuProps:{items:[br]},onRender:function(e){return C.createElement(Er,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},ir.e.pack(!0))},Tr=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.commands,i=t.overflowCommands,s=t.farCommands,o=i?Object(r.__spreadArrays)(i):[],u=n?Object(r.__spreadArrays)(n):[],a=s;return{commands:u=Nr(e,{defaultCommands:u}).overrideDefaultCommands,overflowCommands:o,farCommands:a}}}});function Nr(e,t){for(var n=[],r=0,i=t.defaultCommands;r<i.length;r++){var s=i[r];s.key===rr.e.key?n.push(xr):n.push(s)}return{overrideDefaultCommands:n}}var Cr=n(326),kr=n(409),Lr=n(1071),Ar=n(24),Or=n(379),Mr={key:new yn.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:F.L,appMap:or.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?C.createElement(Or.e,{itemKey:n,action:Object(Ar.i)(e,C.createElement(gr,{itemKey:n}))}):void 0}}},_r=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.handlers,i=void 0===n?[]:n;return{handlers:Object(r.__spreadArrays)([Lr.e,Mr],i)}}}});var Dr=n(147),Pr=n(269),Hr=Object(m.i)({key:new yn.e("dateAccessedColumn").id,name:Dr.e.AccessedDate,fieldName:"",minWidth:m.e.regularMin,maxWidth:m.e.regularMax,isCollapsable:!0},y.e)(function(e,t){var n=e.demandItemFacet(F.s,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(b.S,b.n),s=i&&i.language||window.navigator.language;return s?{text:Object(Pr.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(F.s,t)}),Br=Object(a.t)()(function(){return function(e){return Fr}});var jr=[h,p.e,Hr];function Fr(e,t){return{columns:jr}}var Ir=n(403),qr=Object(a.t)()(function(){return function(e){return Ur}});var Rr=[rr.e,Ir.n,Ir.t];function Ur(e,t){return{commands:Nr(0,{defaultCommands:Rr}).overrideDefaultCommands}}var zr=Object(a.t)()(function(){return function(e){return Xr}});var Wr=[rr.e,Ir.n,Ir.t];function Xr(e,t){return{commands:Wr}}var Vr=n(853),$r=Object(i.t)(function(){return function(e){e(Object(a.r)(ut.e,f.e)(Br));e(Object(a.r)(at.e,Cr.e)(qr));e(Object(a.r)(at.e,Vr.e)(zr))}}),Jr=n(869),Kr=Object(m.i)({key:new yn.e("dateFollowedColumn").id,name:Dr.e.SavedDate,fieldName:"",minWidth:m.e.regularMin,maxWidth:m.e.regularMax,isCollapsable:!0},y.e)(function(e,t){var n=e.demandItemFacet(F.u,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(b.S,b.n),s=i&&i.language||window.navigator.language;return s?{text:Object(Pr.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(F.u,t)}),Qr=n(1008),Gr=Object(a.t)()(function(){return function(e){return Zr}});var Yr=[h,p.e,Kr,Qr.e];function Zr(e,t){return{columns:Yr}}var ei=n(313),ti=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?C.createElement("div",{className:"root_09895c92"},this.props.group.name):null};return t})(C.PureComponent),ni=n(1271),ri=n(319),ii=n(474),si=n(315),oi=n(597);function ui(e,t){var n=t.signals;if(n){var i=Object(si.t)(n,function(e){return e.key===oi.n});if(i&&i.index>-1){var s=i.index;return{signals:Object(r.__spreadArrays)(n.slice(0,s),n.slice(s+1))}}}return{}}var ai=Object(a.t)()(function(){return function(e){return li}});var fi=function(e){var t=e.defaultRender,n=Object(r.__assign)({},ii.e.pack(ui));return t?C.createElement(ri.e,{controlHandlers:n},C.createElement(t,Object(r.__assign)({},e))):null};function li(){return{groupHeaderRenderer:ti,rowRenderer:fi,groupProps:{collapseAllVisibility:ni.e.hidden}}}var ci=Object(a.t)()(function(){return function(e){return di}});function hi(e,t){var n=t.itemKey,r=e.demandItemFacet(F.u,n,{suppressGetItems:!0}),i=r&&new Date(r).getTime();if("number"==typeof i&&!isNaN(i)){var s=e.demandItemFacet(b.S,b.n),o=s&&s.language||window.navigator.language,u=Object(Pr.n)(new Date(i),o);return{itemActivity:u&&C.createElement(y.e,{text:u})||null}}return{}}var pi=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]),i=Object(r.__assign)(Object(r.__assign)({},ii.e.pack(ui)),er.e.pack(hi));return t?C.createElement(ri.e,{controlHandlers:i},C.createElement(t,Object(r.__assign)({},n))):null};return t})(C.PureComponent);function di(){return{tileRenderer:pi}}var vi=n(377),mi=n(3368),gi=Object(a.t)()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:mi.e.savedForLaterEmptyStateTitle}}}});var yi=Object(i.t)(function(){return function(e){e(Object(a.r)(lt.e,ei.e)(ai));e(Object(a.r)(lt.e,Jr.e)(ci));e(Object(a.r)(lt.e,f.e)(Gr));e(Object(a.r)(lt.e,vi.e)(gi));e(Object(a.r)(ct.e,Cr.e)(Tr))}});n.d(t,"graphAddon",function(){return wi});var bi=Object(ln.e)(function(){return Promise.resolve().then(n.bind(null,3897))},{chunkName:"graphaddondeferred"}),wi=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(jt.e)(function(){e(hn);e(Object(a.r)(fe.e,f.e)(Hn));e(Object(a.r)(fe.e,qn.e)(Un));e(Object(a.r)(o.e,f.e)(H));e(Object(a.r)(U.e,Cn.e)(vn));e(Object(a.r)(fe.e,Ln.e)(An));e(Object(a.r)(U.e,Wn.e)(Xn));e(Object(s.o)(gn,R.e)($n));e(Object(a.r)(U.e,kn.e)(En));e(Object(a.r)(U.e,Zn.e)(Gn));e(Object(a.r)(ae,Zn.e)(Gn));e(Object(a.r)(U.e,er.e)(nr));e(Object(a.r)(ae,er.e)(nr));e(Object(a.r)(U.e,kr.e)(_r));e(Object(a.r)(at.e,Cr.e)(Tr));e(In);e($r);e(yi)}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,bi()];case 3:if(!(t=r.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(rn.e)({error:n}));return[3,5];case 5:return[2]}})})}})},,,,function(e,t,n){"use strict";n.r(t);var r,i,s=n(0),o=n(22),u=n(71),a=n(11),f=n(410),l=new(n(9).e)("itemsBreadcrumbControl"),c=n(367),h=n(326),p=n(853),d=n(774),v=n(79),m=n(1011),g=n(1042),y=n(1043),b=n(1049),w=n(111),E=n(80),S=n(778),x=n(1010),T=n(781),N=n(3651),C=n(1029),k=n(178),L=n(3),A=n(2548),O=n(522),M=n(2988),_=n(3240),D=n(2870),P=n(1),H=n(2),B=n(302),j=n(2637),F=n(35),I=n(2181),q=n(6),R=n(26),U=n(208),z=n(2287),W=n(23),X=n(511),V=n(25),$=n(119),J=n(76),K=n(2544),Q=n(12),G=n(2649),Y=((r={})[J.r.started]=function(e){var t=e.count,n=e.isScheduled;return Object(V.formatToArray)(Object(V.getLocalizedCountValue)(n?G.e.schedulePublishStartedItemsTitle:G.e.publishStartedItemsTitle,G.e.publishCompletedItemsTitleIntervals,t)||"",t)},r[J.r.completed]=function(e){var t=e.count,n=e.isScheduled;return Object(V.formatToArray)(Object(V.getLocalizedCountValue)(n?G.e.schedulePublishCompletedItemsTitle:G.e.publishCompletedItemsTitle,G.e.publishCompletedItemsTitleIntervals,t)||"",t)},r[J.r.failed]=function(e){var t=e.count,n=e.isScheduled;return Object(V.formatToArray)(Object(V.getLocalizedCountValue)(n?G.e.schedulePublishFailedItemsTitle:G.e.publishFailedItemsTitle,G.e.publishFailedItemsTitleIntervals,t)||"",t)},r[J.r.canceled]=function(e){var t=e.count,n=e.isScheduled;return Object(V.formatToArray)(Object(V.getLocalizedCountValue)(n?G.e.schedulePublishFailedItemsTitle:G.e.publishFailedItemsTitle,G.e.publishFailedItemsTitleIntervals,t)||"",t)},r),Z=((i={})[J.r.started]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(V.formatToArray)(Object(V.getLocalizedCountValue)(r?G.e.schedulePublishStartedItemsTitle:G.e.publishStartedItemsTitle,G.e.publishStartedItemsDestinationTitleIntervals,t)||"",t,P.createElement(K.e,{key:"link",itemKey:n}))},i[J.r.completed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(V.formatToArray)(Object(V.getLocalizedCountValue)(r?G.e.schedulePublishCompletedItemsDestinationTitle:G.e.publishCompletedItemsDestinationTitle,G.e.publishCompletedItemsDestinationTitleIntervals,t)||"",t,P.createElement(K.e,{key:"link",itemKey:n}))},i[J.r.failed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(V.formatToArray)(Object(V.getLocalizedCountValue)(r?G.e.schedulePublishFailedItemsDestinationTitle:G.e.publishFailedItemsDestinationTitle,G.e.publishFailedItemsDestinationTitleIntervals,t)||"",t,P.createElement(K.e,{key:"link",itemKey:n}))},i[J.r.canceled]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(V.formatToArray)(Object(V.getLocalizedCountValue)(r?G.e.schedulePublishFailedItemsDestinationTitle:G.e.publishFailedItemsDestinationTitle,G.e.publishFailedItemsDestinationTitleIntervals,t)||"",t,P.createElement(K.e,{key:"link",itemKey:n}))},i),ee=Object(o.t)(function(){return function(e){e(Object(a.r)(j.e,X.e)(Object(a.t)()(te)))}});function te(){return function(e){return ne}}function ne(e,t){var n,r,i=Object($.i)(e,t),o=i.phase,u=i.count,a=(function(e,t){var n=void 0,r=e.demandItemFacet(Q.e,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(J.g,o),a=u&&u.itemKey,f=e.demandItemFacet(q.A,a),l=f&&f.itemKey;if(l)if(n){if(l!==n)break}else n=l}return n})(e,t),f=e.demandItemFacet(Q.e,t.itemKey),l=f&&f.itemKeys;l&&l.length>0&&(r=e.demandItemFacet(j.t,l[0]));var c=!!r&&r.publishActionType===I.e.SchedulePublish;n="group"===t.format&&a?Z[o]({count:u,itemKey:a,isScheduled:c}):Y[o]({count:u,isScheduled:c});return Object(s.__assign)(Object(s.__assign)({},n&&"item"!==t.format?{title:n}:{}),{})}var re=n(15),ie=n(1884),se=n(317),oe=re.e.isActivated("991d2b61-3537-434c-8a72-45623f632435","1/13/2020","Use progress addon for publish")?Object($.s)({operationTypeFacet:j.t,progressKeyFacet:j.e}):Object($.s)({operationTypeFacet:j.t,progressKeyFacet:j.e,initializeBatch:function(){return ee}}),ue=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={publishItemError:void 0};return n}t.prototype.componentDidMount=function(){var e=this.props,t=e.itemCacheDispatch,n=e.itemKeys,r=e.itemSetKey,i=e.resolve,s=e.reject,o=n[0],u=t(Object(R.e)(function(e){return e.demandItem({firstItemKey:v.e,displayName:q.l},n[0])})),a=u.firstItemKey,f=u.displayName,l=t(Object(R.e)(function(e){return z.n(e,o)})),c={publishActionType:l},h=!1;if(a){var p=t(Object(R.e)(function(e){return e.demandItemFacet(L.we,w.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}))}));h=!!p&&p.templateType===W.t.webPageLibrary}if(a&&h&&l===I.e.SubmitForApproval){var d=re.e.isActivated("bb2acf46-d145-4ac4-9aed-542d0b2c2e0b","6/2/2020","FixPageUrlInLibSubFolder2"),m=d?"":new se.e(a.webAbsoluteUrl).authority,g=d?"":t(Object(R.e)(function(e){return e.demandItemFacet(L.G,n[0])})),y=d?a.listFullUrl+"/"+f:""+m+g;window.location.href=y}else t(oe({items:Object(F.e)(n,function(){return c})})).then(function(){var e,s;t(Object(U.t)({items:(e={},e[o]=[L.Rt],e[o]=[L.De],e)}));r&&t(Object(ie.e)({items:(s={},s[r]=Object(F.e)(n,function(){return{}}),s)}));i()}).catch(function(e){s(e)})};t.prototype.render=function(){return null};return t})(P.PureComponent),ae=n(16),fe=n(8),le=n(167),ce=n(48),he=n(2258),pe=n(24),de=n(30),ve=n(75),me=n(390),ge=n(920),ye=Object(fe.t)()(ue),be=Object(fe.t)(function(e,t){var n=t.onCancel,r=t.reject;return{onCancel:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){r(new le.e);n&&n();return[2]})})},title:G.e.MissingMetadataDialogTitle,prompt:G.e.MissingMetadataDialogText,cancelText:G.e.MissingMetadataDialogButton}})(he.e),we=Object(fe.i)(function(e,t){var n,r=t.itemKeys,i=t.publishType,o=t.source;if(!r||!r.length)return null;var u=Object(ve.e)(e),a=e.demandItem({firstItemKey:v.e,hasMissingMetadata:q.C,contentTypeId:L.c},r[0]),f=a.firstItemKey,l=a.hasMissingMetadata,c=a.contentTypeId;if(!f)return null;var h=f&&e.demandItemFacet(L.Mt,me.e.serialize({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}));if(h&&(h.isAnonymousGuestUser||h.isEmailAuthenticationGuestUser))return null;var p=!1,d=!!h&&Object(re.t)(h).isActivated("f307ef95-b7d3-4b5a-af39-d71f6f4eaaf1","06/09/2020","Dont show submit for approval button when multiple items are selected"),m=z.n(e,r[0]);if(!(!d&&r.length>1&&((null===(n=h)||void 0===n?void 0:n.listBaseTemplate)!==W.n.webPageLibrary||!(m===I.e.Publish||m===I.e.Republish||m===I.e.PostNews||m===I.e.UpdateNews))))for(var g=0,y=r;g<y.length;g++){var b=y[g];if(!(p=!!z.e(e,b)&&(!(!d&&r.length>1&&!z.i(c))&&(ge.t(e,b)?1===i:0===i))))break}var w=Object(pe.o)(function(e){if(l){return P.createElement(be,Object(s.__assign)({},e,{onCancel:function(e){}}))}return P.createElement(ye,Object(s.__assign)({},e,{itemKeys:r,itemSetKey:u}))});return P.createElement(de.e,Object(s.__assign)({isAvailable:p,onExecute:w},Object(ce.e)(e,{itemKey:r[0],engagement:{name:"PublishItem",isIntentional:!0,extraData:{publishSource:o}}})))}),Ee=Object(ae.s)()(we),Se=n(247),xe=new H.e("Publish").id,Te=new H.e("Schedule").id,Ne=new Map([[I.e.Publish,B.e.Publish],[I.e.CancelApproval,B.e.CancelApproval],[I.e.SubmitForApproval,B.e.SubmitForApproval],[I.e.SchedulePublish,B.e.Schedule],[I.e.Republish,B.e.Republish]]),Ce=(function(e){Object(s.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=e.itemKeys,r=Object(s.__rest)(e,["defaultRender","itemKeys"]),i=n[0];return P.createElement(Se.e,null,function(e){var n=e.itemCache,o=Object(z.n)(n,i),u=Ne.get(o)||B.e.Publish;return t?P.createElement(t,Object(s.__assign)({},r,{text:u})):null})};return t})(P.PureComponent),ke={key:xe,automationId:"PublishCommand",iconProps:{iconName:"ReadingMode"},name:B.e.Publish,action:P.createElement(Ee,{publishType:0,source:"Command"}),commandBarButtonAs:Object(ae.s)()(Ce)},Le={key:Te,automationId:"ScheduleCommand",iconProps:{iconName:"DateTime2"},name:B.e.Schedule,action:P.createElement(Ee,{publishType:1,source:"Command"}),commandBarButtonAs:Object(ae.s)()(Ce)},Ae=n(2644),Oe=n(611),Me=n(526),_e=n(760),De=n(93),Pe=n(211),He=n(515),Be=n(201),je=n(779),Fe=n(1044),Ie=n(432),qe=n(274),Re=n(1016),Ue=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2]})})},ze=Object(ae.e)()(Object(ae.s)()(Object(fe.t)(function(e,t){var n,r,i,o=t.itemKey,u=t.itemKeys,a=t.enabledForMultipleItems,f=void 0===a?t.enabledForMultipleItems||!1:a,l=t.isEnabledFunc,c=t.url,h=!!f||1===u.length,p=void 0,d=void 0;if(h&&u[0]){var m=e.demandItem({key:v.e,permissions:L.ze,rowData:L.rt},u[0])||void 0;if(m){d=m.key;p=m.rowData;i=m.permissions}}else if(h&&o){var g=e.demandItem({key:v.e,permissions:L.ze},o);if(g){d=g.key;i=g.permissions}}n=d&&d.webAbsoluteUrl;r=d&&d.listFullUrl;var y=n&&r&&e.demandItemFacet(L.Mt,me.e.serialize({webAbsoluteUrl:n,listFullUrl:r}))||void 0;if(h&&!f)if("boolean"==typeof l)h=l;else if("function"==typeof l){var b="",w="",E="";if(p){var S=p;b=S.File_x0020_Type||"";w=S.ContentTypeId||"";E=S.ProgId||""}else h=!1;h=l({permissions:i||0,extension:b,contentTypeId:w,progId:E})}if(h&&c){var x=[];u.forEach(function(t){var n=e.demandItem({itemId:L.Se,itemUrl:L.G},t);n&&x.push({id:n.itemId||"",url:n.itemUrl||""})});y&&(c=Object(qe.r)(c,x,y))}var T=Ue;T=c&&"javascript:LaunchApp("===c.substring(0,21)&&");"===c.substring(c.length-2)?function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){c&&y&&Object(Re.e)(c,y);return[2]})})}:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(t){(e=window.open(c,"_blank"))&&e.focus();return[2]})})};return Object(s.__assign)({isAvailable:h,onExecute:T},Object(ce.e)(e,{itemKey:u[0],engagement:{name:"CustomActionNavigation",isIntentional:!0}}))})(de.e))),We=n(88),Xe=n(50),Ve=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2]})})},$e=Object(fe.i)(function(e,t){var n=t.itemKeys,r=t.enabledForMultipleItems,i=void 0===r?t.enabledForMultipleItems||!1:r,o=t.isEnabledFunc,u=t.commandAdapter,a=e.dispatch,f=!!i||1===n.length;if(f&&1===n.length&&"function"==typeof o){var l=e.demandItem({key:v.e,permissions:L.ze,rowData:L.rt},n[0]),c="",h="",p="";if(l&&l.rowData){var d=l.rowData;c=d.File_x0020_Type||"";h=d.ContentTypeId||"";p=d.ProgId||""}else f=!1;f=f&&o({permissions:l&&l.permissions||0,extension:c,contentTypeId:h,progId:p})}if(f&&u){var m=[];n.forEach(function(t){var n=e.demandItemFacet(Be.u,t);n&&m.push(n)});u.refresh(m);f=f&&u.visible}var g=Ve;u&&(g=function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2,u.execute()]})})});var y=!re.e.isActivated("416CBFAD-51CE-4EFF-8231-D4EFCAC3DB3C","12/13/2019","Generate rowAdapter if not available");return P.createElement(P.Fragment,null,y?P.createElement(Je,{dispatch:a,itemKeys:n}):null,P.createElement(de.e,Object(s.__assign)({isAvailable:f,onExecute:g},Object(ce.e)(e,{itemKey:n[0],engagement:{name:"ClientSideCommandSet",isIntentional:!0}}))))}),Je=function(e){var t=e.dispatch,n=e.itemKeys;if(n.length<1)return null;var r=n[0],i=void 0;if(v.e.matches(r)){var o=v.e.deserialize(r);if(o){var u=w.e.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl});i=t(Object(We.e)({listViewAdapter:Be.o},u)).listViewAdapter}}var a={};if(i){n.forEach(function(e){var n=t(Object(We.e)({rowData:L.rt,rowAdapter:Be.u},e)),r=n.rowData;if(!n.rowAdapter&&r&&i){var o=i.createRowAdapter({values:r});o&&(a[e]=Object(s.__assign)({},Be.u.pack(o)))}});Object.keys(a).length>0&&t(Object(Xe.e)({items:a}))}return null},Ke=Object(ae.s)()($e),Qe=n(749),Ge=n(99),Ye="customActionCommandIcon_9e2eb146",Ze=n(63),et=new H.e("customActionNavigationCommand").id;function tt(e){var t=e.key,n=e.name,r=e.url,i=e.iconUrl,s=e.enabledForMultipleItems,o=e.isEnabledFunc,u=e.commandAdapter;return{key:et+"-"+t,automationId:"customactionNavigation",name:n,iconProps:{iconType:Qe.e.image,className:Ye,imageProps:{src:i||"",imageFit:Ge.t.contain,className:Ye}},action:u?P.createElement(Ke,{enabledForMultipleItems:s,isEnabledFunc:o,commandAdapter:u}):r?P.createElement(ze,{url:r,enabledForMultipleItems:s,isEnabledFunc:o}):void 0}}var nt=new H.e("customActionGroupCommand").id;function rt(e,t){var n=[],r=e.demandItemFacet(Q.e,t);r&&r.itemKeys&&r.itemKeys.forEach(function(t){var r,i,s,o,u=e.demandItem({displayName:q.l,openUrl:q.L,iconUrl:Ie.t,childItemKeys:Q.e,enabledForMultipleItems:Ie.e,isEnabledFunc:Ie.n,commandAdapter:Be.i},t);if(u&&u.displayName){var a=u.displayName,f=u.openUrl,l=u.iconUrl,c=u.enabledForMultipleItems,h=u.isEnabledFunc,p=u.childItemKeys,d=u.commandAdapter;if(p&&p.itemKeys&&p.itemKeys.length>0){var v=[];p.itemKeys.forEach(function(n,r,i){var s=e.demandItem({subMenuDisplayName:q.l,openUrl:q.L,iconUrl:Ie.t,enabledForMultipleItems:Ie.e,isEnabledFunc:Ie.n,commandAdapter:Be.i},n);s&&s.subMenuDisplayName&&v.push(tt({key:t+"-"+n,name:s&&s.subMenuDisplayName,url:s&&s.openUrl,iconUrl:s&&s.iconUrl,enabledForMultipleItems:s&&s.enabledForMultipleItems,isEnabledFunc:s&&s.isEnabledFunc,commandAdapter:s&&s.commandAdapter}))});n.push((i=(r={key:t,name:a,subCommands:v}).key,s=r.name,o=r.subCommands,{key:nt+"-"+i,automationId:"customActionGroupCommand",name:s,subMenuProps:{items:o}}))}else a&&n.push(tt({key:t,name:a,url:f,iconUrl:l,enabledForMultipleItems:c,isEnabledFunc:h,commandAdapter:d}))}});return n}function it(e){var t=e.keys,n=t.webAbsoluteUrl,r=t.listFullUrl,i=e.itemCache,s=e.targetCustomActionSetKey,o=void 0,u=w.e.serialize({webAbsoluteUrl:n,listFullUrl:r}),a=i.demandItemFacet(Be.s,u),f=i.demandItemFacet(L.et,s),l=!!a&&!!f,c=Object(Ze.e)(i).itemsScopeItemKey;if(l&&c){var h=Fe.e.serialize({webAbsoluteUrl:n,listFullUrl:r,isSPFXandCustomActionsAvailable:l,targetCustomActionSetKey:s,itemsScopeItemKey:c});i.demandItemFacet(Q.e,h)&&(o=h)}return o}var st=n(403),ot=n(592),ut=n(268),at=n(1243),ft=n(3664),lt=n(2257),ct=n(2872),ht="keyboardMapGroup_83c329c3",pt="keyboardMapTable_83c329c3",dt="keyboardMapRow_83c329c3",vt="keyboardMapKey_83c329c3",mt="keyboardMapVal_83c329c3",gt=n(2588),yt=n(265),bt=[{keys:"Ctrl + a",desc:ut.e.selectAllDesc},{keys:"Ctrl + d",desc:ut.e.deselectAllDesc},{keys:"esc",desc:ut.e.escDesc},{keys:"space",desc:ut.e.spaceDesc},{keys:"enter",desc:ut.e.enterDesc}],wt=[{keys:"F2",desc:ut.e.renameDesc},{keys:"Delete",desc:ut.e.deleteDesc},{keys:"s",desc:ut.e.showShareDesc},{keys:"alt + up",desc:ut.e.altUpDesc},{keys:"?",desc:ut.e.showKeymapDesc},{keys:"g",desc:ut.e.showActionDetailsDesc},{keys:"i",desc:ut.e.toggleInfoDesc}];function Et(e){var t=e.resolve,n=Object(yt.e)(function(){t()}),r=[bt,wt],i=-1,s=-1;return P.createElement(gt.e,null,P.createElement(ft.e,{onDismiss:n,hidden:!1,dialogContentProps:{type:lt.e.close,title:ut.e.KeyboardMapTitle},styles:xt},r.map(function(e){return P.createElement("div",{className:ht,key:"keyMap"+ ++i},P.createElement("ul",{className:pt,key:""+i},e.map(function(e){return P.createElement("li",{className:dt,key:""+ ++s},P.createElement("span",{className:vt,key:i+"."+s+".0.0"},e.keys),P.createElement("span",{className:mt,key:i+"."+s+".1.1"},e.desc))})))}),P.createElement(ct.e,null,P.createElement(at.e,{onClick:n},ut.e.okButtonText))))}var St=Object(fe.i)(function(e){var t=Object(pe.o)(Et);return P.createElement(de.e,{onExecute:t})});function xt(){return{main:{maxWidth:"700px !important"}}}var Tt={key:new H.e("ShowKeymapShortcut").id,automationId:"ShowKeymapShortcut",shortcutProps:{keySequences:["Shift/"],content:ut.e.showKeymapDesc},action:P.createElement(St,null)},Nt=n(2542),Ct=Object(fe.i)(function(e,t){return P.createElement(de.e,{onExecute:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})}),kt={key:new H.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:ut.e.getNPSSurveyFocusShortcut},action:P.createElement(Ct,{elementId:"obf-TPromptContainer"})},Lt=n(2375),At=n(952),Ot=n(3248),Mt=n(2991),_t=n(3279),Dt=n(58),Pt=n(264),Ht=n(51),Bt=n(47),jt=n(2987),Ft=n(453),It=n(184),qt={ODB:1544},Rt=[Ae.t,Ae.e,Ae.r],Ut=[Tt,Nt.e,kt],zt={ODB:1231},Wt="658D384B-C862-48CC-986B-F1CD32B00BFE",Xt="9cf4436a-b8a9-4b05-a921-e34436841ba3",Vt=Object(a.t)()(Qt),$t=Object(a.t)()(Qt),Jt=function(e,t){var n=Object(s.__rest)(M.e,[]);if(e&&e.open&&e.open.length>0){n.subMenuProps=n.subMenuProps||{};n.subMenuProps.items=Object(Lt.t)(n.subMenuProps&&n.subMenuProps.items||[],e.open,t);!re.e.isActivated("BC85A80B-0AA5-41F5-98B6-C875D1773EE5","12/9/2019","Log engagement for open menu for promoted file handler")&&e.open.some(function(e){return e.isPromoted||!1})&&(n.engagement={name:"OpenCommand",isIntentional:!0,extraData:{hasPromotedFileHandler:!0}})}return n};function Kt(e,t){var n,r,i=t.itemKey,o=t.itemSetKey,u=t.commands,a=t.overflowCommands,f=t.farCommands,l=t.shortcutCommands,c=e.demandItemFacet(v.e,i),h=e.demandItemFacet(E.e,o),p=a?Object(s.__spreadArrays)(a):[],d=!0,m=!1,g=void 0,y=void 0,b=void 0,S=u?Object(s.__spreadArrays)(u):[],x=f,T=[],N="",P=c&&w.e.serialize(c),H=e.demandItemFacet(w.e,P);h&&h.viewKey&&(N=h.viewKey.viewId);var B,j,F,I=[],q=!1;if(c&&H){q=Object(At.t)(e,i,c);var R=e.demandItemFacet(L.we,P);d=!!R&&!!R.isDocumentLibrary;B=Object(Bt.e)(e,i);if(d)T=l?Object(s.__spreadArrays)(l,Ut):Object(s.__spreadArrays)(Ut);else{S=Object(A.e)(B);T.push(kt)}if(!(m=!!R&&R.templateType===W.t.mySiteDocumentLibrary)){d&&p.push.apply(p,Rt);p&&p.push(Object(jt.e)({listFacets:R}));var U={webAbsoluteUrl:H.webAbsoluteUrl,listFullUrl:H.listFullUrl},z=C.e.serialize(U),X=e.demandItemFacet(Q.e,z);if(X&&X.itemKeys&&f){!N&&B&&B.viewId&&(N=De.e.normalizeLower(B.viewId,!1));r=e.demandItemFacet(L.He,P);x=(j=f,F=Object(_.e)(e,{viewKeys:X.itemKeys,webAbsoluteUrl:c.webAbsoluteUrl,listViewSetKey:U,itemSetKey:o,currentViewKey:k.e.serialize({viewId:N})}),j.map(function(e){return e.key===He.e.key?F:e}))}}R&&H&&(I=(n=Object(_t.e)(e,{key:c,listFacets:R,listKey:H,pageContext:B})).contentTypes,g=n.contentTypeCommands);y=(function(e,t){var n=t.webAbsoluteUrl,r=t.listFullUrl,i=je.e.serialize({webAbsoluteUrl:n,listFullUrl:r}),s=it({itemCache:e,targetCustomActionSetKey:i,keys:{webAbsoluteUrl:n,listFullUrl:r}}),o=rt(e,i);s&&(o=o.concat(rt(e,s)));return o})(e,c);B&&R&&(b=Object(Mt.e)(e,{isODB:m,key:c,listFacets:R,pageContext:B}).fileHandlerCommands)}var V=Object(Ht.e)(e,{enableQuickEdit:L.F}).enableQuickEdit,$=!!B&&!!V&&Object(Dt.e)(e,{feature:zt,pageContext:B});if($){var J=Object(Ze.e)(e).itemsScopeItemKey;if(Object(It.e)(e,{itemsScopeItemKey:J})===Pt.e)return{commands:[Object(_e.t)(B)],overflowCommands:[],farCommands:[],shortcutCommands:[]}}var K=(function(e,t){for(var n=t.quickEditEnabled,r=t.defaultCommands,i=t.isDocumentLibrary,s=t.isODB,o=t.contentTypeCommands,u=t.customActionCommands,a=t.fileHandlerCommands,f=t.newDocumentTemplates,l=t.contentTypes,c=t.isCreateFolderAvailable,h=t.listKey,p=t.pageContext,d=[],v=!re.e.isActivated(Wt,"7/5/2019","Show file handler commands before OOB commands"),m=!re.e.isActivated(Xt,"3/9/2020","Show publish command"),g=Object(Me.e)(p),y={},b=0,w=r;b<w.length;b++){var E=w[b];y[E.key]=E}for(var S=0,x=r;S<x.length;S++){if((E=x[S]).key===Pe.e.key){var T=Object(Ot.e)(e,{contentTypes:l,newCommandMenu:E,fileHandlerCommands:a,isCreateFolderAvailable:c,newDocumentTemplates:f,contentTypeCommands:o,listKey:h}).visibleNewCommands;d.push(T)}else if(E.key===Ft.e.key&&n&&!y[g.key])d.push(E,g);else if(E.key===M.e.key){var N=Jt(a,v);d.push(N)}else if(E.key===st.t.key&&i&&!y[Oe.e.key])d.push(E,Oe.e);else if(E.key===ot.e.key&&i){d.push(E);s||y[O.e.key]||d.push(O.e);d.push(D.t,D.e)}else if(E.key===st.n.key){!i&&Object(Dt.e)(e,{feature:qt,pageContext:p})?d.push(st.e):d.push(E);m&&d.push(ke,Le)}else d.push(E)}u&&u.length>0&&d.push.apply(d,u);a&&a.custom&&a.custom.length>0&&(d=Object(Lt.t)(d,a.custom));return{overrideDefaultCommands:d}})(e,{defaultCommands:S,isDocumentLibrary:d,isODB:m,contentTypeCommands:g,customActionCommands:y,fileHandlerCommands:b,newDocumentTemplates:r,contentTypes:I,isCreateFolderAvailable:q,quickEditEnabled:$,listKey:c,pageContext:B});return{commands:S=K.overrideDefaultCommands,overflowCommands:p,farCommands:x,shortcutCommands:T}}function Qt(){return function(e){return function(e,t){return Kt(e,t)}}}var Gt=n(780),Yt=n(2545),Zt=n(212),en=n(1063),tn=n(1062),nn=n(602),rn=n(423),sn=n(57),on=n(38),un={ODB:1544},an=Object(a.t)()(function(){return function(e){return function(t,n){var r,i=n.itemKey,o=n.commands,u=t.demandItemFacet(v.e,i);if(u){var a=w.e.serialize(u);r=t.demandItemFacet(L.we,a)}var f=o?Object(s.__spreadArrays)(o):[];f.push(D.t,D.e);var l=void 0;if(u){var c=u.listFullUrl,h=u.webAbsoluteUrl,p=Object(Ae.i)({listFacets:r}),d=t.demandItemFacet(L.Mt,me.e.serialize({webAbsoluteUrl:h,listFullUrl:c}));if(r&&!r.isDocumentLibrary){f=[A.t];for(var m=0,g=Object(A.e)(d);m<g.length;m++){var y=g[m];y.key===st.n.key&&Object(Dt.e)(t,{feature:un,pageContext:d})?f.push(st.e):y.key!==O.e.key&&f.push(y)}}f.push(p);var b=Gt.e.serialize({webAbsoluteUrl:h,listFullUrl:c}),E=it({itemCache:t,targetCustomActionSetKey:b,keys:{webAbsoluteUrl:h,listFullUrl:c}});f=f.concat(rt(t,b));E&&(f=f.concat(rt(t,E)));if(d&&r&&(r.templateType===W.t.documentLibrary||r.templateType===W.t.mySiteDocumentLibrary)){var S=new se.e(h||c).authority+"/_api/v2.0",x=Zt.t.serialize({endpoint:S});l=Object(Lt.e)(t,{itemKey:x})}}var T=!re.e.isActivated(Wt,"7/5/2019","Show file handler commands before OOB commands");return{commands:fn(f,l,r&&r.templateType===W.t.mySiteDocumentLibrary,T),onMenuOpened:function(){e(function(e){var t=(e(Object(sn.e)({spLoggerConfiguration:on.o})).spLoggerConfiguration||{}).scenarioId,n=void 0===t?"":t;e(rn.t(n))})}}}}});function fn(e,t,n,r){for(var i=[],s=0,o=e;s<o.length;s++){var u=o[s],a=u.key;if(a===M.e.key){var f=t&&t.open||[];f.length>0&&Yt.t.subMenuProps&&(Yt.t.subMenuProps.items=Object(Lt.t)(Yt.t.subMenuProps.items,f,r));i.push(Yt.t)}else{i.push(u);a===ot.e.key?i.push(tn.e):a===nn.e.key&&!1===n&&i.push(en.e)}}return t&&t.custom&&t.custom.length>0?Object(Lt.t)(i,t.custom):i}var ln=n(31),cn=n(467),hn=Object(a.t)()(function(){return function(e){return function(e,t){var n=Object(ve.e)(e),r=(function e(t,n,r){var i=n,o=r;if(n&&r){var u=t.demandItem({spGroupField:L.Et,groupValue:L.se,parentGroupKey:L.Ue,groupFilterByValue:L.ne},n),a=u.spGroupField,f=u.groupValue,l=u.parentGroupKey,c=u.groupFilterByValue;l&&(o=e(t,l.itemKey,r));var h=t.demandItemFacet(E.e,o);if(h){var p=t.demandItemFacet(m.e,n),d=Object(cn.e)(Object(s.__assign)(Object(s.__assign)({},h),p?{viewKey:p.viewKey}:{})),v=c||f;void 0!==v&&a&&a.internalName&&a.fieldType&&(i=d({filterField:a.internalName,filterValues:[v],filterType:a.fieldType,useLookupId:!1}))}}return i})(e,t.itemKey,n),i=e.demandItem({parentItem:Q.i},n).parentItem,o=(function(e){var t=this,n=e.stageItem,r=e.parentItemKey;return n?Object(ln.t)(function(e){var i=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t;return Object(s.__generator)(this,function(u){switch(u.label){case 0:r&&e(Object(Xe.e)({items:(t={},t[o]=Object(s.__assign)({},Q.i.pack({itemKey:r})),t)}));return[4,e(n({currentItemKey:o,itemsScopeItemKey:i}))];case 1:u.sent();return[2]}})})}}):void 0})({parentItemKey:i&&i.itemKey,stageItem:t.stageItem});return r?Object(s.__assign)({itemKey:r},o?{stageItem:o}:{}):{}}}});var pn=n(64),dn=new pn.e("siteTargetDocumentLibraryItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(Q.t,n),i=r&&r.itemKey,s=e.demandItemFacet(Q.e,i),o=s&&s.itemKeys;if(o&&1===o.length)return{itemKey:o[0]}}),vn=Object(a.t)()(function(){var e=this;return function(){return function(t,r){var i=r.itemKey,o=r.stageItem,u=t.demandItemFacet(dn,i,{suppressGetItems:!0});return Object(s.__assign)({},u?{itemKey:u.itemKey}:{stageItem:function(t){return function(r){return Object(s.__awaiter)(e,void 0,void 0,function(){var e,i,u,a,f,l;return Object(s.__generator)(this,function(c){switch(c.label){case 0:u=[Object(s.__assign)({},t)];return(a=o)?[4,r(o(t))]:[3,2];case 1:a=c.sent();c.label=2;case 2:e=s.__assign.apply(void 0,u.concat([a||{}])).currentItemKey,i=void 0===e?t.currentItemKey:e;return[4,Promise.resolve().then(n.bind(null,1615))];case 3:f=c.sent().demandItems;return[4,r(f(function(e){return e.demandItemFacet(dn,i)}))];case 4:return(l=c.sent())?[2,{currentItemKey:l.itemKey}]:[2]}})})}}})}}});var mn=n(144),gn=n(791),yn=n(216),bn=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.createOpenItem,r=t.rootItemKey,i=t.itemKey,s=Object(ve.e)(e),o=void 0;if(r){var u=e.demandItemFacet(v.e,r);u&&(o=v.e.serialize(u))}return{getBreadcrumbItems:function(){var t=[],u={},a=e.demandItemFacet(E.e,s),f=a&&a.filterParams,l=e.demandItemFacet(L.mt,s),c=l&&l.filterList;!l&&f&&(c=mn.default.getFilterList(f,void 0,!0));if(c&&c.length&&f)for(var h=c.length-1;h>=0;h--){var p=c[h],d=(p.displays&&p.displays.length?p.displays:p.values).map(function(e){return e||yn.e.EmptyFilterOptionLabel}),v=mn.default.formatBreadcrumbFilterValues(d,p.type||"",{booleanFalse:yn.e.booleanFalse,booleanTrue:yn.e.booleanTrue}),m=wn(f,c,h+1),g=(y=Object(gn.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:m}))?E.e.serialize(y):i;t.unshift({key:p.fieldName,text:v,onClick:n&&g?n(g):void 0})}for(;i&&!u[i];){u[i]=!0;var y,b=e.demandItem({displayName:q.l,parentFolder:q.A},i),w=b.displayName,S=b.parentFolder;g=(y=Object(gn.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:""}))?E.e.serialize(y):i;t.unshift({key:i,text:w||"",onClick:n&&g?n(g):void 0});if(r&&(r===i||o===i))break;i=S&&S.itemKey||""}return t}}}}});function wn(e,t,n){for(var r=n=n||0;r<t.length;r++){var i=t[r];e=mn.default.addFilterInfo(e,i.fieldName,"",!0)}return e}var En=n(54),Sn=n(1000),xn=n(334),Tn=n(290),Nn=n(287),Cn=Tn.e.serialize({}),kn={key:new H.e("uploadToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(Tn.t,Cn),i=r&&r.draggedItem,s=!i||i.type===Nn.t,o=e.demandItemFacet(En.s,n);return{action:s&&o?P.createElement(Sn.e,{itemKey:n}):void 0}},canHandleEvent:function(e){return function(t){return e.event&&e.event&&Object(xn.n)(e.event)||!1}}},Ln=n(2884),An={isAvailable:!1,onExecute:void 0},On=Object(fe.t)(function(e,t){var n=t.itemKeys,r=t.groupKey;if(!(!!e.demandItemFacet(m.e,r)&&n&&n.length>0))return An;var i=e.demandItem({childItems:Q.e},r).childItems,o=i&&i.itemKeys||[],u=!!e.demandItemFacet(m.e,o[0]);if(0===o.length||u)return An;var a=n.filter(function(e){return!o.some(function(t){return t===e})});if(0===a.length)return An;var f=a[0],l=e.dispatch;return Object(s.__assign)({isAvailable:!0,onExecute:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(t){e={groupKey:r};return[2,l(Object(Ln.t)({items:Object(F.e)(n,function(){return e})}))]})})}},Object(ce.e)(e,{itemKey:f,engagement:{name:"Move",isIntentional:!0}}))})(de.e),Mn=Tn.e.serialize({}),_n={key:new H.e("moveToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(En.s,n),i=e.demandItemFacet(Tn.t,Mn),s=i&&i.draggedItem;return{action:(!s||s.type===Nn.e)&&r?P.createElement(On,{itemKeys:s&&s.itemKeys||[],groupKey:n}):void 0}},canHandleEvent:function(e){return function(t){if(e&&e.event){var n=e.event.dataTransfer;return n&&n.type===Nn.e||!1}return!1}}},Dn=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.handlers;return{handlers:Object(s.__spreadArrays)([kn,_n],n||[])}}}});var Pn=n(53),Hn=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItem({key:m.e,isDropEnabled:En.i},n),i=r.key,s=r.isDropEnabled,o=i&&i.itemSetKey&&v.e.serialize(i.itemSetKey),u=o&&e.demandItemFacet(L.ze,o),a=Pn.e.hasItemPermission({permissions:u},Pn.e.insertListItems);if(a){var f=i&&i.itemSetKey&&e.demandItemFacet(L.we,w.e.serialize({webAbsoluteUrl:i.itemSetKey.webAbsoluteUrl,listFullUrl:i.itemSetKey.listFullUrl}));a=!!s&&!!f&&!!f.isDocumentLibrary&&f.templateType!==W.t.webPageLibrary}return{isAvailable:a}}}});var Bn=n(2993),jn=n(1040),Fn=n(108),In=Object(fe.t)()(Object(Fn.e)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("543").then(n.bind(null,3802))];case 1:return[2,e.sent().ContentTypeNavigationCreator]}})})})),qn=Object(fe.i)(function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(v.e,r),o=!1;if(i&&(n=e.demandItemFacet(L.Mt,me.e.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})))&&!n.isAnonymousGuestUser){var u=e.demandItemFacet(L.ze,r);o=Pn.e.hasItemPermission({permissions:u},Pn.e.insertListItems)}var a=Object(pe.o)(function(e){return P.createElement(In,Object(s.__assign)({},e,t,{pageContext:n}))});return P.createElement(de.e,Object(s.__assign)({isAvailable:o,onExecute:a},Object(ce.e)(e,{itemKey:r,engagement:{name:"ContentTypeNavigation",isIntentional:!0}})))}),Rn=Object(ae.i)()(qn),Un=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=y.e.deserialize(n);return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u;return Object(s.__generator)(this,function(a){t=e(Object(We.e)({listFacets:L.we},w.e.serialize(r.listKey))).listFacets;i=jn.e.serialize({listKey:{webAbsoluteUrl:r.listKey.webAbsoluteUrl,listFullUrl:r.listKey.listFullUrl},contentTypeId:r.contentTypeId});o=!!t&&t.openInClient;e(Object(Xe.e)({items:(u={},u[n]=Object(s.__assign)({},L.t.pack(function(){return P.createElement(Rn,{contentTypeId:r.contentTypeId,openInClient:o,contentTypeKey:i})})),u)}));return[2]})})}});var zn=n(165),Wn=n(227),Xn=n(1484),Vn=n(42),$n=Object(o.i)()(function(e){var t=this,n=b.e.deserialize(e.itemKey),r=n.webAbsoluteUrl,i=n.listFullUrl;return function(n){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l;return Object(s.__generator)(this,function(c){t=n(Object(We.e)({pageContext:L.Mt},me.e.serialize({webAbsoluteUrl:r,listFullUrl:i}))).pageContext;o=n(Object(Wn.n)({webAbsoluteUrl:r,listFullUrl:i})).hasTokenProvider;if(t){u=o?void 0:function(e){return n(Object(Wn.e)({url:e}))};a=new Xn.e({},{pageContext:t,getAuthToken:u});(f=new Vn.e).resolveItems({items:(l={},l[e.itemKey]=Object(s.__assign)({},L.Pt.pack(a)),l)});n(f.execute())}return[2]})})}});var Jn=n(2970),Kn=n(2995),Qn=n(785),Gn=n(1663),Yn=n(2994),Zn=Object(o.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.childItemKey;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,o,u,a,f,l,c,h,p,d,m,g,y,b,E,S,x,T;return Object(s.__generator)(this,function(N){r=e(Object(We.e)({deserializedItemKey:v.e,displayName:q.l},n)),i=r.deserializedItemKey,o=r.displayName;if(i&&o){u=e(Object(We.e)({contentTypeKeys:L.h},t)).contentTypeKeys;a=[];u&&u.length&&u.forEach(function(t){var n=e(Object(We.e)({contentType:L.At},t)).contentType;n&&a.push(n)});f=a.length?a[0].contentTypeId:void 0;l=o.replace(/\.[^.]+$/,"");if(!(c={contentTypeId:f,isUpload:!0,templateId:l,title:l,url:i.itemId,visible:!0}).url)throw new Error("No template URL to save.");if((h=e(Object(We.e)({defaultView:L.g},t)).defaultView)&&h.viewKey){p=h.viewKey;d=e(Object(We.e)({existingTemplates:L.He},t)).existingTemplates,m=void 0===d?[]:d;(g=Object(s.__spreadArrays)(m)).length||(y=e(Object(We.e)({newCommands:Yn.e},t)).newCommands)&&y.forEach(function(e){var t=e.contentTypeId,n=e.isContentType,r=e.templateId,i=e.title,s=e.visible;g.push({contentTypeId:t,isContentType:n,templateId:r,title:i,visible:s})});g.filter(function(e){return e.url===c.url}).length>0||g.push(Object(s.__assign)({},c));b=w.e.deserialize(t);E=Qn.e.serialize({templateUrl:c.url,listKey:b});e(Object(Xe.e)({items:(S={},S[t]=Object(s.__assign)({},L.He.pack(g)),S[E]=Object(s.__assign)({},L.Pe.pack(c)),S)}));return[2,e(Object(Gn.e)({items:(x={},x[C.e.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})]={views:(T={},T[p]={newDocumentTemplatesJsonString:JSON.stringify(g)},T),qosName:"saveNewTemplatesToDefaultView"},x)}))]}}return[2]})})}}),er=n(792),tr=n(2449),nr=n(879),rr=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(L.Oe,n,{suppressGetItems:!0}),i=e.demandItemFacet(nr.e,n);return{isAvailable:!!r||!!i}}}});var ir=Object(o.t)(function(){return function(e){e(Object(a.r)(v.e,er.e)(rr));e(Object(u.o)(v.e,tr.t)(Object(o.r)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("555").then(n.bind(null,3989))];case 1:return[2,e.sent().removeFromOneDriveOperationHandler]}})})})))}}),sr=Object(o.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.templates;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r;return Object(s.__generator)(this,function(i){e(Object(Xe.e)({items:(r={},r[t]=Object(s.__assign)({},L.He.pack(n)),r)}));return[2]})})}}),or=n(763),ur=n(125),ar=n(231),fr=n(2650),lr=n(319),cr=n(2047),hr=n(582),pr=n(1068),dr=n(36),vr=n(793);function mr(e,t){return{enableItemHoverCard:!1}}var gr=Object(fe.t)(function(e,t){var n=br(e,t.itemSetKey);return{customFormatterFeature:n&&e.demandItemFacet(ur.n,ur.t.serialize({})),viewFormatter:n,dispatch:e.dispatch,isDefaultCardEnabled:Object(Dt.e)(e,{feature:{ODB:1615}}),cardDesignerFeatureEnabled:Object(pr.e)(e)}})(function(e){Object(P.useEffect)(function(){if(r&&r.isTileFormatterAvailable()&&0===f){e.dispatch(Object(ar.e)({name:"CustomFormatterTileLoad",isIntentional:!0}));r.hasFormatterReferences()&&e.dispatch(Object(ar.e)({name:"FormatterReferenceTile",isIntentional:!0}))}},[]);var t=e.defaultRender,n=e.customFormatterFeature,r=e.viewFormatter,i=e.isDefaultCardEnabled,o=e.cardDesignerFeatureEnabled,u=Object(s.__rest)(e,["defaultRender","customFormatterFeature","viewFormatter","isDefaultCardEnabled","cardDesignerFeatureEnabled"]);if(!t)return null;var a=n&&n.tileRenderer,f=u.selectionIndex,l=u.itemKey,c=u.itemSetKey,h=void 0===c?"":c;if(r&&r.isTileFormatterAvailable()&&a){var p=r.shouldHideSelectionInTiles(),d=r.getTileFormatter(),v=P.createElement(t,Object(s.__assign)({},u,o?{href:void 0,invokeSelection:!1}:{},{className:Object(dr.e)(u.className,"customTile_f9500118"),itemName:null,itemActivity:null,foreground:null,isSelectable:!p,selection:p?void 0:u.selection,selectionIndex:p?-1:u.selectionIndex,background:P.createElement(a,{rowIndex:f,itemKey:l,itemSetKey:h,formatter:d})}));return i&&d?P.createElement(lr.e,{controlHandlers:cr.e.pack(mr)},v):v}return P.createElement(t,Object(s.__assign)({},u))}),yr=new pn.e("generatedViewFormatter",function(e,t){var n=t.itemKey;if(e.isItemFacetResolved(L.Te,n)&&n){var r=Object(fr.e)(e,{itemSetKey:n}),i=e.demandItemFacet(ur.n,ur.t.serialize({})),s=e.demandItemFacet(E.e,n);if(s&&r&&i){var o=e.demandItemFacet(L.we,w.e.serialize(s)),u=Object(hr.t)(e,{mapping:{fieldData:L.X},itemSetKey:n}),a=Object(Dt.e)(e,{feature:{ODB:522}}),f=Object(Dt.e)(e,{feature:{ODB:1822}}),l=u.map(function(e){return e.fieldData}),c=o&&o.templateType||W.n.invalidType,h=l&&l.length>0&&c===W.n.genericList,p=Object(or.e)({formatter:void 0,fields:l,generatedTileProps:h?i.tileDesigner.createDefaultTileProps(l,a):void 0,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:f}});if(p)return p.viewFormatter}}});function br(e,t){if(t){var n=e.demandItemFacet(L.Xt,Object(fr.e)(e,{itemSetKey:t})),r=n&&n.viewFormatter,i=r&&r.getTileProps();r&&r.isTileDesignerTemplateApplied()&&(r=e.demandItemFacet(wr,t));i&&i.formatter&&i.formatter||!Object(pr.e)(e)||(r=e.demandItemFacet(yr,t));return r}}var wr=new pn.e("postColumnDeleteViewFormatterFacet",function(e,t){var n=t.itemKey,r=e.demandItemFacet(L.Xt,Object(fr.e)(e,{itemSetKey:n})),i=r&&r.viewFormatter;if(n){var s=Object(hr.t)(e,{mapping:{fieldData:L.X},itemSetKey:n}),o=[],u=s.map(function(e){o.push(e.fieldData);return e.fieldData?e.fieldData.StaticName:""}),a=i&&i.getTileFormatterDesignerConfig(),f=e.demandItemFacet(ur.n,ur.t.serialize({}));if(f){var l=f.tileDesigner,c=l.encodeTileDesignerConfig,h=l.decodeTileDesignerConfig,p=l.createJSONFromConfig,d=a&&h(a),v=[];if(a&&u.length>0&&d){for(var m=!1,g=0;g<d.columns.length;g++)-1!==u.indexOf(d.columns[g].id)?v.push(d.columns[g]):m=!0;d.columns=v;var y=c(d);if(m){var b=p(o,y,!1),w=Object(or.e)({formatter:JSON.stringify({tileProps:b})});return w&&w.viewFormatter}}}}return i});var Er=n(1069),Sr=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemSetKey;return n&&Object(Dt.e)(e,{feature:{ODB:1294}})?(function(e,t){var n=br(e,t);if(!(n&&n.isTileFormatterAvailable()))return{};var r=(function(e){var t=254,n=340,r=e&&e.getTileProps(),i=r&&r.width&&r.width>=0?r.width:t;return{height:r&&r.height&&r.height>=0?r.height:n,width:i,disableMarqueeSelection:r&&r.hideSelection}})(n),i=r.height,s=r.width,o=r.disableMarqueeSelection,u=Object(vr.t)(e)?Object(vr.e)(t,"TILES"):void 0;return{tileRenderer:gr,grid:{minRowHeight:i},disableMarqueeSelection:o,tileControlHandler:function(){return{desiredSize:{width:s,height:i}}},groupControlHandler:function(){return{headerRenderer:u,maxItemCount:30}}}})(e,n):Object(Ht.e)(e,{enableMediaTilesInDocumentGroup:L.M}).enableMediaTilesInDocumentGroup?{tileControlHandler:Er.e}:{}}}});var xr=n(869),Tr=n(768),Nr=n(20),Cr=n(1056),kr=n(3666),Lr=n(17),Ar=n(507),Or=n(2614),Mr=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=Object(Ht.e)(e,{graphTokenProvider:Or.e,spRestTokenProvider:L.jt}),i=r.graphTokenProvider,o=r.spRestTokenProvider,u=Object(Bt.e)(e,n),a=u&&(u.env2||u.env);return{initializeShareFrame:function(e){var t=e.parentElement,n=e.calloutProps,r=e.sharingInformation,u=e.onError,f=n.defaultRecipients,l=n.itemName,c=n.locale,h=n.mode,p=n.openManageAccess,d=n.theme,v=n.getClientId,m=r.authToken,g=r.isListSharing,y=r.listId,b=r.serverRelativeItemUrl,w=r.shareItemKey,E=r.webAbsoluteUrl,S={authToken:m||"",clientId:v(),defaultRecipients:f,itemName:l,mode:Number(h),theme:d||Object(Lr._)(),webAbsoluteUrl:E||""},x={};if(w&&Cr.e.matches(w)){var T=Cr.e.deserialize(w);x={listId:T.listId,uniqueId:T.uniqueId,webAbsoluteUrl:T.webAbsoluteUrl}}else{x={isListSharing:g,itemUrl:""+new Ar.e(E).authority+b,listId:y}}new kr.e({element:t,environment:a||Nr.e.prod,locale:c,context:Object(s.__assign)(Object(s.__assign)({},S),x),options:{onError:u,openManageAccess:p,graphTokenProvider:i,spRestTokenProvider:o}}).initializeUI()}}}}});var _r=n(885),Dr=n(2996),Pr=n(74),Hr=n(2984),Br=Object(a.t)()(function(){return function(e){return function(t,n){var r=n.itemKey,i=t.demandItemFacet(v.e,r),s=i&&me.e.serialize(i),o=t.demandItemFacet(L.Mt,s),u=t.demandItemFacet(L.Ut,r),a=t.demandItemFacet(q.i,r),f=i&&i.listFullUrl,l=i&&i.webAbsoluteUrl,c=t.demandItemFacet(q.h,r);return{checkInAction:P.createElement(Hr.e,{checkInOutType:"checkIn"}),undoCheckOutAction:P.createElement(Hr.e,{checkInOutType:"undoCheckOut"}),onDismiss:function(t,n){var r=e(Object(Wn.n)({webAbsoluteUrl:l||"",listFullUrl:f})).dataRequestor,i={ListId:o&&o.listId,ListItemUniqueId:u,Operation:"RecommendationActedOn",AffectedResourceUrl:a,ItemType:"File",json:JSON.stringify({FileName:c&&c.name,Scenario:"RecommendedActions",SourceRelativeUrl:f,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(n+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:t,Canvas:"Web",Workload:"SharePoint",WebId:o&&o.webId,SiteId:o&&o.siteId,SiteUrl:o&&o.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:c&&c.name,SourceFileExtension:c&&c.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:t,ActionType:"Dismiss"})},s=new Pr.t(l+"/_api/web/ActivityLogger/FeedbackDirect");r.getData({url:s.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(i),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})}}}}});var jr=n(228),Fr=n(794),Ir=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.signalData,r=t.itemKey;if(n&&r&&n.key===Fr.t.key){var i=e.demandItemFacet(L.De,r),o=e.demandItemFacet(v.e,r),u=o&&me.e.serialize(o),a=e.demandItemFacet(L.Mt,u);if(!i||!a||a.listBaseTemplate!==W.n.webPageLibrary)return{};if(1===Object(jr.e)(90021,a)){var f=e.demandItemFacet(L.Rt,r),l=e.demandItemFacet(L.Ae,r),c=Object(ge.t)(e,r),h=a&&Object(re.t)(a),p=!!h&&h.isActivated("0b95f189-dff4-441e-a8e1-e860c9d15392","4/9/2020","add schedule action to hoverCard"),d=G.e.publishNowAction,m=0,g=Fr.t.signal,y=G.e.pageNeedsRepublishing;if(l)d=G.e.submitNowAction;else if(!p&&c){d=G.e.scheduleAction;m=1;g=Fr.e.signal;y=G.e.pageNeedsScheduling}else if(f){var b=Math.floor(Number(f)/512);d=0===b?G.e.publishNowAction:G.e.republishNowAction}return{onRenderLifeCycleSignal:function(e,t){return t?P.createElement(pe.n,{action:P.createElement(we,{itemKeys:[r],publishType:m,source:"FileCard"})},function(n){var r=n.isAvailable,i=n.execute,o=r?function(){i()}:void 0,u=Object(s.__assign)(Object(s.__assign)({},e),{actionName:d,action:o,content:y,signal:g});return t(u)}):null}}}return{}}return{}}}});var qr=n(638),Rr=n(845),Ur=n(455),zr=n(471),Wr=n(27),Xr=n(65),Vr=n(357),$r={key:new H.e("manageAccess").id,automationId:"manageAccessCommand",name:Wr.e.ManageAccess,title:Wr.e.ManageAccessCommandTooltipV3,action:P.createElement(Xr.t,null,P.createElement(zr.t,null)),iconProps:{iconName:"PlayerSettings"},facets:Object(s.__assign)({},Vr.t.pack(!0))},Jr=!re.e.isActivated(Wt,"7/5/2019","Show file handler commands before OOB commands"),Kr=Object(a.t)()(function(){return function(e){return Gr}});var Qr=[Rr.e,st.n,st.t,$r];function Gr(e,t){var n=Yr(e,t.itemKey);return{commands:(function(e,t){return e.map(function(e){return e.key===Rr.e.key?Jt(t,Jr):e})})(Qr,n)}}function Yr(e,t){var n,r=e.demandItemFacet(Ur.t,t);if(r){var i=new se.e(r.tenantRootUrl).authority+"/_api/v2.0",s=Zt.t.serialize({endpoint:i});n=Object(Lt.e)(e,{itemKey:s})}return n}var Zr=!re.e.isActivated(Wt,"7/5/2019","Show file handler commands before OOB commands"),ei=[Rr.e,st.n,st.t],ti=Object(a.t)()(function(){return function(e){return ni}});function ni(e,t){var n=Yr(e,t.itemKey);return{commands:fn(ei,n,!0,Zr)}}var ri=n(458),ii=n(2547),si=n(740),oi=Object(a.t)()(function(){return function(e){return ai}});var ui=[ri.e,ii.e,si.e];function ai(e,t){return{columns:ui}}var fi=n(364),li=n(337),ci=n(454),hi=n(3377),pi=n(1282),di=n(248),vi=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=Ur.t.deserialize(n).tenantRootUrl;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u,a,f,l;return Object(s.__generator)(this,function(c){switch(c.label){case 0:t=Object(pi.n)({webAbsoluteUrl:r}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,e(Object(Wn.t)({url:t.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 1:if(!((i=c.sent())&&i.d&&i.d.mySite))throw new li.e({facets:Object(s.__assign)({},di.f.pack({}))});o=i.d.mySite.replace(/\/$/,"");u=ci.t.serialize({webAbsoluteUrl:o||r});a=e(Object(sn.e)({sharedByMeYouEnabled:Nr.L})).sharedByMeYouEnabled;(f=new Vn.e).resolveItems({items:(l={},l[n]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},Q.t.pack({itemKey:u})),q.l.pack(a||hi.e.sharedByMe)),q.d.pack({})),l)});e(f.execute());return[2]}})})}});var mi=n(3743),gi=n(249),yi=n(183),bi=n(2969),wi=n(1023),Ei=n(1034),Si=n(279),xi=n(596),Ti=n(418),Ni=n(600),Ci=n(365),ki=n(154);function Li(e,t){var n=[];e.d.results.forEach(function(e){var r,i,o,u,a=""+new se.e(e.SiteUrl).authority+e.UrlPath,f=wi.e.serialize({itemFullUrl:a});n.push(f);var l=Object(mi.t)(e.Modified),c=(function(e){var t=Object(bi.e)(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:wi.e.serialize(n)}})(a),h=c.parentItemKey,p=c.parentItemUrl;t.mapKeys({mappings:(r={},r[wi.e.serialize({itemFullUrl:p})]=h,r)});var d=(function(e,t){var n=void 0!==t?t:3,r=!1,i=!1;if(e.IsContainer){n=Si.e.folder;i=!0}"OneNote.Notebook"===e.ProgId&&(r=!0);return{isOneNote:r,isDocSet:!1,fileIconType:n,isFolder:i}})(e),v=e.SpItemUrl?Object(Ti.e)(e.SpItemUrl):void 0;if(v)for(var m=0,g=Object(Ti.t)(v);m<g.length;m++){var y=g[m];t.mapKeys({mappings:(i={},i[y]=f,i)})}var b=e.Editor,w=Ei.e.serialize({id:b.email}),E={itemKey:w,displayValue:b.name};t.resolveItems({items:(o={},o[w]=Object(s.__assign)(Object(s.__assign)({},q.l.pack(b.name)),gi.e.pack(b.email)),o)});t.resolveItems({items:(u={},u[f]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},q.l.pack(e.FileLeafRef)),q.E.pack(!0)),q.h.pack({name:e.FileLeafRef,extension:e.Extension})),yi.e.pack(d.fileIconType)),q.a.pack(l.getTime())),q.i.pack(a)),q.A.pack({itemKey:h})),q.k.pack(E)),yi.n.pack(d.isOneNote?{}:void 0)),q.d.pack(d.isFolder?{}:void 0)),q.L.pack(a)),ki.e.pack(v)),v?Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},q.n.pack({itemKey:Ni.e.serialize({driveItemKey:v})})),q.v.pack({itemKey:Ci.e.serialize({driveItemKey:v})})),q.e.pack({itemKey:xi.e.serialize({driveItemKey:v})})):{}),Object(U.e)().forFacet(q.l).thenInvalidate(f,Q.e).pack()),u[h]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},q.d.pack({})),q.i.pack(p)),q.L.pack(p)),u)})});return n}var Ai=n(1172),Oi=n(213),Mi=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=ci.t.deserialize(n).webAbsoluteUrl;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u,a,f,l,c,h;return Object(s.__generator)(this,function(p){switch(p.label){case 0:t=(t=Object(pi.r)({webAbsoluteUrl:r,listOrItemFullUrl:""})).segment("OneDriveSharedItems").parameter("$top",100).parameter("$expand",{raw:"SpItemUrl,DriveAccessToken,DriveAccessTokenV21,DriveUrl"});i=t.toString();return[4,e(Object(Wn.t)({url:i,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:r}))];case 1:o=p.sent();u=new Vn.e;a=Li(o,u);f=""+new se.e(r).authority;l=Ur.t.serialize({tenantRootUrl:f});if(o.d.__next){c=Ai.e.serialize({itemSet:ci.t.deserialize(n),after:o.d.__next});a.push(c);u.merge(Object(Oi.t)({itemKey:c}).itemResolver)}u.resolveItems({items:(h={},h[n]=Object(s.__assign)(Object(s.__assign)({},Q.e.pack({itemKeys:a})),Q.i.pack({itemKey:l})),h[l]=Object(s.__assign)({},Object(U.e)().forFacet(Q.t).thenInvalidate(n,Q.e).pack()),h)});e(u.execute());return[2]}})})}});var _i=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=Ai.e.deserialize(n).after,i=Ai.e.deserialize(n).itemSet;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return[4,e(Object(Wn.t)({url:r,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:i.webAbsoluteUrl}))];case 1:t=s.sent();o=ci.t.serialize(i);u=new Vn.e;a=Li(t,u);if(t.d.__next){f=Ai.e.serialize({itemSet:i,after:t.d.__next});a.push(f);u.merge(Object(Oi.t)({itemKey:f}).itemResolver)}u.merge(Object(Oi.e)({itemKey:n,itemSetKey:o,childItemKeys:a}).itemResolver);e(u.execute());return[2]}})})}});var Di=n(3278),Pi=n(645),Hi=n(1061),Bi=n(591),ji=n(964),Fi=Object(a.t)()(function(){return function(e){return function(e,t){return(function(e,t){var n=t.itemKey,r=Object(Ht.e)(e,{enableItemActivityField:L.k}).enableItemActivityField,i=e.demandItemFacet(L.Y,n),o=r&&Object(fe.s)(e,P.createElement(ji.e,{itemKey:n,isCompact:!0,hideDate:!0}))||i&&P.createElement(Bi.e,{text:i}),u=e.demandItemFacet(L.Oe,n);return Object(s.__assign)(Object(s.__assign)({},o?{itemActivity:o}:{}),{folderCoverControlHandler:function(e,t){return u?{folderCoverAs:Ii}:{}}})})(e,t)}}});function Ii(e){var t=e.defaultRender,n=Object(s.__rest)(e,["defaultRender"]);return t?P.createElement(t,Object(s.__assign)({},n,{folderCoverType:"linked"})):null}var qi=n(872),Ri=n(732),Ui=n(2051),zi=n(298),Wi=Object(a.t)()(function(){return function(e){return Vi}}),Xi={ODB:1928};function Vi(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(v.e,n);if(!i)return{};var s=(function(e,t){var n=t.itemKey,r=t.spItem,i=t.desiredSize,s=Object(Ht.e)(e,{enableSharePointDirectThumbnails:L.q,spCookieDomainConfiguration:L.lt}),o=s.enableSharePointDirectThumbnails,u=void 0===o||o,a=s.spCookieDomainConfiguration,f=Object(Bt.e)(e,n);if(u&&Object(Dt.e)(e,{pageContext:f,feature:Xi})&&f&&!Object(re.t)(f).isActivated("C5892D55-79FA-4399-8941-95AD020ABB93","3/30/2020","Support direct SharePoint thumbnails")){var l=r.webAbsoluteUrl,c=r.listFullUrl,h=new se.e(l||c).authority;if(a&&a===h){var p=h+"/_api/v2.1",d=e.demandItemFacet(ki.e,n),v=e.demandItemFacet(q.c,n)||"";if(d){var m=d.driveId,g=d.itemId,y=Object(Ui.t)({endpoint:p,driveId:m,itemId:g}),b=Math.ceil(i.width),w=Math.ceil(i.height);return{url:y+"/thumbnails/0/c"+b+"x"+w+"/content?"+Object(zi.e)({prefer:"noredirect,closestavailablesize",cb:v}),width:0,height:0}}}}})(e,{itemKey:n,spItem:i,desiredSize:r})||(function(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(Ri.t,n),s=i&&i(r.width,r.height);if(s)return{url:s,width:0,height:0}})(e,{itemKey:n,desiredSize:r})||(function(e,t){var n=t.spItem,r=t.itemKey,i=w.e.serialize(n),s=e.demandItemFacet(L.we,i);if(!s)return;var o=s.templateType===W.n.publishingAsset;if(s.isPromotedLinks||o){var u=e.demandItemFacet(L.rt,r),a=void 0;s.isPromotedLinks?a=u&&u.BackgroundImageLocation:o&&u&&u.AlternateThumbnailUrl&&(a=e.demandItemFacet(Ri.e,r));if(a)return{url:a,width:0,height:0}}})(e,{spItem:i,itemKey:n});return s?{thumbnail:s}:{}}var $i=n(957),Ji=n(1615),Ki=n(255),Qi=n(851);function Gi(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var r=t[".transformUrl"],i=n[".hasThumbnail"],o=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},t),n),{".method":"thumbnail"});if("True"===i&&r)return function(e,t){var n=t?{width:e,height:t}:{width:e};return Object(Qi.t)(r,o)+"&"+Object(zi.e)(n)}}}var Yi=Object(o.i)({maxParallelOperationCount:16})(function(e){var t=this,n=$i.e.deserialize(e.itemKey).itemKey;return function(r){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u;return Object(s.__generator)(this,function(a){switch(a.label){case 0:return[4,r(Object(Ji.demandItems)(function(e){var t=e.demandItemFacet(v.e,n),r=t&&w.e.serialize(t);return{generator:Gi({listMediaTransformSchema:e.demandItemFacet(Ki.t,r),itemMediaTransformSchema:e.demandItemFacet(Ki.e,n)})}}))];case 1:t=a.sent().generator;(i=new Vn.e).resolveItems(((o={items:(u={},u[e.itemKey]=Object(s.__assign)({},Ki.n.pack(t)),u)})[n]=Object(s.__assign)({},Object(U.e)().forFacet(Ki.e).thenInvalidate(e.itemKey,Ki.n).pack()),o));r(i.execute());return[2]}})})}});var Zi=n(1081),es=Object(o.t)(function(){return function(e){e(Object(a.r)(v.e,cr.e)(Fi));e(Object(a.r)(v.e,qi.e)(Wi));e(Object(u.o)($i.e,zn.e)(Yi));e(Zi.e)}}),ts=n(2997),ns=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;return{isAvailable:!!e.demandItemFacet(v.e,n)}}}});var rs=n(539),is=n(1064),ss=n(2956),os=n(417),us=n(496),as=n(954),fs=n(3378),ls=n(854),cs=n(29),hs=n(115),ps=Object(a.t)()(function(){return function(e){return function(e,t){return{errorRenderer:ds}}}});var ds=Object(fe.i)(function(e,t){var n=t.defaultRender,r=(t.itemKey,t.title,Object(s.__rest)(t,["defaultRender","itemKey","title"])),i=r.error;if(i instanceof hs.e&&i.extraData&&404===i.extraData.status){var o=Object(Ze.e)(e).itemsScopeItemKey,u=e.demandItemFacet(cs.n,o),a=e.demandItemFacet(us.e,u&&u.itemKey),f=a&&v.e.serialize(a.mountPointItem),l=void 0,c=fs.e.mountPointNotFoundDefaultErrorMessage;if(f){var h=e.demandItemFacet(q.l,f);h&&(c=V.format(fs.e.mountPointNotFoundErrorMessage,h));l=P.createElement("div",null,P.createElement(pe.n,{action:P.createElement(as.e,{itemKeys:[f]})},function(e){var t=e.execute;return P.createElement(ls.e,{onClick:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,t().then(function(){window.location.href="#"}).catch()];case 1:e.sent();return[2]}})})}},fs.e.removeThisShortcut)}))}return P.createElement(P.Fragment,null,n?P.createElement(n,Object(s.__assign)({key:"error"},r,{title:fs.e.mountPointNotFoundErrorTitle,subText:c,actions:l})):null)}return n?P.createElement(n,Object(s.__assign)({},t)):null}),vs=n(950),ms=n(1522),gs={key:Ei.e,displayName:q.l,email:gi.e},ys=Object(o.i)()(function(e){var t=e.itemKey,n=vs.e.deserialize(t);return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,o,u,a,f,l,c,h;return Object(s.__generator)(this,function(p){switch(p.label){case 0:r=n.siteUrl||"";i=n.listId||"";o=n.uniqueId||"";u=r+"/_api/web/Lists('"+i+"')/GetPlacesInformation('"+o+"')?$expand=places";p.label=1;case 1:p.trys.push([1,3,,4]);return[4,e(Object(ms.n)({url:u,qosName:"GetPlacesInformation",method:"GET",endpoint:r}))];case 2:a=p.sent();f=new Vn.e;l=[];(c=a&&a.places)&&c.forEach(function(e){var t,n=e.userEntity.email,r=Ei.e.serialize({id:String(n)});f.resolveItems({items:(t={},t[r]=Object(H.n)(gs,{key:{id:String(n)},displayName:e.userEntity.name,email:n}),t)});l.push(r)});f.resolveItems({items:(h={},h[t]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},L.$e.pack({locationKeys:l})),L.me.pack(a.itemSourcePath)),q.l.pack(a.itemSourceSiteTitle)),h)});e(f.execute());return[3,4];case 3:throw p.sent();case 4:return[2]}})})}});n.d(t,"SpAddonDeferred",function(){return bs});n.d(t,"spProjectedUploadedItemSetAddon",function(){return ss.spProjectedUploadedItemSetAddon});var bs=Object(o.t)(function(){return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(t){e(ir);e(qr.e);e(Pi.e);e(N.spDataOnlyAddonDeferred);if(e(Object(sn.e)({enablePltCommands:L.B})).enablePltCommands)e(Object(a.r)(v.e,Hi.e)(Vt));else{e(Object(a.r)(v.e,h.e)($t));e(Object(a.r)(v.e,rs.e)(is.e))}e(Object(a.r)(v.e,p.e)(an));e(Object(a.r)(m.e,c.e)(hn));e(Object(a.r)(v.e,l)(bn));e(Object(a.r)(m.e,d.e)(Dn));e(Object(a.r)(m.e,f.e)(Hn));e(es);e(Object(u.o)(g.e,zn.e)(Bn.e));e(Object(u.o)(y.e,zn.e)(Un));e(Object(u.o)(b.e,zn.e)($n));e(Object(u.o)(w.e,Jn.t)(Zn));e(Object(u.o)(w.e,Kn.t)(sr));e(Object(a.r)(E.e,xr.e)(Sr));e(Object(a.r)(v.e,Tr.e)(Mr));e(Object(a.r)(v.e,_r.e)(Br));e(Object(a.r)(Ur.t,h.e)(Kr));e(Object(a.r)(ci.t,fi.e)(oi));e(Object(a.r)(Ur.t,p.e)(ti));e(Object(u.o)(Ur.t,zn.e)(vi));e(Object(u.o)(ci.t,zn.e)(Mi));e(Object(u.o)(Ai.e,zn.e)(_i));e(Object(u.o)(vs.e,zn.e)(ys));e(Object(a.r)(S.e,c.e)(vn));e(Object(a.r)(v.e,Dr.e)(Ir));e(Object(u.o)(x.e,zn.e)(Di.t));e(Object(a.r)(T.e,os.e)(ps));e(Object(a.r)(v.e,ts.e)(ns));return[2]})})}})},,,,,,,function(e,t,n){"use strict";n.r(t);var r,i=n(22),s=n(71),o=n(326),u=n(853),a=n(11),f=n(845),l=n(403),c=n(2),h=n(1),p=n(332),d=n(636),v={action:h.createElement(d.e,null),automationId:"addShortcutFromSharedWithMeCommand",title:p.e.AddShortcutFromSharedWithMeTooltip,iconProps:{iconName:"FabricFolderLink"},key:new c.e("AddShortcutFromSharedWithMe").id,name:p.e.AddShortcutFromSharedWithMe},m=n(65),g=n(954),y={action:h.createElement(m.t,null,h.createElement(g.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:p.e.RemoveShortcutFromSWMTooltip,iconProps:{iconName:"FabricFolderLink"},key:new c.e("RemoveShortcutFromSWM").id,name:p.e.RemoveShortcutFromSWM},b=n(0),w=n(167),E=n(247),S=n(2027),x=n(119),T=n(2454),N=n(6),C=n(8),k=n(75),L=n(35),A=n(24),O=n(30),M=n(16),_=n(2997),D=n(48),P=Object(C.i)(function(e,t){var n=t.itemKeys,r=t.removeFromSharedListWizard,i=t.removeItemsFromSharedList,s=void 0===i?T.t:i,o=Object(k.e)(e)||"";if(0===n.length)return null;for(var u=n.length<=200,a=r,f=0,l=n;f<l.length;f++){var c=l[f],p=e.demandItemFacet(_.e,c);_.e.evaluate(p)(e,{itemKey:c,isAvailable:!1}).isAvailable||(u=!1)}var d=e.dispatch,v=function(){return Object(b.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(b.__generator)(this,function(r){switch(r.label){case 0:e={itemSetKey:o};t=Object(L.e)(n,function(){return e});return[4,d(s({items:t}))];case 1:r.sent();return[2]}})})},m=Object(A.o)(function(e){return h.createElement(a,Object(b.__assign)({},e,{onItemRemoved:v,itemKeys:n}))});return h.createElement(O.e,Object(b.__assign)({isAvailable:u,onExecute:m},Object(D.e)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),H=Object(M.s)()(P),B=n(3465),j=n(3088),F=n(25),I=n(76),q=n(511),R=((r={})[I.r.started]=function(e){return Object(F.formatToArray)(Object(F.getLocalizedCountValue)(j.e.removeStartedItemsTitle,j.e.removeCompletedItemsTitleIntervals,e)||"",e)},r[I.r.completed]=function(e){return Object(F.formatToArray)(Object(F.getLocalizedCountValue)(j.e.removeCompletedItemsTitle,j.e.removeCompletedItemsTitleIntervals,e)||"",e)},r[I.r.failed]=function(e){return Object(F.formatToArray)(Object(F.getLocalizedCountValue)(j.e.removeFailedItemsTitle,j.e.removeFailedItemsTitleIntervals,e)||"",e)},r[I.r.canceled]=function(e){return Object(F.formatToArray)(Object(F.getLocalizedCountValue)(j.e.removeFailedItemsTitle,j.e.removeFailedItemsTitleIntervals,e)||"",e)},r),U=Object(i.t)(function(){return function(e){e(Object(a.r)(T.e,q.e)(Object(a.t)()(z)))}});function z(){return function(e){return W}}function W(e,t){var n,r=Object(x.i)(e,t),i=r.phase,s=r.count;n=R[i](s);return Object(b.__assign)({},n&&"item"!==t.format?{title:n}:{})}var X=(function(e){Object(b.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,r=t.reject,i=t.onItemRemoved,s=t.itemKeys,o=function(){return Object(b.__awaiter)(e,void 0,void 0,function(){return Object(b.__generator)(this,function(e){switch(e.label){case 0:n();return[4,i()];case 1:e.sent();return[2]}})})},u=function(){return Object(b.__awaiter)(e,void 0,void 0,function(){return Object(b.__generator)(this,function(e){r(new w.e);return[2]})})};return h.createElement(E.e,null,function(e){var t=e.itemCache,n=V(t,s),r=n.title,i=n.prompt;return h.createElement(S.e,{onCancel:u,onConfirm:o,yesText:j.e.removeFromSharedListConfirmButtonText,noText:B.e.removeFromSharedListCancelButtonText,defaultToYes:!0,title:r,prompt:i})})};return t})(h.PureComponent),V=function(e,t){if(t.length>1)return{title:B.e.itemsTitleWithAccess,prompt:B.e.itemsSubTextWithAccess};if(1===t.length){var n=e.demandItemFacet(N.d,t[0]);return{title:n?B.e.folderTitleWithAccess:B.e.fileTitleWithAccess,prompt:n?B.e.folderSubTextWithAccess:B.e.fileSubTextWithAccess}}return{title:"",prompt:""}},$=Object(x.s)({operationTypeFacet:T.n,progressKeyFacet:T.e,initializeBatch:function(){return U}});var J=Object(C.t)(function(){return{removeFromSharedListWizard:X,removeItemsFromSharedList:$}})(H),K={key:new c.e("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:p.e.removeFromSharedList,title:p.e.removeFromSharedListTooltip,action:h.createElement(m.t,null,h.createElement(J,null)),iconProps:{iconName:"Cancel"}},Q=Object(a.t)()(function(){return function(e){return Y}});var G=[f.e,l.n,l.t,v,y,K];function Y(e,t){return{commands:G}}var Z=n(3652),ee=n(589),te=Object(a.t)()(function(){return function(e){return re}});var ne=[f.e,l.n,l.t,v,y,K];function re(e,t){return{commands:ne}}var ie,se=n(299),oe=n(258),ue=n(251),ae=n(214),fe=((ie={})[ae.t]=!0,ie[ae.r]=!0,ie[ue.i]=!0,ie[ue.e]=!0,ie[ue.r]=!0,ie),le=Object(a.t)()(function(){return function(e){return ce}});function ce(e,t){var n=t.itemSetKey,r=t.handler,i=r.columnKey,s=r.isAscending;if(!fe[i])return{};var o=e.demandItemFacet(se.e,n);if(!o)return{};var u=ue.t[i];return u?{newItemSetKey:se.e.serialize(Object(b.__assign)(Object(b.__assign)({},o),{sortBy:u,isAscending:s}))}:{}}var he,pe=n(367),de=n(388),ve=n(2968),me=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(se.e,n),i=r&&r.driveItemKey.endpoint,s=i&&Object(ve.e)(e,{parentItemKey:ee.e.serialize({endpoint:i}),stageItem:t.stageItem});return Object(b.__assign)({},s?{stageItem:s}:{})}}});var ge=((he={})[ue.i]=!0,he[ue.e]=!0,he),ye=Object(a.t)()(function(){return function(e){return be}});function be(e,t){var n=t.itemSetKey,r=t.handler.columnKey;if(!ge[r])return{};var i=e.demandItemFacet(se.e,n);if(!i)return{};var s=ue.t[r];return s?{newItemSetKey:se.e.serialize(Object(b.__assign)(Object(b.__assign)({},i),{groupBy:s}))}:{}}var we=Object(a.t)()(function(){return function(e){return Ee}});function Ee(e,t){var n=t.itemSetKey,r=e.demandItemFacet(se.e,n);return r?{newItemSetKey:se.e.serialize(Object(b.__assign)(Object(b.__assign)({},r),{groupBy:void 0}))}:{}}var Se=n(2966),xe=Object(a.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Te=Object(a.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Ne=n(120),Ce=n(2634),ke=n(165),Le=n(42),Ae=n(57),Oe=n(161),Me=n(1522),_e=n(4),De=new _e.e("topCollaboratorItemKeyFacet",{id:Object(_e.s)()}),Pe=n(50),He=n(249),Be=n(12),je=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(r){return Object(b.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;return Object(b.__generator)(this,function(w){switch(w.label){case 0:t=new Le.e;i=r(Object(Ae.e)({graphEndpoint:Oe.u})).graphEndpoint;s=Ce.e.deserialize(n);o=i||s.endpoint;u=o+"/me/people/";return[4,r(Object(Me.n)({url:u,qosName:"getTopCollaborator",endpoint:o}))];case 1:a=w.sent();f=[];for(l=0,c=a.value;l<c.length;l++){h=c[l];p=h.id,d=h.displayName,v=h.userPrincipalName;m=De.serialize({id:p});r(Object(Pe.e)({items:(g={},g[m]=Object(b.__assign)(Object(b.__assign)({},N.l.pack(d)),He.e.pack(v)),g)}));f.push(m)}t.resolveItems({items:(y={},y[e.itemKey]=Object(b.__assign)({},Be.e.pack({itemKeys:f})),y)});r(t.execute());return[2]}})})}});n.d(t,"graphAddonDeferred",function(){return Fe});var Fe=Object(i.t)(function(){return function(e){e(Object(Ne.e)(function(){e(Z.graphAddonDataOnlyDeferred);e(Object(a.r)(ee.e,o.e)(te));e(Object(a.r)(ee.e,u.e)(Q));e(Object(a.r)(se.e,oe.e)(le));e(Object(a.r)(se.e,pe.e)(me));e(Object(a.r)(se.e,de.e)(ye));e(Object(a.r)(se.e,de.t)(we));e(Object(a.r)(Se.n,pe.e)(xe));e(Object(a.r)(Se.t,pe.e)(Te));e(Object(s.o)(Ce.e,ke.e)(je))}))}})}],Array(21),[function(e,t,n){"use strict";n.r(t);var r,i=n(22),s=n(11),o=n(80),u=n(2934),a=n(0),f=n(1),l=n(359),c=n(51),h=n(12),p=n(6),d=n(42),v=n(139),m=n(143),g=n(949),y=n(3000),b=n(1658),w=n(82),E=n(33);(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(r||(r={}));var S=1e4,x={ODB:819,ODC:"EnablePushChannelLogging"},T={ODB:459},N=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new v.e;var e=t._async.debounce(function(){return t._onNotification()},S,{leading:!0,maxWait:S});t._pushChannelService.setupNotificationHandler({source:y.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",y.t.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:y.t.EventHub},function(){t._log("PushChannelMessageSource",y.t.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?Object(g.e)(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:y.t.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r=this;return Object(a.__generator)(this,function(i){switch(i.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if("latest"!==this._syncToken)return[3,4];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,this._getChangeMessages()];case 2:i.sent();return[3,4];case 3:t=i.sent();this._getChangesAttempts++;if(this._getChangesAttempts>10)return[2];n=!1;if(Object(b.s)(t))switch(t.status){case 404:case 410:n=!0;this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return r._onPushChannelConnection(r._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts));return[2];case 4:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,r=Date.parse(t.expirationDateTime),i=Date.now(),s=r-i-n;if(s<12e4){if(m.e.isFeatureEnabled(T)){var o={refreshDelay:s,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:r,dateTimeNow:i,recreateBufferRandom:n};new w.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:E.e.Failure,extraData:o})}s=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},s)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,s,o,u,f,l,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:a.trys.push([0,2,,3]);e=new d.e;return[4,this._getChangeMessages()];case 1:t=a.sent();this._log("Change messages",t);n=this._processMessages(t.messages);this._log("Changes",n);e.merge(t.itemResolver);for(i=0,s=n;i<s.length;i++)switch((o=s[i]).type){case r.New:e.invalidateItems({items:(f={},f[o.invalidateKey]=[h.t],f)});break;case r.Update:o.hasSelection&&this._itemScopeItemKey?this._updateItems(o.invalidateKey):e.invalidateItems({items:(l={},l[o.invalidateKey]=[o.invalidateFacet],l)});break;case r.Delete:e.invalidateItems({items:(c={},c[o.invalidateKey]=[p.f],c)})}this._dispatch(e.execute());return[3,3];case 2:u=a.sent();this._log("onNotification error",u);return[3,3];case 3:return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];m.e.isFeatureEnabled(x)&&console.log.apply(console,Object(a.__spreadArrays)(["ItemAutoRefreshHelper"],e))};return e})(),C=n(1522),k=n(2104),L=n(161),A=n(3382),O=n(3381),M=n(23),_=n(15),D=n(255),P=n(58),H=n(3),B=n(79),j=n(390),F=n(111),I=n(227),q=n(88),R=n(26),U=n(57),z=n(154),W=n(418),X=n(833),V=n(1023),$=n(115),J=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t,n,r,i,s,o,u,a,f,l=this,c=e(Object(R.e)(function(e){return{spItem:e.demandItemFacet(B.e,l._rootItemKey)}})).spItem;if((null===(t=c)||void 0===t?void 0:t.webAbsoluteUrl)&&c.listFullUrl){var h=F.e.serialize({webAbsoluteUrl:null===(n=c)||void 0===n?void 0:n.webAbsoluteUrl,listFullUrl:null===(r=c)||void 0===r?void 0:r.listFullUrl}),p=e(Object(R.e)(function(e){return e.demandItemFacet(H.Ne,h)}));if((null===(i=p)||void 0===i?void 0:i.notificationUrl)&&(null===(s=p)||void 0===s?void 0:s.expirationDateTime)&&(null===(o=p)||void 0===o?void 0:o.subscribeID))return{notificationUrl:null===(u=p)||void 0===u?void 0:u.notificationUrl,expirationDateTime:null===(a=p)||void 0===a?void 0:a.expirationDateTime,id:null===(f=p)||void 0===f?void 0:f.subscribeID}}};e.prototype.getChangeMessages=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,i,s,o,u,f,l,c,h,p,v,m,g,y,b,w,E,S,x,T,N,C,A,O,M,P,J,K=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";r=n.endpoint+"/drives/"+n.driveId;i=e(Object(U.e)({isTAB:L.c})).isTAB;s=e(Object(R.e)(function(e){var t=e.demandItemFacet(B.e,K._rootItemKey);return{spItem:t,pageContext:t&&e.demandItemFacet(H.Mt,j.e.serialize(t))}})),o=s.spItem;if(!(u=s.pageContext)||!Object(_.t)(u).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!i)return[3,1];f=e(Object(R.e)(function(e){var t=o&&F.e.serialize(o),n=e.demandItemFacet(D.t,t),r=n&&n[".driveAccessToken"];return r&&r.replace("access_token=","")}));return[3,3];case 1:return[4,e(Object(I.e)({url:r,disallowCookies:!0}))];case 2:f=a.sent();a.label=3;case 3:return[3,7];case 4:return(c=n.endpoint)?[4,e(Object(k.e)(n.endpoint,r))]:[3,6];case 5:c=a.sent();a.label=6;case 6:f=(l=c)&&l.accessToken;a.label=7;case 7:if(void 0===f)throw new $.e({code:"authFailure"});h=u&&Object(_.t)(u).isActivated("C827C03F-4B57-4B6A-8BAB-3AE30D6AB56B","01/23/2020","including drive endpoint in the path")?"/drive/root/view.delta?token="+encodeURIComponent(t):r+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:h,accessToken:{accessToken:f,tokenUrl:r},useAuthorizationHeaders:!0,headers:{"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"}})];case 8:p=a.sent();v=[];m=new d.e;if(p&&p.value)for(g=0,y=p.value;g<y.length;g++){b=y[g];w=void 0;E={endpoint:n.endpoint,driveId:n.driveId,itemId:b.id};if(b.root){C=Object(W.t)(E);for(S=0,x=C;S<x.length;S++){M=x[S];m.mapKeys({mappings:(P={},P[M]=this._rootItemKey,P)})}}else if(b.webUrl&&(T=Object(X.n)(b.webUrl))){N=V.e.serialize({itemFullUrl:T});if(e(Object(q.e)({spItemKey:B.e},N)).spItemKey){C=Object(W.t)(E);for(A=0,O=C;A<O.length;A++){M=O[A];m.mapKeys({mappings:(J={},J[M]=N,J)})}}}if(!b.root){b.parentReference&&(w=b.parentReference.id);v.push({itemKey:z.e.serialize(E),parentItemKey:w&&z.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:w}),isDeleted:!!b.deleted,isShared:!!b.shared,name:b.name,dateModified:b.lastModifiedDateTime,eTag:b.eTag})}}return[2,{syncToken:p["@delta.token"],messages:v,itemResolver:m}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(q.e)({deleted:p.f},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(q.e)({spItemKey:B.e,mediaTransformSchema:D.e,displayName:p.l},t.itemKey)),s=i.spItemKey,o=i.mediaTransformSchema,u=i.displayName;if(void 0===s){if(!t.parentItemKey)return;return{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(o&&t.eTag){var a=o[".etag"];if(a&&t.eTag&&t.eTag!==a)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.e,reason:"eTag changed from "+a+" to "+t.eTag}}if(void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:p.l,reason:"Name changed from "+u+" to "+t.name}};return e})(),K=n(130),Q=n(52),G=n(401),Y=n(28),Z=n(38),ee=n(1604),te=n(93),ne=n(40),re=n(1282),ie={ODB:819,ODC:"EnablePushChannelLogging"},se=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,s,o,u,f,c,h,p,d,v,m,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.existingSubscription)return[3,5];n=Object(re.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(Object(I.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){ne.n.isFeatureEnabled(ie)&&console.log("Error getting service url: ",e)})];case 1:r=a.sent();i=this._dispatch(Object(U.e)({isTest:L.c})).isTest;if(!(s=r&&r.d&&r.d.GetServiceUrls&&r.d.GetServiceUrls.results&&r.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(s="https://northcentralus0-pushs.svc.ms");o=s+"/notifications/register";u=te.e.generate();f=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"}));c={correlationId:u};a.label=2;case 2:a.trys.push([2,4,,5]);return[4,ee.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":u},requestTimeoutInMS:1e4})];case 3:(h=a.sent())&&h.responseText&&h.responseText.length>0&&(p=JSON.parse(h.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(f({resultType:Z.t.success,extraData:c}));return[3,5];case 4:d=a.sent();this._dispatch(f({resultType:Z.t.failure,extraData:c}));throw d;case 5:v=Object(re.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){v=v.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else v=v.segments("Subscriptions","Add");m={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(Object(I.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:v.toString(),body:JSON.stringify(m),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((g=a.sent())&&g.d){delete g.d.__metadata;if(e.existingSubscription){g.d.id=e.existingSubscription.id;g.d.notificationUrl=e.existingSubscription.notificationUrl;g.d.expirationDateTime=m.parameters.expirationDateTime}return[2,g.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=Object(re.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(I.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})(),oe=n(267),ue=n(47),ae=n(195),fe=n(236),le=n(155),ce=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof se){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){var t,n,r,i,s,o;if(this._webAbsoluteUrl&&this._listFullUrl){var u=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),a=e(Object(R.e)(function(e){return e.demandItemFacet(H.Ne,u)}));if((null===(t=a)||void 0===t?void 0:t.notificationUrl)&&(null===(n=a)||void 0===n?void 0:n.expirationDateTime)&&(null===(r=a)||void 0===r?void 0:r.subscribeID))return{notificationUrl:null===(i=a)||void 0===i?void 0:i.notificationUrl,expirationDateTime:null===(s=a)||void 0===s?void 0:s.expirationDateTime,id:null===(o=a)||void 0===o?void 0:o.subscribeID}}};e.prototype.getChangeMessages=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,r,i,s,o,u,f,l,c,h,p,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,D,P,H,j,F=this;return Object(a.__generator)(this,function(I){switch(I.label){case 0:if(i=!!t&&"SPO_LIST,"===t.substr(0,9)){s=t.split(",");o=s[1];u=s[2];f='<Eq><FieldRef Name="Modified" />';f+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+u+"</Value></Eq>";l='<Gt><FieldRef Name="ID" /><Value Type="Number">'+o+"</Value></Gt>";n=Object(K.e)([f,l],Q.n.and);c='<Gt><FieldRef Name="Modified" />';c+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+u+"</Value>";c+="</Gt>";n=Object(K.e)([n,c],Q.n.or);r=["ID","FileRef","Modified","Title"];h=this._getListColumns(e);for(p=0,v=h;p<v.length;p++)"ID"!==(m=v[p]).internalName&&"FileRef"!==m.internalName&&"Modified"!==m.internalName&&"Title"!==m.internalName&&r.push(m.internalName)}else r=["ID","FileRef","Modified"];"ID";g=i;y=i?200:1;b=new G.e("<View></View>");n&&b.addFilters([n]);r&&b.replaceFields(r);b.updateSort({fieldName:"ID",isAscending:g});b.updateRowLimit({rowLimit:y,isPerPage:!1});w=e(Object(R.e)(function(e){return Object(ue.e)(e,B.e.serialize({webAbsoluteUrl:F._webAbsoluteUrl,listFullUrl:F._listFullUrl}))}));this._requestDatesInUtc=!w||Object(_.t)(w).isActivated("3599C6B2-C5C1-42F2-A5E1-CA0C352D20AB","01/09/2020","Do not request dates in UTC for autorefresh");return[4,e(Object(oe.e)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:b.getEffectiveViewXml(),postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:w}))];case 1:E=I.sent();this._serverResponse=E;S=E.ListData;x=S&&S.Row||[];T=[];N=this._getLastIdInList(x);C=i?this._getLastModifiedTimeInList(x,w):(new Date).toISOString();for(k=0,L=x;k<L.length;k++)if(void 0!==(A=L[k]).FileRef){O={};M=Object.keys(A);for(D=0,P=M;D<P.length;D++){H=P[D];j=0===H.indexOf("OData_")?H.substr(6):H;O[j]=A[H]}T.push(Object(a.__assign)(Object(a.__assign)({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:A.ID}),parentItemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:A.Title||""},A.Modified?{dateModified:""+A.Modified}:{}),{fields:O}))}0===T.length&&T.push({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});return[2,{syncToken:"SPO_LIST,"+N+","+C,messages:T,itemResolver:new d.e}]}})})};e.prototype.updateItems=function(e,t){if(t&&o.e.matches(this._itemSetKey)&&this._serverResponse){var n=o.e.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(le.n)({itemSetKey:r})),s=e(Object(le.e)(n,i,"getSPItem")),u=e(Object(fe.t)({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(u.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){if(void 0===t.parentItemKey)return{type:r.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"};if(t.isDeleted){if(e(Object(q.e)({deleted:p.f},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(R.e)(function(e){return e.isItemFacetResolved(B.e,t.itemKey)?{rowData:e.demandItemFacet(H.rt,t.itemKey),spItemKey:e.demandItemFacet(B.e,t.itemKey),title:e.demandItemFacet(H.qt,t.itemKey),selectedItemKeys:Object(ae.e)(e,{itemsScopeItemKey:n})}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:void 0}})),s=i.rowData,o=i.spItemKey,u=i.title,a=i.selectedItemKeys,f=a&&a.length>0;if(void 0===o||void 0===s){if(!t.parentItemKey)return;if(void 0===e(Object(q.e)({spParentItemKey:B.e},t.parentItemKey)).spParentItemKey)return;return f?void 0:{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==u&&void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.qt,reason:'Item title changed from "'+u+'" to '+t.name+")"};if(t.fields){f||(this._serverResponse=void 0);for(var l=this._getListColumns(e),c=function(e){for(var n=e.internalName,i=0,o=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<o.length;i++){var u=o[i],a=s&&s[u],l=t.fields[u];try{"object"==typeof a&&(a=JSON.stringify(a));"object"==typeof l&&(l=JSON.stringify(l));if(h._requestDatesInUtc&&"DateTime"===e.fieldType){var c=Date.parse(a),p=Date.parse(l);if(!isNaN(c)&&!isNaN(p)){a=c;l=p}}}catch(e){continue}if(a!==l)return{value:{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.rt,hasSelection:f,reason:'Item field "'+n+'" changed from "'+a+'" ('+typeof a+') to "'+l+'" ('+typeof l+")"}}}},h=this,d=0,v=l;d<v.length;d++){var m=c(v[d]);if("object"==typeof m)return m.value}}};e.prototype._getLastIdInList=function(e){return e&&e.length>0?Math.max.apply(Math,e.map(function(e){return parseInt(e.ID,10)})):0};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(Object(q.e)({schema:h.s},this._itemSetKey)).schema,r=n&&n.columnKeys;if(r)for(var i=0,s=r;i<s.length;i++){var o=s[i],u=e(Object(q.e)({internalName:H.ue,fieldType:H.K,mappedFieldType:H.Ce},o)),a=u.internalName,f=u.fieldType,l=u.mappedFieldType;void 0!==a&&void 0!==f&&void 0!==l&&l!==Y.t.Title&&t.push({internalName:a,fieldType:f,mappedFieldType:l})}return t};return e})(),he=n(109),pe=n(103),de=n(63),ve=n(4),me=n(184),ge=n(264),ye={ODB:860},be={ODB:818},we=new ve.e("itemAutoRefreshHelper",{itemsScopeItemKey:Object(ve.s)(),spPageContextKey:Object(ve.s)()}),Ee=Object(pe.e)(function(e){return{}});function Se(e){var t=Object(he.t)();f.useLayoutEffect(function(){var n,r,i,s,o,u,a,f,c,h;return t((r=(n=e).spPageContextKey,i=n.pageContext,s=n.listId,o=n.webAbsoluteUrl,u=n.listFullUrl,a=n.isTAB,f=n.itemKey,c=n.driveUrl,h=n.itemsScopeItemKey,function(e){var t=e(Ee),n=we.serialize({itemsScopeItemKey:h,spPageContextKey:r}),p=t[n];if(!p){var d,v,m=void 0;if(i&&!Object(_.t)(i).isActivated("1280C2A6-E41F-4140-9BBD-AD7F6BC4C604","10/31/2019","Use socketIo api for list subscriptions")){var g=e(C.e).dataRequestor;m=new A.e({listId:s,webAbsoluteUrl:o},{dataRequestor:g})}else m=new se({dispatch:e,webAbsoluteUrl:o,listFullUrl:u,listId:s});d=new O.e({disableWebSockets:!0},{subscriptionService:m});v=new ce({pushChannelService:d,subscriptionService:m,webAbsoluteUrl:o,listFullUrl:u,itemSetKey:f});p=t[n]=new N({id:n,isTestMode:a,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:c,dispatch:e,template:v,itemsScopeItemKey:h,pushChannelService:d,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete t[n]}})}return p})).subscribe()},[]);return null}function xe(e){var t=Object(he.t)();f.useLayoutEffect(function(){return t((function(e){var t=this,n=e.spPageContextKey,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.isTAB,o=e.driveAccessToken,u=e.pageContext,f=e.driveUrl,c=e.endpoint,h=e.itemsScopeItemKey;return function(e){var p=e(Ee),d=we.serialize({itemsScopeItemKey:h,spPageContextKey:n}),v=p[d];if(!v){var m,g,y=e(C.e).dataRequestor;g=new J({dataRequestor:y,rootItemKey:B.e.serialize({webAbsoluteUrl:r,listFullUrl:i,rootFolder:""})});m=new O.e({disableWebSockets:!0},{subscriptionService:new A.e({},{dataRequestor:y}),sessionTokenFetcher:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:if(!u||!Object(_.t)(u).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!s)return[3,1];t=o;return[3,3];case 1:return[4,e(Object(I.e)({url:f,disallowCookies:!0}))];case 2:t=i.sent();i.label=3;case 3:return[3,7];case 4:return(r=c)?[4,e(Object(k.e)(c,f))]:[3,6];case 5:r=i.sent();i.label=6;case 6:t=(n=r)&&n.accessToken;i.label=7;case 7:if(!t)throw new $.e({code:"authFailure"});return[2,{accessToken:t,tokenUrl:f}]}})})}});v=p[d]=new N({id:d,isTestMode:s,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:f,dispatch:e,itemsScopeItemKey:h,template:g,pushChannelService:m,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}})(e)).subscribe()},[]);return null}var Te=Object(s.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;if(!n)return{};var r=e.demandItem({key:o.e},n).key;if(!r||!r.webAbsoluteUrl||!r.listFullUrl)return{};var i=r.webAbsoluteUrl,s=r.listFullUrl,u=j.e.serialize({webAbsoluteUrl:i,listFullUrl:s}),a=e.demandItemFacet(H.Mt,u);if(!Object(P.e)(e,{feature:ye,pageContext:a})||!Object(P.e)(e,{feature:be,pageContext:a}))return{};var l=F.e.serialize({webAbsoluteUrl:i,listFullUrl:s}),h=e.demandItem({listFacets:H.we,listMediaTransformSchema:D.t},l),p=h.listFacets,d=h.listMediaTransformSchema;if(!p||void 0===p.id||void 0===p.templateType)return{};var v=p.isDocumentLibrary,m=M.s(p.templateType);if(!v&&!m)return{};var y,b=Object(c.e)(e,{isTAB:L.c}).isTAB,w=d&&d[".driveUrl"],E=w&&Object(g.e)(w),S=E&&E.endpoint,x=Object(de.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(v&&!w)return{};var T=Object(me.e)(e,{itemsScopeItemKey:x});if(T&&T.id===ge.e.id)return{};if(v){if(!d)return{};if(!w)return{};if(b){var N=d[".driveAccessToken"];y=N&&N.replace("access_token=","")}if(!E)return{};var C=E.driveId;return S&&C?{isAvailable:!0,itemSubscriber:f.createElement(xe,{spPageContextKey:u,driveUrl:w,isTAB:b,listFullUrl:s,endpoint:S,driveAccessToken:y,webAbsoluteUrl:i,pageContext:a,itemsScopeItemKey:x})}:{}}return{isAvailable:!0,itemSubscriber:f.createElement(Se,{spPageContextKey:u,isTAB:b,itemKey:n,listFullUrl:s,webAbsoluteUrl:i,listId:p.id,pageContext:a,driveUrl:w,itemsScopeItemKey:x})}}}});n.d(t,"sharePointAddonAutoRefresh",function(){return Ne});var Ne=Object(i.t)(function(){return function(e){e(Object(s.r)(o.e,u.e)(Te))}})}],Array(88),[function(e,t,n){"use strict";n.r(t);var r=n(22),i=n(11),s=n(80),o=n(537),u=n(1),a=n(1006),f=Object(i.t)()(function(){return function(e){return function(e,t){return{quickEditLayout:u.createElement(a.e,null)}}}});var l=n(3001);n.d(t,"sharePointAddonQuickEdit",function(){return c});n.d(t,"QuickEditActionExecutor",function(){return l.QuickEditActionExecutor});var c=Object(r.t)(function(){return function(e){e(Object(i.r)(s.e,o.e)(f))}})}])]);
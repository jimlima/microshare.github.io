(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-datasources"],{1182:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(40),s=n(146),o=n(191),u=n(89),a=!1;function f(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(a)return[2];if(i.n.isFeatureEnabled(s.n)||i.n.isFeatureEnabled(s.i)||i.n.isFeatureEnabled(s.t))return[3,2];Object(u.s)("FabricCustomizations_Deferred_AwaitLoad");return[4,n.e("556").then(n.bind(null,3653))];case 1:e=r.sent();Object(u.s)("FabricCustomizations_Deferred_Start");t={ColorPicker:{styles:e.ColorPickerStyles},ColorRectangle:{styles:e.ColorRectangleStyles},ColorSlider:{styles:e.ColorSliderStyles},CompoundButton:{styles:e.CompoundButtonStyles},Checkbox:{styles:e.CheckboxStyles},ChoiceGroupOption:{styles:e.ChoiceGroupOptionStyles},ComboBox:{styles:e.ComboBoxStyles},Dropdown:{styles:e.DropdownStyles},ExpandingCard:{styles:e.ExpandingCardStyles},IconButton:{styles:e.IconButtonStyles},Panel:{styles:e.PanelStyles},Persona:{styles:e.PersonaStyles},PersonaCoin:{styles:e.PersonaCoinStyles},PlainCard:{styles:e.PlainCardStyles},Slider:{styles:e.SliderStyles},SpinButton:{styles:e.SpinButtonStyles},Toggle:{styles:e.ToggleStyles}};a=!0;o.e.applyBatchedUpdates(function(){for(var e in t)o.e.applyScopedSettings(e,t[e])},!0);Object(u.s)("FabricCustomizations_Deferred_End");r.label=2;case 2:return[2]}})})}},1397:function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"})(r||(r={}));t.e=r},1476:function(e,t,n){"use strict";n(2169);var r,i=n(14),s=n(82),o=n(33);(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(r||(r={}));var u=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};return e})();t.e=u},1484:function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(92),s=n(570),o=n(1397),u=n(14),a=n(2170),f=n(573),l=n(399),c=n(1539),h=n(1931),p=n(1658),d=n(15),v=n(1719),m=n(74),g=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=this,i=y(t)?t:n.pageContext;r=e.call(this,{},{pageContext:i})||this;var s=y(t)?t.apiUrlHelper:n.apiUrlHelper;r._apiUrlHelper=s||new f.e({},{itemUrlHelper:new l.e({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(n){r._dataRequestor=n.dataRequestor;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._substratePeoplePickerHelper=n.substratePeoplePickerHelper;r._livePeoplePickerHelper=n.livePeoplePickerHelper;r._getAuthToken=n.getAuthToken}return r}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getPersonaDetails=function(e){var t=this;return u.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},r=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,s={personDetails:n(r.Primary),managerChain:r.ManagerChain.results.map(n),directReports:r.DirectReports.results.map(n)};s.personDetails.profilePage=Object(i.r)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(s.personDetails.sip)+"&origin=ProfileODBCard";return s}})})};t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===o.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return u.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})};t.prototype.resolve=function(e,t){var n=this;return u.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,parseResponse:function(e){var r=JSON.parse(e),i=JSON.parse(r.d.ClientPeoplePickerResolveUser),s=[];s[0]=i;d.e.isActivated("067ca2b4-2244-4153-8dfa-d11e6b4487bb","03/19/2018","Only overwrite display text if it is null or empty")?i.IsResolved||(s[0].DisplayText=i.Key):i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(s[0].DisplayText=i.Key);var u=(s=n._transformData(s,t.filterExternalUsers))[0];if(t.filterExternalUsers&&u&&1===u.entityType){u.isResolved=!1;u.entityType=0}else if(t.blockViaPolicy&&!t.filterExternalUsers&&u&&!u.isResolved&&0===u.multipleMatches.length){u.isResolved=!0;u.isExternal=!0;u.entityType=1}if(t.isGraphDistributionList&&t.useGraph&&u.isExternal){u.entityType=2;u.principalType=o.e.distributionList}return u}})})};t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t&&!this._dataRequestor&&(this._dataRequestor=new h.t({},{}));return t};t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t&&!this._dataRequestor&&(this._dataRequestor=new h.t({},{}));return t};t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper};t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)};t.prototype.sharePointSearch=function(e,t){var n=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return u.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",authToken:r,parseResponse:function(r){var i=t.allowSharePointGroups,s=void 0===i||i,u=t.filterExternalUsers,a=t.forceResolve,f=JSON.parse(r),l=JSON.parse(f.d.ClientPeoplePickerSearchUser),c=n._transformData(l,u);u&&(c=c.filter(function(e){return 1!==e.entityType}));var h=!c.length;c=c.filter(function(e){return e.principalType===o.e.sharePointGroup?s:e.principalType===o.e.securityGroup?s||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)});if(d.e.isActivated("cc7520a8-6922-4e12-81c1-179764750212","3/29/2018","Disable limiting no results behavior to e-mail addresses."))a&&h&&c.push({name:e,userId:e,email:e});else if(!1!==t.resolveEmailIfNoResults&&0===c.length&&n._isValidEmail(e,!1)){var p={Key:e,IsResolved:!1};c.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:p,rawPersonData:p,isExternal:!0})}return c}})})};t.prototype.subscribePresence=function(e,t){var n=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,r);return{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null};t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)};t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};t.prototype._graphSearch=function(e,t){var n=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=new m.t("https://graph.microsoft.com/v1.0/me/people");if(e){i.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});!1!==t.filterPublicDistributionList&&i.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'")}return n._dataRequestor.send({apiName:"Graph.PeopleSearch",path:i.toString(),headers:{Authorization:"Bearer "+r,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);if(!r||!r.value||0===r.value.length)return n.sharePointSearch(e,t);var i=r.value,s=[];i.forEach(function(e){var r=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i=e.userPrincipalName&&n._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:r,u={Key:i,IsResolved:!1},a="ImplicitContact"===e.personType.subclass,f="OrganizationUser"===e.personType.subclass,l="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,h="PublicDistributionList"===e.personType.subclass,p=Object(c.e)(r),d={department:e.department,email:r,image:a?void 0:p,job:!1===t.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||r,name:e.displayName,providerName:f?"Provider":void 0,userId:i,rawData:u,rawPersonData:u,isExternal:!f};if(f){d.entityType=0;d.principalType=o.e.user;d.isResolved=!0}else if(l){d.entityType=2;d.principalType=o.e.securityGroup;d.isResolved=!1;d.userId=e.id}else{d.principalType=h?o.e.distributionList:o.e.none;d.entityType="Group"===e.personType.class?2:1;d.isResolved=!1;d.providerName=void 0}d.userId&&s.push(d)});if(!1!==t.resolveEmailIfNoResults&&0===s.length&&n._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return s},function(r){if(Object(p.s)(r))switch(r.status){case 400:case 401:case 403:case 404:n._graphPeoplePickerHelper.disableGraphCallsForPicker();return n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else"Canceled"!==r.name&&n._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===r.name?null:n.sharePointSearch(e,t)})})};t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(i=t.siteIBSegmentIDs);var s=["Directory"];d.e.isActivated("9403ac4d-b51a-48b3-a4c0-9007477f73ea","02/18/2020","Mailbox Searching in Substrate People Suggestions.")||s.splice(0,0,"Mailbox");var u={};u=d.e.isActivated("04f09a5b-1c0f-42ef-9b9f-ba8c1e321810","07/03/2020","Removing litoken in Substrate call.")?{Authorization:"Bearer "+r,"X-User-Context":"litoken="+r}:{Authorization:"Bearer "+r};return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:a.e+"/api/v1/suggestions",headers:u,needsAuthorization:!1,requestType:"POST",postData:JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:s,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.Groups[0]?r.Groups[0].Suggestions:[],s=[];i.forEach(function(e){var r=e.EmailAddresses[0]||e.QueryText||"",i=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r,u={Key:i,IsResolved:!1},a="ImplicitContact"===e.PeopleSubtype,f="OrganizationUser"===e.PeopleSubtype,l="LinkedIn"===e.PeopleSubtype,h="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,p="PublicDistributionList"===e.PeopleSubtype,d=Object(c.e)(r),v={department:e.Department,office:e.OfficeLocation,email:r,image:a?void 0:d,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:i,rawData:u,rawPersonData:u,isExternal:!f};if(f){v.entityType=0;v.principalType=o.e.user;v.isResolved=!0}else if(h){v.entityType=2;v.principalType=o.e.securityGroup;v.isResolved=!1;v.providerName=void 0}else if(l)v.entityType=4;else{v.principalType=p?o.e.distributionList:o.e.none;v.entityType="Group"===e.PeopleType?2:1;v.isResolved=!1;v.providerName=void 0}v.userId&&s.push(v)});if(!1!==t.resolveEmailIfNoResults&&0===s.length&&n._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return s},function(r){if("Canceled"!==r.name){n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();n.sharePointSearch(e,t)}return null})})};t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&v.e.isValidEmailSyntax(e,!1):!t};t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,i={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(i.multipleMatches.length>0){i.multipleMatches=n._transformData(i.multipleMatches,t);t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType}))}var s=i.email;i.isResolved&&(i.image=s?Object(c.e)(s):null);var u=r.PrincipalType||e.EntityType;switch(u){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1;i.principalType=o.e.user;i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2;i.principalType="SharePointGroup"===u?o.e.sharePointGroup:o.e.securityGroup;break;default:i.entityType=0;i.principalType=o.e.user}return i})};return t})(s.t);function y(e){return!!e.webAbsoluteUrl}},1488:function(e,t,n){"use strict";var r,i=n(0),s=(function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e})();(function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"})(r||(r={}));var o=(function(e){Object(i.__extends)(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return t})(Error),u=(function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var r=this._getCachedTokenData(e);if(r&&!this._isExpiring(r)){var i={token:r.accessToken,isGuest:!1,expirationTimeMs:r.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:r.correlationId,spRequestTimestamp:r.requestTimestamp})}return this._retriableFetchWithDigest(e,s.retries,t).then(function(t){n._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,u=this._context.qosMonitor(),a=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(f){if(200!==f.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+f.statusText);var l=new o(r.unknownError,{httpResponseStatus:f.status,message:f.statusText,correlationId:e._getCorrelationId(f)});if(400!==f.status){u.writeUnexpectedFailure("UnknownError",l);return Promise.reject(l)}return f.json().then(function(r){var o=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(o);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(o);u.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(f,u,a)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",s.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<s.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==s.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8");n.append("Odata-Version","4.0");n.append("Accept","application/json;odata.metadata=minimal");var r={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1));return new Request(i+s.apiUrl,r)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(r.malformedResponseBody,{httpResponseStatus:400,message:s.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;n=e.message.lang}return new o(r.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(r){n.writeSuccess();return{accessToken:r.access_token,expiresOn:Number(r.expires_on),notBefore:Number(r.not_before),resource:r.resource,tokenType:r.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){n.writeUnexpectedFailure("ResponseParseError",i);return Promise.reject(new o(r.malformedResponseBody,{httpResponseStatus:200,message:s.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e})(),a=n(570),f=n(14),l=n(92),c=n(82),h=n(33),p=(function(){function e(){this._qos=new c.e({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:h.e.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.ExpectedFailure,error:JSON.stringify(t)})};return e})(),d=(function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e})(),v=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{},{pageContext:t})||this;r.logger=new d;if(n){n.logger&&(r.logger=n.logger);n.useAbsoluteUrlForOAuth&&(r._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}r._oAuthUtility=new u(r);return r}t.prototype.qosMonitor=function(){return new p};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.n)(this._pageContext)},enumerable:!0,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new f.n(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t})(a.t);t.e=v},1545:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.queued=0]="queued";e[e.started=1]="started";e[e.completed=2]="completed";e[e.aborted=3]="aborted";e[e.failed=4]="failed";e[e.none=5]="none"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.other=1]="other";e[e.general=2]="general";e[e.conflict=3]="conflict";e[e.invalidName=4]="invalidName";e[e.fileSize=5]="fileSize";e[e.emptyFileOrFolder=6]="emptyFileOrFolder";e[e.emptyFileOrFolderForDocLib=7]="emptyFileOrFolderForDocLib";e[e.overQuota=8]="overQuota";e[e.accessDenied=9]="accessDenied";e[e.lockMismatch=10]="lockMismatch";e[e.overQuotaSharedFolder=11]="overQuotaSharedFolder";e[e.folderUploadNotSupported=12]="folderUploadNotSupported";e[e.versionMismatch=13]="versionMismatch";e[e.authFailure=14]="authFailure";e[e.targetFolderMissing=15]="targetFolderMissing";e[e.itemNotFound=16]="itemNotFound";e[e.malwareDetected=17]="malwareDetected";e[e.throttled=18]="throttled";e[e.pathTooLong=19]="pathTooLong";e[e.disconnected=20]="disconnected";e[e.unlockRequired=21]="unlockRequired";e[e.insufficientVaultQuota=22]="insufficientVaultQuota"})(i||(i={}))},1616:function(e,t,n){"use strict";n.d(t,"t",function(){return y});n.d(t,"o",function(){return b});n.d(t,"s",function(){return w});n.d(t,"f",function(){return E});n.d(t,"i",function(){return S});n.d(t,"e",function(){return T});n.d(t,"u",function(){return N});n.d(t,"a",function(){return C});n.d(t,"r",function(){return k});n.d(t,"n",function(){return L});var r=n(130),i=n(1091),s=n(28),o=n(143),u=n(1617),a=n(1408),f=n(401),l=n(1831),c=n(947),h=n(1539),p=n(40),d={ODB:108},v="Modified",m="TaxKeyword",g="_ModerationStatus";function y(e,t,n,r,i,o){var u,f=r,l=[i];if(n===s.e.FileIcon){var c=i,h=a.t[c];if(h){l=a.e[h];h=a.r(h)}f=h||c||t.OtherFileTypeOption;u=e.getIconUrlFromExtension(c)}else if(void 0===f){f=(function(e,t){var n;if(e===s.e.Number||e===s.e.AverageRating){var r=e===s.e.AverageRating?2:void 0;n=(function(e,t){var n,r=new RegExp("^\\d*\\.\\d*$");if(!e||!r.test(e))return e;try{var i=parseFloat(e);isNaN(i)||(n=void 0===t?i.toString():i.toFixed(t))}catch(e){0}return n})(t,r)}else if(e===s.e.DateTime){var i=t.split("-");if(i&&3===i.length&&4===i[0].length){var o=parseInt(i[0],10),u=parseInt(i[1],10),a=parseInt(i[2],10);n=u+"/"+a+"/"+o}}void 0===n&&(n=t);return n})(n,i);l=[x(n,i)]}return{key:f=f||t.EmptyFilterOptionLabel,checked:!!o,values:l,label:f,iconUrl:u}}function b(e,t){if(e===s.e.Taxonomy&&o.e.isFeatureEnabled(d)&&t!==m)return 4;switch(e){case s.e.User:return 0;case s.e.DateTime:return 1;case s.e.FileIcon:return 2;default:return 3}}function w(e,t,n){return t===s.e.FileIcon?e.FileTypeFilterSectionTitle:n}function E(e,t,n,i,o,u){if(i&&!(i.length<1)&&n)for(var a=0,f=i;a<f.length;a++){for(var l=f[a],c=o[l.fieldName],h=void 0,p=0,d=n;p<d.length;p++){var v=d[p];if(v.fieldName===l.fieldName){h=v;break}}if(h){if(1===h.type){void 0!==(I=O(l))&&(h.value=I)}else H||4!==h.type||h.isLoading||(h.checkedValues=l.values);for(var m=0,g=l.values;m<g.length;m++){var w=g[m];if(H||4!==h.type||"0"!==w){var E=void 0;h.options||(h.options=[]);for(var x=0,T=h.options;x<T.length;x++){var N=T[x];if(D(N,w)){E=N;break}}if(E){E.checked=!0;if(!H&&4===h.type&&!h.isLoading){for(var C=h,k=0,L=E.values;k<L.length;k++){var A=L[k];if("0"!==A&&-1===l.values.indexOf(A)){E.checked=!1;break}}E.checked&&C.checkedKeys&&-1===C.checkedKeys.indexOf(E.key)&&C.checkedKeys.push(E.key)}}else{if(1===h.type&&r.s(w)||!H&&4===h.type)continue;var M=y(e,t,c.fieldType,void 0,w,!0);h.options.push(M)}}}}else{for(var _=[],P=void 0,B=0,j=l.values;B<j.length;B++){var F=j[B];M=y(e,t,c.fieldType,void 0,F,!0);_.push(M)}if(c.fieldType===s.e.DateTime){P=S(l.fieldName,c.columnDefinition.id,c.fieldType,c.displayName,u[l.fieldName]);var I;void 0!==(I=O(l))&&(P.value=I);P.options=_}else P={fieldName:l.fieldName,fieldId:c.columnDefinition.id,fieldType:c.fieldType,type:b(c.fieldType,l.fieldName),serverFieldType:c.columnDefinition.serverFieldType,title:c.displayName,options:_,showSeeAllLink:!0};c&&c.columnDefinition&&c.columnDefinition.isCalculated&&(P.isCalculatedField=!0);n.push(P)}}}function S(e,t,n,r,i){var s,o={fieldName:e,fieldId:t,fieldType:n,type:1,serverFieldType:"DateTime",title:r,value:u.e.none,minValueLabel:A(i),maxValueLabel:(s=(new Date).getFullYear()+1,s+"+"),maxValue:u.e.nextYear,showSeeAllLink:!0,options:[]};e===v&&(o.maxValue=u.e.today);return o}function x(e,t){e===s.e.Currency&&(t=t.replace(/[^0-9\.]+/g,""));return t}function T(e,t,n){for(var r,s,o=0;o<e.length;o++)if(e[o].fieldName===t.fieldName){r=o;break}if(H||4!==t.type){var u=void 0,a={};if(t.options&&t.options.length>0){u=[];for(o=0;o<t.options.length;o++){var f=t.options[o];if(f.shouldAlwaysRender){u.splice(0,0,f);a[f.key]=f}else if(f.checked){u.push(f);a[f.key]=f}}if(u.length<n)for(var l=0,c=r>=0?e[r].options:t.options;l<c.length;l++){var h=c[l];if(!a[h.key]){h.checked=!1;u.push(h);a[h.key]=h;if(u.length>=n)break}}}(s=i.e(t)).options=u}else s=i.e(t);r>=0?e[r]=s:e.push(s)}function N(e,t,n,r){return P(e,{fieldName:t,fieldType:n,filterValue:r,operator:"BeginsWith"})}function C(e,t,n,r){return P(e,{fieldName:t,fieldType:n,filterValue:r,operator:"Contains"})}function k(e,t,n,r,i){for(var s={},o=0,u=n;o<u.length;o++){var a=u[o];if(a)for(var f=0,l=L(e,t,a.properties,r,i);f<l.length;f++){var c=l[f];s[c.key]||(s[c.key]=c)}}var h=[];for(var p in s)s.hasOwnProperty(p)&&h.push(s[p]);return h}function L(e,t,n,r,i){var o=n[t],u=[];if(e===s.e.FileIcon)o=n.File_x0020_Type;else if(e===s.e.Title)o=n.Title;else if(e===s.e.WorkflowStatus&&o){var a=c.e.getWorkflowStatusFromRawHtml(o);if(a){var f=i(e,a.display,a.value);u.push(f);return u}}if(null!=o){var l=n[t+".calculated"];if(l){var p=l.indexOf(";#"),d=p>-1?l.substr(p+2):l;u.push(i(e,o,d))}else if(e===s.e.User)for(var v=0,m=o||[];v<m.length;v++){var y=m[v],b=Object(h.e)(y.email),w=y.title||r.EmptyFilterOptionLabel;u.push({key:w,values:[y.title],iconUrl:b,label:w})}else if(e===s.e.Lookup&&Array.isArray(o))if(o.length>0)for(var E=0,S=o;E<S.length;E++){f=i(e,void 0,S[E].lookupValue);u.push(f)}else{f=i(e,void 0,"");u.push(f)}else if(e===s.e.Boolean){f=i(e,o,n[t+".value"]);u.push(f)}else if(e===s.e.Taxonomy&&o){o instanceof Array||(o=[o]);if(o.length>0)for(var x=0,T=o;x<T.length;x++){f=i(e,void 0,T[x].Label);u.push(f)}else{f=i(e,void 0,"");u.push(f)}}else if(e===s.e.Currency||e===s.e.Number||e===s.e.DateTime||t===g){var N=t+".";f=void 0;f=void 0!==n[N]?i(e,o,n[N]):i(e,void 0,o);u.push(f)}else{var C=o instanceof Array?o:[o];if(C.length>0)for(var k=0,L=C;k<L.length;k++){f=i(e,void 0,L[k]);u.push(f)}}}return u}function A(e){var t;for(var n in e)try{var r=e[n].option&&e[n].option.values&&e[n].option.values[0];if(r&&4===r.indexOf("-")){var i=parseInt(r.substr(0,4),10);(!t||t>i)&&(t=i)}}catch(e){0}return t&&t.toString()}function O(e){var t,n=e.values&&e.values.length>0&&e.values[0],i=r.s(n)&&r.r(n);if(void 0!==i)t=_(i);else for(var s=0,o=e.values;s<o.length;s++){var u=M(o[s]);t=void 0===t?u:Math.min(t,u)}return t}function M(e){var t=u.e.none;try{var n=e.split(/[^0-9]/),r=new Date(Number(n[0]),Number(n[1])-1,Number(n[2])),i=(function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())})(new Date);t=_(Math.round((r.getTime()-i.getTime())/864e5))}catch(e){0}return t}function _(e){return 0===e?u.e.today:-1===e?u.e.yesterday:e<-1&&e>=-7?u.e.last7Days:e<-7&&e>=-30?u.e.last30Days:e<-30&&e>=-92?u.e.last3Months:e>=1&&e<7?u.e.tomorrow:e>=7&&e<30?u.e.next7Days:e>=30&&e<92?u.e.next30Days:e>=92&&e<365?u.e.next3Months:e>=365?u.e.nextYear:u.e.none}function D(e,t){var n=!1;try{if(/^-?\d+(?:[.,]\d*?)?$/.test(t)){var r=parseFloat(t);if(!isNaN(r))for(var i=0,s=e.values;i<s.length;i++){var o=s[i];if(r===parseFloat(o)){n=!0;break}}}else n=e.values.indexOf(t)>=0}catch(e){0}return n}function P(e,t){var n,r=t.fieldName,i=t.fieldType,o=t.filterValue,u=t.operator,a=new f.e(e);a.updateGroupBy(null);switch(i){case s.e.User:n="Lookup";break;case s.e.FileIcon:n="Computed";break;case s.e.Choice:n="Choice";break;case s.e.DateTime:n="DateTime";break;default:n="Text"}var c={fieldName:r,values:[o],type:n,operator:u,id:r};l.updateFilter(a,c);return a.getEffectiveViewXml()}function H(){return p.n.isFeatureEnabled({ODB:1763})}},1617:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return i});var r,i,s={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged"};(function(e){e[e.user=0]="user";e[e.date=1]="date";e[e.fileType=2]="fileType";e[e.choice=3]="choice";e[e.hierarchy=4]="hierarchy"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.last3Months=1]="last3Months";e[e.last30Days=2]="last30Days";e[e.last7Days=3]="last7Days";e[e.yesterday=4]="yesterday";e[e.today=5]="today";e[e.tomorrow=6]="tomorrow";e[e.next7Days=7]="next7Days";e[e.next30Days=8]="next30Days";e[e.next3Months=9]="next3Months";e[e.nextYear=10]="nextYear"})(i||(i={}))},1639:function(e,t,n){"use strict";n.r(t);var r,i,s=n(0),o=n(145),u=n(15),a=n(570),f=n(74),l=n(61),c=(function(e){Object(s.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"SiteScriptProgressDataSource"},{pageContext:t.pageContext})||this}t.prototype.getDesignPackageMenuContents=function(){return this.getData(this._constructGetDesignPackageMenuContentsUrl.bind(this),function(e){return JSON.parse(e)},"GetDesignPackageMenuContentsAPI")};t.prototype.getSiteDesignTasks=function(){var e=this;return this.getData(this._constructGetSiteDesignTasksUrl.bind(this),function(e){return JSON.parse(e)},"GetSiteDesignTasksAPI",function(){return u.e.isActivated("C9983E3A-9ADE-46A3-AA71-5D790B7A6566","6/28/2019","GetSiteDesignTasksOnlyForCurrentWeb")?JSON.stringify({webUrl:""}):JSON.stringify({webUrl:l.e.escapeUrlForCallback(e._pageContext.webAbsoluteUrl)})})};t.prototype.addSiteDesignTask=function(e){return this.getData(this._constructAddSiteDesignTaskUrl.bind(this),function(e){return JSON.parse(e)},"AddSiteDesignTaskAPI",function(){return JSON.stringify({siteDesignId:e})})};t.prototype.getSiteDesignRunStatus=function(e){return this.getData(this._constructGetSiteDesignRunStatusUrl.bind(this),function(e){return JSON.parse(e)},"GetSiteDesignRunStatusAPI",function(){return JSON.stringify({runId:e})})};t.prototype.getSiteDesignRuns=function(){return this.getData(this._constructGetSiteDesignRunsUrl.bind(this),function(e){return JSON.parse(e)},"GetSiteDesignStagesAPI")};t.prototype.getSiteDesignStages=function(e){return this.getData(this._constructGetSiteDesignStagesUrl.bind(this),function(e){return JSON.parse(e)},"GetSiteDesignStagesAPI",function(){return JSON.stringify({siteDesignId:e})})};t.prototype.applySiteDesign=function(e){var t=this;return this.getData(this._constructApplySiteDesignUrl.bind(this),function(e){return JSON.parse(e)},"ApplySiteDesignAPI",function(){return JSON.stringify({siteDesignId:e,webUrl:t._pageContext.webAbsoluteUrl})})};t.prototype.getTenantSiteDesigns=function(){return this.getData(this._consturctGetTenantSiteDesignsUrl.bind(this),function(e){return JSON.parse(e)},"GetTenantSiteDesignsAPI")};t.prototype.getIsSiteDesignPending=function(){return this.getData(this._constructValidateSiteDesignPendingUrl.bind(this),function(e){return JSON.parse(e)},"ValidateSiteDesignPendingAPI")};t.prototype.applyImplicitSiteDesign=function(){this.getData(this._constructApplyImplicitSiteDesignUrl.bind(this),function(e){return e},"ApplyImplicitSiteDesignAPI")};t.prototype._constructGetDesignPackageMenuContentsUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetDesignPackageMenuContents")};t.prototype._constructGetSiteDesignTasksUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesignTasks")};t.prototype._constructAddSiteDesignTaskUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.AddSiteDesignTaskToCurrentWeb")};t.prototype._constructGetSiteDesignRunStatusUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesignRunStatusAndSchema")};t.prototype._constructGetSiteDesignRunsUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesignRun")};t.prototype._constructGetSiteDesignStagesUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesignStages")};t.prototype._constructApplySiteDesignUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.ApplySiteDesign")};t.prototype._consturctGetTenantSiteDesignsUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.GetSiteDesigns")};t.prototype._constructValidateSiteDesignPendingUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.ValidatePendingWebTemplateExtension")};t.prototype._constructApplyImplicitSiteDesignUrl=function(){return this._constructGenericUrl("/_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.ApplyImplicitSiteDesign")};t.prototype._constructGenericUrl=function(e){return new f.t(f.t.concatenate(l.e.escapeUrlForCallback(this._pageContext.webServerRelativeUrl),e)).toString()};return t})(a.t),h=(function(){function e(e){this._dataSource=e.dataSource;this._currentCultureName=e.currentCultureName}e.prototype.getSiteDesignRunStatus=function(e,t){var n=this;return this._dataSource.getSiteDesignRunStatus(e).then(function(e){var r=[],i=e&&e.d&&e.d.GetSiteDesignRunStatusAndSchema&&e.d.GetSiteDesignRunStatusAndSchema.ActionStatus&&e.d.GetSiteDesignRunStatusAndSchema.ActionStatus.results;if(i&&i.length)for(var s=0;s<i.length;s++){var o=i[s];r.push({outcomeCode:o.OutcomeCode,outcomeText:o.OutcomeText})}var u=void 0;t&&e.d.GetSiteDesignRunStatusAndSchema.Schema&&(u=n._constructSiteScriptData(e.d.GetSiteDesignRunStatusAndSchema.Schema,void 0));return{siteScriptData:u,stageResultData:r}})};e.prototype.getSiteDesignRuns=function(){var e=this;return this._dataSource.getSiteDesignRuns().then(function(t){var n=[];if(t&&t.d&&t.d.results)for(var r=0;r<t.d.results.length;r++){var i=t.d.results[r],s=parseInt(i.StartTime,10);n.push({siteDesignId:i.SiteDesignID,siteDesignTitle:i.SiteDesignTitle,runId:i.ID,version:i.SiteDesignVersion,runDate:isNaN(s)?"":new Date(s).toLocaleDateString(e._currentCultureName)})}return n})};e.prototype.getSiteDesignStages=function(e){var t=this;return this._dataSource.getSiteDesignStages(e).then(function(n){if(n&&n.d&&n.d.GetSiteDesignStages)return t._constructSiteScriptData(n.d.GetSiteDesignStages,e)})};e.prototype.addSiteDesignTask=function(e){return this._dataSource.addSiteDesignTask(e).then(function(e){if(e&&e.d&&e.d.AddSiteDesignTaskToCurrentWeb&&e.d.AddSiteDesignTaskToCurrentWeb.ID)return{taskId:e.d.AddSiteDesignTaskToCurrentWeb.ID,siteDesignId:e.d.AddSiteDesignTaskToCurrentWeb.SiteDesignID,logonName:e.d.AddSiteDesignTaskToCurrentWeb.LogonName}})};e.prototype.getSiteDesignTasks=function(){return this._dataSource.getSiteDesignTasks().then(function(e){if(e&&e.d&&e.d.GetSiteDesignTasks&&e.d.GetSiteDesignTasks.results&&e.d.GetSiteDesignTasks.results.map)return e.d.GetSiteDesignTasks.results.map(function(e){return{taskId:e.ID,siteDesignId:e.SiteDesignID,logonName:e.LogonName}})})};e.prototype.applySiteDesign=function(e){return this._dataSource.applySiteDesign(e).then(function(e){if(e&&e.d&&e.d.ApplySiteDesign){var t=e.d.ApplySiteDesign.results;if(t){for(var n=[],r=0;r<t.length;r++){var i=t[r],s=parseInt(i.Outcome,10);n.push({outcomeCode:isNaN(s)?1:s,outcomeText:i.OutcomeText})}return n}}})};e.prototype.getTenantSiteDesigns=function(){var e=this;return this._dataSource.getTenantSiteDesigns().then(function(t){if(t&&t.d&&t.d.GetSiteDesigns){var n=t.d.GetSiteDesigns.results;if(n&&n.length){for(var r=[],i=0;i<n.length;i++){var s=n[i];if(s){var o=e._getSupportedTemplates(s.WebTemplate);r.push({id:s.Id,title:s.Title,version:s.Version,schema:void 0,imageUrl:s.PreviewImageUrl,imageAltText:s.PreviewImageAltText,description:s.Description,supportedTemplates:o,designPackageId:void 0})}}return r}}return[]})};e.prototype.getIsSiteDesignPending=function(){return this._dataSource.getIsSiteDesignPending().then(function(e){return!(!e||!e.d)&&(!e.error&&!!e.d.ValidatePendingWebTemplateExtension)},function(e){return!1})};e.prototype.applyImplicitSiteDesign=function(){this._dataSource.applyImplicitSiteDesign()};e.prototype._constructSiteScriptData=function(e,t){var n=JSON.parse(e),r=[],i=[];if(n&&n.recipes.length)for(var s=0;s<n.recipes.length;s++){r.push({id:n.recipes[s].recipeGuid,name:n.recipes[s].recipeName,actions:n.recipes[s].actions});if(n.recipes[s].actions&&n.recipes[s].actions.length)for(var o=0;o<n.recipes[s].actions.length;o++)n.recipes[s].actions[o]&&n.recipes[s].actions[o].stages&&n.recipes[s].actions[o].stages.length&&i.push.apply(i,n.recipes[s].actions[o].stages)}return{siteDesignId:t,siteDesignTitle:n.siteDesignTitle,siteScripts:r,stageNames:i,isLongRunning:i.length>30}};e.prototype._getSupportedTemplates=function(e){if(e){var t=parseInt(e,10);if(!isNaN(t))return[t]}return[]};return e})();n.d(t,"SiteScriptProgressCallbackType",function(){return r});n.d(t,"SiteScriptRunAge",function(){return i});n.d(t,"SiteScriptProgressStateManager",function(){return y});(function(e){e[e.newProgressData=0]="newProgressData";e[e.newNonProgressData=1]="newNonProgressData";e[e.openPanelAction=2]="openPanelAction"})(r||(r={}));(function(e){e[e.unknown=0]="unknown";e[e.old=1]="old";e[e.new=2]="new"})(i||(i={}));var p=8,d=(function(){function e(e,t){this._totalTimeWaited=0;this._useTimerV2=!1;if(u.e.isActivated("67B7383B-D5DF-4CFD-9BCB-7D8A2A1468A1","05/30/2019","Delay site script exponential backoff")){this._nextTimeout=e;this._lastTimeout=t}else{this._useTimerV2=!0;this._nextTimeout=p;this._lastTimeout=p}}e.prototype.getNextTimeout=function(){if(this._useTimerV2){var e=void 0;if(this._totalTimeWaited>=120){e=this._nextTimeout;this._nextTimeout=this._nextTimeout+this._lastTimeout;this._lastTimeout=e}else e=p;this._totalTimeWaited+=e;return 1e3*e}var t=this._lastTimeout;this._lastTimeout=this._nextTimeout;this._nextTimeout=this._nextTimeout+t;return 1e3*this._lastTimeout};return e})(),v=404,m="00000000-0000-0000-0000-000000000000",g=m,y=(function(){function e(e){var t=this;this._getSiteDesignProgress=function(e,n,s,o,u,a){if(!t.isRunComplete(n)){var f=setTimeout(t._getSiteDesignProgress.bind(t),o.getNextTimeout(),e,n,s,o,!1,a),l=!t._data[n].stageResultData||t._runCompletionStates[n].isSchemaDirty;t._provider.getSiteDesignRunStatus(e,l).then(function(e){if(e){var o=!1,u=!1;e.siteScriptData&&!e.siteScriptData.siteDesignTitle&&t._siteDesignRunDict[n]&&t._siteDesignRunDict[n].siteDesignTitle&&(e.siteScriptData.siteDesignTitle=t._siteDesignRunDict[n].siteDesignTitle);var l=t._getStageOutcomesKnownButIncomplete(e.stageResultData);if(e.siteScriptData){t._data[n].siteScriptData=e.siteScriptData;t._runCompletionStates[n].isSchemaDirty=!1;t._runCompletionStates[n].stagesRetrieved=!0;t._runCompletionStates[n].stagesRequired=e.siteScriptData.stageNames.length;o=!0}if(!t._data[n].stageResultData||e.stageResultData.length>t._data[n].stageResultData.length||l<t._runCompletionStates[n].stageOutcomesKnownButIncomplete){t._data[n].stageResultData=e.stageResultData;t._runCompletionStates[n].stageOutcomesKnown=e.stageResultData.length;t._runCompletionStates[n].stageOutcomesKnownButIncomplete=l;o=!0}var c=t.isRunComplete(n);if(t._runCompletionStates[n].age===i.unknown){t._runCompletionStates[n].age=c?i.old:i.new;o=!0}if(c){clearTimeout(f);if(t._runCompletionStates[n].age===i.new){t._state.hasARunCompleted=!0;u=!0}}if(o&&n===t._state.displayedRunKey){t._updateState(t._runCompletionStates[n]);t._notifyListeners(r.newProgressData)}else u&&t._notifyListeners(r.newProgressData)}else if(t._runCompletionStates[n].age===i.unknown){t._runCompletionStates[n].age=i.new;a&&t._getSiteDesignStages(n,s);if(n===t._state.displayedRunKey){t._updateState(t._runCompletionStates[n]);t._notifyListeners(r.newProgressData)}}},function(e){if(t._runCompletionStates[n].age===i.unknown){t._runCompletionStates[n].age=i.new;a&&t._getSiteDesignStages(n,s);if(n===t._state.displayedRunKey){t._updateState(t._runCompletionStates[n]);t._notifyListeners(r.newProgressData)}}e.status===v&&u&&t._provider.applyImplicitSiteDesign()})}};this._pageContext=e.pageContext;this._currentCultureName=this.getCurrentCultureName();this._webTemplate=e.pageContext?e.pageContext.webTemplate:"";this._provider=new h({dataSource:this.createSiteScriptProgressDataSource(),currentCultureName:this._currentCultureName});this._state={isSiteDesignPending:!1,stagesRetrieved:!1,stageOutcomesKnown:0,stageOutcomesKnownButIncomplete:0,displayedRunKey:g,stagesRequired:0,age:i.unknown,selectedTenantSiteDesign:"",hasARunCompleted:!1};this._runCompletionStates={};this._data={};this._registeredCallbacks=[];this._tenantSiteDesignsDict={};this._siteDesignRunDict={};this._siteDesignRunRequestSentDict={};this._tenantSiteDesignSchemaRequestSentDict={};this._triggeredOpenBefore=!1;e.pageContext?e.pageContext.hasPendingWebTemplateExtension?this._isSiteDesignPendingPromise=this._checkForPendingSiteDesign():this._isSiteDesignPendingPromise=Promise.resolve(!1):this._isSiteDesignPendingPromise=this._checkForPendingSiteDesign()}e.getInstance=function(t){e._instance||(e._instance=new e(t));return e._instance};e.prototype.createSiteScriptProgressDataSource=function(){return new c({pageContext:this._pageContext})};e.prototype.getCurrentCultureName=function(){return this._pageContext.currentCultureName};e.prototype.getWebTemplate=function(){return this._webTemplate};e.prototype.showSiteDesignRun=function(e){if(this._siteDesignRunDict[e]){if(!this._data[e]&&!this._siteDesignRunRequestSentDict[e]){this._siteDesignRunRequestSentDict[e]=!0;this._initializeRunData(e,i.unknown);this._getSiteDesignProgress(e,e,this._siteDesignRunDict[e].siteDesignId,new d(3,2),!1,!0)}this._updateState(Object(s.__assign)(Object(s.__assign)({},this._runCompletionStates[e]),{displayedRunKey:e,selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0,showingTenantSiteDesigns:!1}));this._notifyListeners(r.newNonProgressData)}};e.prototype.showTenantSiteDesigns=function(){this._updateState({showingTenantSiteDesigns:!0,selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0});this._notifyListeners(r.newNonProgressData)};e.prototype.hideTenantSiteDesigns=function(){if(this._state.showingTenantSiteDesigns){this._updateState({showingTenantSiteDesigns:!1,selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0});this._notifyListeners(r.newNonProgressData)}};e.prototype.showTenantSiteDesign=function(e){var t=this;if(e){if(this._tenantSiteDesignsDict[e]){this._updateState({selectedTenantSiteDesign:e,selectedTenantSiteDesignSchema:this._tenantSiteDesignsDict[e].schema});this._notifyListeners(r.newNonProgressData);if(!this._tenantSiteDesignsDict[e].schema&&!this._tenantSiteDesignSchemaRequestSentDict[e]){this._tenantSiteDesignSchemaRequestSentDict[e]=!0;this._provider.getSiteDesignStages(e).then(function(n){n&&(t._tenantSiteDesignsDict[e].schema=n);if(t._state.selectedTenantSiteDesign===e){t._state.selectedTenantSiteDesignSchema=t._tenantSiteDesignsDict[e].schema;t._notifyListeners(r.newNonProgressData)}})}}}else{this._updateState({selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0});this._notifyListeners(r.newNonProgressData)}};e.prototype.applySiteDesign=function(e){var t;if(this._tenantSiteDesignsDict[e]){t=this._tenantSiteDesignsDict[e];var n=Date.now().toString();this._siteDesignRunRequestSentDict[n]=!0;this._siteDesignRunDict[n]={siteDesignTitle:t.title,siteDesignId:e,runId:n,version:t.version,runDate:(new Date).toLocaleDateString(this._currentCultureName)};this._state.siteDesignRuns=Object(s.__spreadArrays)([this._siteDesignRunDict[n]],this._state.siteDesignRuns);this._initializeRunData(n,i.new);this._data[n].stageResultData=[];this._addSiteDesignTask(t,n);this._updateState(Object(s.__assign)(Object(s.__assign)({},this._runCompletionStates[n]),{displayedRunKey:n,showingTenantSiteDesigns:!1,selectedTenantSiteDesign:"",selectedTenantSiteDesignSchema:void 0}));this._notifyListeners(r.newNonProgressData)}};e.prototype.retrieveTenantSiteDesignsAndSiteDesignRuns=function(){var e=this;if(!this._requestedTenantSiteDesigns){this._requestedTenantSiteDesigns=!0;this._provider.getTenantSiteDesigns().then(function(t){o.e.logData({name:"SiteScripts.GetTenantSiteDesigns",extraData:{siteDesignCount:t?t.length:0}});e._updateState({tenantSiteDesigns:t});for(var n=0;n<t.length;n++)e._tenantSiteDesignsDict[t[n].id]=t[n];e._notifyListeners(r.newNonProgressData)})}this._getSiteDesignRuns()};e.prototype.getSiteDesignRun=function(e){return this._siteDesignRunDict[e]};e.prototype._addSiteDesignTask=function(e,t){var n=this;this._data[t].siteScriptData=e.schema;this._runCompletionStates[t].stagesRetrieved=!0;this._runCompletionStates[t].stagesRequired=this._data[t].siteScriptData.stageNames.length;this._runCompletionStates[t].isSchemaDirty=!0;this._provider.addSiteDesignTask(e.id).then(function(r){n._getSiteDesignProgress(r.taskId,t,e.id,new d(3,2),!1,!1)})};e.prototype._getSiteDesignRuns=function(){var e=this;this._siteDesignRunsPromise||(this._siteDesignRunsPromise=this._provider.getSiteDesignRuns().then(function(t){e._updateState({siteDesignRuns:t});for(var n=0;n<t.length;n++)e._siteDesignRunDict[t[n].runId]=t[n];e._notifyListeners(r.newNonProgressData);return t}));return this._siteDesignRunsPromise};e.prototype._getSiteDesignTasks=function(){this._siteDesignTasksPromise||(this._siteDesignTasksPromise=this._provider.getSiteDesignTasks());return this._siteDesignTasksPromise};e.prototype.getState=function(){return this._state};e.prototype.getData=function(e){return this._data[e]};e.prototype.getTenantSiteDesign=function(e){return this._tenantSiteDesignsDict[e]};e.prototype.registerCallback=function(e,t,n){this._registeredCallbacks[t]||(this._registeredCallbacks[t]={});this._registeredCallbacks[t][e]=n};e.prototype.unregisterCallback=function(e,t){var n=this._registeredCallbacks[t];n&&n.hasOwnProperty(e)&&delete n[e]};e.prototype.triggerOpenPanelAction=function(){var e=this;if(!this._triggeredOpenBefore){this._triggeredOpenBefore=!0;this._isSiteDesignPendingPromise.then(function(t){t||e._getSiteDesignRuns().then(function(t){if(t&&t.length){var n=t[0].runId;e._initializeRunData(n,i.unknown);e._updateState(Object(s.__assign)(Object(s.__assign)({},e._runCompletionStates[n]),{displayedRunKey:n}));e._notifyListeners(r.newNonProgressData);e._siteDesignRunRequestSentDict[n]=!0;e._getSiteDesignProgress(n,n,t[0].siteDesignId,new d(3,2),!1,!0)}})})}this._notifyListeners(r.openPanelAction)};e.prototype.isRunComplete=function(e){if(this._runCompletionStates[e]){var t=this._runCompletionStates[e];return t.stagesRetrieved&&t.stageOutcomesKnown===t.stagesRequired&&0===t.stageOutcomesKnownButIncomplete}return!1};e.prototype.getCompletionRatio=function(e){if(this._data&&this._data[e]&&this._data[e].siteScriptData&&this._data[e].siteScriptData.stageNames){return 0===this._data[e].siteScriptData.stageNames.length?1:Math.max(0,this._state.stageOutcomesKnown-this._state.stageOutcomesKnownButIncomplete)/this._data[e].siteScriptData.stageNames.length}return 0};e.prototype._updateState=function(e){this._state=Object(s.__assign)(Object(s.__assign)({},this._state),e)};e.prototype._initializeRunData=function(e,t){this._runCompletionStates[e]={stagesRetrieved:!1,stageOutcomesKnown:0,stageOutcomesKnownButIncomplete:0,stagesRequired:0,age:t};this._data[e]={siteScriptData:void 0,stageResultData:void 0}};e.prototype._notifyListeners=function(e){var t=this._registeredCallbacks[e];if(t)for(var n in t)if(t.hasOwnProperty(n))try{t[n](Object(s.__assign)({},this._state))}catch(e){}};e.prototype._checkForPendingSiteDesign=function(){var e=this;this._siteDesignRunRequestSentDict[g]=!0;return this._provider.getIsSiteDesignPending().then(function(t){if(t){u.e.isActivated("402D171D-93E7-49F4-8E32-4231EFA41B9D","5/10/2019","Show stages for long site designs")?e._initializeRunData(g,i.new):e._initializeRunData(g,i.unknown);e._updateState(Object(s.__assign)(Object(s.__assign)({},e._runCompletionStates[g]),{isSiteDesignPending:!0}));e._notifyListeners(r.newProgressData);u.e.isActivated("402D171D-93E7-49F4-8E32-4231EFA41B9D","5/10/2019","Show stages for long site designs")?e._getSiteDesignProgress(g,g,m,new d(3,2),!0,!1):e._getSiteDesignProgress(g,g,m,new d(3,2),!0,!0);return!0}return e._getSiteDesignTasks().then(function(t){if(t.length){e._initializeRunData(t[0].taskId,i.new);e._updateState(Object(s.__assign)(Object(s.__assign)({},e._runCompletionStates[t[0].taskId]),{displayedRunKey:t[0].taskId,isSiteDesignPending:!0}));e._notifyListeners(r.newProgressData);e._getSiteDesignProgress(t[0].taskId,t[0].taskId,t[0].siteDesignId,new d(3,2),!1,!0);return!0}return!1})},function(){return!1})};e.prototype._getSiteDesignStages=function(e,t){var n=this,i=this._provider.getSiteDesignStages(t);i.then(function(t){if(!n._data[e].siteScriptData){n._data[e].siteScriptData=t;n._runCompletionStates[e].stagesRetrieved=!0;n._runCompletionStates[e].stagesRequired=t.stageNames.length;n._runCompletionStates[e].isSchemaDirty=!0;if(e===n._state.displayedRunKey){n._updateState(n._runCompletionStates[e]);n._notifyListeners(r.newNonProgressData)}}});return i};e.prototype._getStageOutcomesKnownButIncomplete=function(e){for(var t=0,n=0;n<e.length;n++)4===e[n].outcomeCode&&(t+=1);return t};return e})()},1661:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.download=0]="download";e[e.open=1]="open";e[e.textContent=2]="textContent";e[e.viewInBrowser=3]="viewInBrowser";e[e.bingClickInstrumentation=4]="bingClickInstrumentation";e[e.original=5]="original";e[e.shortcutTarget=6]="shortcutTarget";e[e.video=7]="video";e[e.downloadAsZip=8]="downloadAsZip";e[e.itemUrl=9]="itemUrl";e[e.mediaBaseUrl=10]="mediaBaseUrl"})(r||(r={}));t.t=r},1696:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(93),i=n(404),s=n(317),o=(function(){function e(){}e.getBatchOperationUrl=function(e,t){return new i.t({webAbsoluteUrl:!e&&t?new s.e(t).authority:e}).build().segment("$batch").toString()};e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var r=e.code?e.code.split(","):e.error.code.split(","),i=Number(r[0]),s=e.message.value;n.error={code:i,message:s}}return{items:[n]}};e.getBatchResponseText=function(e){var t,n,r,i=[];e.split("\n").length>0&&(t=e.split("\n")[0]);if(t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var s=1;s<n.length;s++)(r=n[s].split("\n\r")).length>2&&i.push(r[2])}return i};e.processBatchResponse=function(e,t,n){var r,i,s,o,u=[],a=!1;e.split("\n").length>0&&(r=e.split("\n")[0]);if(r){i=(e=e.replace(r.trim()+"--","")).split(r);for(var f=1;f<i.length;f++)if((s=i[f].split("\n\r")).length>2){try{o=JSON.parse(s[2])}catch(e){o=s[2]}var l=t&&t[f-1],c=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var h=o.code?o.code.split(","):o.error.code.split(","),p=Number(h[0]),d=o.message.value;c.error={code:p,message:d};a=!0}u.push(c)}}return{items:u,hasError:a}};e.getBatchContent=function(e,t,n,i){for(var s=[],o=0;o<t.length;o++){for(var u=t[o],a=r.e.generate(),f=[],l=0;l<u.length;l++){var c=u[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");f.push(n+" "+c+" HTTP/1.1");f.push(i);f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");s.push("--batch_"+e);s.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');s.push("Content-Length: "+h.length);s.push("Content-Transfer-Encoding: binary");s.push("");s.push(h);s.push("")}s.push("--batch_"+e+"--");return s.join("\r\n")};e.getBatchContentExtended=function(e,t,n,i,s,o,u){var a=r.e.generate(),f=[];s&&s.length!==t.length&&(s=null);for(var l=0;l<t.length;l++){var c=t[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");u?f.push(u[l]+" "+c+" HTTP/1.1"):f.push(n+" "+c+" HTTP/1.1");f.push(i);o&&f.push(o);if(s){f.push("");f.push(s[l])}f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");(f=[]).push("--batch_"+e);f.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');f.push("Content-Length: "+h.length);f.push("Content-Transfer-Encoding: binary");f.push("");f.push(h);f.push("");f.push("--batch_"+e+"--");return f.join("\r\n")};e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose";e.defaultBatchAcceptData="accept: application/json;odata=verbose";return e})();t.t=o},1711:function(e,t,n){"use strict";var r,i=n(144);(function(e){e.getFilterData=function(e,t,r){var s=[];e=e.split("<br>")[0];var o=document.createElement("DIV");o.innerHTML=e;var u=o.querySelector("#diidFilter"+t);if(null!=u)for(var a=u.childNodes.length,f=u.childNodes,l=1;l<a;l++){var c=i.default.getText(f[l]),h=f[l].value.toString(),p={display:c,value:h};if(r){var d=n(h);if(d.filterType){p.value=d.value;p.calculatedFieldOriginFilterValue=h;p.calculatedFieldFilterType=d.filterType;s.push(p)}}else s.push(p)}for(var v={},m=0,g=s;m<g.length;m++){(w=g[m]).display in v?v[w.display]++:v[w.display]=1}for(var y=0,b=s;y<b.length;y++){var w;v[(w=b[y]).display]>1&&(w.display=w.value)}return s};var t=["Text","Text","Text","Text","Text","Number","Text","DateTime","Text","Text","Error","Boolean"];function n(e){var n=e.indexOf("_"),r=e,i=void 0;if(n>0){r=e.substring(n+1);var s=Number(e.substring(0,n));!isNaN(s)&&s<t.length&&(i=t[s])}return{value:r,filterType:i}}e.getCalculatedFieldFilterValueAndType=n})(r||(r={}));t.e=r},1772:function(e,t,n){"use strict";n.r(t);n.d(t,"HubSiteQueryOption",function(){return r});n.d(t,"HubSiteJoinApprovalErrorCode",function(){return i});n.d(t,"HubDataSource",function(){return y});var r,i,s=n(0),o=n(887),u=n(297),a=n(437),f=n(40),l=n(14),c=n(61),h=n(93),p=n(225),d=n(15),v={ODB:1076},m={ODB:1631},g={ODB:1145};(function(e){e[e.Parent=0]="Parent";e[e.Children=1]="Children";e[e.Siblings=2]="Siblings"})(r||(r={}));(function(e){e[e.NeedsApproval=1]="NeedsApproval";e[e.SiteNotPendingApproval=2]="SiteNotPendingApproval";e[e.UnexpectedApprovalCorrelationId=3]="UnexpectedApprovalCorrelationId";e[e.ApprovalTokenRejected=4]="ApprovalTokenRejected";e[e.InvalidApprovalToken=5]="InvalidApprovalToken";e[e.Unknown=-1]="Unknown"})(i||(i={}));var y=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"HubDataSource",id:"HubDataSource",cacheTimeoutTime:36e5,cacheType:d.e.isActivated("8f9b8975-e745-4add-8517-2acbbaa982f3","06/11/2020","Use local cache to store hub data")?p.e.session:p.e.local},{pageContext:t})||this;n._parseRawHubSite=function(e){return e?{etag:e.Version||(e.__metadata?e.__metadata.etag:void 0),id:e.ID,siteId:e.SiteId,siteUrl:e.SiteUrl,logoUrl:e.LogoUrl,name:e.Title,description:e.Description,targets:n._parseReturnedHubSiteTargetString(e.Targets),siteDesignId:e.SiteDesignId,requiresJoinApproval:e.RequiresJoinApproval,hideNameInNavigation:e.HideNameInNavigation,parentHubSiteId:e.ParentHubSiteId,isNavAudienceTargeted:e.IsNavAudienceTargeted,enablePermissionsSync:e.EnablePermissionsSync}:void 0};n._parseReturnedHubSites=function(e){var t=JSON.parse(e).d;return t.Items?t.Items.results:t.results};return n}t.prototype.getHubData=function(e,t,n){var r=this,i=this._pageContext.hubSiteId,u=t;!t&&this.isCachedDataInvalidated(i)&&(t=!0);return this.getDataUtilizingCache({getUrl:function(){return r._pageContext.webAbsoluteUrl+"/_api/web/HubSiteDataAsStream"+(t?"(true)":"")},qosName:"GetHubData",cacheRequestKey:i,bypassCache:t,setInvalidated:u,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0}).then(function(n){var i=n?Object(s.__assign)(Object(s.__assign)({},n),{navigation:o.t.transformNodesToLinks(n.navigation||[])}):void 0;return e?r._ensureHubNavData(i,t):i}).then(function(e){var t=new a.e(r._pageContext);return r._pageContext&&e&&!e.usesMetadataNavigation&&!n&&a.e.isAudienceTargetedNavEnabled()&&e.isNavAudienceTargeted?t.filterLinks(e.navigation).then(function(t){return Object(s.__assign)(Object(s.__assign)({},e),{navigation:t})}):e})};t.prototype.joinHubSite=function(e,t,n){e||(e=h.e.Empty);var r=t?{approvalToken:t,approvalCorrelationId:n}:void 0;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/JoinHubSite(@v1)?@v1='"+c.e.encodeRestUriStringToken(e)+"'",qosName:"JoinHubSite",additionalPostData:JSON.stringify(r),parseResponse:function(){},noRedirect:!0}).catch(function(e){if(e.code&&e.code.indexOf("HubSiteJoinApprovalException")>=0){var t=Number(e.code.substring(0,e.code.indexOf(",")));throw Object(s.__assign)({hubSiteJoinApprovalErrorCode:t},e)}throw e})};t.prototype.getConnectedHubs=function(e,t){var n=this;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/hubsites/getconnectedhubs(hubSiteId='"+e+"',option='"+t+"')",qosName:"HubSite.GetConnectedHubs",parseResponse:this._parseReturnedHubSites,method:"GET"}).then(function(e){return e?e.map(n._parseRawHubSite):void 0})};t.prototype.makeHubSite=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/RegisterHubSite",qosName:"MakeHubSite",parseResponse:function(e){return JSON.parse(e).d}}).then(this._parseRawHubSite)};t.prototype.registerHubSite=function(e){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/SPO.Tenant/RegisterHubSiteWithCreationInformation",qosName:"RegisterHubSite",parseResponse:function(e){return JSON.parse(e).d},additionalPostData:JSON.stringify({siteUrl:e.SiteUrl,creationInformation:e}),method:"POST"}).then(this._parseRawHubSite)};t.prototype.removeHubSite=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/UnregisterHubSite",qosName:"RemoveHubSite",parseResponse:function(){}})};t.prototype.getHubSites=function(){var e=this;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/HubSites",qosName:"GetHubSites",method:"GET",parseResponse:this._parseReturnedHubSites,noRedirect:!0}).then(function(t){return t?t.map(e._parseRawHubSite):void 0})};t.prototype.getHubSite=function(e){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/HubSites/GetById('"+e+"')",qosName:"GetHubSite",parseResponse:function(e){return JSON.parse(e).d},noRedirect:!0}).then(this._parseRawHubSite)};t.prototype.updateHubSite=function(e){var t={__metadata:{etag:e.etag,type:"SP.HubSite"},LogoUrl:e.logoUrl,Title:e.name,Description:e.description};t.Targets=this._constructHubSiteTargetString(e.targets);t.SiteDesignId=e.siteDesignId;t.HideNameInNavigation=e.hideNameInNavigation;f.n.isFeatureEnabled(v)&&(t.RequiresJoinApproval=e.requiresJoinApproval);f.n.isFeatureEnabled(m)&&(t.ParentHubSiteId=e.parentHubSiteId);f.n.isFeatureEnabled(g)&&(t.EnablePermissionsSync=e.enablePermissionsSync);return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/HubSites/GetById('"+e.id+"')",qosName:"UpdateHubSite",method:"POST",additionalPostData:JSON.stringify(t),additionalHeaders:{"X-HTTP-Method":"MERGE","If-Match":"*"},noRedirect:!0})};t.prototype.canCreateHubJoinedSite=function(e){var t=this,n=e+this._pageContext.userId;return this.getDataUtilizingCache({getUrl:function(){return t._pageContext.webAbsoluteUrl+"/_api/SPSiteManager/CanCreateHubJoinedSite('"+e+"')"},qosName:"CanCreateHubJoinedSite",cacheRequestKey:""+n,parseResponse:function(e){return JSON.parse(JSON.parse(e).d.CanCreateHubJoinedSite)},noRedirect:!0}).then(function(e){return e})};t.prototype.syncHubSiteTheme=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web/SyncHubSiteTheme",qosName:"SyncHubSiteTheme",parseResponse:function(){},noRedirect:!0})};t.prototype.onHubSiteJoinRequestStarted=function(e){var t=e?{approvalCorrelationId:e}:void 0;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/OnHubSiteJoinRequestStarted",method:"POST",qosName:"OnHubSiteJoinRequestStarted",additionalPostData:JSON.stringify(t),parseResponse:function(){}})};t.prototype.onHubSiteJoinRequestCanceled=function(e){var t=e?{approvalCorrelationId:e}:void 0;return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/OnHubSiteJoinRequestCanceled",method:"POST",qosName:"OnHubSiteJoinRequestCanceled",additionalPostData:JSON.stringify(t),parseResponse:function(){}})};t.prototype.getHubSiteJoinApprovalCorrelationId=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/GetHubSiteJoinApprovalCorrelationId",method:"GET",qosName:"GetHubSiteJoinApprovalCorrelationId",parseResponse:function(e){return JSON.parse(e).d.GetHubSiteJoinApprovalCorrelationId}})};t.prototype.onHubSiteJoinRequestApproved=function(e){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/OnHubSiteJoinRequestApproved",method:"POST",qosName:"OnHubSiteJoinRequestApproved",additionalPostData:JSON.stringify({joiningSiteId:e}),parseResponse:function(e){return JSON.parse(e).d.OnHubSiteJoinRequestApproved}})};t.prototype.grantHubSiteRights=function(e,t){return 0===t.length?l.n.resolve():this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/SPO.Tenant/GrantHubSiteRightsById",method:"POST",qosName:"GrantHubSiteRights",additionalPostData:JSON.stringify({hubSiteId:e,principals:t,grantedRights:1}),additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"application/json; odata.metadata=minimal"}})};t.prototype.revokeHubSiteRights=function(e,t){return 0===t.length?l.n.resolve():this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/SPO.Tenant/RevokeHubSiteRightsById",method:"POST",qosName:"RevokeHubSiteRights",additionalPostData:JSON.stringify({hubSiteId:e,principals:t})})};t.prototype._ensureHubNavData=function(e,t){if(e&&e.usesMetadataNavigation){var n=this._pageContext,r={env:n.env,killSwitches:n.killSwitches,layoutsUrl:n.layoutsUrl,siteAbsoluteUrl:e.url,siteClientTag:"",webAbsoluteUrl:e.url,webServerRelativeUrl:null,webTemplate:null,hasManageWebPermissions:!1,systemUserKey:n.systemUserKey,userDisplayName:n.userDisplayName,userId:n.userId,userLoginName:n.userLoginName,userEmail:n.userEmail};return new o.t(r,"GlobalNavigationSwitchableProvider").getMenuState({useCache:!0,forceRefresh:t}).then(function(t){var n=t&&t.links||[];return Object(s.__assign)(Object(s.__assign)({},e),{navigation:n})})}return l.n.resolve(e)};t.prototype._parseReturnedHubSiteTargetString=function(e){var t=[];if(e)for(var n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("ace"),r=0;r<n.length;r++){var i=n[r].getAttribute("identityName"),s=n[r].getAttribute("displayName"),o="";if(i){var u=i.split("|"),a=u[u.length-1];a.indexOf("@")>0&&(o=a)}t.push({userId:i,email:o,name:s})}return t};t.prototype._constructHubSiteTargetString=function(e){if(e&&e.length>0){var t="<acl>";e.forEach(function(e){t+='<ace identityName="'+e.userId+'" displayName="'+e.name+'" allowRights="1" />'});return t+"</acl>"}return""};return t})(u.t);t.default=y},1773:function(e,t,n){"use strict";n.d(t,"r",function(){return a});n.d(t,"t",function(){return f});n.d(t,"n",function(){return l});n.d(t,"e",function(){return c});var r=n(40),i=n(15),s={ODB:751},o="https://flow.microsoft.com",u="https://tip1.flow.microsoft.com";function a(){return r.n.isFeatureEnabled(s)}function f(e){if(i.e.isActivated("BE4B8FC5-0DC1-4A4B-A35F-7C7C1E3573BF","7/25/2019","Use Flow hostname from farmSettings"))return a()?u:o;if(a())return u;var t=e&&e.farmSettings&&e.farmSettings.ExternalService_flowhostname;return t?"https://"+t:o}function l(e,t){return f(t)+"/manage/environments/"+e.environmentId+"/flows/shared/"+e.id+"/details"}function c(e,t){return f(t)+"/manage/environments/"+e+"/approvals/received"}},1774:function(e,t,n){"use strict";var r=n(14),i=n(139),s=n(346),o=n(145),u=n(143),a=n(93),f=n(33),l=n(82),c=n(1476),h=n(1773),p=n(2923),d=n(1488),v=n(15),m="FlowWidgetProvider.",g=(function(){function e(e,t){void 0===e&&(e={});this._params=e;this._oAuthTokenProvider=t.oAuthTokenProvider||new c.e({},{oAuthTokenDataSource:new d.e(t.pageContext)});this._async=new i.e;this._widget=null;this._widgetErrorTimeout=null;this._pageContext=t.pageContext}e.prototype.dispose=function(){this._widgetReadyQos&&this._widgetReadyQos.end({resultType:f.e.ExpectedFailure,extraData:{message:"Widget disposed"}});this._renderWidgetQos&&this._renderWidgetQos.end({resultType:f.e.ExpectedFailure,extraData:{message:"Widget disposed"}});this._notifyWidgetQos&&this._notifyWidgetQos.end({resultType:f.e.ExpectedFailure,extraData:{message:"Widget disposed"}});if(this._widgetErrorTimeout){this._async.clearTimeout(this._widgetErrorTimeout);this._widgetErrorTimeout=null}if(this._widget){this._widget.dispose();this._widget=null}};e.prototype.launchFlowWidget=function(t,n){var r=this;o.e.logData({name:m+"PanelOpened",extraData:{flowId:n.flow.id}});e._loadSdk(this._pageContext).then(function(e){t.id||(t.id="od-Flow-iframeContainer-"+a.e.generate());var i={container:t.id,campaign:n.campaign,environmentId:n.flow.environmentId,enableOnBehalfOfTokens:!0,enableRegionalPortal:!0,widgetStyleSettings:n.widgetStyleSettings,approvalCenterSettings:n.approvalCenterSettings,templatesSettings:{useServerSideProvisioning:!0,defaultParams:n.widgetDefaultParams,allowCustomFlowName:n.allowCustomFlowName},enableWidgetV2:u.e.isFeatureEnabled(p.e)};r._widgetReadyQos=new l.e({name:m+"WidgetReady"});r._renderWidgetQos=new l.e({name:m+"RenderWidget"});r._widgetErrorTimeout=r._setErrorTimeout("WIDGET_READY");try{var s=e.renderWidget(n.widgetType,i);r._registerListeners(s);r._widget=s;r._currentFlowParams=n}catch(e){r._onWidgetError(e)}})};e.preloadSdk=function(t,n){o.e.logData({name:m+"PreloadSdk"});return e._loadSdk(n,t).then(function(){return r.n.resolve()})};e.prototype._registerListeners=function(e){var t=this;e.listen("GET_ACCESS_TOKEN",function(e,n){t._onGetAccessToken(e,n)});e.listen("WIDGET_READY",function(){t._onWidgetReady(e)});e.listen("WIDGET_RENDERED",function(){t._onWidgetRendered()});e.listen("RUN_FLOW_STARTED",function(){t._onTriggerFlowStarted()});e.listen("RUN_FLOW_COMPLETED",function(e){t._onTriggerFlowSucceeded(e)});e.listen("RUN_FLOW_DONE_BUTTON_CLICKED",function(){t._onTriggerFlowDoneClicked()});e.listen("RUN_FLOW_CANCEL_BUTTON_CLICKED",function(){t._onTriggerFlowCancelClicked()});e.listen("WIDGET_CLOSE",function(){t._onWidgetClose()});e.listen("FLOW_CREATION_SUCCEEDED",function(e){t._onFlowCreationSucceeded(e)});e.listen("FLOW_CREATION_FAILED",function(){t._onFlowCreationFailed()});e.listen("RECEIVED_APPROVAL_STATUS_CHANGED",function(e){t._onApprovalStatusChanged(e)});e.listen("GET_STRINGS",function(e,n){t._onGetStrings(e,n)})};e.prototype._notifyWidget=function(e,t){var n=this;this._notifyWidgetQos=new l.e({name:m+"NotifyWidget"});e.notify(t.actionName,t.actionData).then(function(){n._notifyWidgetQos.end({resultType:f.e.Success,extraData:{flowId:t.flow.id}})}).catch(function(e){var r=f.e.Failure,i=null;if(e){var s=e.code;"runFlowWidgetCancelled"!==s&&"flowWidgetClosed"!==s||(r=f.e.Success);i=s}else i="Error unknown: no error returned in the notifyWidget promise catch clause.";n._notifyWidgetQos.end({resultType:r,extraData:{flowId:t.flow.id,message:i}})})};e.prototype._onGetAccessToken=function(e,t){this._getToken().then(function(e){t(null,{token:e})})};e.prototype._onWidgetReady=function(e){this._widgetReadyQos.end({resultType:f.e.Success});this._async.clearTimeout(this._widgetErrorTimeout);this._widgetErrorTimeout=this._setErrorTimeout("WIDGET_RENDERED");this._notifyWidget(e,this._currentFlowParams)};e.prototype._onWidgetRendered=function(){this._async.clearTimeout(this._widgetErrorTimeout);this._widgetErrorTimeout=null;this._renderWidgetQos.end({resultType:f.e.Success});this._params.onWidgetRendered&&this._params.onWidgetRendered()};e.prototype._onTriggerFlowStarted=function(){o.e.logData({name:m+"RunFlowClicked",extraData:{flowId:this._currentFlowParams.flow.id}});this._params.onTriggerFlowStarted&&this._params.onTriggerFlowStarted(this._currentFlowParams)};e.prototype._onTriggerFlowSucceeded=function(e){u.e.isFeatureEnabled(p.t)&&o.e.logData({name:"ManualFlowTriggered",isIntentional:!0});if(this._params.onTriggerFlowSucceeded){var t=e.data;this._params.onTriggerFlowSucceeded(this._currentFlowParams,t)}};e.prototype._onTriggerFlowDoneClicked=function(){this._params.onTriggerFlowDoneClicked&&this._params.onTriggerFlowDoneClicked(this._currentFlowParams)};e.prototype._onTriggerFlowCancelClicked=function(){this._params.onTriggerFlowCancelClicked&&this._params.onTriggerFlowCancelClicked(this._currentFlowParams)};e.prototype._onWidgetClose=function(){this._params.onWidgetClose&&this._params.onWidgetClose(this._currentFlowParams)};e.prototype._onFlowCreationSucceeded=function(e){if(this._params.onFlowCreationSucceeded){var t=e.data;this._params.onFlowCreationSucceeded(this._currentFlowParams,t)}};e.prototype._onFlowCreationFailed=function(){this._params.onFlowCreationFailed&&this._params.onFlowCreationFailed(this._currentFlowParams)};e.prototype._onApprovalStatusChanged=function(e){this._params.onApprovalStatusChanged&&this._params.onApprovalStatusChanged(e)};e.prototype._onGetStrings=function(e,t){this._currentFlowParams.additionalEvents&&this._currentFlowParams.additionalEvents.indexOf("GET_STRINGS")>-1&&this._params.onGetStrings?this._params.onGetStrings(t):t(null,{})};e.prototype._onTokenError=function(e){this._params.onTokenError&&this._params.onTokenError(e)};e.prototype._onWidgetError=function(e){this._renderWidgetQos&&this._renderWidgetQos.end({resultType:f.e.Failure,extraData:{message:e.message}})};e.prototype._setErrorTimeout=function(e){var t=this;return this._async.setTimeout(function(){t._onWidgetError(new Error("Timeout: Widget timed out waiting for: "+e))},15e3)};e._loadSdk=function(t,i){if(e._loadSdkPromise)return e._loadSdkPromise;e._loadSdkPromise=new r.n(function(e){0;n.e("30").then(n.t.bind(null,3079,7)).then(function(n){var r=new MsFlowSdk({hostName:Object(h.t)(t),locale:s.e.language,hostId:i});e(r)})});return e._loadSdkPromise};e.prototype._getToken=function(){var e=this;return new r.n(function(t){var n=new l.e({name:m+"GetToken"}),r="https://service.flow.microsoft.com/";if(!v.e.isActivated("EE645DA8-7C00-446D-9E39-7A11F52BF789","7/25/2019","Use Flow hostname from farmSettings")){var i=e._pageContext&&e._pageContext.farmSettings&&e._pageContext.farmSettings.ExternalService_flowservicehostname;i&&(r="https://"+i+"/")}e._oAuthTokenProvider.getToken(r).then(function(e){t(e);n.end({resultType:f.e.Success})},function(r){e._onTokenError(r);n.end({resultType:f.e.Failure,extraData:{serverErrorCode:r._serverErrorCode,message:r.message}});t(null)})})};return e})();t.e=g},1781:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(1545),s=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,Object(r.__assign)(Object(r.__assign)({},t),{isExpected:o(t.errorType)}))||this;n.message=t.message;n.errorType=t.errorType||i.e.other;n.maxSizeInBytes=t.maxSizeInBytes;n.allowRename=t.allowRename||!1;n.allowMerge=t.allowMerge||!1;n.supportsVersioning=t.supportsVersioning||!1;n.extraData=t.extraData;n.libraryName=t.libraryName;n.isFolder=t.isFolder;n.fixItUrl=t.fixItUrl;return n}return t})(n(115).e);function o(e){switch(e){case i.e.conflict:case i.e.emptyFileOrFolder:case i.e.emptyFileOrFolderForDocLib:case i.e.fileSize:case i.e.folderUploadNotSupported:case i.e.insufficientVaultQuota:case i.e.invalidName:case i.e.lockMismatch:case i.e.malwareDetected:case i.e.overQuota:case i.e.overQuotaSharedFolder:case i.e.pathTooLong:case i.e.targetFolderMissing:case i.e.throttled:case i.e.unlockRequired:case i.e.versionMismatch:return!0;case i.e.accessDenied:case i.e.itemNotFound:case i.e.disconnected:case i.e.authFailure:case i.e.general:return!1;case i.e.none:case i.e.other:return}}},1805:function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r;(function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb";e[e.fluid=39]="fluid";e[e.modernFileExplorer=40]="modernFileExplorer";e[e.listsHome=41]="listsHome";e[e.listsIos=42]="listsIos";e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp"})(r||(r={}));var i=void 0;function s(e){if(void 0===i){i={};for(var t in r){var n=parseInt(t);if(!isNaN(n)){var s=r[n].toLowerCase();i[s]=n}}}var o=e?e.toLowerCase():"";return i[o]||r.unknown}t.e=r},1831:function(e,t,n){"use strict";n.r(t);n.d(t,"getFilter",function(){return a});n.d(t,"updateFilter",function(){return f});n.d(t,"removeFilter",function(){return l});n.d(t,"getAllSmartFilters",function(){return c});n.d(t,"removeSmartFilters",function(){return h});n.d(t,"getEffectiveFilterParams",function(){return p});var r=n(181),i=n(2175),s=n(514),o=n(130),u=n(144);function a(e,t){var n=d(e,t);if(n){var r=i.e(n);if(r&&1===r.length&&r[0]){var s=r[0];s.id=t;return s}}}function f(e,t){if(!t.id)throw new Error("Must provide a filter with an id to use updateFilter");var n=s.e(t);if(!n)throw new Error("Filter could not be serialized");var i=d(e,t.id);if(i){var u=void 0;try{u=o.a(n).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}i.parentNode.replaceChild(u,i);e.setIsDirty(!0,r.e.filters)}else e.addFilters([n])}function l(e,t){var n=d(e,t);if(n){var i=n.parentNode;if("Where"===i.tagName)e.clearFilters();else{i.removeChild(n);"Or"!==i.tagName&&"And"!==i.tagName||i.parentNode.replaceChild(i.firstElementChild,i);e.setIsDirty(!0,r.e.filters)}}}function c(e){var t=e.getDomParts();if(t&&t.where){var n=t.where.querySelectorAll("[id]"),r=[];if(n)for(var s=0;s<n.length;s++){var o=i.e(n[s]);o&&r.push.apply(r,o)}return r}}function h(e){var t=c(e);if(t)for(var n=0,r=t;n<r.length;n++){l(e,r[n].id)}}function p(e,t){var n=e,r=c(t);r&&r.length>0&&r.forEach(function(e){n=u.default.updateFilterInfoInQueryString(n,{filterField:e.fieldName,filterValues:e.values,filterType:e.type,useLookupId:e.lookupId})});return n}function d(e,t){var n=e.getDomParts();if(n&&n.where){var r=n.where.querySelectorAll('[id="'+t+'"]');if(r.length>1)throw new Error("More than one filter found with id "+t);return r[0]}}},1833:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r,i=n(0),s=n(1413),o=n(15),u=n(144),a=n(401),f=n(23);(function(e){e.getItemName=function(e,t,n){return n&&!n.isDocLib&&t!==s.t.Folder&&(e.Title||e["URL.desc"])||e.FileLeafRef};e.updateListContext=function(e,t){if(Number(e.ListTemplateType)){t.listTemplateType=Number(e.ListTemplateType);t.isDocLib=Object(f.i)(t.listTemplateType)}"boolean"==typeof e.ContentTypesEnabled&&(t.contentTypesEnabled=e.ContentTypesEnabled);if(e.ListSchema){t.listId=e.listName;t.rawListSchema=e.ListSchema;t.viewTitle=e.viewTitle;t.openInClient="0"===t.rawListSchema.DefaultItemOpen}e.ListTitle&&(t.listTitle=e.ListTitle);e.listUrlDir&&(t.listUrl=decodeURIComponent(e.listUrlDir));e.EnableAttachments&&(t.enableAttachments="true"===e.EnableAttachments);e.Flags2&&(t.flags2=e.Flags2);var n=e.BasePermissions;n&&(t.permissions={manageLists:n.ManageLists,managePersonalViews:n.ManagePersonalViews,openItems:n.OpenItems});"boolean"!=typeof e.ExcludeFromOfflineClient&&"boolean"!=typeof e.WebExcludeFromOfflineClient||(t.excludeFromOfflineClient=!(!e.ExcludeFromOfflineClient&&!e.WebExcludeFromOfflineClient));"boolean"==typeof e.TenantTagPolicyEnabled&&(t.tenantTagPolicyEnabled=e.TenantTagPolicyEnabled);"boolean"==typeof e.verEnabled&&(t.enableVersions=e.verEnabled);"boolean"==typeof e.checkPowerAppState&&(t.checkPowerAppState=e.checkPowerAppState);"boolean"==typeof e.EnableMinorVersions&&(t.enableMinorVersions=e.EnableMinorVersions);"boolean"==typeof e.NewWOPIDocumentEnabled&&(t.newWOPIDocumentEnabled=e.NewWOPIDocumentEnabled);"number"==typeof e.NewWOPIDocumentTypes&&(t.newWOPIDocumentTypes=e.NewWOPIDocumentTypes);"boolean"==typeof e.isForceCheckout&&(t.isForceCheckout=e.isForceCheckout);"boolean"==typeof e.isModerated&&(t.isModerated=e.isModerated);"boolean"==typeof e.EnableRequestSignOff&&(t.enableRequestSignOff=e.EnableRequestSignOff);"boolean"==typeof e.AllowCreateFolder&&(t.allowCreateFolder=e.AllowCreateFolder);"boolean"==typeof e.AllowGridMode?t.allowGridMode=e.AllowGridMode:"boolean"!=typeof t.allowGridMode&&(t.allowCreateFolder=!0);e.displayFormUrl&&(t.displayFormUrl=e.displayFormUrl);e.editFormUrl&&(t.editFormUrl=e.editFormUrl);e.newFormUrl&&(t.newFormUrl=e.newFormUrl);e.metadataNavFeatureEnabled&&(t.metadataNavFeatureEnabled=e.metadataNavFeatureEnabled);e.AvailableContentTypes&&(t.availableContentTypes=e.AvailableContentTypes);if(e.ViewMetadata){var r=void 0;r=o.e.isActivated("F5D38A68-8774-425A-BC0B-1650EAA9C41D","9/21/2018","avoid mutate the original serverView object in the spdata")?e.ViewMetadata:Object(i.__assign)({},e.ViewMetadata);if(e.VisualizationInfo)try{r.VisualizationInfo=JSON.parse(e.VisualizationInfo)}catch(e){}r.CustomFormatter=e.ListSchema&&e.ListSchema.CustomFormatter;t.viewResult=new a.e(r)}t.isPlaceholder=!1};e.updateListContextGroupInfo=function(e){var t=void 0;if(e.groupByOverride)t=[e.groupByOverride];else if(e.rawListSchema&&e.rawListSchema.group1){(t=[]).push(e.rawListSchema.group1);e.rawListSchema.group2&&t.push(e.rawListSchema.group2)}var n=-1,r=e.rawListSchema&&"TRUE"===e.rawListSchema.Collapse;if(t&&t.length>0){n=0;if(e.filterParams&&!r){var i=Boolean(u.default.getFilterFieldByName(e.filterParams,t[0])),s=!(!i||!t[1])&&Boolean(u.default.getFilterFieldByName(e.filterParams,t[1]));(i&&1===t.length||s&&2===t.length)&&(n=-1)}}e.groupLevel=n;e.groupBy=n>-1?t:void 0;e.isGrouped=Boolean(e.groupBy)}})(r||(r={}))},1942:function(e,t,n){"use strict";n.r(t);var r;(function(e){e.getParent=function(e,t){if(e.level&&e.parentKey&&0!==e.level){return t.filter(function(t){return t.groupingId===e.parentKey})[0]}};e.getFilterDetails=function(n,r){for(var i=n,s=[],o=[];i&&i.fieldSchema;){s.unshift(i.fieldSchema.Name);var u=t(i);o.unshift(u);i=e.getParent(i,r)}return{fields:s,values:o}};function t(e){var t="";switch(e.fieldSchema.Type){case"User":case"Lookup":t=e.name;break;case"DateTime":var n=decodeURIComponent(e.groupString).split(";#"),r=n[0];n.length>0&&(n=n.slice(1,n.length-1))[e.level]&&(r=n[e.level]);t=(function(e){if(!e)return e;var t=e.substring(0,4),n=e.substring(4,6),r=e.substring(6,8);return[t,"-",n,"-",r].join("")})(r);break;default:t=e.fieldValue}return t}})(r||(r={}));t.default=r},1992:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(128),i=n(298);function s(e,t){var n=Object(r.e)(e).id;t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0);return n}function o(e,t){var n=e;0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t}));return n}},2108:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(570),s=n(61),o=n(28),u=n(399),a=n(573),f=n(144),l=n(1992),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;n._listContext=t.listContext;n._itemUrlHelper=t.itemUrlHelper||new u.e({},{pageContext:t.pageContext});n._apiUrlHelper=t.apiUrlHelper||new a.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper});n._folderPath=t.folderPath;void 0===n._folderPath&&(n._folderPath=Object(l.t)(t.parentKey,n._listContext));return n}t.prototype.getFilterData=function(e,t,n,r){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,r)},function(e){return e},"GetFilterData")};t.prototype._getFilterDataUrl=function(e,t,n,r){var i=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl}),u=this._apiUrlHelper.build().webByItemUrl(i).method("GetList",i.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e);n&&(u=u.parameter("ViewId",n));this._folderPath&&(u=u.parameter("RootFolder",{raw:s.e.encodeURIComponent(this._folderPath)}));r&&r===o.e.Taxonomy&&(u=u.parameter("ExcludeFieldFilteringHtml",!0));var a=f.default.getFilterParams(t,!0);return(u=u.rawParameter(a)).toString()};return t})(i.t)},2170:function(e,t,n){"use strict";n.d(t,"e",function(){return c});n.d(t,"t",function(){return p});var r=n(14),i=n(82),s=n(33),o=n(1931),u=n(282),a=n(225),f=n(40),l=n(15),c="https://outlook.office.com/search",h={ODB:1286},p=(function(){function e(e,t){this._dataRequestor=new o.e({},{});this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken);this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;if(this._pageContext&&!this._pageContext.isSPO)return e;if(this._pageContext&&this._pageContext.authToken)return e;this._pageContext&&this._oAuthTokenProvider&&f.n.isFeatureEnabled(h)&&(e=!0);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",a.e.session));return e};e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableSubstrateSearch",!0,a.e.session)};e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return r.n.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(c).then(function(e){t.end({resultType:s.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:s.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:s.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableSubstrateCallsForPicker();return null})}return null};e.prototype.init=function(e){var t=c+"/api/v1/init?scenario=documentshare";l.e.isActivated("20373606-dfd1-4220-9a96-50f93570a877","07/03/2020","Removing litoken while calling Substrate.")?this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e,"X-User-Context":"litoken="+e},needsAuthorization:!1}):this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e},needsAuthorization:!1})};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},2175:function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return c});var r=n(52),i=n(450),s=n(130);function o(e){var t="string"==typeof e?Object(i.t)(e):e;return{filters:l(t.where),sorts:u(t.orderBy),groupBy:a(t.groupBy),fieldNames:Object(i.s)(t.viewFields),rowLimit:f(t.rowLimit),associatedContentTypeId:Object(i.i)(t.associatedContentTypeId)}}function u(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return h(e)}).filter(function(e){return!!e});return t.length?t:void 0}}function a(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return h(e)}).filter(function(e){return!!e});if(t.length){var n={isCollapsed:p(e,r.e.collapse,!0),group1:t[0]};t[1]&&(n.group2=t[1]);return n}}}function f(e){if(e&&e.textContent)return{rowLimit:Number(e.textContent),isPerPage:p(e,r.e.paged,!1)}}function l(e){if(e&&e.childElementCount){var t=c(e.firstElementChild);return t&&t.length?t:void 0}}function c(e){if(e){var t;switch(e.tagName){case r.n.and:t=(function(e){if(!e||!e.childElementCount)return;var t=e.firstElementChild,n=c(t);if(!t.nextElementSibling)return n;var r=c(t.nextElementSibling);if(!n&&!r)return;return(n||[]).concat(r||[])})(e);break;case r.n.or:t=(function(e){var t=(function e(t){if(!t.childElementCount)return;var n;switch(t&&t.tagName){case r.n.or:var i=t.firstElementChild,s=e(i);if(s&&i.nextElementSibling){var o=e(i.nextElementSibling);n=o?s.concat(o):void 0}else n=s;break;case r.n.eq:n=d(t);break;case r.n.isNull:n=v(t)}if(n)return Array.isArray(n)?n:[n];return})(e);if(t&&t.length&&!t.some(function(e){return!e})){if(t.every(function(e){return e.fieldName===t[0].fieldName&&e.lookupId===t[0].lookupId})){var n=!1,i=t.reduce(function(e,t){if(!n)if(e.type&&t.type&&e.type!==t.type){n=!0;e.type=void 0}else e.type=e.type||t.type;e.values.push(t.values[0]);return e});i.operator=r.n.eq;i.id=e&&s.t(e,r.e.id);return i}}return null})(e);break;case r.n.isNull:case r.n.isNotNull:case r.n.membership:t=v(e);break;case r.n.beginsWith:case r.n.contains:case r.n.eq:case r.n.greaterEq:case r.n.greater:case r.n.includes:case r.n.lessEq:case r.n.less:case r.n.notEq:case r.n.notIncludes:t=d(e);break;case r.n.inTag:t=(function(e){var t=m(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.values})[0];if(!t||!n)return;var i=!1,s=Array.prototype.map.call(n.childNodes,function(e){var n=g(e);if(n&&n.type&&!i){var r=n.type,s=t.type;i=!(!s||!r||s===r);t.type=s||r}return n&&n.value});if((s=s.filter(function(e){return!!e})).length){t.values=s;i&&(t.type=void 0)}return s.length?t:void 0})(e)}return t?Array.isArray(t)?t.length?t:void 0:[t]:void 0}}function h(e){if(e&&e.tagName===r.n.fieldRef){var t=s.t(e,r.e.name);if(t)return{fieldName:t,isAscending:p(e,r.e.ascending,!0)}}}function p(e,t,n){switch((s.t(e,t)||"").toLowerCase()){case"true":return!0;case"false":return!1;default:return n}}function d(e){var t=m(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.value})[0];if(t&&n){var i=g(n);if(i){t.type=i.type;t.values=[i.value];return t}}}function v(e){var t=m(e);if(t)if(e.tagName===r.n.isNull)t.values=[""];else if(e.tagName===r.n.membership){var n=s.t(e,r.e.type);n?t.values=[n]:t=void 0}return t}function m(e){var t=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.fieldRef})[0],n=t&&s.t(t,r.e.name),i=e&&s.t(e,r.e.id);if(n)return{fieldName:n,id:i,type:void 0,lookupId:p(t,r.e.lookupId),operator:e.tagName,values:void 0}}function g(e){var t=e&&e.childElementCount&&e.firstElementChild.tagName!==r.n.today;if(e&&e.tagName===r.n.value&&!t){var n,i={value:e.textContent,type:s.t(e,r.e.type)};if(e.childElementCount){var o=e.firstElementChild,u=s.t(o,r.e.offset)||s.t(o,r.e.offsetDays),a=parseInt(u,10)||0;i.value=s.i(a);i.type=i.type||"DateTime"}i.value&&"DateTime"===i.type&&!0!==p(e,r.e.includeTimeValue)&&(n=i.value.match(r.t.datetimeNoTimeRegex))&&(i.value=n[1]);return i}}},2419:function(e,t,n){"use strict";n.d(t,"e",function(){return b});n.d(t,"r",function(){return w});n.d(t,"t",function(){return E});n.d(t,"n",function(){return x});n.d(t,"i",function(){return T});var r=n(0),i=n(3743),s=n(399),o=n(573),u=n(570),a=n(1805),f=n(3326),l=n(3742),c=n(92),h=n(1413),p=n(2927),d=n(68),v=n(1539),m=n(143),g=n(15),y=n(1078),b="role:1073741827",w="role:1073741826",E="role:1073741829",S={ODB:1657},x=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;r._getParentListId=t.getParentListId;r._itemUrlHelper=t.itemUrlHelper||new s.e({},{pageContext:t.pageContext});r._apiUrlHelper=t.apiUrlHelper||new o.e({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper});r._sharingContextInformation=t.sharingContextInformation||void 0;r._sharingDataSourceHelper=new p.e({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(c.n)(r._pageContext);r._shareUrl=i+"/_api/SP.Web.ShareObject";return r}t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})};t.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}};t.prototype.getSharingInformation=function(e,t,n,r,i,s){var o,u=this,a=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),f="pickerSettings";t&&(f+=",permissionsInformation");n&&(f+=",sharingLinkTemplates");i&&(f+=",addressBarLinkSettings");o=a.oDataParameter("$Expand",f).toString();return this.getData(function(){return o},function(t){var n=JSON.parse(t);return u._parseGetSharingInformationResponse(n,e)},"GetSharingInformation",null,"POST",null,null,null,!0,void 0,void 0,this._getExtraData(),s)};t.prototype.emailWithoutPermissioning=function(e,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return s},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n&&n.id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,s=e;n<s.length;n++){var o=s[n];t.push(o.rawPersonData)}var u={peoplePickerInput:JSON.stringify(t),emailBody:r,emailSubject:i};return JSON.stringify(u)})};t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);if(t.d){return t.d.CheckPermissions.results}return null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})};t.prototype.share=function(e,n){var r,i=this,s=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(9===n.linkType||6===n.linkType||5===n.linkType)return this._shareLink(e,n);if(s){var o=n.items[0],u=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));r=u.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n.items[0]&&n.items[0].id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}n.roleValue===2..toString()?n.roleValue=b:n.roleValue===1..toString()&&(n.roleValue=w);var u={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};s||(u.url=i._sharingDataSourceHelper.getFileUrl(n.items[0]));return JSON.stringify(u)})};t.prototype.updatePermissions2=function(e,t,n){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case 0:case 1:case 6:case 2:case 3:t=n;break;default:t=1}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return s},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case 0:t=0;break;case 1:t=1;break;case 6:t=6;break;case 2:t=2;break;default:t=1}var s={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(s)})};t.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)};t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})};t.prototype.shareLink=function(e){var t=e.settings,n=e.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(n)).segment("ShareLink").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?T(t):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var n=null;t.expiration&&(n=Object(i.e)(t.expiration.toString()));var r=null;if(e.recipients&&e.recipients.length>0){r=[];for(var s=0,o=e.recipients;s<o.length;s++){var u=o[s];u.rawPersonData&&r.push(u.rawPersonData)}}var a=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){a=[];for(var f=0,l=t.inviteesToRemove;f<l.length;f++){var c=l[f];a.push({id:c.id,loginName:c.loginName,name:c.primaryText,isExternal:c.isExternal,principalType:c.type,email:c.email})}}var h=!0;g.e.isActivated("6F4EB8E9-C7E5-4F82-8801-48F56246C34D","04/09/2020","Send CreateLink for create and update only")||(h=!!t.createLink);var p={request:{createLink:h,settings:{allowAnonymousAccess:t.allowAnonymousAccess,linkKind:t.sharingLinkKind,expiration:n,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId,description:t.description}}};a&&(p.request.settings.inviteesToRemove={results:a});if(r&&r.length>0){p.request.peoplePickerInput=JSON.stringify(r);var d=e.emailData,v=e.emailSubject;void 0!==d&&void 0===v&&(p.request.emailData={body:e.emailData,subject:""});void 0===d&&void 0!==v&&(p.request.emailData={body:"",subject:e.emailSubject});void 0!==d&&void 0!==v&&(p.request.emailData={body:e.emailData,subject:e.emailSubject})}var m=e.settings.shareId;if(m){p.request.settings.shareId=m;p.request.emailData={body:""}}return JSON.stringify(p)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})};t.prototype.shareLinkExpress=function(e,t,n){var r=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?N(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(y.e)(this._pageContext))return a.e.sharePoint;switch(e){case d.t.teamSite:case d.t.group:case d.t.subgroup:case d.t.sitePagePublishing:return a.e.sharePoint;case d.t.mySite:return a.e.odb;default:return g.e.isActivated("49c1f4de-c1fb-47ed-8d4b-695083cb10ef","11/08/2019","Default clientId to SharePoint if unknown for other web templates")?a.e.unknown:a.e.sharePoint}};t.prototype._shareLink=function(e,t){var n=this,r=t.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return s},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var r=[],s=0,o=e;s<o.length;s++){var u=o[s];r.push(u.rawPersonData)}var a=null;t.expiration&&(a=Object(i.e)(t.expiration));var f={request:{peoplePickerInput:JSON.stringify(r),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:a}};return JSON.stringify(f)})};t.prototype._getSharingLinkKind=function(e,t){var n=1;6===e?n=5:5===e?n=4:9===e&&(n=t===2..toString()?3:2);return n};t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0};var n=e.d,r=!!n.permissionsInformation,i=!!n.sharingLinkTemplates,s=m.e.isFeatureEnabled(S)&&r,o=!!n.addressBarLinkSettings,u=r?this._parseSharingLinks(n.permissionsInformation.links.results,n.directUrl):[],a=i?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results):[],l=o?n.addressBarLinkSettings:null,c=[];if(g.e.isActivated("4681ee55-dadc-4d9b-a53c-30012907318a","5/5/2020","Mark site admins amongst sharing principals")){var p=r?n.permissionsInformation.siteAdmins.results.concat(n.permissionsInformation.principals.results):[];c=this._parseSharingPrincipals(p)}else if(r){var d=n.permissionsInformation.siteAdmins.results,v=n.permissionsInformation.principals.results,y=this._parseSharingPrincipals(d);y.forEach(function(e){return e.isSiteAdmin=!0});var b=this._parseSharingPrincipals(v);c=y.concat(b)}var w=this._getDefaultSharingLink(n.defaultLinkKind,u,n.sharingAbilities),E={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var x=t.properties,T=x.ItemChildCount?parseInt(x.ItemChildCount,10):0,N=x.FolderChildCount?parseInt(x.FolderChildCount,10):0,C=t.type===h.t.OneNote?0:T+N,k=this._isPolicyTipFlagSet(t.policyTip,4);E={name:t.name,childCount:C,hasDlpPolicy:k,extension:t.extension,appmap:t.appMap,itemType:t.type}}var L=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||u.length>1;return{anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:L,defaultSharingLink:w,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!s&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(u,c),item:E,sharingLinks:u,sharingPrincipals:c,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:f.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:a,addressBarLinkSettings:l,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering}};t.prototype._computeIsShared=function(e,t){for(var n=!1,r=0,i=e;r<i.length;r++){var s=i[r];s.isActive&&1!==s.sharingLinkKind&&(n=!0)}n||(n=t.length>0);return n};t.prototype._parseSharingLinks=function(e,t){var n=this,r=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t=e.linkDetails;return{allowsAnonymousAccess:t.AllowsAnonymousAccess,hasPassword:t.RequiresPassword,blockDownload:t.BlocksDownload,description:t.Description,audience:C(t.LinkKind,t.AllowsAnonymousAccess,t.RestrictedShareMembership),expiration:t.Expiration?new Date(t.Expiration):null,isActive:t.IsActive,isEdit:k(t.LinkKind)||t.IsEditLink,isReview:t.IsReviewLink,principals:n._parseSharingPrincipals(e.linkMembers.results,t.LinkKind),invitees:n._parseLinkInvitees(t),shareId:t.ShareId,sharingLinkKind:t.LinkKind,url:t.Url,updatePassword:t.UpdatePassword,password:t.Password,passwordLastModifiedBy:n._parseSharingPrincipal(t.PasswordLastModifiedBy),isCreateOnlyLink:t.IsCreateOnlyLink,isAddressBarLink:t.IsAddressBarLink,isUnhealthy:t.IsUnhealthy}});(r=r.sort(function(e,t){return n._getLinkRanking(t)-n._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:f.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null});return r};t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case f.e.anyone:t+=30;break;case f.e.organization:t+=20;break;case f.e.specificPeopleFlex:t+=10}e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1);return t};t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case 0:t+=30;break;case 1:t+=20;break;case 2:t+=10}switch(e.role){case 2:t+=3;break;case 6:t+=2;break;case 1:t+=1}}return t};t.prototype._parseSharingLinkTemplates=function(e){var t=this,n=e.map(function(e){var n,r=e.linkDetails;null!==r&&(n={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:C(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:k(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:t._parseSharingPrincipal(r.PasswordLastModifiedBy)});return{linkDetails:n,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}});return n=n.sort(function(e,n){return t._getSharingLinkTemplateRanking(n)-t._getSharingLinkTemplateRanking(e)})};t.prototype._parseLinkInvitees=function(e){var t=e.Invitations;if(!t)return[];for(var n=[],r=0,i=t.results;r<i.length;r++){var s=i[r];s&&s.invitee&&n.push(s.invitee)}return n.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:Object(v.e)(t.email)}})};t.prototype._parseSharingPrincipals=function(e,t){var n=e.map(function(e){var n=e.principal;n||(n=e);var r={id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:Object(v.e)(n.email),email:n.email};t&&(r.sharingLinkKind=t);return r});return p.e.getUniqueSharingPrincipals(n)};t.prototype._getExtraData=function(){var e;this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:l.e[this._sharingContextInformation.mode]});return e};t.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;t||(t=e);return{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:Object(v.e)(t.email),email:t.email}}return null};t.prototype._getDefaultSharingLink=function(e,t,n){(n.peopleSharingLinkAbilities.canManageEditLink.enabled||n.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var r=e;5!==r||n.anonymousLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anonymousLinkAbilities.canManageReadLink.enabled||(r=3);3!==r||n.organizationLinkAbilities.canManageEditLink.enabled||(r=2);2!==r||n.organizationLinkAbilities.canManageReadLink.enabled||(r=1);var i=void 0;g.e.isActivated("EC56AEFA-095C-4470-B17D-E0A9462C99C9","04/09/2020","Set the audience correctly in the default sharing link")||(5===e||4===e?i=f.e.anyone:3===e||2===e?i=f.e.organization:1===e?i=f.e.specificPeople:6===e&&(i=f.e.specificPeopleFlex));return{allowsAnonymousAccess:void 0,audience:i,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}};t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return t})(u.t);function T(e){if(e.d){return N(e.d.ShareLink.sharingLinkInfo)}}function N(e){var t=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:C(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership),expiration:t,description:e.Description,isActive:e.IsActive,isEdit:k(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,shareId:e.ShareId,sharingLinkKind:e.LinkKind,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy}}}function C(e,t,n){return 5===e||4===e?f.e.anyone:3===e||2===e?f.e.organization:1===e?f.e.specificPeople:6===e?t?f.e.anyone:!1===n?f.e.organization:f.e.specificPeopleFlex:void 0}function k(e){return 5===e||3===e||4!==e&&2!==e&&null}},2543:function(e,t,n){"use strict";var r=n(263),i=n(25),s="forms.officeppe.com",o="forms.office.com",u="&action=edit";function a(e,t,n){var r=e.replace(u,""),i=n?s:o,a="Action=Create&Host=OneDrive&XlWorkbookId="+encodeURIComponent(r)+"&Title="+encodeURIComponent(t);return"https://"+i+"/Pages/DesignPage.aspx?Action=Create&Fragment="+encodeURIComponent(a)}n.d(t,"e",function(){return f});n.d(t,"t",function(){return l});function f(e,t,n){var r=void 0;"string"==typeof e?0===(e=e.trim()).length?r=t.emptyNameError:/["\*:<>\?\/\\\|]/.test(e)&&(r=i.format(n?t.invalidNameError2:t.invalidNameError,e)):r=t.emptyNameError;return r}function l(e,t,n,i){var s="";null!==e&&""!==e&&(s=t===r.e.ExcelSurvey?e.replace("action=edit","action=formedit"):t===r.e.ExcelForm?a(e,n,i):e.replace("action=edit","action=editnew"));return s}},2576:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(14),i=n(40),s=n(82),o=n(33),u=n(282),a=n(225),f={ODB:387},l=(function(){function e(e,t){this._pageContext=t.pageContext;this._sharingContextInformation=t.sharingContextInformation;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken);this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.n.isFeatureEnabled(f);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",a.e.session));return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableGraph",!0,a.e.session)};e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return r.n.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new s.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken("https://graph.microsoft.com").then(function(e){t.end({resultType:o.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:o.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:o.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},2912:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(0),i=n(92),s=n(53),o=n(2913),u=n(61),a=n(1076),f=n(570),l=n(23),c="SuiteNavDataSource",h=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:c},n)||this;r._suiteNavContext=t.suiteNavContext;r._suiteNavDataUpdater=t.suiteNavDataUpdater;r._suiteNavDataSourceBasic=t.suiteNavDataSourceBasic?t.suiteNavDataSourceBasic:new a.e(t,n);return r}t.prototype.getCapabilities=function(){return this._suiteNavDataSourceBasic.getCapabilities()};t.prototype.getReactShellBootstrapperUrl=function(){return this._suiteNavDataSourceBasic.getReactShellBootstrapperUrl()};t.prototype.getInitialRenderNavBarData=function(){return this._suiteNavDataSourceBasic.getInitialRenderNavBarData()};t.prototype.getCacheToken=function(){return this._suiteNavDataSourceBasic.getCacheToken()};t.prototype.getUserIdentifier=function(){return this._suiteNavDataSourceBasic.getUserIdentifier()};t.prototype.setFeedbackMetadata=function(e){var t=this._suiteNavContext.feedbackOptions;if(t&&t.appId){var n=(e=e||{contentLanguage:void 0,source:"OneShell",options:{telemetryGroup:{}}}).options;n.appId=t.appId;n.userVoiceEnabled=t.userVoiceEnabled;n.userVoiceLink=t.userVoiceLink;var r=n.telemetryGroup;r.audienceGroup=this._getAudienceGroup();r.featureArea=this._getFeatureArea();r.processSessionId=this._pageContext.CorrelationId}return e};t.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;var n,r=u.e.escapeUrlForCallback(this._pageContext.currentUICultureName),s=Object(i.n)(this._pageContext),o=s?u.e.escapeUrlForCallback(s):"",f=o+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale="+r+"&v=2&msajax=1&cv=2",l=o+"/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale="+r,c=function(e){return t.getData(function(){return e},function(e){return JSON.parse(e)},"LoadData",null,"POST",null,null,1).then(function(n){var r=e===f?n:JSON.parse(n.d.GetSuiteNavData),i={suiteNavData:r.NavBarData,suiteNavContext:t._suiteNavContext,pageContext:t._pageContext},s=t._suiteNavDataUpdater?t._suiteNavDataUpdater.updateSuiteNavData(i):r.NavBarData,o=!(!s.HasTenantBranding||!r.TenantPrimaryColorShades&&!s.TenantLogoUrl);s.AppBrandTheme=Object(a.n)(t._suiteNavContext);return{data:s,jsUrl:r.JsUrl,cssUrl:r.CssUrl,hasCobranding:o,userIdentifier:t.getUserIdentifier(),cacheToken:t.getCacheToken()}})};n=this._pageContext.isSPO?c(f).catch(function(){return c(l)}):c(l);this._dataPromise=n;n.catch(function(){t._dataPromise=null});return n};t.prototype.onCssLoad=function(e){if(e.data&&e.data.ClientData)try{var t=JSON.parse(e.data.ClientData);t&&t.IsFallbackShell&&Object(o.e)()}catch(e){}};t.prototype.updateDataForCurrentPage=function(e){var t={suiteNavData:e,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext};return this._suiteNavDataUpdater.updateSuiteNavData(t)};t.prototype._getAudienceGroup=function(){var e,t=this._pageContext;"prodbubble"===t.env&&"MSIT_SPDF_1_Content"===t.farmLabel?e="Dogfood":"prodbubble"===t.env?e="Microsoft":"prod"!==t.env&&"dprod"!==t.env||(e="Production");return e};t.prototype._getFeatureArea=function(){var e=this._pageContext;return e.listBaseTemplate===l.t.genericList?"List":e.listBaseTemplate===l.t.documentLibrary?"Libraries":e.listBaseTemplate===l.t.webPageLibrary?"Modern Pages and News Authoring (Floodgate)":"Site"};t.siteSettingsPermissions=[s.e.enumeratePermissions,s.e.manageWeb,s.e.manageSubwebs,s.e.addAndCustomizePages,s.e.applyThemeAndBorder,s.e.manageAlerts,s.e.manageLists,s.e.viewUsageData];return t})(f.e)},2918:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(614),i=n(1089),s=n(993),o=n(14);function u(e){var t=e||window._spPageContextInfo,n={webThemeProvider:function(){return new i.e({pageContext:t,getThemeDataSource:function(){return o.n.resolve(new s.e(t))}})}};return Object(r.e)(n,t)}},2919:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(205),i=Object(r.e)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError",requiresParent:!1},{message:1,stack:1,type:1})},2923:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r,i,s,o={ODB:1518},u={ODB:1565};(function(e){e.ApprovalCenter="approvalCenter";e.Flows="flows";e.FlowCreation="flowCreation";e.FlowsRuntime="flowsRuntime";e.Templates="templates"})(r||(r={}));(function(e){e.CreateFlowFromTemplate="createFlowFromTemplate";e.TriggerFlow="triggerFlow";e.TriggerFlowByTemplate="triggerFlowByTemplate"})(i||(i={}));(function(e){e.GetAccessToken="GET_ACCESS_TOKEN";e.WidgetClose="WIDGET_CLOSE";e.WidgetReady="WIDGET_READY";e.WidgetRendered="WIDGET_RENDERED";e.RunFlowCompleted="RUN_FLOW_COMPLETED";e.RunFlowCancelButtonClicked="RUN_FLOW_CANCEL_BUTTON_CLICKED";e.RunFlowDoneButtonClicked="RUN_FLOW_DONE_BUTTON_CLICKED";e.RunFlowStarted="RUN_FLOW_STARTED";e.FlowCreationFailed="FLOW_CREATION_FAILED";e.FlowCreationSucceeded="FLOW_CREATION_SUCCEEDED";e.Error="ERROR";e.ApprovalStatusChanged="RECEIVED_APPROVAL_STATUS_CHANGED";e.GetStrings="GET_STRINGS"})(s||(s={}))},2927:function(e,t,n){"use strict";var r=n(833),i=n(15),s=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._sharingContextInformation=e.sharingContextInformation}e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var i=this._sharingContextInformation,s=i.isFolder,o=i.isListSharing,u=i.itemUrl,a=i.listId,f=i.listItemId,l=i.listUrl,c=i.resourceId,h=i.serverRelativeItemUrl,p=i.uniqueId,d=i.webAbsoluteUrl;if(!this.isListSharingKillswitchActive()&&o)return e.build().webByUrl({webUrl:d}).method("Lists",a);if(p){if(a)return e.build().webByUrl({webUrl:d}).segment("lists").method("getbyid",a).method("GetItemByUniqueId",p);var v=s?"GetFolderById":"GetFileById",m={guid:p};return e.build().webByUrl({webUrl:d}).method(v,m).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",h):u?e.build().webByUrl({webUrl:d}).method("GetFileByUrl",r.t(u)).segment("ListItemAllFields"):a&&f?e.build().webByUrl({webUrl:d}).method("Lists",a).method("GetItemById",f):e.build().webByUrl({webUrl:d}).method("GetListItemByResourceId",c)}var g;g=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var y=e.build().webByItemUrl(g).method("Lists",n);this.isListSharingKillswitchActive()?y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId):t.isRootFolder||(y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId));return y};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(this.isListSharingKillswitchActive()?!!t.ID||!!t.uniqueId:e.isRootFolder?!!e.list&&!!e.list.id:!!t.ID||!!t.uniqueId)};e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){if(t.has(e.loginName))return!1;t.add(e.loginName);return!0})}};e.prototype.isListSharingKillswitchActive=function(){return i.e.isActivated("0d6f4387-b53c-48b9-aab6-66369291541d","03/27/2020","List sharing changes in odsp-datasources")};return e})();t.e=s},2929:function(e,t,n){"use strict";var r=(function(){function e(){this.members=new Array}e.prototype.addUserToList=function(e){this.members.unshift(e)};e.prototype.removeUserFromList=function(e){for(var t=-1,n=0;n<this.members.length;n++)this.members[n].userId===e.userId&&(t=n);t>=0&&this.members.splice(t,1)};e.prototype.containsUserByPrincipalName=function(e){if(e)for(var t=e.toLowerCase(),n=0;n<this.members.length;n++)if(this.members[n].principalName&&this.members[n].principalName.toLowerCase()===t)return!0;return!1};return e})();t.e=r},2974:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t=e.serverRelativeItemUrl,n=e.dataRequestor,r=e.webApiUrl,i=e.duration,s=void 0===i?1:i,o=e.authToken,u=r;u=(u=u.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",s);return n.getData({url:u.toString(),method:"GET",authToken:o,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}},2976:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r;(function(e){e.standard="HTML";e.datasheet="GRID";e.calendar="CALENDAR";e.recurrence="RECURRENCE";e.chart="CHART";e.gantt="GANTT";e.power="POWER";e.tiles="TILES";e.compactList="COMPACTLIST";e.modernCalendar="MODERNCALENDAR";e.gridFixed="GRIDFIXED"})(r||(r={}));var i,s,o=["TILES","COMPACTLIST","MODERNCALENDAR","GRIDFIXED"];(function(e){e[e.dynamicHeight=0]="dynamicHeight";e[e.fixedHeight=1]="fixedHeight"})(i||(i={}));(function(e){e[e.defaultScope=0]="defaultScope";e[e.recursive=1]="recursive";e[e.recursiveAll=2]="recursiveAll";e[e.filesOnly=3]="filesOnly"})(s||(s={}))},3077:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(14),i=n(40),s=n(92),o=n(74),u=n(15),a={ODB:870},f=(function(){function e(e,t){var n=this._pageContext=t.pageContext;this._groupsProvider=t.groupsProvider;this._graphUserInfoDataSource=t.graphUserInfoDataSource;this._userInfoDataSource=t.userInfoDataSource;this._isTeamsRelevant=i.n.isFeatureEnabled(a)&&Object(s.i)(n);this._hideTeamifyKillswitch=u.e.isActivated("61F9968C-D778-4963-9A95-573BC29B5CBF","02/03/2019","Enable Hide teamify banner")}e.prototype.getTeamsUrl=function(){return this._isTeamsRelevant?this._groupsProvider.getGroup().then(function(e){return e&&e.teamsUrl}):r.n.resolve()};e.prototype.canTeamify=function(){var e=this,t=this._pageContext;if(!this._isTeamsRelevant||!t.isSiteAdmin)return r.n.resolve(!1);if(!u.e.isActivated("233F5D13-C231-46A9-820F-68FD2F032580","4/16/2020","Don't show banner if server side flag set")&&t.isTeamsConnectedSite)return r.n.resolve(!1);var n=function(){return e._groupsProvider.getGroup().then(function(t){return!t.teamsUrl&&!t.yammerResources&&e._graphUserInfoDataSource.canUseTeams().then(function(e){return e})}).catch(function(){return!1})};return this._hideTeamifyKillswitch?n():this._groupsProvider.getTeamifyBannerHidden().then(function(e){return!e&&n()})};e.prototype.shouldShowTeamsCoachmark=function(){var e=this;return(-1!==(window.location.search||"").indexOf("resetbubble=1")?this._userInfoDataSource.setUserFlagValue("sharePointTeamsTeachingBubble",!1).then(function(){return!1}):this._userInfoDataSource.getUserFlagValue("sharePointTeamsTeachingBubble")).then(function(t){if(!1===t)return e._graphUserInfoDataSource.canUseTeams()})};e.prototype.findTeamsLink=function(e,t){if(e&&e.length){var n=new o.t(t.toLowerCase());t=decodeURIComponent(n.getStringWithoutQueryAndFragment());for(var r=0,i=e;r<i.length;r++){var s=i[r],u=decodeURIComponent((s.url||"").toLowerCase());if(u.substring(0,t.length)===t||-1!==u.indexOf("/_layouts/15/groupstatus.aspx?target=team"))return s}}};e.prototype.setTeamsBubbleFlag=function(e){return this._userInfoDataSource.setUserFlagValue("sharePointTeamsTeachingBubble",e)};return e})()},3323:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(153),s=n(282),o=n(225),u=n(2919),a=n(901),f=n(40),l=n(2918),c=n(14),h=n(826),p=n(145),d=n(82),v=n(33),m=n(1077),g={ODB:556,ODC:null,Fallback:!1},y={ODB:1302,ODC:null,Fallback:!1},b={ODB:1836,ODC:null,Fallback:!1},w=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{engagementEvent:p.e,qosEvents:{"SuiteNavProvider.GetO365Shell":new d.e({name:"SuiteNavProvider.GetO365Shell"})}},n)||this;r._dataSource=n.dataSource;r._cssLoaded=!1;r._isSuiteNavBootstrapperLoadingFlowEnabled=f.n.isFeatureEnabled(y);return r}t.prototype.clearCachedPromise=function(){this._modelPromise=void 0};t.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};t.prototype.getO365Shell=function(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return e.prototype.getO365Shell.call(this);if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var t=new i.e,n=new d.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(t);t.getPromise().then(function(){n.end({resultType:v.e.Success})},function(e){n.end(Object(m.n)({error:e}))});return t.getPromise()};t.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i&&i.Id===a.e.MAIL)return i.Url}})};t.prototype.updateWorkloadSettingsLinks=function(e){var t,n=this;return this.getO365Shell().then(function(r){return(t=r)&&t.Settings?n.loadData(e):void 0}).then(function(e){e&&e.CurrentWorkloadSettingsSubLinks&&e.CurrentWorkloadSettingsSubLinks.length>0&&t.Settings.SetWorkloadSettingsLinks(e.CurrentWorkloadSettingsSubLinks)}).catch(function(e){p.e.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})};t.prototype.trySetDataAfterInitialRender=function(e,t){var n=this;p.e.logData({name:"SuiteNavProvider.SetDataAfterInitialRender"});var i=t.actionContext,s=t.bundleLoader;return this.loadData().then(function(t){if(!t){p.e.logData({name:"SuiteNavProvider.NoSuiteNavData"});return!1}if(!e){p.e.logData({name:"SuiteNavProvider.NoO365Shell"});return!1}try{e.SetData(t)}catch(e){p.e.logData({name:"SuiteNavProvider.SetDataFail"});d.e.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n.loadData(!0)});return!1}t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var n=t.ActionsMap[e.Id];n&&(e.Cancel=!n(Object(r.__assign)(Object(r.__assign)({},e),i||{})))});e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return d.e.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n.loadData(!0)}).done()})});f.n.isFeatureEnabled(b)&&e.NFD&&e.NFD.OnFeedbackMetadataRequested(function(e){return e=n._dataSource.setFeedbackMetadata(e)});s&&s.pageRenderingIsComplete();return!0},function(e){p.e.logData({name:"SuiteNavProvider.LoadDataError"});return!1})};t.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(r){if(!n._cssLoaded&&r.cssUrl){h.e.loadStylesheet(r.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(r);n._cssLoaded=!0}p.e.logData({name:"SuiteNavProvider.GetO365ShellByS2S"});n._requestShellCore(r.jsUrl,t,E).then(function(t){e.complete(t)},function(t){n._modelPromise=void 0;if((t=Object(m.n)({error:t}))&&"LoadScriptError"===t.resultCode&&n._isDataFromCache){p.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._clearCache();n._getSuiteNavShell(e)}else if(n._hasRetriedShell)e.error(t);else{n._hasRetriedShell=!0;n._cssLoaded=!1;p.e.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(e,!0)}})})};t.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,r,s=new i.e,o=this._capabilities.supportsCaching,u=this._dataSource,a=v.e.Failure,h=d.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new c.n(function(r,i){var s;!e&&o&&t._isCacheValid()&&(s=t._cache.getValue(t._cacheDataKey));if(s&&s.data){p.e.logData({name:"SuiteNavProvider.DataFromCache"});u.updateDataForCurrentPage&&(s.data=u.updateDataForCurrentPage(s.data));if(o&&t._isCacheOutdated()){p.e.logData({name:"SuiteNavProvider.RefreshCache"});u.loadData().then(function(e){t._updateCache(e)})}t._isDataFromCache=!0;r(s)}else{t._isDataFromCache=!1;e&&p.e.logData({name:"SuiteNavProvider.ForceUpdateData"});p.e.logData({name:"SuiteNavProvider.DataFromServer"});u.loadData().done(function(e){if(e)if(e.data){o&&!(function(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})})(e)&&t._updateCache(e);r(e)}else{n="NoModelData";i("Model with no data returned")}else{n="NoModel";i("No model returned")}},function(e){if(c.n.isCanceled(i)){n="Canceled";a=v.e.ExpectedFailure}else n="ServerLoadFailure";i(e)})}})},null,function(e){if(c.n.isCanceled(e)){a=v.e.ExpectedFailure;n="Canceled"}return{resultType:a,resultCode:n||"Other",error:e}});(r=Object(l.e)())?this._modelPromise=c.n.all({suiteNavModel:h,theme:r.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,r=t&&t.data,i=t&&t.hasCobranding,s=r&&r.UseSPOBehaviors,o=f.n.isFeatureEnabled(g),u=n&&n.suiteBarBackground;!(u&&r&&s)||i&&o||(r.ThemeColors=[u,n.primaryText,u,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]);return t}):this._modelPromise=h;this._modelPromise.then(function(e){return s.complete(e)},function(e){return s.error(e)});return s.getPromise()};t.prototype._clearCache=function(){this._cache.remove(this._cacheDataKey);this._cache.remove(this._cacheThemeDataKey);this._cache.remove(this._cacheDateKey);this._cache.remove(this._cacheVersionKey);this._cache.remove(this._cacheSessionKey,o.e.session)};t.prototype._updateCache=function(e,t){this._cache.setValue(this._cacheDataKey,e);this._cache.setValue(this._cacheDateKey,new Date);this._cache.setValue(this._cacheVersionKey,this._cacheVersion);this._cache.setValue(this._cacheSessionKey,!0,o.e.session)};t.prototype._isCacheOutdated=function(){var e=this._cache.getValue(this._cacheSessionKey,o.e.session),t=Date.parse(this._cache.getValue(this._cacheDateKey));return s.e.hasStorageType(o.e.session)&&!e||Date.now()-t>=60*this._cacheRenew*60*1e3};return t})(m.e);function E(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var r=n[t];S(e.b,r)}}function S(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(this,e)}catch(e){u.e.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}},3324:function(e,t,n){"use strict";var r=n(14),i=n(139),s=n(346),o=n(145),u=n(143),a=n(93),f=n(33),l=n(82),c=n(1773),h=n(2923),p=n(15),d="od-Flow-iframeContainer-",v="FlowWidgetProviderOld.",m={runFlowWidgetCancelled:f.e.Success,flowWidgetClosed:f.e.Success},g=(function(){function e(e,t){void 0===e&&(e={});this._widgetData=t.widgetData;this._oAuthTokenProvider=t.oAuthTokenProvider;this.containerId=d+a.e.generate();this._listeners=new Array;this._async=new i.e;this._isWidgetReady=!1}e.prototype.addListener=function(e){if(e){this._listeners.indexOf(e)<0&&this._listeners.push(e)}};e.prototype.removeListener=function(e){if(e){var t=this._listeners.indexOf(e);t>=0&&this._listeners.splice(t,1)}};e.prototype.launchFlowWidget=function(e){var t=this;this._currentLaunchFlowData=e;o.e.logData({name:v+"PanelOpened",extraData:{flowId:e.flow.id}});p.e.isActivated("6A24FAB5-B66C-4A87-831E-CF8E543D167D","11/08/2018","FlowWidgetProvider managing listeners")||this.addListener(e.listener);return this._widgetData.getPromise().then(function(n){t._onLaunchWidget();return t._getWidget(e).then(function(n){t._widget=n;t._notifyWidget(e)},function(n){t._onWidgetError(n,e)})})};e.prototype.preloadSdk=function(e,t){if(p.e.isActivated("8B5248EE-6FF7-4C9F-B888-1485D51BC017","12/01/2018","FlowWidgetProvider preload sdk"))return r.n.resolve();o.e.logData({name:v+"PreloadSdk"});return this._loadSdk(e).then(function(){return r.n.resolve()})};e.prototype.onDismiss=function(){this._notifyWidgetQos&&this._notifyWidgetQos.end({resultType:f.e.Success,extraData:{message:"onDismiss"}});p.e.isActivated("3067C8F6-A92C-4264-9DBF-1ED2F221AC22","9/20/2018","Flow Widget dismiss calls _onWidgetClose")?p.e.isActivated("5346FE2A-9601-4AA8-BD09-632520D561B3","9/04/2018","Flow Widget dismiss calls closeWidget")?this._onRunFlowCanceled(this._currentLaunchFlowData):this.closeWidget():this._onWidgetClose(this._currentLaunchFlowData)};e.prototype.closeWidget=function(){p.e.isActivated("3067C8F6-A92C-4264-9DBF-1ED2F221AC22","9/20/2018","Flow Widget dismiss calls _onWidgetClose")?this._listeners.forEach(function(e){e.onCloseWidget&&e.onCloseWidget()}):this._onWidgetClose(this._currentLaunchFlowData)};e.prototype._getWidget=function(e){var t=this;if(!p.e.isActivated("48255E70-701C-48EB-8198-97B44A7DB68E","02/13/2019","Disable flow widget caching upon request")&&Boolean(e.noCache)||!this._createWidgetPromise||"triggerFlowByTemplate"===e.actionName||e.widgetType!==(this._widget&&this._widget.getWidgetType())){if(this._widget){this._widget.dispose();this._widget=null;this._isWidgetReady=!1}o.e.logData({name:v+"CreateNewFlowWidget"});this._widgetReadyQos=new l.e({name:v+"WidgetReady"});this._createWidgetPromise=this._createWidget(e)}else o.e.logData({name:v+"ReuseCachedFlowWidget"});return this._widget?r.n.wrap(this._widget):this._createWidgetPromise.then(function(e){return e},function(e){t._createWidgetPromise=null;return r.n.wrapError(e)})};e.prototype._createWidget=function(e){var t=this;return new r.n(function(n,r){t._widgetData.getPromise().then(function(i){t._renderWidget(i,e).then(function(e){n(e)},function(e){r(e)})})})};e.prototype._registerListeners=function(e){var t=this;if(this._widget){var n,r=this._activateTimeout("WIDGET_READY",e);this._widget.listen("GET_ACCESS_TOKEN",function(e,n){t._getToken().then(function(e){n(null,{token:e})})});this._widget.listen("WIDGET_READY",function(){t._widgetReadyQos&&t._widgetReadyQos.end({resultType:f.e.Success});t._isWidgetReady=!0;t._notifyWidget(e);t._async.clearTimeout(r);n=t._activateTimeout("WIDGET_RENDERED",e)});this._widget.listen("WIDGET_RENDERED",function(){t._onWidgetRendered();t._async.clearTimeout(n)});this._widget.listen("RUN_FLOW_COMPLETED",function(n){t._onRunFlowCompleted(e,n)});this._widget.listen("RUN_FLOW_CANCEL_BUTTON_CLICKED",function(){t._onRunFlowCanceled(e)});this._widget.listen("RUN_FLOW_DONE_BUTTON_CLICKED",function(){t._onRunFlowDoneClicked(e)});this._widget.listen("WIDGET_CLOSE",function(){t._onWidgetClose(e)});this._widget.listen("FLOW_CREATION_SUCCEEDED",function(n){t._onFlowCreationSucceeded(e,n)});this._widget.listen("FLOW_CREATION_FAILED",function(){t._onFlowCreationFailed(e)});this._widget.listen("RECEIVED_APPROVAL_STATUS_CHANGED",function(e){t._onApprovalStatusChanged(e)});!p.e.isActivated("a62f4d5a-349b-449b-bf44-c5b464d66328","7/09/2018","getStrings callback")&&e.additionalEvents&&e.additionalEvents.indexOf("GET_STRINGS")>-1&&this._widget.listen("GET_STRINGS",function(e,n){t._onGetStrings(n)})}};e.prototype._activateTimeout=function(e,t){var n=this;return this._async.setTimeout(function(){n._onWidgetError(new Error("Timeout: Widget timed out waiting for: "+e),t)},15e3)};e.prototype._notifyWidget=function(e){var t=this,n=!!this._widget;p.e.isActivated("7F471D6A-BFA2-4F72-BE2C-6601BA0A50E6","3/8/2018","Check isWidgetReady in notifyWidget")||(n=!!this._widget&&this._isWidgetReady);if(n){this._widget.listen("RUN_FLOW_STARTED",function(){t._onRunFlowStarted(e);o.e.logData({name:v+"RunFlowClicked",extraData:{flowId:e.flow.id}})});this._notifyWidgetQos=new l.e({name:v+"NotifyWidget"});this._widget.notify(e.actionName,e.actionData).then(function(){t._notifyWidgetQos.end({resultType:f.e.Success,extraData:{flowId:e.flow.id}})}).catch(function(n){if(n){var r=n.code,i=void 0!==m[r]?m[r]:f.e.Failure;t._notifyWidgetQos.end({resultType:i,extraData:{flowId:e.flow.id,message:r}})}else t._notifyWidgetQos.end({resultType:f.e.Failure,extraData:{flowId:e.flow.id,message:"Error unknown: no error returned in the notifyWidget promise catch clause."}})})}};e.prototype._onRunFlowStarted=function(e){this._listeners.forEach(function(t){t.onRunFlowStarted&&t.onRunFlowStarted(e)})};e.prototype._onWidgetRendered=function(){this._renderWidgetQos&&this._renderWidgetQos.end({resultType:f.e.Success});this._listeners.forEach(function(e){e.onWidgetRendered&&e.onWidgetRendered()})};e.prototype._onRunFlowCompleted=function(e,t){this._listeners.forEach(function(n){n.onRunFlowCompleted&&n.onRunFlowCompleted(e,t)})};e.prototype._onRunFlowCanceled=function(e){this._logWidgetCloseData("CancelClicked",e);this._listeners.forEach(function(t){t.onRunFlowCanceled&&t.onRunFlowCanceled(e)})};e.prototype._onRunFlowDoneClicked=function(e){this._logWidgetCloseData("DoneClicked",e);this._listeners.forEach(function(t){t.onRunFlowDoneClicked&&t.onRunFlowDoneClicked(e)})};e.prototype._onWidgetClose=function(e){this._logWidgetCloseData("WidgetClose",e);this._listeners.forEach(function(e){e.onCloseWidget&&e.onCloseWidget()});p.e.isActivated("6A24FAB5-B66C-4A87-831E-CF8E543D167D","11/08/2018","FlowWidgetProvider managing listeners")||e&&this.removeListener(e.listener)};e.prototype._logWidgetCloseData=function(e,t){var n=t&&t.flow?{flowId:t.flow.id,templateName:t.flow.templateName}:{};o.e.logData({name:""+v+e,extraData:n})};e.prototype._onFlowCreationSucceeded=function(e,t){var n=t?t.data:void 0;this._listeners.forEach(function(t){t.onFlowCreationSucceeded&&t.onFlowCreationSucceeded(e,n)})};e.prototype._onFlowCreationFailed=function(e){this._listeners.forEach(function(t){t.onFlowCreationFailed&&t.onFlowCreationFailed(e)})};e.prototype._onApprovalStatusChanged=function(e){this._listeners.forEach(function(t){t.onApprovalStatusChanged&&t.onApprovalStatusChanged(e)})};e.prototype._onWidgetError=function(e,t){this._renderWidgetQos&&this._renderWidgetQos.end({resultType:f.e.Failure,extraData:{message:e.message}});this._listeners.forEach(function(t){t.onWidgetError&&t.onWidgetError(e)})};e.prototype._onTokenError=function(e){this._listeners.forEach(function(t){t.onTokenError&&t.onTokenError(e)})};e.prototype._onLaunchWidget=function(){this._renderWidgetQos=new l.e({name:v+"RenderWidget"});this._listeners.forEach(function(e){e.onLaunchWidget&&e.onLaunchWidget()})};e.prototype._onGetStrings=function(e){this._listeners.forEach(function(t){t.onGetStrings&&t.onGetStrings(e)})};e.prototype._renderWidget=function(e,t){var n=this,i=this._loadSdk(t.hostId),s=e.iframePromise,o=this._getToken();return r.n.all([i,s,o]).then(function(i){var s=i[1];i[2];if(!n._widget){var o={container:s.id,campaign:t.campaign,environmentId:t.flow.environmentId,enableOnBehalfOfTokens:!0,enableRegionalPortal:!0,widgetStyleSettings:e.widgetStyleSettings,approvalCenterSettings:t.approvalCenterSettings,enableWidgetV2:u.e.isFeatureEnabled(h.e)};o.templatesSettings={useServerSideProvisioning:!0,defaultParams:t.widgetDefaultParams?t.widgetDefaultParams:void 0,allowCustomFlowName:t.allowCustomFlowName};try{n._widget=n._sdk.renderWidget(t.widgetType,o);n._registerListeners(t)}catch(e){return r.n.wrapError(e)}}return n._widget})};e.prototype._loadSdk=function(e){var t=this;if(this._sdkPromise)return this._sdkPromise;this._sdkPromise=new r.n(function(r){if(t._sdk)r();else{0;n.e("30").then(n.t.bind(null,3079,7)).then(function(n){t._sdk=new MsFlowSdk({hostName:Object(c.t)(void 0),locale:s.e.language,hostId:e});r()})}});return this._sdkPromise};e.prototype._getToken=function(){var e=this;return new r.n(function(t){var n=new l.e({name:v+"GetToken"});e._oAuthTokenProvider.getToken("https://service.flow.microsoft.com/").then(function(e){t(e);n.end({resultType:f.e.Success})},function(r){e._onTokenError(r);n.end({resultType:f.e.Failure,extraData:{serverErrorCode:r._serverErrorCode,message:r.message}});t(null)})})};return e})();t.e=g},3326:function(e,t,n){"use strict";var r;(function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"})(r||(r={}));t.e=r},3334:function(e,t,n){"use strict";n.r(t);n.d(t,"UserExpirationDataSource",function(){return h});var r=n(300),i=n(14),s=n(92),o=n(1696),u=n(93),a="/_api/web/SiteUserInfoList/GetItems",f="/_api/web/SiteUsers/GetById(@a)",l="/_api/web/SiteUsers/GetById(@a)/Expire",c="/_api/Site/ExternalUserExpirationInDays",h=(function(){function e(e){this._pageContext=e.pageContext;this._dataRequestor=new r.t({qosName:"UserExpirationDataSource",pageContext:e.pageContext});var t=Object(s.n)(e.pageContext);this._getExpiringUsersUrl=t+a;this._setUserExpirationUrl=t+f;this._expireUserUrl=t+l;this._externalUserExpirationPolicyUrl=t+c}e.prototype.setUserExpiration=function(e,t){var n=this;if(!e||e.length<1)return i.n.reject([!1]);if(e.length>1){var r=u.e.generate(),s="multipart/mixed; boundary=batch_"+r,a=[],f=[],l=[];e.forEach(function(e){a.push(n._setUserExpirationUrl+"?@a="+e.id);f.push(JSON.stringify({__metadata:{type:"SP.User"},Expiration:t?t.toISOString():""}));l.push("PATCH")});return this._dataRequestor.getData({url:o.t.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:function(e){return e},qosName:"SetUserExpirations",additionalPostData:o.t.getBatchContentExtended(r,a,"PATCH",o.t.defaultBatchRequestPostData,f,o.t.defaultBatchAcceptData,l),method:"POST",contentType:s,noRedirect:!0,needsRequestDigest:!0}).then(function(e){var t=o.t.processBatchResponse(e);return t.hasError?i.n.reject(t):t}).then(function(e){return e.items.map(function(){return!0})},function(e){return e.items.map(function(e){return!e.error})})}var c=this._setUserExpirationUrl+"?@a="+e[0].id,h={__metadata:{type:"SP.User"},Expiration:t?t.toISOString():""};return this._dataRequestor.getData({url:c,parseResponse:function(e){return[!e]},qosName:"SetUserExpiration",additionalPostData:JSON.stringify(h),method:"POST",additionalHeaders:{"X-HTTP-Method":"PATCH"},noRedirect:!0,needsRequestDigest:!0})};e.prototype.expireUser=function(e){var t=this;if(!e||e.length<1)return i.n.reject([!1]);if(e.length>1){var n=u.e.generate(),r="multipart/mixed; boundary=batch_"+n,s=[],a=[];e.forEach(function(e){s.push(t._expireUserUrl+"?@a="+e.id);a.push("POST")});return this._dataRequestor.getData({url:o.t.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:function(e){return e},qosName:"BatchExpireUser",additionalPostData:o.t.getBatchContentExtended(n,s,"POST",o.t.defaultBatchRequestPostData,[],o.t.defaultBatchAcceptData,a),method:"POST",contentType:r}).then(function(e){var t=o.t.processBatchResponse(e);return t.hasError?i.n.reject(t):t}).then(function(e){return e.items.map(function(){return!0})},function(e){return e.items.map(function(e){return!e.error})})}var f=this._expireUserUrl+"?@a="+e[0].id;return this._dataRequestor.getData({url:f,parseResponse:function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return[!0]}return[!1]},qosName:"ExpireUser",method:"POST"})};e.prototype.getUsersWithExpirations=function(e,t,n,r,i){var s=[];n&&s.push("$top="+n);r&&s.push("$skip="+r);e&&s.push("$orderby="+e+" "+(t?"asc":"desc"));i&&s.push("$filter="+i);s.push("$select=Title,ID,Name,UserExpiration,IsSiteAdmin,EMail");var o=this._getExpiringUsersUrl;s.length>0&&(o+="?"+s.join("&"));return this._dataRequestor.getData({url:o,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.results?t.d.results.map(function(e){return{id:e.ID,loginName:e.Name,email:e.EMail,expiration:new Date(e.UserExpiration),title:e.Title,isSiteAdmin:e.IsSiteAdmin}}):e},qosName:"GetUsersWithExpirations",additionalPostData:JSON.stringify({query:{__metadata:{type:"SP.CamlQuery"},ViewXml:"<View><Query><Where><IsNotNull><FieldRef Name='UserExpiration'/></IsNotNull></Where></Query></View>"}}),method:"POST"})};e.prototype.getExternalUserExpirationPolicy=function(){return this._dataRequestor.getData({url:this._externalUserExpirationPolicyUrl,parseResponse:function(e){if(e){var t=JSON.parse(e);if(t&&t.d&&t.d.ExternalUserExpirationInDays)return t.d.ExternalUserExpirationInDays}return 0},qosName:"GetExternalUserExpirationPolicy",method:"GET",needsRequestDigest:!0})};return e})();t.default=h},3376:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2419),i=(function(){function e(e){this._dataSource=e.sharingDataSource||new r.n({getParentListId:e.getParentListId,pageContext:e.pageContext});this._itemProvider=e.itemProvider}e.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,i)};e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){t._invalidateItem(e.items[0]);return n})};e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateItem(e.item);return n})};e.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateItem(t);return e})};e.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateItem(t);return e})};e.prototype.getClientId=function(){return this._dataSource.getClientId()};e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};e.prototype.emailWithoutPermissioning=function(e,t,n,r){return this._dataSource.emailWithoutPermissioning(e,t,n,r).then(function(e){return e})};e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})};e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};return e})()},3424:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r,i=n(0),s=n(14),o=n(225),u=n(15),a=n(297),f=n(399),l=n(573);(function(e){e.odbFirstRun="sharePointOneDriveBusinessFirstRun";e.filtersPaneFirstRun="sharePointFiltersPaneFirstRun";e.teamsTeachingBubble="sharePointTeamsTeachingBubble";e.librariesFirstRun="sharePointLibrariesFirstRun";e.listsFirstRun="sharePointListsFirstRun";e.modernDocSetsFirstRun="sharePointModernDocSetsFirstRun"})(r||(r={}));var c=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"UserInfo",id:"UserInfo",cacheType:o.e.local},n)||this,i=r._pageContext,s=n.itemUrlHelper||new f.e({},{pageContext:i});r.apiUrlHelper=n.apiUrlHelper||new l.e({},{pageContext:i,itemUrlHelper:s});r._additionalHeaders={"X-ClientType":"SharePointFirstRunUserFlag"};return r}t.prototype.getUserFlagValue=function(e){var t=this;if(u.e.isActivated("AC6676C2-EA2E-4FFE-AAEA-E36483FB5552","03/29/2020","Disable Firstrun check"))return s.n.resolve(!0);if(!this._pageContext.userLoginName&&!this._pageContext.aadUserId)return s.n.resolve(!0);if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return s.n.resolve(!0);var n={url:this._getApiUrl()+"&$select="+e,qosName:"GetUserFlag",method:"GET",cacheRequestKey:e};return this.getDataUtilizingCache(Object(i.__assign)({onlyCache:!0,useStale:!0},n)).then(function(r){return r||t.getDataUtilizingCache(Object(i.__assign)(Object(i.__assign)({},n),{additionalHeaders:Object(i.__assign)({},t._additionalHeaders),parseResponse:function(t){var n=JSON.parse(t);if(n&&n.d&&void 0!==n.d[e])return!!n.d[e];throw new Error("Response did not contain flag: "+e)}}))}).catch(function(){return null})};t.prototype.setUserFlagValue=function(e,t){var n;return this.getDataUtilizingCache({url:this._getApiUrl(),qosName:"SetUserFlag",additionalPostData:JSON.stringify((n={},n[e]=t,n)),method:"POST",additionalHeaders:Object(i.__assign)({"X-HTTP-Method":"PATCH",Accept:"application/json; odata=minimalmetadata"},this._additionalHeaders),contentType:"application/json; odata=minimalmetadata",cacheRequestKey:e,bypassCache:!0,parseResponse:function(){return t}})};t.prototype._getApiUrl=function(){return this.apiUrlHelper.build().segment("SP.Directory.DirectorySession").methodWithAliases("User",this._pageContext.aadUserId?{id:this._pageContext.aadUserId}:{principalName:this._pageContext.userLoginName}).toString()};return t})(a.e)},3449:function(e,t,n){"use strict";var r=n(0),i=n(570),s=n(61),o=n(25),u=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"APIHubConnector"},{pageContext:t})||this}t.prototype.getItem=function(e,t){var n=this,r=s.e.encodeURIComponent(s.e.encodeURIComponent(s.e.encodeURIComponent(this._pageContext.webAbsoluteUrl))),i=s.e.encodeURIComponent(s.e.encodeURIComponent(s.e.encodeURIComponent(this._pageContext.listTitle))),u=o.format("https://localhost/datasets/{0}/tables/{1}/items/{2}",r,i,e);return this.getData(function(){return n._pageContext.webAbsoluteUrl+"/_api/SP.APIHubConnector.InvokeQuery"},t||function(e){return e},"APIHubConnector.getItem",null,"GET",{"x-ms-operation-id":"GetItem","X-MS-APIM-Referrer-Prefix":"https://localhost","X-MS-APIM-Referrer":u})};return t})(i.e);t.e=u},3685:function(e,t,n){"use strict";var r=n(282),i=n(225),s=n(3693),o=n(735),u=n(0),a=n(2929),f=n(297),l=n(14),c=n(25),h=n(61),p=n(93),d=n(1696),v=n(1539),m=n(40),g=n(15),y="Group('{0}')/{1}?$skip={2}&$top={3}&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,PictureUrl,UserType,Mail",b="Group('{0}')/Members/Add(objectId='{1}', principalName='{2}')",w="Group('{0}')/Owners/Add(objectId='{1}', principalName='{2}')",E="isTeamifyPromptHidden",S=(function(e){Object(u.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"GroupsDataSource",id:"GroupsDataSource",cacheTimeoutTime:36e5},{pageContext:t})||this;n._isTeamifyPromptHiddenCacheKey=t?E+"_"+(t.siteId+t.groupId):E;return n}t._copyMember=function(e){return{sip:e.alias,userId:e.id,email:e.mail,principalName:e.principalName,name:e.displayName,job:e.title,image:e.sharePointPictureUrl,profilePage:e.profilePage,entityType:e&&e.userType&&"guest"===e.userType?1:void 0}};t._parseUser=function(e){var n=JSON.parse(e);return t._copyMember(n.d)};t._copyMembers=function(e){var n=new a.e;n.members=e.map(function(e){return t._copyMember(e)});return n};t._parseGroup=function(e){var n=JSON.parse(e);return t._copyGroup(n.d)};t._parseMembership=function(e){var n=JSON.parse(e);return t._copyMembership(n.d)};t._copyGroup=function(e){var n={description:e.description,alias:e.alias,name:e.displayName,principalName:e.principalName,creationTime:e.creationTime,pictureUrl:e.pictureUrl,inboxUrl:e.inboxUrl,calendarUrl:e.calendarUrl,filesUrl:e.documentsUrl,sharePointUrl:e.siteUrl,editUrl:e.editGroupUrl,membersUrl:e.peopleUrl,notebookUrl:e.notebookUrl,teamsUrl:e.teamsUrl,isPublic:e.isPublic,mail:e.mail,classification:e.classification,yammerResources:e.yammerResources,teamsResources:e.teamsResources,allowToAddGuests:e.allowToAddGuests,isDynamic:e.isDynamic,membership:t._copyMembership(e)};t._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&(n.assignedLabels=e.assignedLabels);return n};t._copyMembership=function(e){return{totalNumberOfMembers:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,membersList:e&&e.results?t._copyMembers(e.results):void 0}};t._parseOwnership=function(e){var n=JSON.parse(e);return t._copyOwnership(n.d)};t._copyOwnership=function(e){return{totalNumberOfOwners:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,ownersList:e&&e.results?t._copyMembers(e.results):void 0}};Object.defineProperty(t,"_isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled",{get:function(){return m.n.isFeatureEnabled({ODB:1688})},enumerable:!0,configurable:!0});t.prototype.getGroupBasicProperties=function(e){var n=this;return this.getData(function(){return n._getUrl(c.format(t._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled?"Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic,assignedLabels":"Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic",e),"SP.Directory.DirectorySession")},function(r){var i=t._parseGroup(r);i.id||(i.id=e);n._calculateMissingGroupProperties(i,e);return i},"GetBasicProperties",void 0,"GET",void 0,void 0,3)};t.prototype.setGroupBasicProperties=function(e){var n=this;if(!e)return l.n.reject("Group parameter is null or undefined");return this.getData(function(){return n._getUrl(c.format("Group('{0}')",e.id),"SP.Directory.DirectorySession")},void 0,"SetBasicProperties",function(){var n;n=g.e.isActivated("97B53A51-2910-4797-9994-18DC8486A4CF","04/14/2020","Smarter Save Logic")?{__metadata:{type:"SP.Directory.Group"},displayName:e.name,description:e.description}:{__metadata:{type:"SP.Directory.Group"}};if(!g.e.isActivated("97B53A51-2910-4797-9994-18DC8486A4CF","04/14/2020","Smarter Save Logic")){e.name&&(n.displayName=e.name);e.description&&(n.description=e.description)}if(t._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&e.assignedLabels){g.e.isActivated("29C95462-1E6C-41B4-996F-C2C8DB554DD5","06/10/2020","AuthZenSendPrivacyIfChanged")||null==e.isPublic||(n.isPublic=e.isPublic);if(m.n.isFeatureEnabled({ODB:1939})&&e.assignedLabels===p.e.Empty){n.assignedLabels="";g.e.isActivated("29C95462-1E6C-41B4-996F-C2C8DB554DD5","06/10/2020","AuthZenSendPrivacyIfChanged")&&null!=e.isPublic&&(n.isPublic=e.isPublic)}else n.assignedLabels=e.assignedLabels}else{null!=e.isPublic&&(n.isPublic=e.isPublic);e.classification&&(n.classification=e.classification)}return JSON.stringify(n)},"PATCH",void 0,void 0,3)};t.prototype.getGroupByAlias=function(e){var n=this;return this.getData(function(){return n._getUrl(c.format("Group(alias='{0}')",e),"SP.Directory.DirectorySession")},function(e){return t._parseGroup(e)},"GetGroupByAlias",void 0,"GET",void 0,void 0,0)};t.prototype.getGroupMembership=function(e,n,r,i){var s=this;void 0===r&&(r=!1);void 0===i&&(i=!1);var o=r?"100":"3";return this.getData(function(){return s._getUrl(c.format(y,e,"members","0",o),"SP.Directory.DirectorySession")},function(e){var r=t._parseMembership(e);s._calculateMissingMembershipProperties(r,n);return r},"GetMembership",void 0,"GET",void 0,void 0,3).then(function(t){return i?s._addOwnerInformation(e,n,t):l.n.resolve(t)})};t.prototype.getGroupMembershipPage=function(e,n,r,i){var s=this;return this.getData(function(){return s._getUrl(c.format(y,e,"members",r,i),"SP.Directory.DirectorySession")},function(e){var r=t._parseMembership(e);s._calculateMissingMembershipProperties(r,n);return r},"GetMembershipPage",void 0,"GET",void 0,void 0,3)};t.prototype.getGroupOwnership=function(e,n){var r=this,i=n||"100";return this.getData(function(){return r._getUrl(c.format(y,e,"owners","0",i),"SP.Directory.DirectorySession")},function(e){var n=t._parseOwnership(e);r._calculateMissingOwnershipProperties(n);return n},"GetOwnership",void 0,"GET",void 0,void 0,3)};t.prototype.getUserGroupsFromAAD=function(e){var t=this;return this.getData(function(){return t._getCsomUrl("ProcessQuery")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroupsFromAAD",function(){return c.format('<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',e.email)},"POST")};t.prototype.getUserGroups=function(e){var t=this,n=function(){return t.getUserGroupsFromAAD(e)};return this.getData(function(){return t._getUrl(c.format("User('{0}')/RankedMembership?$top=100&$select=DisplayName,DocumentsUrl,SharePointPictureUrl,PictureUrl,Id,IsFavorite",e.userId),"SP.Directory.DirectorySession")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroups",void 0,"GET",void 0,void 0,0).then(function(e){return e&&e.length?e:n()},n)};t.prototype.addGroupMember=function(e,t,n,r){var i=this;t=t||p.e.Empty;n=n||"";return this.getData(function(){return i._getUrl(c.format(b,e,t,n),"SP.Directory.DirectorySession")},void 0,r||"AddMember",void 0,"POST",void 0,void 0,3)};t.prototype.addGroupOwner=function(e,t,n,r){var i=this;t=t||p.e.Empty;n=n||"";return this.getData(function(){return i._getUrl(c.format(w,e,t,n),"SP.Directory.DirectorySession")},void 0,r||"AddOwner",void 0,"POST",void 0,void 0,3)};t.prototype.removeGroupMember=function(e,t,n){var r=this;return this.getData(function(){return r._getUrl(c.format("Group('{0}')/Members/Remove('{1}')",e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveMember",void 0,"POST",void 0,void 0,3)};t.prototype.removeGroupOwner=function(e,t,n){var r=this;return this.getData(function(){return r._getUrl(c.format("Group('{0}')/Owners/Remove('{1}')",e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveOwner",void 0,"POST",void 0,void 0,3)};t.prototype.addUsersToGroup=function(e,t,n,r,i){var s=this,o=p.e.generate(),a="multipart/mixed; boundary=batch_"+o,f=[],h=[],v=0,m=0,g=function(t,n,r){for(var i=n?w:b,o=0;o<t.length;o++){var u=void 0,a=void 0;r?a=t[o]:u=t[o];if(u||a){u=u||p.e.Empty;a=a||"";var l=s._getUrl(c.format(i,e,u,a),"SP.Directory.DirectorySession");n?h.push(l):f.push(l)}}};if(t){g(t,!0,!1);v=t.length}else if(r){g(r,!0,!0);v=r.length}if(n){g(n,!1,!1);m=n.length}else if(i){g(i,!1,!0);m=i.length}if(!(h.length<1&&f.length<1)){var y=this.getData(function(){return d.e.getBatchOperationUrl(s._pageContext.webAbsoluteUrl)},function(e){return e},"AddUsersToGroup",function(){return d.e.getBatchContent(o,[h,f],"POST",d.e.defaultBatchRequestPostData)},"POST",void 0,a,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;if(t){t.extraData={OwnersNumber:v,MembersNumber:m};return{eventData:Object(u.__assign)(Object(u.__assign)({},n),{resultCode:t.status.toString()})}}return{eventData:n}},void 0);return new l.n(function(e,t){y.then(function(n){var r=d.e.processBatchResponse(n);r.hasError?t(r):e(r)},function(e){t(e)})})}};t.prototype.addRemoveGroupUsers=function(e,t,n,r,i){var s=this,o=p.e.generate(),a="multipart/mixed; boundary=batch_"+o,f=[],h=[],v=[],m=[],g=function(t,n,r){var i="SP.Directory.DirectorySession";if(void 0!==t)for(var o=0;o<t.length;o++)if(n)if(r){var u=s._getUrl(c.format(w,e,t[o],""),i);f.push(u)}else{u=s._getUrl(c.format("Group('{0}')/Owners/Remove('{1}')",e,t[o]),i);v.push(u)}else if(r){u=s._getUrl(c.format(b,e,t[o],""),i);h.push(u)}else{u=s._getUrl(c.format("Group('{0}')/Members/Remove('{1}')",e,t[o]),i);m.push(u)}};g(t,!0,!0);g(r,!0,!1);g(n,!1,!0);g(i,!1,!1);if(0!==f.length||0!==h.length||0!==v.length||0!==m.length){var y=this.getData(function(){return d.e.getBatchOperationUrl(s._pageContext.webAbsoluteUrl)},function(e){return e},"AddRemoveGroupOwners",function(){return d.e.getBatchContent(o,[f,h,v,m],"POST",d.e.defaultBatchRequestPostData)},"POST",void 0,a,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;if(t){t.extraData={OwnersToAdd:f.length,MembersToAdd:h.length,OwnersToRemove:v.length,MembersToRemove:m.length};return{eventData:Object(u.__assign)(Object(u.__assign)({},n),{resultCode:t.status.toString()})}}return{eventData:n}},void 0);return new l.n(function(e,t){y.then(function(n){var r=d.e.processBatchResponse(n);r.hasError?t(r):e(r)},function(e){t(e)})})}};t.prototype.getUserInfo=function(e){var n=this;return this.getData(function(){return n._getUrl(c.format("User(principalName='{0}')",h.e.encodeRestUriStringToken(e)),"SP.Directory.DirectorySession")},function(n){var r=t._parseUser(n);r.email=e;return r},"GetGraphUser",void 0,"GET",void 0,void 0,3)};t.prototype.deleteGroup=function(e){var t=this;if(!e)return l.n.reject("Group parameter is null or undefined");return this.getData(function(){return t._getUrl(c.format("Group('{0}')",e.id),"SP.Directory.DirectorySession")},void 0,"DeleteGroup",void 0,"DELETE",void 0,void 0,3)};t.prototype.deleteSite=function(e){var t=this;return this.getData(function(){return t._pageContext.siteAbsoluteUrl+c.format("/_api/GroupSiteManager/Delete?siteUrl='{0}'",e)},void 0,"DeleteSite",void 0,"POST",void 0,void 0,3)};t.prototype.teamify=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroup"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroup}},"Groupify",function(){return""},"POST",void 0,void 0,0)};t.prototype.teamifyV2=function(e,t){var n=this;return this.getData(function(){return n._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroupEx"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroupEx}},"TeamifyV2",function(){return""},"POST",void 0,void 0,0).then(function(r){t(r);return r&&r.teamsId?n._pinToTeam(r,e):void 0})};t.prototype.dismissTeamifyBanner=function(){var e=this;return this.getData(function(){return e._pageContext.siteAbsoluteUrl+c.format("/_api/GroupSiteManager/HideTeamifyPrompt?siteUrl='{0}'",e._pageContext.siteAbsoluteUrl)},function(e){return null},"DismissTeamifyBanner",function(){return""},"POST").then(function(){if(!g.e.isActivated("B96CEE94-D6AD-4AAA-9E6F-DFD3A0CA44BA","4/20/2020","Cache getTeamifyBannerHidden call")){e.flushCache(e._isTeamifyPromptHiddenCacheKey);e.getTeamifyBannerHidden(!0)}})};t.prototype.getTeamifyBannerHidden=function(e){var t=this,n=function(){return t._pageContext.siteAbsoluteUrl+c.format("/_api/GroupSiteManager/IsTeamifyPromptHidden?siteUrl='{0}'",t._pageContext.siteAbsoluteUrl)},r=function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsTeamifyPromptHidden};return g.e.isActivated("B96CEE94-D6AD-4AAA-9E6F-DFD3A0CA44BA","4/20/2020","Cache getTeamifyBannerHidden call")?this.getData(n,r,"TeamifyBannerHidden",function(){return""},"Get"):this.getDataUtilizingCache({getUrl:n,qosName:"TeamifyBannerHidden",parseResponse:r,additionalPostData:"",method:"Get",bypassCache:e,cacheRequestKey:this._isTeamifyPromptHiddenCacheKey})};t.prototype._getUrl=function(e,t){return this._pageContext.webAbsoluteUrl+"/_api/"+t+"/"+e};t.prototype._getCsomUrl=function(e){return this._pageContext.webAbsoluteUrl+"/_vti_bin/client.svc/"+e};t.prototype._getGroupStatusNotebookUrl=function(e){return this._pageContext.webAbsoluteUrl+c.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",e,"notebook")};t.prototype._getGroupStatusFilesUrl=function(e){return this._pageContext.webAbsoluteUrl+c.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",e,"documents")};t.prototype._addOwnerInformation=function(e,t,n){return this.getGroupOwnership(e,"100").then(function(e){var r=e.ownersList.members,i=n.membersList.members,s=[],o={};r.forEach(function(e){o[e.userId]=!0;e.principalName.toLowerCase()===t.toLowerCase()&&(n.isOwner=!0)});var u=0,a={};i.forEach(function(e){if(o[e.userId]){e.isOwnerOfCurrentGroup=!0;s.push(e);u++;a[e.userId]=!0}else s.push(e);e.principalName===t&&(n.isMember=!0)});u<r.length&&r.forEach(function(e){if(!a[e.userId]){e.isOwnerOfCurrentGroup=!0;s.push(e)}});n.membersList.members=s;n.totalNumberOfMembers<s.length&&(n.totalNumberOfMembers=s.length);n.totalNumberOfOwners=e.totalNumberOfOwners;return l.n.resolve(n)})};t.prototype._fixUserImages=function(e){!e.image&&e.email&&(e.image=Object(v.e)(e.email));!e.profilePage&&e.email&&(e.profilePage=c.format("/_layouts/15/me.aspx?p={0}&v=profile&origin=ProfileODB",e.email))};t.prototype._calculateMissingMembershipProperties=function(e,t){var n=this;e.membersList.members.forEach(function(e){n._fixUserImages(e)})};t.prototype._calculateMissingOwnershipProperties=function(e){var t=this;e.ownersList.members.forEach(function(e){t._fixUserImages(e)})};t.prototype._calculateMissingGroupProperties=function(e,t){e.creationTime||(e.creationTime=Date.now());e.pictureUrl&&(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto"));!e.notebookUrl&&t&&(e.notebookUrl=this._getGroupStatusNotebookUrl(t));!e.filesUrl&&t&&(e.filesUrl=this._getGroupStatusFilesUrl(t))};t.prototype._parseResponseForGetUserGroups=function(e){var t=this,n=JSON.parse(e);if(n.constructor===Array)return n[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});var r=n.d.results.map(function(e){var n={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl,isFavorite:e.isFavorite};t._calculateMissingGroupProperties(n,n.id);return n}),i=r.filter(function(e){return e.isFavorite});i.push.apply(i,r.filter(function(e){return!e.isFavorite}));return i};t.prototype._pinToTeam=function(e,t){var n=this;t=t.map(function(e){return{displayName:e.displayName,isDefault:e.isDefault,url:e.url}});return this.getData(function(){return n._pageContext.siteAbsoluteUrl+"/_api/GroupSiteManager/PinToTeam"},function(t){if(t){var n=JSON.parse(t);if(n&&n.d)return{pinToTeam:n.d.PinToTeam,teamsInfo:e}}},"PinToTeam",function(){if(n._pageContext&&n._pageContext.navigationInfo&&n._pageContext.navigationInfo.quickLaunch){var r={requestParams:{__metadata:{type:"Microsoft.SharePoint.Portal.PinToTeamParams"},teamsId:e.teamsId,tabs:{__metadata:{type:"Collection(Microsoft.SharePoint.Portal.M365TabItem)"},results:t}}};return JSON.stringify(r)}},"POST",void 0,void 0,0)};return t})(f.t),x=20,T=(function(){function e(e,t,n,r,i){this._groupsProvider=e;this._parentGroup=t;this._loadPageFromServerDelegate=n;this._pageSize=r&&"number"==typeof r.pageSize?r.pageSize:x;this._shouldAddOwnershipInformation=!r||(r.ownershipInformation,!1)||r.ownershipInformation;this._userLoginName=i;this._foundOwnersDictionary={};this._numberOfOwnersFound=0}e.prototype.loadPage=function(e){var t=this,n=e||0;if(this._groupsProvider&&this._parentGroup.id){return this._loadPageFromServerDelegate(this._parentGroup.id,n,this._pageSize).then(function(e){return t._processPage(e,n)},function(e){t.error=e;return l.n.reject(e)})}return l.n.reject(void 0)};e.prototype._processPage=function(e,t){var n=this;this.totalNumberOfMembers=e.totalNumberOfMembers;var r=t+this._pageSize>=this.totalNumberOfMembers,i=r?void 0:this._computeGetNextPagePromise(t+this._pageSize);if(this._shouldAddOwnershipInformation){if(this._ownersDictionary){this._addOwnershipInformationToPage(e,r);return l.n.resolve({page:e.membersList.members,getNextPagePromise:i})}return this._groupsProvider.loadOwnershipContainerFromServer(this._parentGroup.id).then(function(t){n._addOwnershipInformationToPage(e,r,t);return l.n.resolve({page:e.membersList.members,getNextPagePromise:i})})}return l.n.resolve({page:e.membersList.members,getNextPagePromise:i})};e.prototype._addOwnershipInformationToPage=function(e,t,n){var r=this;if(n){this.totalNumberOfOwners=n.totalNumberOfOwners;this._ownersDictionary={};n.ownersList.members.forEach(function(e){e.userId&&(r._ownersDictionary[e.userId]=e)});this.isOwner=n.ownersList.containsUserByPrincipalName(this._userLoginName)}e.membersList.members.forEach(function(e){e.isOwnerOfCurrentGroup=r._ownersDictionary&&!!r._ownersDictionary[e.userId];if(e.isOwnerOfCurrentGroup){r._numberOfOwnersFound++;r._foundOwnersDictionary[e.userId]=!0}});if(t&&this._ownersDictionary&&this._numberOfOwnersFound<this.totalNumberOfOwners)for(var i in this._ownersDictionary){var s=this._ownersDictionary[i];if(!this._foundOwnersDictionary[s.userId]){s.isOwnerOfCurrentGroup=!0;e.membersList.members.push(s);this.totalNumberOfMembers++}}};e.prototype._computeGetNextPagePromise=function(e){var t=this;return function(){return t.loadPage(e)}};return e})(),N=n(92),C=n(95),k=n(300);n.d(t,"e",function(){return A});var L="GroupsNext",A=(function(){function e(e){this._missingLoginNameError="Missing user login name information.";this._pageContext=e.pageContext;this._dataRequestor=new k.t({qosName:"GroupsProvider"},{pageContext:e.pageContext});this._dataSource=e.dataSource||new S(e.pageContext);this._dataStore=e.dataStore||new r.e(L,i.e.session);this._userLoginName=e.pageContext&&e.pageContext.userLoginName;this._groups=[];this._eventGroup=new C.t(this);this.switchCurrentGroup(e.groupId||e.pageContext&&e.pageContext.groupId)}e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.getSPPageContext=function(){return this._pageContext};e.prototype.getMembershipPager=function(e){var t=this;return new T(this,this.group,function(e,n,r){return e?t._userLoginName?t._dataSource.getGroupMembershipPage(e,t._userLoginName,n,r):l.n.reject(t._missingLoginNameError):l.n.reject("Missing group id.")},e,this._userLoginName)};e.prototype.loadGroupInfoFromCache=function(e){if(this._dataStore&&e)return this._dataStore.getValue(e,i.e.session)};e.prototype.saveGroupToCache=function(e){e&&this._dataStore&&this._dataStore.setValue(e.id,e,i.e.session)};e.prototype.saveMembershipToCache=function(e,t){if(this._dataStore){var n=this._dataStore.getValue(e,i.e.session);if(n){n.membership={isMember:t.isMember,totalNumberOfMembers:t.totalNumberOfMembers,totalNumberOfOwners:t.totalNumberOfOwners,membersList:t.membersList,isOwner:t.isOwner,isJoinPending:t.isJoinPending,lastLoadTimeStampFromServer:t.lastLoadTimeStampFromServer};this.saveGroupToCache(n)}}};e.prototype.loadGroupInfoContainerFromServer=function(e){var t=this;return e?this._dataSource.getGroupBasicProperties(e).then(function(e){t._performBasicPropertiesPostProcessing(e);Object(N.i)(t._pageContext)&&t.doesCachedGroupPropertiesDiffer(e)&&t.syncGroupProperties();return e}):l.n.reject("Missing group id.")};e.prototype.loadMembershipContainerFromServer=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!1);return e?this._userLoginName?this._dataSource.getGroupMembership(e,this._userLoginName,t,n):l.n.reject(this._missingLoginNameError):l.n.reject("Missing group id.")};e.prototype.loadOwnershipContainerFromServer=function(e,t){return e?this._dataSource.getGroupOwnership(e,t):l.n.reject("Missing group id.")};e.prototype.loadUserGroups=function(e){var t=this;return this.loadUserGroupsFromCache(e).then(function(n){return n&&0!==n.length?l.n.resolve(n):t.getCurrentUser().then(function(n){return e?t._dataSource.getUserGroupsFromAAD(n).then(function(e){t._dataStore&&t._dataStore.setValue("UserGroupsFromAAD"+n.userId,e,i.e.session);return e}):t._dataSource.getUserGroups(n).then(function(e){t._dataStore&&t._dataStore.setValue("UserGroups"+n.userId,e,i.e.session);t._setUsersGroups(e,o.e.Server);return e})})})};e.prototype.loadUserGroupsFromCache=function(e){var t=this;return this._dataStore?this.getCurrentUser().then(function(n){var r;if(r=e?t._dataStore.getValue("UserGroupsFromAAD"+n.userId,i.e.session):t._dataStore.getValue("UserGroups"+n.userId,i.e.session)){e||t._setUsersGroups(r,o.e.Cache);return l.n.resolve(r)}return l.n.resolve(void 0)}):l.n.resolve(void 0)};e.prototype.isUserInGroup=function(e){return this.loadUserGroups(!0).then(function(t){for(var n=0,r=t.length;n<r;n++)if(t[n].id===e)return!0;return!1})};e.prototype.getGroup=function(e,t){var n=this;void 0===t&&(t=!1);if(e)throw new Error("NotImplemented: Calling getGroup() on groupsProvider supplying a groupId is not yet implemented.");if(t||e&&0!==e.length&&(!this.group||e!==this.group.id)){e&&0!==e.length||(e=this.group.id);return this.loadGroupInfoContainerFromServer(e)}return new l.n(function(e,t){var r=n.group;n.group?r.source===o.e.None?n._eventGroup.on(r,s.t.onSourceChange,function(i){i!==o.e.Error?i===o.e.None||e(r):t(n.group.error)}):e(r):t("There is no group currently being managed by GroupsProvider.")})};e.prototype.getCurrentUser=function(){var e=this;if(!this._userLoginName)return l.n.reject(this._missingLoginNameError);this.currentUser||(this.currentUser=this._getUserFromCache("CurrentUser"));return this.currentUser?l.n.resolve(this.currentUser):this._dataSource.getUserInfo(this._userLoginName).then(function(t){e._saveUserToCache(t,"CurrentUser");e.currentUser=t;return t})};e.prototype.addUserToGroupMembership=function(e,t,n,r){var i,s=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){i=o;return s._dataSource.addGroupMember(e,t,n,r)}).then(function(){s._clearUserGroupsCache(i)}):l.n.reject("Missing group id.")};e.prototype.addUserToGroupOwnership=function(e,t,n,r){var i,s=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){i=o;return s._dataSource.addGroupOwner(e,t,n,r)}).then(function(){s._clearUserGroupsCache(i)}):l.n.reject("Missing group id.")};e.prototype.removeUserFromGroupMembership=function(e,t,n){var r,i=this;return e?this._getUserIdForCacheClear(t).then(function(s){r=s;return i._dataSource.removeGroupMember(e,t,n)}).then(function(){i._clearUserGroupsCache(r)}):l.n.reject("Missing group id.")};e.prototype.removeUserFromGroupOwnership=function(e,t,n){var r,i=this;return e?this._getUserIdForCacheClear(t).then(function(s){r=s;return i._dataSource.removeGroupOwner(e,t,n)}).then(function(){i._clearUserGroupsCache(r)}):l.n.reject("Missing group id.")};e.prototype.addUsersToGroup=function(e,t,n,r,i){var s,o=this;if(!e)return l.n.reject("Missing group id.");if(this.currentUser){s=this.currentUser.userId;return this._dataSource.addUsersToGroup(e,t,n,r,i).then(function(e){o._clearUserGroupsCache(s);return e})}return this.getCurrentUser().then(function(e){s=e.userId}).then(function(){return o._dataSource.addUsersToGroup(e,t,n,r,i)}).then(function(e){o._clearUserGroupsCache(s);return e})};e.prototype.saveGroupProperties=function(e){return this._dataSource.setGroupBasicProperties(e)};e.prototype.switchCurrentGroup=function(e){var t=this.group?this.group.id:void 0;if(e&&e!==t){var n=this.getCachedGroup(e);n.load();this.group=n}};e.prototype.getCachedGroup=function(e,t){var n=this._groups[e];if(!n){n=new s.t(t,this,e,this._pageContext);this._groups[e]=n}return n};e.prototype.syncGroupProperties=function(){var e=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SyncGroupProperties";return this._dataRequestor.getData({url:e,qosName:"SyncGroupProperties",method:"POST",noRedirect:!0})};e.prototype.setGroupImage=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SetGroupImage";return this._dataRequestor.getData({url:t,qosName:"SetGroupImage",method:"POST",noRedirect:!0,additionalPostData:e,contentType:e?e.type:"image/jpeg"})};e.prototype.doesCachedGroupPropertiesDiffer=function(e){var t=this._pageContext;return t.groupId===e.id&&(t.webTitle!==e.name||(t.siteClassification||e.classification)&&t.siteClassification!==e.classification||(t.sensitivityLabel||e.assignedLabels)&&t.sensitivityLabel.toLocaleLowerCase()!==e.assignedLabels.toLocaleLowerCase()||null===t.groupType||void 0===t.groupType||"Public"===t.groupType!==e.isPublic||!g.e.isActivated("C846AC33-6AD5-479A-B4FD-8DE1AF891B6F","04/10/2020","Lazt Sync Teams Connected Site")&&!t.isTeamsConnectedSite&&!!e.teamsUrl&&e.teamsUrl.length>0)};e.prototype.teamify=function(){return this._dataSource.teamify()};e.prototype.teamifyV2=function(e,t){return this._dataSource.teamifyV2(e,t)};e.prototype.hideTeamifyBanner=function(){var e=this._makeHideTeamifyKey();this._dataStore.setValue(e,{},i.e.session)};e.prototype.dismissTeamifyBanner=function(){return this._dataSource.dismissTeamifyBanner()};e.prototype.getTeamifyBannerHidden=function(e){return this._dataStore.getValue(this._makeHideTeamifyKey(),i.e.session)?new l.n(function(e){return e(!0)}):this._dataSource.getTeamifyBannerHidden(e).catch(function(){return!1})};e.prototype.deleteGroup=function(e){return this._dataSource.deleteGroup(e)};e.prototype.deleteSite=function(e){return this._dataSource.deleteSite(e)};e.prototype._makeHideTeamifyKey=function(e){return"HideTeamify:"+(e||this._pageContext.siteId)};e.prototype._setUsersGroups=function(t,n){var r=this;this.userGroups=t.map(function(e){var t=r.getCachedGroup(e.id,e);n!==o.e.Server&&t.source===o.e.Server||t.extend(e);t.pictureUrl||t.load();return t});this._eventGroup.raise(e.onUserGroupsChange,this.userGroups)};e.prototype._performBasicPropertiesPostProcessing=function(e){if(this._pageContext){e.hasPictureUrl=!!e.pictureUrl;e.pictureUrl=this._pageContext.webAbsoluteUrl+"/_api/GroupService/GetGroupImage";e.inboxUrl=this._getWorkloadUrl(e,"inboxUrl","conversations","Yammer.FeedURL");e.calendarUrl=this._getWorkloadUrl(e,"calendarUrl","CALENDAR",null);e.membersUrl=this._getWorkloadUrl(e,"membersUrl","members",null);e.teamsUrl=this._getWorkloadUrl(e,"teamsUrl",null,"MicrosoftTeams.TeamHomeURL")}};e.prototype._getWorkloadUrl=function(e,t,n,r){var i=null,s=e.yammerResources,o=e.teamsResources,u=function(e){var t=e.filter(function(e){return e.Key===r});return t&&t[0]?t[0].Value:null};"MicrosoftTeams.TeamHomeURL"===r?o&&o.results&&o.results.length>0&&(i=u(o.results)):s&&s.results&&s.results.length>0?"Yammer.FeedURL"===r&&(i=u(s.results)):i=e[t]?e[t]:this._pageContext.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?id="+e.id+"&target="+n;return i};e.prototype._saveUserToCache=function(e,t){e&&this._dataStore&&this._dataStore.setValue(t,e,i.e.session)};e.prototype._getUserFromCache=function(e){return this._dataStore?this._dataStore.getValue(e,i.e.session):void 0};e.prototype._clearUserGroupsCache=function(e){if(e&&this._dataStore){this._dataStore.setValue("UserGroupsFromAAD"+e,void 0,i.e.session);this._dataStore.setValue("UserGroups"+e,void 0,i.e.session)}};e.prototype._getUserIdForCacheClear=function(e,t){var n;if(this.currentUser&&e){n=e===this.currentUser.userId?e:null;return l.n.resolve(n)}return this.getCurrentUser().then(function(r){return n=e?e===r.userId?r.userId:null:t===r.principalName?r.userId:null})};e.onUserGroupsChange="userGroups";return e})();t.t=A},3687:function(e,t,n){"use strict";var r=n(0),i=n(14),s=n(139),o=n(1735),u=n(153),a=n(93),f=n(61),l=n(1413),c=n(578),h=n(1545),p=n(300),d=n(23),v=n(1992),m=n(1781),g=n(95),y=n(246),b=(function(){function e(){var e=this.scope=new y.e;this._events=e.attach(new g.t(this))}e.prototype.start=function(){};e.prototype.abort=function(){};e.prototype.dispose=function(){this.scope.dispose()};e.prototype.updateState=function(e){if(e!==this.state){this.state=e;this._events.raise("upload_state_change",e)}};return e})(),w=n(15);n.d(t,"e",function(){return T});var E=8388608,S=262144e3,x=new o.e(3),T=(function(e){Object(r.__extends)(t,e);function t(t){var n=this,r=t.fileUpload;(n=e.call(this)||this)._fileUpload=r;n._authToken=t.authToken;n._uploadId=null;n._chunkNumber=0;n._streamingChunkNumber=0;n._currentChunkSize=E;n._currentStreamingChunkSize=S;n._onProgress=t.onProgress;n._dataRequestor=t.dataRequestor;n._async=n.scope.attach(new s.e(n));n.totalBytes=r.size;n.uploadedBytes=0;n.fileName=r.name;n.iconName=t.iconName;n.state=0;n.error=null;n.nameConflictBehavior=0;n.allowRename=!1;n.supportsVersioning=!0;n._expandAllItemFields=t.expandAllItemFields;n._uniqueId=t.uniqueId;n._parentItemKey=t.parentItemKey;n._targetItemKey=t.targetItemKey;n._serverRelativeItemUrl=t.serverRelativeItemUrl;n._webApiUrl=t.webApiUrl;return n}t.prototype.start=function(){var e=this;this.updateState(0);var t=x.enqueue(function(){e.error=void 0;e.updateState(1);return e._upload().then(function(){e.updateState(2)},function(t){var n;n=t instanceof m.e?t:new m.e({message:t&&t.message||"",errorType:h.e.general});e.error=n;e.updateState(4);return i.n.reject(t)})});this._uploadPromise=t;return t};t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null;this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0;if(t){t.cancel();t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()})}}};t.prototype.restart=function(){var e,t=this,n=this._uploadPromise;this._uploadPromise=void 0;if(n){n.cancel();e=n.catch(function(){return t._cancelChunkUpload().catch(function(){})})}else e=i.n.resolve();e.done(function(){t.start()})};t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var n=this._fileUpload.size;if(n<=25165824)e=this._sendSingleRequestUpload();else{this._maxUploadRequestDuration=15e4;e=this._sendStreamingUpload()}return e.then(function(e){t.uploadedBytes=n;t.item=e})};t.prototype._createUploadError=function(e){var t,n,r,i;if("string"==typeof e)r=String(e);else{t=this._getErrorCode(e);n=e.status;r="string"==typeof e.message?String(e.message):e.message.value}switch(t){case-2130575257:i=h.e.conflict;break;case-1:i=h.e.disconnected;break;case-2130575245:i=h.e.invalidName;break;case-2130246326:i=h.e.versionMismatch;break;case-2147023080:case-2130575282:i=h.e.overQuota;break;default:switch(n){case 401:i=h.e.authFailure;break;case 404:i=h.e.targetFolderMissing;break;case 403:case 429:i=h.e.accessDenied;break;case 409:i=h.e.conflict;break;case 412:i=h.e.versionMismatch;break;case 415:i=h.e.emptyFileOrFolder;break;case 423:i=h.e.lockMismatch;break;case 507:i=h.e.overQuota;break;default:r?i||(i=h.e.other):i=h.e.general}}return new m.e({message:r,errorType:i,allowRename:this.allowRename,supportsVersioning:this.supportsVersioning})};t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]};t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,n=this._webApiUrl;n=e?n.method("GetFolderById",e):N(n,{serverRelativeItemUrl:t,isFolder:!0});var r=this._fileUpload.name,i=1===this.nameConflictBehavior;n=n.segment("Files");n=w.e.isActivated("BE901A1A-3518-425D-B67D-7AE0021E433B","9/25/2019","Add AutoCheckoutOnInvalidData param for uploading file")?n.methodWithAliases("AddUsingPath",{DecodedUrl:r,overwrite:i}):n.methodWithAliases("AddUsingPath",{DecodedUrl:r,overwrite:i,AutoCheckoutOnInvalidData:!0});var s="ListItemAllFields";this._expandAllItemFields&&(s+="/ContentType/Fields");s&&(n=n.oDataParameter("$Expand",s));return n.toString()};t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return i.n.resolve(!1);var t=this._serverRelativeItemUrl,n=this._webApiUrl;n=(n=N(n,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+f.e.encodeRestUriStringToken(this._fileUpload.name)+"'");return this._dataRequestor.getData({url:n.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var n=JSON.parse(t);return!!(n&&n.d&&n.d.results&&n.d.results.length>0)&&!(n.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!i.n.isCanceled(e)&&i.n.reject(e)})};t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)};t.prototype._getItemFromResponse=function(e){var t;try{var n=JSON.parse(e).d,r=this._targetItemKey,i=void 0;n.ListItemAllFields&&n.ListItemAllFields.Id&&(i=String(n.ListItemAllFields.Id));var s=!1;if(n.ListItemAllFields&&n.ListItemAllFields.ContentType&&n.ListItemAllFields.ContentType.Fields&&n.ListItemAllFields.ContentType.Fields.results){var o=n.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(o.length>0)for(var u=0,f=o;u<f.length;u++){var h=f[u];if(!n.ListItemAllFields[h.InternalName]){s=!0;break}}}var p=void 0;n.UniqueId&&(p=a.e.normalizeLower(n.UniqueId));var d=n.Name,v=c.t(d);t={key:r,parentKey:this._parentItemKey,type:l.t.File,id:n.ServerRelativeUrl,name:d,displayName:d,extension:v,properties:{ID:i,uniqueId:p},itemFromServer:n,hasMissingMetadata:s}}catch(e){}return t};t.prototype._generateChunkPostUrl=function(e,t){var n,i=this._fileUpload,s=this._uniqueId,o=i.size<=t,u=this._serverRelativeItemUrl,a=this._webApiUrl,f={uploadId:{guid:this._uploadId}};if(0===this._chunkNumber&&0===this._streamingChunkNumber){n="StartUpload";a=(a=s?a.method("GetFolderById",s):N(a,{serverRelativeItemUrl:u,isFolder:!0})).segment("Files");a=1===this.nameConflictBehavior?a.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:i.name}):a.methodWithAliases("AddStubUsingPath",{DecodedUrl:i.name})}else{n=o?"FinishUpload":"ContinueUpload";a=N(a,{serverRelativeItemUrl:u+"/"+i.name,isFolder:!1});f=Object(r.__assign)(Object(r.__assign)({},f),{fileOffset:e})}return(a=a.methodWithAliases(n,f)).toString()};t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,n=this._serverRelativeItemUrl,r=this._webApiUrl;r=r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:n+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}});return this._dataRequestor.getData({url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){if(e.d&&e.d.ExpectedContentRange){return parseInt(e.d.ExpectedContentRange.split("-")[0],10)}return i.n.reject(new Error("No expected range from server response."))})};t.prototype._uploadFragment=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);var r=this._fileUpload.size,s=Math.min(this._currentChunkSize+e,r);this._uploadId||(this._uploadId=a.e.generate());var o=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,s),offset:e,length:s-e}).then(function(e){n.uploadedBytes=s;if(s<r){n._chunkNumber++;Date.now()-o<6e4&&(n._currentChunkSize=Math.min(Math.floor(n._currentChunkSize*Math.pow(2,.25)),62914560));return n._uploadFragment(s)}return n._processUploadCompleteResponse(e)},function(r){if(i.n.isCanceled(r))return i.n.reject(r);if(-2===n._getErrorCode(r)){if(n._currentChunkSize>262144){n._currentChunkSize=Math.max(Math.floor(n._currentChunkSize/2),262144);var s=void 0;0===n._chunkNumber&&(s=n._cancelChunkUpload());return i.n.resolve(s).then(function(){return n._uploadFragment(e)})}}else if(t>0&&n._canRetry(r)){var o,a=new u.e(function(){o&&n._async.clearTimeout(o)});o=n._async.setTimeout(function(){return a.complete()},1e3);return a.getPromise().then(function(){return n._uploadFragment(e,t-1)})}return i.n.reject(n._createUploadError(r))})};t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var n=new m.e({message:"",errorType:h.e.conflict});return i.n.reject(n)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){if(i.n.isCanceled(t))return i.n.reject(t);if(-2===e._getErrorCode(t)){e.nameConflictBehavior=1;return e._uploadFragment()}return i.n.reject(e._createUploadError(t))})})};t.prototype._sendStreamingUpload=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._uploadId||(this._uploadId=a.e.generate());var r=this._fileUpload.size,s=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,r):0;return this._isConflictFile().then(function(t){if(t){var r=new m.e({message:"",errorType:h.e.conflict});return i.n.reject(r)}return n._fileUpload.slice(e,s)}).then(function(o){return n._sendFileData({url:n._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:o,offset:e,length:o.size}).then(function(e){n.uploadedBytes=s;if(s<r){n._streamingChunkNumber++;return n._sendStreamingUpload(s,t)}return n._processUploadCompleteResponse(e)},function(e){if(i.n.isCanceled(e))return i.n.reject(e);if(-2===n._getErrorCode(e)){if(n._currentStreamingChunkSize<=1048576)return i.n.reject(n._createUploadError(e));n._currentStreamingChunkSize=n._currentStreamingChunkSize/2}return n._getUploadStatus().then(function(e){return n._sendStreamingUpload(e,3)},function(r){if(t>0&&n._canRetry(e)){var s,o=new u.e(function(){s&&n._async.clearTimeout(s)});s=n._async.setTimeout(function(){return o.complete()},1e3);return o.getPromise().then(function(){return n._sendStreamingUpload(0,t-1)})}return i.n.reject(n._createUploadError(e))})})})};t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t};t.prototype._cancelChunkUpload=function(){var e=this._uploadId;this._uploadId=void 0;this._chunkNumber=0;if(e){var t=this._fileUpload,n=this._serverRelativeItemUrl,r=this._webApiUrl;r=(r=N(r,{serverRelativeItemUrl:n+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}});return this._dataRequestor.getData({url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return i.n.resolve()};t.prototype._sendFileData=function(e){var t,n,r,i=this,s=e.url,o=e.qosName,a=e.data,f=e.offset,l=e.length,c=new u.e(function(){t.cancel()}),h=function(e){var t=i._chunkNumber>0&&f+l>=i._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&i._async.clearTimeout(n);e&&(n=i._async.setTimeout(function(){c.error({code:"-1",message:""})},r))},p=Date.now(),d=Date.now(),v=0,m=0,g=0,y=this._async.debounce(function(e){if(e>i.uploadedBytes){i.uploadedBytes=e;i._onProgress&&i._onProgress(e)}},100,{leading:!1});t=this._dataRequestor.getData({url:s,authToken:this._authToken,qosName:o,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:a,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();m+=(e.loaded-v)/(t-d);g++;r=e.loaded/(t-p);d=t;v=e.loaded;y(f+e.loaded);h(l-e.loaded)}}});h(l);var b=this._async.setInterval(function(){if(g){Date.now()-p+(l-v)/((m+r)/(g+1))>i._maxUploadRequestDuration&&v<l&&c.error({code:"-2",message:""})}},1e4);t.done(function(e){c.complete(e)},function(e){c.error(e)});c.getPromise().done(function(){n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)},function(){t.cancel();n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)});return c.getPromise()};return t})(b);(function(e){Object(r.__extends)(t,e);function t(t,n){var r=t.parentItem,i=t.fileUpload,s=n.listContext,o=n.itemUrlHelper,u=n.apiUrlHelper,a=s&&s.contentTypesEnabled&&s.listTemplateType!==d.n.mySiteDocumentLibrary,f=o.getItemUrlParts(r.key),l=r.properties&&r.properties.uniqueId,c=r.key,h=(function(e,t,n){var r=e.getItemUrlParts(t),i=r.serverRelativeItemUrl,s=r.normalizedListUrl,o=i+"/"+n;return Object(v.e)(o,s)})(o,c,i.name),m=f.serverRelativeItemUrl,g=u.build().webByItemUrl(f),y=new p.t({pageContext:n.pageContext,qosName:"SingleFileUploader"});return e.call(this,{uniqueId:l,expandAllItemFields:a,dataRequestor:y,parentItemKey:c,targetItemKey:h,serverRelativeItemUrl:m,webApiUrl:g,iconName:i.iconName,fileUpload:i})||this}})(T);function N(e,t){var n=t.serverRelativeItemUrl,r=t.isFolder;return e=e.methodWithAliases(r?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:n})}},3693:function(e,t,n){"use strict";var r,i=n(2929),s=n(735),o=n(14),u=n(95),a=n(15);(function(e){e[e.none=0]="none";e[e.allMembers=1]="allMembers";e[e.ownershipInformation=2]="ownershipInformation";e[e.forceSkipCache=4]="forceSkipCache"})(r||(r={}));var f=(function(){function e(e,t,n){this._eventGroup=new u.t(this);this.source=s.e.None;this.lastLoadTimeStampFromServer=-1;this._groupsProvider=t;this._parent=n;e&&this.extend(e,s.e.None);this.membersList||(this.membersList=new i.e)}e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}this._parent=void 0};e.prototype.load=function(e,t){var n=this;void 0===e&&(e=!1);void 0===t&&(t=!1);if(this._groupsProvider&&this._parent.id){var i=0;e&&(i|=r.allMembers);t&&(i|=r.ownershipInformation);if(this.source===s.e.None&&!i){var o=this._groupsProvider.loadGroupInfoFromCache(this._parent.id);o&&o.membership&&o.membership.lastLoadTimeStampFromServer>0&&this.extend(o.membership,s.e.Cache)}if(this._shouldLoadNewData(i)){this._startLoadingFromServer(i);this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e,t).then(function(e){n.extend(e,s.e.Server);n._finishLoadingFromServer();if(!i){e.lastLoadTimeStampFromServer=n.lastLoadTimeStampFromServer;n._groupsProvider.saveMembershipToCache(n._parent.id,e)}},function(e){n._errorLoading(e)})}}};e.prototype.loadWithOptions=function(e){var t=this;if(this._groupsProvider&&this._parent.id){if(this.source===s.e.None&&!e){var n=this._groupsProvider.loadGroupInfoFromCache(this._parent.id);n&&n.membership&&n.membership.lastLoadTimeStampFromServer>0&&this.extend(n.membership,s.e.Cache)}if(this._shouldLoadNewData(e)){this._startLoadingFromServer(e);return this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e&&(e&r.allMembers)===r.allMembers,e&&(e&r.ownershipInformation)===r.ownershipInformation).then(function(n){t.extend(n,s.e.Server);t._finishLoadingFromServer();if(!e||e===r.forceSkipCache){n.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer;t._groupsProvider.saveMembershipToCache(t._parent.id,n)}},function(e){t._errorLoading(e)})}}return o.n.resolve(void 0)};e.prototype.extend=function(t,n){this.isMember=t.isMember;this.isOwner=t.isOwner;this.isJoinPending=t.isJoinPending;this.membersList=t.membersList;this.totalNumberOfMembers=t.totalNumberOfMembers;this.totalNumberOfOwners=t.totalNumberOfOwners;this.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer;this._parent.membership=this;this.source=n;this._eventGroup.raise(e.onSourceChange,this.source)};e.prototype._shouldLoadNewData=function(e){var t=a.e.isActivated("905638c9-80d6-4790-bc83-9f9097067247","04/30/2020","Longer group cache time")?12e4:864e5;return!this.isLoadingFromServer&&this.source!==s.e.Server&&(this.lastLoadTimeStampFromServer<0||Date.now()-this.lastLoadTimeStampFromServer>t)||e&&(e&r.forceSkipCache)===r.forceSkipCache||e&&(e&r.allMembers)===r.allMembers&&!(this._currentLoadOptions&&(this._currentLoadOptions&r.allMembers)===r.allMembers)||e&&(e&r.ownershipInformation)===r.ownershipInformation&&!(this._currentLoadOptions&&(this._currentLoadOptions&r.ownershipInformation)===r.ownershipInformation)};e.prototype._startLoadingFromServer=function(e){this.isLoadingFromServer=!0;this._currentLoadOptions=e};e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1;this._currentLoadOptions=void 0;this.lastLoadTimeStampFromServer=Date.now()};e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1;this._currentLoadOptions=void 0;this.error=e};e.onSourceChange="source";return e})(),l=n(25);n.d(t,"e",function(){return c});var c=(function(){function e(t,n,r,i){this._eventGroup=new u.t(this);this.source=s.e.None;this.lastLoadTimeStampFromServer=-1;this._groupsProvider=n;this.id=r;t?this.extend(t):this.load();this.membership=new f(void 0,this._groupsProvider,this);!i&&n&&(i=n.getSPPageContext());this.plannerUrl=e._getPlannerUrl(i,r)}e._getPlannerUrl=function(e,t){if(e){t||(t=e.groupId);return e.webAbsoluteUrl+l.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",t,"planner")}};e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.load=function(t){var n=this;if(this._groupsProvider&&this.id){if(this.source===s.e.None){var r=this._groupsProvider.loadGroupInfoFromCache(this.id);if(r&&r.lastLoadTimeStampFromServer>0){this.extend(r);this.source=s.e.Cache;this._eventGroup.raise(e.onSourceChange,this.source)}}if(this._shouldLoadNewData(t)){this._startLoadingFromServer();this._groupsProvider.loadGroupInfoContainerFromServer(this.id).then(function(e){e.lastLoadTimeStampFromServer=Date.now();n.extend(e);n._finishLoadingFromServer();n._groupsProvider.saveGroupToCache(e)},function(e){n._errorLoading(e)})}}};e.prototype.extend=function(e){this.name=e.name;this.principalName=e.principalName;this.alias=e.alias;this.mail=e.mail;this.description=e.description;this.creationTime=e.creationTime;this.profileUrl=e.profileUrl;this.inboxUrl=e.inboxUrl;this.calendarUrl=e.calendarUrl;this.filesUrl=e.filesUrl;this.notebookUrl=e.notebookUrl;this.pictureUrl=e.pictureUrl;this.hasPictureUrl=e.hasPictureUrl;this.sharePointUrl=e.sharePointUrl;this.editUrl=e.editUrl;this.membersUrl=e.membersUrl;this.teamsUrl=e.teamsUrl;this.isPublic=e.isPublic;this.classification=e.classification;this.assignedLabels=e.assignedLabels;this.allowToAddGuests=e.allowToAddGuests;this.isDynamic=e.isDynamic;this.yammerResources=e.yammerResources;this.teamsResources=e.teamsResources;this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer};e.prototype._shouldLoadNewData=function(e){var t=a.e.isActivated("905638c9-80d6-4790-bc83-9f9097067247","04/30/2020","Longer group cache time")?6e4:864e5;return!this.isLoadingFromServer&&(e||this.source!==s.e.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>t))};e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0};e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1;this.source=s.e.Server;this._eventGroup.raise(e.onSourceChange,this.source)};e.prototype._errorLoading=function(t){this.isLoadingFromServer=!1;this.error=t;this._eventGroup.raise(e.onSourceChange,s.e.Error)};e.onSourceChange="source";return e})();t.t=c},3742:function(e,t,n){"use strict";var r;(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(r||(r={}));t.e=r},3745:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return o});var r,i=n(1539),s=n(15);(function(e){e.Small="S";e.Medium="M";e.Large="L"})(r||(r={}));function o(e){var t=e.webUrl||"",n=e.size||r.Small;if(s.e.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN"))return t+"/_layouts/15/userphoto.aspx?accountname="+e.userLoginName+"&size="+n;var o=void 0;switch(e.size){case r.Large:o=3;break;case r.Medium:o=2;break;default:o=1}return Object(i.e)(e.userLoginName,o)}},3746:function(e,t,n){"use strict";n.r(t);n.d(t,"UserExpirationProvider",function(){return r});var r=(function(){function e(e){this._dataSource=e.dataSource}e.prototype.getUsersWithExpirations=function(e,t,n,r,i){return this._dataSource.getUsersWithExpirations(e,t,n,r,i)};e.prototype.setUserExpiration=function(e,t){return this._dataSource.setUserExpiration(e,t)};e.prototype.expireUser=function(e){return this._dataSource.expireUser(e)};e.prototype.getExternalUserExpirationPolicy=function(){return this._dataSource.getExternalUserExpirationPolicy()};return e})();t.default=r},3767:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(581),s=n(509),o=n(570),u=n(14),a=n(33),f=n(145),l=n(93),c=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}t.prototype.getItem=function(t,n,r,i){var s=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;return e.prototype.getData.call(this,function(){return s.getUrl(n,t)},function(e,t){return s._parseResponse(e,r.qosEvent,t)},r.qosName,function(){return s.getAdditionalPostData(t.postDataContext,n)},"POST",this._getListRequestHeaders(t,n),void 0,void 0,void 0,void 0,function(e){var t=s._telemetryHandler(e);i&&i(t.eventData);return t},void 0).then(function(e){return e},function(e){s._errorHandler(r.qosName,e);return u.n.reject(e)})};t.prototype.getUrl=function(e,t){var n=t&&t.postDataContext,r={webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath,isOnePageNavigation:t.isOnePageNavigation};if(this._isSpecifiedItemRequest(e))r.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||n&&n.isOnePage)&&e.viewIdForRequest!==l.e.Empty&&(r.view=e.viewIdForRequest);!r.view&&e.viewPathForRequest&&(r.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(r.filterParams=e.filterParams);if(e.sortField){r.sortField=e.sortField;r.sortDir="false"===e.isAscending?"Desc":"Asc"}n&&n.groupReplace?r.requestToken=this._isExpandingGroup(r)?void 0:e.requestToken:r.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||n&&n.groupReplace||(r.groupString=e.group.groupString);n&&n.webId&&(r.webId=n.webId)}return i.t(r)};t.prototype.getAdditionalPostData=function(e,t){return s.e(e,t)};t.prototype._getListRequestHeaders=function(e,t){var n=i.r(t,e.postDataContext);n["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst";return n};t.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};t.prototype._isExpandingGroup=function(e){return e.group&&"__next__"!==e.group.groupingId};t.prototype._parseResponse=function(e,t,n){var r=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,r)}catch(n){if("{}"!==e.substring(0,2)){t.end({resultType:a.e.Failure,resultCode:"BadJSON"});throw n}return this._getListItemResponse(e.substring(2),r)}};t.prototype._getListItemResponse=function(e,t){var n;n=JSON.parse(e);"ServiceWorker-FromCache"===t&&(n.isFromServiceWorkerCache=!0);return n};t.prototype._telemetryHandler=function(e){var t=e.errorData,n=Object(r.__assign)({},e.eventData);if(t){var i=void 0,s=t.code?t.code:"";if(s.indexOf("2147024860")>-1)s="ListViewTreshold";else if(s.indexOf("2147024749")>-1)s="LookupColumnTreshold";else if(s.indexOf("2147024809")>-1&&s.indexOf("requestUrl")>-1)s="RequestURLFailure";else if(s.indexOf("2147024809")>-1&&s.indexOf("range")>-1)s="RangeError";else if(s.indexOf("2147024809")>-1&&s.indexOf("view")>-1)s="InvalidView";else if(s.indexOf("2130575340")>-1&&s.indexOf("field")>-1)s="FieldTypesNotInstalledProperly";else if(s.indexOf("2146232832")>-1){s="DefaultDoclibNotFound";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else if(s.indexOf("2147024895")>-1){s="PrefetchWebMismatch";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else s=n.resultCode;n.resultCode=s;return{canRetry:i,eventData:n}}return{eventData:n}};t.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?f.e.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&f.e.logData({name:e+".LookupColumnTreshold"})};return t})(o.t)},3793:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(14),s=n(865),o=n(570),u=n(15),a={method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"}},f=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"GraphUserInfo"},n)||this;r._oAuthTokenProvider=n.oAuthTokenProvider;r._canUseGraph=r._pageContext.isSPO;r._requestCache=new s.e({id:"GraphUserInfo"},{pageContext:r._pageContext});return r}t.prototype.canUseTeams=function(){var e=this;return this._canUseGraph?this._requestCache.getDataUtilizingCache({cacheRequestKey:"CanUseTeams",getData:function(){return e._oAuthTokenProvider.getToken(e._pageContext.msGraphEndpointUrl).then(function(t){return e._canUseTeams(t)})}}).catch(function(){return null}):i.n.resolve(null)};t.prototype._canUseTeams=function(e){return this.dataRequestor.getData(Object(r.__assign)(Object(r.__assign)({url:this._pageContext.msGraphEndpointUrl+"/beta/me/licenseDetails",authToken:e,qosName:"CanUseTeams"},a),{parseResponse:function(e){return JSON.parse(e).value.some(function(e){var t=e.servicePlans||[];if(u.e.isActivated("D8EC3B19-16BC-4A64-8EF4-AF0DB0262805","7/25/2019","Properly check the status of the users Teams license"))return t.some(function(e){return"57ff2da0-773e-42df-b2af-ffb7a2317929"===e.servicePlanId});for(var n=0;n<t.length;n++)if("57ff2da0-773e-42df-b2af-ffb7a2317929"===t[n].servicePlanId)return"Success"===t[n].provisioningStatus;return!1})}}))};return t})(o.e)}}]);
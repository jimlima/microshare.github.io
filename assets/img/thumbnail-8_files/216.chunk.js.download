(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["216"],{1417:function(e,t,n){"use strict";var r=n(1515),i=n(1376),s=n(1378),o=n(33),u=n(1371),a=n(53),f=n(14),l=n(711),c=n(1433),h=n(502),p=n(15),d=new RegExp("^Templates$","i"),v=(function(){function e(){}e.isFolder=function(e,t){return t?e&&(e.type===u.e.Folder||e.type===u.e.OneNote):e&&e.type===u.e.Folder};e.isCheckedOut=function(e){return l.e(e)};e.isCheckedOutByUser=function(e,t){return l.n(e,t)};e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)};e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:r.e.FileCheckedoutOrLockedWarningTitle,component:{name:c.e.tagName,params:{text:r.e.FileCheckedoutOrLockedWarning}},actions:[{name:i.e.cancelActionText,execute:function(){return f.n.wrap(2)},icon:new s.e("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:o.e.Success}})};e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major};e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&(!(e.isPendingApproval(t,n)||!p.e.isActivated("20638368-710f-41c5-b78b-464db07fb707","04/27/2020","No publishing banner for page templates")&&e.isPageTemplate(t))&&(!(Object(h.isFeatureEnabled)(h.WexSitePagesScheduling)&&t.properties&&t.properties._ScheduledVersion&&t.properties.owshiddenversion===t.properties._ScheduledVersion)&&(a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0))))};e.isPublishingRelevant=function(t,n){return a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)};e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)};e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var r=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:r}}return{major:0,minor:0}};e.isPendingApproval=function(t,n){return!!n.isModerated&&(t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty])};e.isPageTemplate=function(e){if(!e.id)return!1;var t=e.id.split("/"),n=t.length;return d.test(t[n-2])};e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&a.e.hasItemPermission(t,a.e.editListItems)&&a.e.hasItemPermission(t,a.e.approveItems)};e.FileTypeProperty="FSObjType";e.PublishProperty="_ModerationStatus.";e.VersionProperty="_UIVersion";return e})();t.e=v},1456:function(e,t,n){"use strict";var r=(function(){function e(e){this._tasksByKey={};this._onChanges=e}e.map=function(e,t){return{update:function(n,r){void 0===r&&(r=!1);e.update(n.map(function(e){return t(e)}),r)}}};e.prototype.dispose=function(){this._tasksByKey={};this._onChanges=null};e.prototype.getTasks=function(){var e=[];for(var t in this._tasksByKey)e.push(this._tasksByKey[t]);return e};e.prototype.getTask=function(e){return this._tasksByKey[e]};e.prototype.update=function(e,t){void 0===t&&(t=!1);var n,r,i;n={};for(var s in this._tasksByKey)n[s]=this._tasksByKey[s];i=[];for(var o=0,u=e;o<u.length;o++){var a=u[o],f=n[a.key],l=a.compare(f);l&&i.push(l);delete n[a.key];this._tasksByKey[a.key]=a}if(t)for(var s in n){r=n[s];delete this._tasksByKey[s];i.push({previous:r,current:null})}this.onChanges(i)};e.prototype.onChanges=function(e){this._onChanges&&this._onChanges(e)};return e})();t.e=r},1541:function(e,t,n){"use strict";var r=n(0),i=n(1224),s=n(1416);n.d(t,"t",function(){return s.e});var o=n(1456),u=n(14),a=n(153),f=n(1407),l=n(1404),c=n(1436),h=n(1388);n.d(t,"e",function(){return h.e});var p=n(1562),d=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._actionsByName={};var i=n.operationProvider,s=void 0===i?r.resources.consume(f.e):i;r._operationProvider=s;r._operationBatch=new p.e;r._operationsByKey={};r._completionSignal=new a.e;r._completionSignal.getPromise().done(function(){r.dispose()},function(){r.dispose()});r._observer=r.addDisposable(new o.e(r._onTaskChanges.bind(r)));r._throttleExecuteAllActions=r.async.debounce(r._executeAllActions);r.registerActions({cancel:r.onCancel});r.addDisposable(r._operationProvider.groups.subscribe(r._onOperationProviderGroupsChanged,r,"arrayChange"));return r}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._observer=null;this._actionsByName={};this._getActionExecutor=null;this._onTaskChanges=null;this._operationsByKey={};this._groupOperation=null;this._throttleExecuteAllActions=null};t.prototype.start=function(){var e=this;return this.onStart(this._observer).then(function(){e._completeIfNoGroupCreated()},function(t){e._completeIfNoGroupCreated();return u.n.wrapError(t)})};t.prototype.wait=function(){return this._completionSignal.getPromise()};t.prototype.onStart=function(e){return u.n.wrap()};t.prototype.onCancel=function(e,t){e=e.map(function(e){return e.cancel()});t.update(e);return u.n.wrap()};t.prototype.registerActions=function(e){for(var t in e){var n=e[t];if(n){n._BaseOperator_actionName=t;this._actionsByName[t]={action:e[t],callback:e[t].bind(this),queue:[],signal:new a.e}}else delete this._actionsByName[t]}};t.prototype.getOperationDetails=function(e){var t;t=1===e.status?l.e.completed:2===e.status?l.e.failed:3===e.status?l.e.canceled:l.e.started;return{type:h.e.multiple,name:"",iconName:null,error:e.error&&new c.e({message:e.error.message,payloads:{}})||null,state:t,progress:{minimum:0,maximum:3!==e.status?1:0,current:1===e.status?1:0},visibility:0,payloads:{},actions:[]}};t.prototype.onOperationFinished=function(e){};t.prototype._queueTaskForAction=function(e,t){var n=this._actionsByName[e];n.queue.push(t);this._throttleExecuteAllActions();return n.signal.getPromise()};t.prototype._executeAllActions=function(){for(var e in this._actionsByName){var t=this._actionsByName[e],n=t.signal;t.signal=new a.e;if(t.queue.length){var r=t.queue.splice(0,t.queue.length);t.callback(r,this._observer).done(v(n),m(n))}}};t.prototype._onTaskChanges=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];this._updateOperationForTask(r)}};t.prototype._updateOperationForTask=function(e){var t,n=e.current,r=this.getOperationDetails(n),i=this._operationsByKey[n.key];t={};for(var s=0,o=r.actions;s<o.length;s++){var u=o[s],a=u._BaseOperator_actionName,f=this._actionsByName[a];f&&f.action===u&&(t[a]=!0)}if(!i){var l={};for(var a in this._actionsByName)l[a]={isAvailable:this.createObservable(a in t),execute:this._getActionExecutor(a,n)};var c={batch:this._operationBatch,type:r.type,name:r.name,iconName:r.iconName,payloads:r.payloads,progress:r.progress,visibility:r.visibility,actions:l};i=this._operationsByKey[n.key]=this._operationProvider.register(c)}if(i.name!==r.name){i.name=r.name;i.payloads(r.payloads)}i.progress.minimum(r.progress.minimum);i.progress.maximum(r.progress.maximum);i.progress.current(r.progress.current);i.type(r.type);i.error(r.error);i.state(r.state);for(var a in this._actionsByName)i.actions.peek()[a].isAvailable(a in t)};t.prototype._getActionExecutor=function(e,t){var n=this;return function(){return n._queueTaskForAction(e,t)}};t.prototype._createGroupOperationSubscription=function(e){var t=this,n=this.createPureComputed(function(){var t=e.state();return t===l.e.completed||t===l.e.canceled||t===l.e.failed||t===l.e.expired});this.createBackgroundComputed(function(){n()&&t.observables.ignore(function(){t.onOperationFinished(e)})})};t.prototype._onOperationProviderGroupsChanged=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r.value;if(i.batch===this._operationBatch)if("added"===r.status){if(!this._groupOperation){this._groupOperation=i;this._createGroupOperationSubscription(i)}}else"deleted"!==r.status||r.moved||this._completionSignal.complete()}};t.prototype._completeIfNoGroupCreated=function(){this._groupOperation||this._completionSignal.complete()};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{operationProvider:f.e});return t})(i.default);t.n=d;function v(e){return function(){return e.complete()}}function m(e){return function(t){return e.error(t)}}},1611:function(e,t,n){"use strict";var r;(function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"})(r||(r={}));t.e=r},1746:function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(14),i=n(10),s=n(260),o=n(1611),u=n(1449),a=n(1402),f=n(7),l=n(1225),c=n(1717),h=n(823),p=n(1416),d=n(87),v=n(152),m=n(829),g=(function(){function e(e,t){this._itemDataSource=t.itemDataSource;this._deleteRestoreDataSource=t.deleteRestoreDataSource;this._itemProvider=t.itemProvider;this._itemTaskObserver=new t.itemTaskObserverType;this._photoProvider=t.photoProvider;this._store=t.itemsStore;this._tagProvider=t.tagProvider;this._updateQuota=t.updateQuota;this._isItemsScopeEnabled=t.isItemsScopeEnabled;this._resources=t.resources}e.prototype.createFolder=function(e,t){var n=this,r=e.parent.key,i=e.folderName,s=new p.e(r+"&cf="+i,i);return this._performOperation([r],t,s,function(){return n._itemDataSource.createFolder(e)})};e.prototype.renameItem=function(e,t){var n=this,r=e.item,i=r.key,s=new p.e(i,r);return this._performOperation([e.parentKey,i],t,s,function(){return n._itemDataSource.renameItem(e)})};e.prototype.deleteItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleDelete)};e.prototype.restoreItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleRestore)};e.prototype.restoreAll=function(e){var t=this;return this._deleteRestoreDataSource.restoreAll(e).then(function(){t._itemProvider.invalidateItem(e.parentKey);t._updateQuota(!0);return!0})};e.prototype._handleDelete=function(e){var t=this,n=this._itemProvider;return this._deleteRestoreDataSource.deleteItems(e).then(function(r){var i;e.deletionType===o.e.Recycle&&(i={triggerFetch:!1,emptyAllOtherSets:!0});n.invalidateItem(e.parentKey,i);var s=e.items.map(function(e){return new p.e(e.key).succeed({item:{key:e.key,parentKey:m.remove()}})}),u=t._itemTaskObserver;u.update(s);u.flush();return r})};e.prototype._handleRestore=function(e){var t=this;return this._deleteRestoreDataSource.restoreItems(e).then(function(n){var r=s.e(e.parentKey);delete r.view;var i=s.t(r);t._itemProvider.invalidateItem(i,{emptyAllOtherSets:!0});(t._isItemsScopeEnabled||t._resources.consume(h.n))&&t._resources.consumeAsync(d._).then(function(e){e.invalidateItems(i)});return n})};e.prototype._handleDeleteOrRestore=function(e,t,n){var r=this,i={},s=e.items.map(function(e){return i[e.id]=new p.e(e.key,e)}),o=this._itemProvider;t.update(s);return n.call(this,e).then(function(n){for(var i=0,o=e.items;i<o.length;i++){var u=o[i];r._invalidatePhoto(u)}r._store.invalidateAllPhotos();r._invalidateAllTags();s=s.map(function(e){return e.succeed()});t.update(s)},function(n){o.invalidateItem(e.parentKey);var r=n.data&&n.data.items||[];s=[];for(var u=0,a=r;u<a.length;u++){var f=a[u],l=i[f.id];delete i[f.id];s.push(f.error?l.fail(f.error):l.succeed())}for(var c in i){l=i[c];s.push(l.cancel())}t.update(s)}).then(function(){r._updateQuota(!0)})};e.prototype._invalidatePhoto=function(e){var t=s.e(e.key);delete t.qt;var n=s.t(t);this._store.invalidateItem(n);(this._isItemsScopeEnabled||this._resources.consume(h.n))&&this._resources.consumeAsync(d._).then(function(e){e.invalidateItems(n)});if(e.tags)for(var r=0,i=e.tags;r<i.length;r++){var o=i[r];this._store.invalidateLocation(o.tag)}};e.prototype._invalidateAllTags=function(){var e=this._photoProvider,t=this._tagProvider;if(e&&t){var n=e.getAllPhotosSettings().peek();t.invalidateAllTags(n.rootId)}};e.prototype._performOperation=function(e,t,n,i){var s=this;t.update([n]);return i().then(function(r){for(var i=0,o=e;i<o.length;i++){var u=o[i];s._itemProvider.invalidateItem(u)}t.update([n.succeed(r)])},function(e){var i=new Error(e);t.update([n.fail(i)]);return r.n.wrapError(i)})};e.dependencies={itemDataSource:d.H,deleteRestoreDataSource:d.u,itemProvider:l.resourceKey,itemsStore:a.t,itemTaskObserverType:u.r,photoProvider:v.p.optional,tagProvider:v.T.optional,updateQuota:c.e,isItemsScopeEnabled:h.h,resources:f.o};return e})(),y=Object(i.s)("FileSystemProvider_5",g)},2141:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(1416),s=n(1456),o=n(1541),u=n(1388),a=n(1746),f=n(1611),l=n(10),c=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._fileSystemProvider=n.fileSystemProvider;r._context=t;r.registerActions({undo:r._onUndo,deleteLocked:r._onDeleteLocked});return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input.item;n.name=r.name;n.iconName=r.iconName;n.type=2===t.input.type?u.e.restoreItems:u.e.deleteItems;n.payloads.deleteItems={item:r,parent:r.parent};n.payloads.restoreItems={item:r};this._context.allowUndo&&this._canUndoItem(r)&&0===t.input.type&&1===t.status&&n.actions.push(this._onUndo);2===t.status&&t.error&&9001===t.error.code&&n.actions.push(this._onDeleteLocked);return n};t.prototype.onStart=function(e){var t=this._context.deletionType===f.e.PermanantDelete?1:0,n=this._context.overrideLock,r=this._context.items.map(function(e){return new i.e(e.key,{item:e,type:t,isOverride:n})});e.update(r);return this._fileSystemProvider.deleteItems({items:this._context.items,deletionType:this._context.deletionType,overrideLock:n,parentKey:this._context.parentKey,emptyRecycleBin:this._context.emptyRecycleBin},h(e,t,n))};t.prototype._canUndoItem=function(e){return!e.isAlbum};t.prototype._onDeleteLocked=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:e.type,isOverride:!0}})});t.update(e);var n=e[0].input,r=n.type,i=n.isOverride;return this._fileSystemProvider.deleteItems({items:e.map(function(e){return e.input.item}),deletionType:this._context.deletionType,overrideLock:!0,parentKey:this._context.parentKey},h(t,r,i))};t.prototype._onUndo=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:2,isOverride:!1}})});t.update(e);var n=e[0].input,r=n.type,i=n.isOverride;return this._fileSystemProvider.restoreItems({items:e.map(function(e){return e.input.item}),parentKey:this._context.parentKey,retainAcls:!0},h(t,r,i))};t.dependencies=Object(r.__assign)(Object(r.__assign)({},o.n.dependencies),{fileSystemProvider:a.e});return t})(o.n);function h(e,t,n){return s.e.map(e,function(e){return e.changeInput(function(e){return{item:e,type:t,isOverride:n}})})}var p=Object(l.o)("DeleteItemsOperator_5",c)},2390:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(41),s=n(1611),o=n(14),u=n(1378),a=n(1224),f=n(1371),l=n(33),c=n(1376),h=n(1383),p=n(1433),d=n(2141),v=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.selectionHelper=t.selectionHelper;n.currentItem=t.currentItem;n.dialogProvider=n.resources.consume(h.e);return n}t.prototype.execute=function(e){var t=this;return this.currentItem?this.selectionHelper.resolveSelection().then(function(e){return e?t.executeDelete(e):t._getFailedQosData()}):o.n.wrap(this._getFailedQosData())};t.prototype.getDeleteExecutionInfo=function(e){return null};t.prototype.executeDelete=function(e){var t=this,n=this.getDeleteExecutionInfo(e);return(n.title?this._getConfirmationDialog(n):o.n.wrap()).then(function(){return t._executeDelete(e,n)})};t.prototype._getFailedQosData=function(){return{resultType:l.e.Failure,extraMetrics:{count:0}}};t.prototype._executeDelete=function(e,t){var n=this;this.selectionHelper.clearSelection();return this.resources.consumeAsync(d.e).then(function(r){var i=new r({items:e,deletionType:t.type,allowUndo:t.allowUndo,emptyRecycleBin:t.emptyRecycleBin,parentKey:n.currentItem.key});n.trackPromise(i.start());return i.wait()}).then(function(){var n={deletionType:s.e[t.type]},r={count:e.length};if(1===e.length){n.fileType=f.e[e[0].type];n.extension=e[0].extension||""}return{resultType:l.e.Success,extraData:n,extraMetrics:r}})};t.prototype._getConfirmationDialog=function(e){return this.dialogProvider.requestDialog({title:e.title,component:{name:p.e.tagName,params:{text:e.text}},actions:[{name:c.e.DeleteItem,execute:function(){return o.n.wrap(2)},isAvailable:this.observables.create(!0),icon:new u.e("Delete"),isDefault:!1},{name:c.e.cancelActionText,execute:function(){return o.n.wrap(3)},isAvailable:this.observables.create(!0),icon:new u.e("Cancel"),isDefault:!0}],focusOnPrimaryAction:!0}).wait()};return t})(a.default),m=n(25),g=n(87),y=n(1417),b=n(32),w=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(g.ge);n._pageContext=n.resources.consume(b.h);return n}t.prototype.getDeleteExecutionInfo=function(e){var t,n,r=this.currentItem.queryType,i=s.e.Recycle;if(this._urlDataSource.isRecycleBin(r)){n=this._getRecycleBinDialogTitle(r);t=this._getRecycleBinDialogText(e);i=this._getRecycleBinDeletionType(e)}else{var o=e&&1===e.length&&e[0].name;n=o?m.format(c.e.deleteConfirmTitleWithFileName,o):c.e.deleteConfirmTitle;t=c.e.deleteConfirmText}return{text:t,title:n,type:i,allowUndo:!1,emptyRecycleBin:!1}};t.prototype.executeDelete=function(t){return t&&1===t.length&&y.e.isCheckedOutByOther(t[0],this._pageContext.userId)?y.e.showCheckedOutByOtherDialog(this.dialogProvider):e.prototype.executeDelete.call(this,t)};t.prototype._getRecycleBinDialogTitle=function(e){return e===i.e.RecycleBin?c.e.deleteConfirmTitle:c.e.recycleBinDeleteConfirmTitle};t.prototype._getRecycleBinDialogText=function(e){return 1===e[0].recycleBinProperties.itemState?1===e.length?m.format(c.e.recycleBinSingleItemMoveToSecondStageConfirmText,e[0].name):c.e.recycleBinMultiItemsMoveToSecondStageConfirmText:1===e.length?m.format(c.e.recycleBinDeleteConfirmTextSingleSelection,e[0].name):c.e.recycleBinDeleteConfirmTextMultiSelection};t.prototype._getRecycleBinDeletionType=function(e){return 1===e[0].recycleBinProperties.itemState?s.e.MoveToSecondStage:s.e.PermanantDelete};return t})(v);t.default=w}}]);
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["111"],{1476:function(e,t,n){"use strict";n(2169);var r,i=n(14),s=n(82),o=n(33);(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(r||(r={}));var u=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};return e})();t.e=u},1488:function(e,t,n){"use strict";var r,i=n(0),s=(function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e})();(function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"})(r||(r={}));var o=(function(e){Object(i.__extends)(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return t})(Error),u=(function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var r=this._getCachedTokenData(e);if(r&&!this._isExpiring(r)){var i={token:r.accessToken,isGuest:!1,expirationTimeMs:r.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:r.correlationId,spRequestTimestamp:r.requestTimestamp})}return this._retriableFetchWithDigest(e,s.retries,t).then(function(t){n._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,u=this._context.qosMonitor(),a=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(f){if(200!==f.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+f.statusText);var l=new o(r.unknownError,{httpResponseStatus:f.status,message:f.statusText,correlationId:e._getCorrelationId(f)});if(400!==f.status){u.writeUnexpectedFailure("UnknownError",l);return Promise.reject(l)}return f.json().then(function(r){var o=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(o);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(o);u.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(f,u,a)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",s.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<s.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==s.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8");n.append("Odata-Version","4.0");n.append("Accept","application/json;odata.metadata=minimal");var r={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1));return new Request(i+s.apiUrl,r)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(r.malformedResponseBody,{httpResponseStatus:400,message:s.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;n=e.message.lang}return new o(r.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(r){n.writeSuccess();return{accessToken:r.access_token,expiresOn:Number(r.expires_on),notBefore:Number(r.not_before),resource:r.resource,tokenType:r.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){n.writeUnexpectedFailure("ResponseParseError",i);return Promise.reject(new o(r.malformedResponseBody,{httpResponseStatus:200,message:s.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e})(),a=n(570),f=n(14),l=n(92),c=n(82),h=n(33),p=(function(){function e(){this._qos=new c.e({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:h.e.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.ExpectedFailure,error:JSON.stringify(t)})};return e})(),d=(function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e})(),v=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{},{pageContext:t})||this;r.logger=new d;if(n){n.logger&&(r.logger=n.logger);n.useAbsoluteUrlForOAuth&&(r._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}r._oAuthUtility=new u(r);return r}t.prototype.qosMonitor=function(){return new p};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.n)(this._pageContext)},enumerable:!0,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new f.n(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t})(a.t);t.e=v},1539:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r,i=n(74),s=n(82),o=n(33),u=n(15);(function(e){e[e.Small=1]="Small";e[e.Medium=2]="Medium";e[e.Large=3]="Large"})(r||(r={}));var a="_eat_",f="_",l="UserPhotoAspx",c="/_layouts/15/userphoto.aspx",h="size",p="accountname",d={},v="TryGetAlternativeUrlFailure",m="_spPageContextInfo",g="_spHomePageContext";function y(e){var t=new i.t(e).getQueryParameter(a);if(t){var n=t.split(f),r=void 0;2===n.length&&(r=Number(n[0]));if(!r){new s.e({name:v}).end({resultType:o.e.Failure,resultCode:"EatParamUnexpectedFormat",extraData:{eatParam:t}});return!0}r-=30;if(Date.now()/1e3>r)return!1}return!0}function b(e,t){var n,r=(function(e){var t,n;function r(e){if(y(window[e].userPhotoCdnBaseUrl))return window[e].userPhotoCdnBaseUrl;delete window[e].userPhotoCdnBaseUrl;return""}try{var i=d&&d[e];i||l!==e||(!u.e.isActivated("d60cf3c2-b338-4e41-87b7-313950a747e1","06/25/2020","WEX Use userPhotoCdnBaseUrl from page context for CDN Rewrite")&&(null===(t=window[m])||void 0===t?void 0:t.userPhotoCdnBaseUrl)?i=r(m):!u.e.isActivated("d906af17-fd75-402b-b63c-dc6ca621dd89","07/02/2020","WEX Use userPhotoCdnBaseUrl from SPHome page context for CDN Rewrite")&&(null===(n=window[g])||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(i=r(g)));if(!i)return;if(!y(i)){delete d[e];return}return i}catch(e){new s.e({name:v}).end({resultType:o.e.Failure,resultCode:"Unexpected",extraData:{error:e}})}})(l)||c;switch(t){case 2:n="M";break;case 3:n="L";break;default:n="S"}var a=new i.t(r);a.setQueryParameter(h,n);a.setQueryParameter(p,e||"");return a.toString()}},1590:function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(122);Object(s.n)([{rawString:".sp-livePersonaCardAdapter-root{display:inline-block}\n"}]);var o=n(1807),u=n(82),a=n(33),f=n(1476),l=n(570),c=n(1488),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"LokiDataSource"},{pageContext:t})||this;n._oAuthTokenProvider=new f.e(null,{oAuthTokenDataSource:new c.e(t)});return n}t.prototype.getRegion=function(){var e=new u.e({name:"LivePersonaCard.GetLokiRegion"});try{var n=this._pageContext.farmLabel;if(!n){e.end({resultType:a.e.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"});return""}var r=n.split("_")[0].toLowerCase();return t.FARMLABEL_TO_REGION_MAPPING[r]}catch(t){e.end({resultType:a.e.Failure,resultCode:"LokiGetRegionError",error:t});return""}};t.prototype.getAuthTokenGetter=function(e){void 0===e&&(e="");return this.getAadAuthTokenGetter()};t.prototype.getAadAuthTokenGetter=function(){var e=this,t=this._pageContext.CorrelationId,n="https://loki.delve.office.com/";p(this._pageContext)&&(n="https://loki.delve.office.de/");return function(r,i){e._oAuthTokenProvider.getInstrumentedToken(n).then(function(e){return r(e.tokenInfo.token,e.spRequestId)}).catch(function(e){var n={httpStatusCode:e.httpResponseStatus,serverErrorCode:e.serverErrorCode,requestCorrelationId:e.correlationId,type:e.type};i(JSON.stringify(n),t)})}};t.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"};return t})(l.t);function p(e){return e.env&&"blackforest"===e.env.toLowerCase()||e.farmLabel&&0===e.farmLabel.toLowerCase().indexOf("deu_")}var d,v=n(1752),m=n(860),g=n(40),y=n(145);(function(e){e[e.SmtpAddress=0]="SmtpAddress";e[e.ExternalDirectoryObjectId=1]="ExternalDirectoryObjectId"})(d||(d={}));var b=function(e){e};n.d(t,"e",function(){return w});var w=(function(e){Object(r.__extends)(t,e);function t(n,r){var i=e.call(this,n,r)||this;i.makeAdapterConfig=function(){var e=i.props.lpcCallbacks||{};i.props.addGroupMembersCallback&&(e.addGroupMembers=i.props.addGroupMembersCallback);return{pageContext:i.props.pageContext,actionCallBacks:e,dataCallBacks:i.props.lpcCallbacks}};i.state={isReady:!1};t.ensureInitializeLPC(i.makeAdapterConfig()).then(function(){i.setState({isReady:!0})});return i}t.prototype.render=function(){var e=this;if(t.LivePersonaCardHoverTargetV2&&!this.props.lpcHoverTargetProps){var n=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),{cardParameters:Object(r.__assign)({personaInfo:{identifiers:{Smtp:this.props.email,Upn:this.props.upn||("User"===this.props.personaType?this.props.email:void 0),PersonaType:this.props.personaType,LocationId:this.props.locationId},displayName:this.props.displayName,personaCoinColor:Object(v.e)({text:this.props.displayName})},behavior:Object(r.__assign)(Object(r.__assign)({},this.props.lpcCardBehavior),{onCardOpen:function(){e.props.loggingData&&y.e.logData(e.props.loggingData);e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardOpen&&e.props.lpcCardBehavior.onCardOpen()}}),externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel})}),this.props.lpcHoverTargetV2Props);return i.createElement(t.LivePersonaCardHoverTargetV2,Object(r.__assign)({},n),this.props.children)}if(t.LivePersonaCardHoverTarget){n=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({upn:this.props.email,hostAppPersonaInfo:{PersonaType:this.props.personaType,LocationId:this.props.locationId},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel}),this.props.lpcHoverTargetProps),{onCardOpen:function(){e.props.loggingData&&y.e.logData(e.props.loggingData);e.props.lpcHoverTargetProps&&e.props.lpcHoverTargetProps.onCardOpen&&e.props.lpcHoverTargetProps.onCardOpen()}});return i.createElement(t.LivePersonaCardHoverTarget,Object(r.__assign)({},n),this.props.children)}return i.createElement("div",{className:"sp-livePersonaCardAdapter-root"},this.props.children)};t.ensureInitializeLPC=function(e){var n=e.pageContext;if(!n.isSPO)return Promise.reject("LPC is not supported on-prem.");if(n.isExternalGuestUser||n.isAnonymousGuestUser)return Promise.reject("LPC is not enabled for guest users.");if(!g.n.isFeatureEnabled({ODB:809,ODC:null,Fallback:!1}))return Promise.reject("The global LPC flight is off for this configuration.");if(!Boolean(Number(n.farmSettings.ExternalService_islivepersonacardenabled)))return Promise.reject("LPC is disabled in this environment via SpoServiceConfig.");if(window.LPC&&window.LPC.getRenderer){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2;e.callback&&e.callback();return Promise.resolve()}var r=new h(e.pageContext),i="Prod";if(e.pageContext){p(e.pageContext)&&(i="Blackforest");(function(e){var t=e.farmLabel&&e.farmLabel.toLowerCase()||"";return 0===t.indexOf("us_2_")||0===t.indexOf("us_86_")||0===t.indexOf("us_96_")})(e.pageContext)&&(i="GccModerate")}var s=r.getAadAuthTokenGetter(),u={culture:e.pageContext.currentUICultureName,region:r.getRegion(),clientType:e.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:e.pageContext.CorrelationId,logMessage:t._logResult,getAuthToken:s,actionCallbacks:e.actionCallBacks,dataCallbacks:e.dataCallBacks,complianceEnvironment:i,isConsumer:!1,dataUpdateBroadcaster:{setGroupMembersUpdateListener:b}};return Object(o.initializeLivePersonaCardAsync)(u).then(function(){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2;e.callback&&e.callback();e.onSuccess&&e.onSuccess()}).catch(function(t){0;e.onFailure&&e.onFailure(t)})};t.LivePersonaCardHoverTarget=void 0;t.LivePersonaCardHoverTargetV2=void 0;t._logResult=function(e,t,n){0};return t})(m.e)},1627:function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r,i,s;(function(e){e[e.tiny=0]="tiny";e[e.extraExtraSmall=1]="extraExtraSmall";e[e.extraSmall=2]="extraSmall";e[e.small=3]="small";e[e.regular=4]="regular";e[e.large=5]="large";e[e.extraLarge=6]="extraLarge";e[e.size8=17]="size8";e[e.size10=9]="size10";e[e.size16=8]="size16";e[e.size24=10]="size24";e[e.size28=7]="size28";e[e.size32=11]="size32";e[e.size40=12]="size40";e[e.size48=13]="size48";e[e.size56=16]="size56";e[e.size72=14]="size72";e[e.size100=15]="size100";e[e.size120=18]="size120"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.offline=1]="offline";e[e.online=2]="online";e[e.away=3]="away";e[e.dnd=4]="dnd";e[e.blocked=5]="blocked";e[e.busy=6]="busy"})(i||(i={}));(function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed";e[e.transparent=15]="transparent";e[e.violet=16]="violet";e[e.lightRed=17]="lightRed";e[e.gold=18]="gold";e[e.burgundy=19]="burgundy";e[e.warmGray=20]="warmGray";e[e.coolGray=21]="coolGray";e[e.gray=22]="gray";e[e.cyan=23]="cyan";e[e.rust=24]="rust"})(s||(s={}))},1678:function(e,t,n){"use strict";n.r(t);n.d(t,"SpLivePersonaCard",function(){return f});var r=n(0),i=n(1),s=n(860),o=n(1539),u=n(15),a=n(1590),f=(function(e){Object(r.__extends)(t,e);function t(n,r){var i=e.call(this,n,r)||this;i.state={lpcCallbacks:t.makeSpLpcCallbacks(void 0,i.props.pageContext)};return i}t.prototype.render=function(){return i.createElement(a.e,{personaType:this.props.personaType,email:this.props.identifier,locationId:this.props.locationId,pageContext:this.props.pageContext,dataAutomationId:this.props.dataAutomationId,lpcCallbacks:this.state.lpcCallbacks,lpcHoverTargetProps:this.props.lpcHoverTargetProps,loggingData:this.props.loggingData,lpcCardBehavior:this.props.lpcCardBehavior,lpcHoverTargetV2Props:this.props.lpcHoverTargetV2Props,ariaLabel:this.props.ariaLabel,tabIndex:this.props.tabIndex},this.props.children)};t.makeSpLpcCallbacks=function(e,t){return{getAndPrefetchPersonaImageUri:function(e,t){"User"===e.PersonaType&&e.Smtp?t(u.e.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN")?"/_layouts/15/userphoto.aspx?size=L&accountname="+e.Smtp:Object(o.e)(e.Smtp,3)):t()},addGroupMembers:e}};return t})(s.e)},1752:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(1627),i=[r.e.lightBlue,r.e.blue,r.e.darkBlue,r.e.teal,r.e.green,r.e.darkGreen,r.e.lightPink,r.e.pink,r.e.magenta,r.e.purple,r.e.orange,r.e.lightRed,r.e.darkRed,r.e.violet,r.e.gold,r.e.burgundy,r.e.warmGray,r.e.cyan,r.e.rust,r.e.coolGray],s=i.length;function o(e){var t=e.primaryText,n=e.text,o=e.initialsColor;return"string"==typeof o?o:(function(e){switch(e){case r.e.lightBlue:return"#4F6BED";case r.e.blue:return"#0078D4";case r.e.darkBlue:return"#004E8C";case r.e.teal:return"#038387";case r.e.lightGreen:case r.e.green:return"#498205";case r.e.darkGreen:return"#0B6A0B";case r.e.lightPink:return"#C239B3";case r.e.pink:return"#E3008C";case r.e.magenta:return"#881798";case r.e.purple:return"#5C2E91";case r.e.orange:return"#CA5010";case r.e.red:return"#EE1111";case r.e.lightRed:return"#D13438";case r.e.darkRed:return"#A4262C";case r.e.transparent:return"transparent";case r.e.violet:return"#8764B8";case r.e.gold:return"#986F0B";case r.e.burgundy:return"#750B1C";case r.e.warmGray:return"#7A7574";case r.e.cyan:return"#005B70";case r.e.rust:return"#8E562E";case r.e.coolGray:return"#69797E";case r.e.black:return"#1D1D1D";case r.e.gray:return"#393939"}})(o=void 0!==o?o:(function(e){var t=r.e.blue;if(!e)return t;for(var n=0,o=e.length-1;o>=0;o--){var u=e.charCodeAt(o),a=o%8;n^=(u<<a)+(u>>8-a)}return t=i[n%s]})(n||t))}},1807:function(e,t,n){var r;void 0!==(r=function(){return(function(e){function t(t){for(var n,i,s=t[0],o=t[1],u=0,f=[];u<s.length;u++)i=s[u],r[i]&&f.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(a&&a(t);f.length;)f.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise(function(t,i){n=r[e]=[t,i]});t.push(n[2]=s);var o,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=(function(e){return i.p+""+({1:"vendors~aria-webjs-sdk"}[e]||e)+"_"+{1:"719a99c981d8afec1ebf"}[e]+".js"})(e),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous"),o=function(t){u.onerror=u.onload=null,clearTimeout(a);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+i+": "+s+")");o.type=i,o.request=s,n[1](o)}r[e]=void 0}};var a=setTimeout(function(){o({type:"timeout",target:u})},12e4);u.onerror=u.onload=o,document.head.appendChild(u)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://lpcres.delve.office.com/lpc/versionless/",i.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp_msfast_lpc_bootstrapper_dist_odsp_livepersonacardbootstrapper=window.webpackJsonp_msfast_lpc_bootstrapper_dist_odsp_livepersonacardbootstrapper||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var a=o;return i(i.s=0)})([function(e,t,n){"use strict";n.r(t);var r,i=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},s=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}},o=(function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.getOrCreate=function(t){return r||(r=new e(t)),r},e.prototype.logEventAsync=function(e,t){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return i(this,void 0,void 0,function(){var n;return s(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return i(this,void 0,void 0,function(){var t,n,r;return s(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,4]:[4,this.getLogManagerAsync()];case 1:return n=i.sent(),r=void 0,"Blackforest"!==this.bootstrapperConfig.complianceEnvironment?[3,3]:[4,this.getCollectorUrlGermanyAsync()];case 2:r=i.sent(),i.label=3;case 3:(t=n.initialize(e,{collectorUri:r}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20190419.4.0"),i.label=4;case 4:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,n.e(1).then(n.t.bind(null,30,7))];case 1:return[2,e.sent().AWTLogManager]}})})},e.prototype.getCollectorUrlGermanyAsync=function(){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,n.e(1).then(n.t.bind(null,30,7))];case 1:return[2,e.sent().AWT_COLLECTOR_URL_GERMANY]}})})},e.prototype.noOp=function(){},e})(),u=function(e,t,n,r,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.statusCode=r,this.numberOfRetries=i};function a(e,t){try{sessionStorage&&sessionStorage.setItem&&sessionStorage.setItem(e,t)}catch(e){}}var f="LokiAuthToken";function l(e,t){return new Promise(function(n,r){e?(a(f,e),n(e)):t(function(e,t){e?(a(f,e),n(e)):r(new u("GetAuthTokenError","Auth token is undefined",t))},function(e,t){r(new u("GetAuthTokenError",e,t))})})}var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function h(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===t?"":window.decodeURIComponent(t[1].replace(/\+/g," "))}var p=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},d=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}},v="https://{0}.loki.delve.office.com/api/v1/configuration/{1}/{2}",m="https://loki.delve.office.de/api/v1/configuration/{0}/{1}",g="https://loki.delve-gcc.office.com/api/v1/configuration/{0}/{1}",y="https://loki.delve.office.com/api/v1/configuration/{0}/{1}",b=6e4,w="LivePersonaCardVersionOverride",E="LivePersonaCardCultureOverride",S="MidgardVersion",x="MidgardBranch",T=2,N=0;function C(e,t){return p(this,void 0,void 0,function(){var n,r;return d(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,8]),[4,k(e,t)];case 1:return n=i.sent(),[3,8];case 2:return(r=i.sent()).statusCode&&401===r.statusCode?[4,l(void 0,t.getAuthToken)]:[3,4];case 3:e=i.sent(),i.label=4;case 4:return N<T?(N++,[4,C(e,t)]):[3,6];case 5:return n=i.sent(),[3,7];case 6:throw r.numberOfRetries=N,r;case 7:return[3,8];case 8:return[2,n]}})})}function k(e,t){return new Promise(function(n,r){var i=new XMLHttpRequest,s=(function(e){var t=h(E)||e.culture;return"ppe"===e.region||"df"===e.region||"msit"===e.region?v.replace("{0}",e.region).replace("{1}",e.clientType).replace("{2}",t):"Blackforest"===e.complianceEnvironment?m.replace("{0}",e.clientType).replace("{1}",t):"GccModerate"===e.complianceEnvironment?g.replace("{0}",e.clientType).replace("{1}",t):y.replace("{0}",e.clientType).replace("{1}",t)})(t);i.open("GET",s,!0),i.setRequestHeader("authToken",e),i.setRequestHeader("Accept","application/json");var o=c.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});i.setRequestHeader("X-RootCorrelationId",o),i.setRequestHeader("X-CorrelationId",o),i.setRequestHeader("X-ClientCorrelationId",t.clientCorrelationId),i.setRequestHeader("X-ClientType",t.clientType);var a=h(S)||h(w);a&&i.setRequestHeader(w,a);var f=h(x);f&&i.setRequestHeader(x,f),i.addEventListener("load",function(){if(200===i.status)try{var e=JSON.parse(i.response);e.RootCorrelationId=o,e.LokiVersion=i.getResponseHeader("x-serverversion")||"",n(e)}catch(e){r(new u("GetLokiConfigError","Failed to parse initialization config.",o))}else r(new u("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+i.status,o,i.status))}),i.addEventListener("error",function(){r(new u("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",o))}),i.addEventListener("timeout",function(){r(new u("GetLokiConfigError","Loki config request timed out after "+b+" ms.",o))}),i.timeout=b,i.send()})}var L=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},A=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}},O=2,M=0;function _(e){return L(this,void 0,void 0,function(){var t;return A(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,6]),[4,D(e)];case 1:return n.sent(),[3,6];case 2:return t=n.sent(),M<O?(M++,[4,_(e)]):[3,4];case 3:return n.sent(),[3,5];case 4:throw t.numberOfRetries=M,t;case 5:return[3,6];case 6:return[2]}})})}function D(e){return new Promise(function(t,n){var r=document.createElement("script");r.type="text/javascript",r.crossOrigin="anonymous",r.src=e,r.addEventListener("load",function(){t()}),r.addEventListener("error",function(){n(new u("LoadScriptError","Unexpected error while loading script on page."))}),document.body.appendChild(r)})}var P="livepersonacard_full",H="livepersonacard_global",B="livepersonacardstrings",j="officefeed_feed",F="officefeedstrings";function I(e,t){return new Promise(function(n,r){setTimeout(function(){try{window.LPC||r(new u("StartLivePersonaCardError","window.LPC is undefined.")),window.LivePersonaCardStrings&&window.LivePersonaCardStrings.strings||r(new u("StartLivePersonaCardError","window.LivePersonaCardStrings is undefined."));var i=(function(e,t){return{refreshAuthToken:q(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:window.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{isLinkedInIntegrationEnabled:!1,hideDocumentFilter:!1},lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}})(e,t);window.LPC.start(i),n()}catch(e){r(new u("StartLivePersonaCardError",e.name+" "+e.message))}},0)})}function q(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n)},function(e,n){t("",e,n)})}}var R,U=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},z=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}};function W(e,t){return U(this,void 0,void 0,function(){var n;return z(this,function(r){switch(r.label){case 0:return[4,(0,new Promise(function(e){return window.setTimeout(e,0)}))];case 1:r.sent();try{if(!window.OfficeFeed)throw new u("StartOfficeFeedError","window.OfficeFeed is undefined.");if(!window.OfficeFeedStrings||!window.OfficeFeedStrings.strings)throw new u("StartOfficeFeedError","window.OfficeFeedStrings is undefined.");return n=(function(e,t){return{accountUpn:e.Upn,getLokiToken:X(t),options:t.options,hostAppActions:t.hostAppActions,strings:window.OfficeFeedStrings.strings}})(e,t),[2,window.OfficeFeed.start(n)]}catch(e){throw new u("StartOfficeFeedError",e.name+" "+e.message)}return[2]}})})}function X(e){return function(t){return new Promise(function(t,n){e.getAuthToken(function(e,n){t(e)},function(e,t){n("Error getting auth token: "+e+" (authRequestCorrelationId: "+t+")")})})}}!(function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration"})(R||(R={}));var V=(function(){function e(){this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{window.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{window.performance.mark(e+"-end"),window.performance.measure(e,e+"-start",e+"-end");var t=window.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=window.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return window.performance&&"function"==typeof window.performance.now?performance.now():Date.now()},e})();function $(e){return void 0===e||"string"!=typeof e||""===e||null===e}function J(e){return void 0===e||"function"!=typeof e}var K=["msit","df","ppe"],Q=["Prod","Blackforest","GccModerate"];function G(e){var t="";if(e){var n=[];$(e.culture)&&n.push("culture"),$(e.clientType)&&n.push("clientType"),$(e.clientContextType)&&n.push("clientContextType"),$(e.clientCorrelationId)&&n.push("clientCorrelationId"),J(e.logMessage)&&n.push("logMessage"),J(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===K.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+K.join(", ")+" for pre-production environments. "),-1===Q.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+Q.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new u("ValidateBootstrapperConfigError",t)}n.d(t,"initializeLivePersonaCardAsync",function(){return oe}),n.d(t,"initializeOfficeFeedAsync",function(){return ae}),n.d(t,"fetchLokiConfigAsync",function(){return fe});var Y,Z,ee=function(){return(ee=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},te=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},ne=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}},re=!1,ie=3e5,se="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257";function oe(e){return te(this,void 0,void 0,function(){var t,n,r=this;return ne(this,function(i){return!re&&Y?[2,Y]:(t=new V,n=o.getOrCreate(e),re=!1,(Y=new Promise(function(i,s){return te(r,void 0,void 0,function(){var r,o,u,a,f;return ne(this,function(c){switch(c.label){case 0:return c.trys.push([0,9,,10]),G(e),t.startCustomTiming(R.getAuthToken),[4,l(e.authToken,e.getAuthToken)];case 1:return r=c.sent(),t.endCustomTiming(R.getAuthToken),t.measureFromStart(R.getAuthTokenFromStart),t.startCustomTiming(R.getLokiConfig),[4,C(r,e)];case 2:return o=c.sent(),t.endCustomTiming(R.getLokiConfig),t.measureFromStart(R.getLokiConfigFromStart),t.startCustomTiming(R.getLpcBundles),e.scriptsInsertedByHostPromise?[4,e.scriptsInsertedByHostPromise]:[3,4];case 3:return c.sent(),[3,6];case 4:return[4,(h=o,d=h.Resources[B],p="OwaPeopleHub"===h.Workload?h.Resources[H]:h.Resources[P],Promise.all([_(d),_(p)]))];case 5:c.sent(),c.label=6;case 6:return t.endCustomTiming(R.getLpcBundles),t.measureFromStart(R.getLpcBundlesFromStart),t.startCustomTiming(R.startLpc),[4,I(o,e)];case 7:return c.sent(),t.endCustomTiming(R.startLpc),t.measureFromStart(R.startLpcFromStart),[4,n.updateContextWithLokiDataAsync(o,se).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 8:return c.sent(),(u=le(t.getAllTimings())).RootCorrelationId=o.RootCorrelationId,u.isConsumer=e.isConsumer,n.logEventAsync({name:"initializeLivePersonaCard_success",properties:u},se),i(),[3,10];case 9:return a=c.sent(),f=le(t.getAllTimings()),n.logEventAsync({name:"initializeLivePersonaCard_failure",properties:ee({},ce(a),f,{isConsumer:e.isConsumer})},se),s("Failed to initialize Live Persona Card: "+a.name+" "+a.message),[3,10];case 10:return[2]}var h,p,d})})})).catch(function(){setTimeout(function(){re=!0},ie)}),[2,Y])})})}var ue=!1;function ae(e){return te(this,void 0,void 0,function(){var t,n,r=this;return ne(this,function(i){return!ue&&Z?[2,Z]:(t=new V,n=o.getOrCreate(e),ue=!1,(Z=new Promise(function(i,s){return te(r,void 0,void 0,function(){var r,o,u,a,f,c;return ne(this,function(h){switch(h.label){case 0:return h.trys.push([0,6,,7]),G(e),[4,l(e.authToken,e.getAuthToken)];case 1:return r=h.sent(),t.measureFromStart(R.getAuthTokenFromStart),[4,C(r,e)];case 2:return o=h.sent(),t.measureFromStart(R.getLokiConfigFromStart),[4,(p=o,d=p.Resources[F],v=p.Resources[j],Promise.all([_(d),_(v)]))];case 3:return h.sent(),t.measureFromStart(R.getOfficeFeedBundles),[4,W(o,e)];case 4:return u=h.sent(),[4,n.updateContextWithLokiDataAsync(o,se).catch(function(){console.log("Office Feed ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 5:return h.sent(),(a=le(t.getAllTimings())).RootCorrelationId=o.RootCorrelationId,n.logEventAsync({name:"initializeOfficeFeed_success",properties:a},se),i(u),[3,7];case 6:return f=h.sent(),c=le(t.getAllTimings()),n.logEventAsync({name:"initializeOfficeFeed_failure",properties:ee({},ce(f),c)},se),s("Failed to initialize Office Feed: "+f.name),[3,7];case 7:return[2]}var p,d,v})})})).catch(function(){setTimeout(function(){ue=!0},ie)}),[2,Z])})})}function fe(e){return te(this,void 0,void 0,function(){return ne(this,function(t){switch(t.label){case 0:return[4,l(e.authToken,e.getAuthToken)];case 1:return[2,C(t.sent(),e)]}})})}function le(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}function ce(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}}])}.apply(t,[]))&&(e.exports=r)},2169:function(e,t){(function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&(function(){try{new Blob;return!0}catch(e){return!1}})(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};l.prototype.append=function(e,t){e=u(e);t=a(t);var n=this.map[e];this.map[e]=n?n+","+t:t};l.prototype.delete=function(e){delete this.map[u(e)]};l.prototype.get=function(e){e=u(e);return this.has(e)?this.map[e]:null};l.prototype.has=function(e){return this.map.hasOwnProperty(u(e))};l.prototype.set=function(e,t){this.map[u(e)]=a(t)};l.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)};l.prototype.keys=function(){var e=[];this.forEach(function(t,n){e.push(n)});return f(e)};l.prototype.values=function(){var e=[];this.forEach(function(t){e.push(t)});return f(e)};l.prototype.entries=function(){var e=[];this.forEach(function(t,n){e.push([n,t])});return f(e)};t.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var s=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};v.call(m.prototype);v.call(b.prototype);b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})};b.error=function(){var e=new b(null,{status:0,statusText:""});e.type="error";return e};var o=[301,302,303,307,308];b.redirect=function(e,t){if(-1===o.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})};e.Headers=l;e.Request=m;e.Response=b;e.fetch=function(e,n){return new Promise(function(r,i){var s=new m(e,n),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:y(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;r(new b(t,e))};o.onerror=function(){i(new TypeError("Network request failed"))};o.ontimeout=function(){i(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);"include"===s.credentials&&(o.withCredentials=!0);"responseType"in o&&t.blob&&(o.responseType="blob");s.headers.forEach(function(e,t){o.setRequestHeader(t,e)});o.send(void 0===s._bodyInit?null:s._bodyInit)})};e.fetch.polyfill=!0}function u(e){"string"!=typeof e&&(e=String(e));if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function a(e){"string"!=typeof e&&(e=String(e));return e}function f(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};t.iterable&&(n[Symbol.iterator]=function(){return n});return n}function l(e){this.map={};e instanceof l?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function c(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise(function(t,n){e.onload=function(){t(e.result)};e.onerror=function(){n(e.error)}})}function p(e){var t=new FileReader,n=h(t);t.readAsArrayBuffer(e);return n}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e));return t.buffer}function v(){this.bodyUsed=!1;this._initBody=function(e){this._bodyInit=e;if(e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e)){this._bodyArrayBuffer=d(e.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};if(t.blob){this.blob=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))};this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}}this.text=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return(function(e){var t=new FileReader,n=h(t);t.readAsText(e);return n})(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve((function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")})(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)};t.formData&&(this.formData=function(){return this.text().then(g)});this.json=function(){return this.text().then(JSON.parse)};return this}function m(e,t){var n,r,i=(t=t||{}).body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url;this.credentials=e.credentials;t.headers||(this.headers=new l(e.headers));this.method=e.method;this.mode=e.mode;if(!i&&null!=e._bodyInit){i=e._bodyInit;e.bodyUsed=!0}}else this.url=String(e);this.credentials=t.credentials||this.credentials||"omit";!t.headers&&this.headers||(this.headers=new l(t.headers));this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),s.indexOf(r)>-1?r:n);this.mode=t.mode||this.mode||null;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function g(e){var t=new FormData;e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}});return t}function y(e){var t=new l;e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}});return t}function b(e,t){t||(t={});this.type="default";this.status="status"in t?t.status:200;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in t?t.statusText:"OK";this.headers=new l(t.headers);this.url=t.url||"";this._initBody(e)}})("undefined"!=typeof self?self:this)}}]);
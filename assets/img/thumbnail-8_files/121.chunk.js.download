(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["121"],{1265:function(e,t,n){"use strict";n.r(t);var r=n(122);Object(r.n)([{rawString:".OneUp{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;outline:0;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.OneUp.OneUp--darkBackground{background-color:#1b1a19}.OneUp-detailsBar{visibility:hidden;opacity:0}.OneUp-detailsBar .CommandBarItem{flex:0 0 auto}html[dir=ltr] .OneUp-detailsBar .CommandBarItem{margin-right:0}html[dir=rtl] .OneUp-detailsBar .CommandBarItem{margin-left:0}.OneUp-detailsBar .CommandBarItem .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-detailsBar .CommandBarItem.is-toggled,.OneUp-detailsBar .CommandBarItem.is-toggled:hover,.OneUp-detailsBar .CommandBarItem:hover{background-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.OneUp-toolbarHost{display:flex;flex-flow:column-reverse nowrap;justify-content:center;align-items:center}.OneUp-toolbar{background-color:rgba(0,0,0,.7);color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:44px;display:flex;align-items:stretch;justify-content:center;flex-flow:row nowrap}.lg .OneUp-toolbar,.xlg .OneUp-toolbar,.xxlg .OneUp-toolbar,.xxxlg .OneUp-toolbar,.xxxxlg .OneUp-toolbar{height:40px}.OneUp-commandBar{position:absolute;left:0;right:0;top:-44px;z-index:2;visibility:hidden;height:44px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";transition:visibility 267ms linear,top 267ms linear}.isFluent .OneUp-commandBar{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.lg .OneUp-commandBar,.xlg .OneUp-commandBar,.xxlg .OneUp-commandBar,.xxxlg .OneUp-commandBar,.xxxxlg .OneUp-commandBar{height:40px;top:-40px}:not(.od-fluentCustomizationDisabled).isFluent.lg .OneUp-commandBar{top:-44px;height:44px}:not(.od-fluentCustomizationDisabled).isFluent.xlg .OneUp-commandBar{top:-44px;height:44px}:not(.od-fluentCustomizationDisabled).isFluent.xxlg .OneUp-commandBar{top:-44px;height:44px}:not(.od-fluentCustomizationDisabled).isFluent.xxxlg .OneUp-commandBar{top:-44px;height:44px}:not(.od-fluentCustomizationDisabled).isFluent.xxxxlg .OneUp-commandBar{top:-44px;height:44px}.OneUp-commandBar .CommandBarItem:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word{background-color:#2b579a;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .ms-Icon--WordLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel{background-color:#217346;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .ms-Icon--ExcelLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint{background-color:#d24726;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .ms-Icon--PowerPointLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF{background-color:#c90304;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .ms-Icon--PDF:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--Excel.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--Excel:hover,.OneUp-commandBar .CommandBarItem.od-Command--PDF.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--PDF.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--PDF:hover,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint:hover,.OneUp-commandBar .CommandBarItem.od-Command--Word.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--Word.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--Word:hover{background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .ms-CommandBar{padding:0}.sm .OneUp-commandBar{top:-44px;height:44px}.CommandBar-center{text-align:center}.OneUp-accessibleItemAnnouncement{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.OneUp-content{position:absolute;left:0;top:0;bottom:0;right:0;transition:top 267ms linear,left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.OneUp-carousel{position:absolute;left:0;right:0;top:0;bottom:0;z-index:1;transition:top 267ms linear}.sm .OneUp--hasCommandBar .OneUp-paneHost{top:44px}.isFluent .OneUp--hasCommandBar .ms-Button--commandBar .ms-Button-menuIcon{background-color:inherit}.OneUp--hasCommandBar .OneUp-content,.OneUp--hasCommandBar .OneUp-paneHost{top:44px}.lg .OneUp--hasCommandBar .OneUp-content,.lg .OneUp--hasCommandBar .OneUp-paneHost,.xlg .OneUp--hasCommandBar .OneUp-content,.xlg .OneUp--hasCommandBar .OneUp-paneHost,.xxlg .OneUp--hasCommandBar .OneUp-content,.xxlg .OneUp--hasCommandBar .OneUp-paneHost,.xxxlg .OneUp--hasCommandBar .OneUp-content,.xxxlg .OneUp--hasCommandBar .OneUp-paneHost,.xxxxlg .OneUp--hasCommandBar .OneUp-content,.xxxxlg .OneUp--hasCommandBar .OneUp-paneHost{top:40px}.OneUp--hasCommandBar .OneUp-commandBar{visibility:visible;top:0}:not(.od-fluentCustomizationDisabled).isFluent .OneUp--hasCommandBar .OneUp-commandBar{top:0}html[dir=ltr] .isFluent .OneUp--hasCommandBar .OneUp-commandBar{padding-left:16px}html[dir=rtl] .isFluent .OneUp--hasCommandBar .OneUp-commandBar{padding-right:16px}.OneUp-detailsBar{transition:visibility 0s linear 267ms,opacity 267ms linear,bottom 267ms linear;position:absolute;left:0;right:0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";z-index:1}[dir=ltr] .lg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .md .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxxlg .OneUp--hasInfoPane .OneUp-content{right:320px}[dir=rtl] .lg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .md .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxxlg .OneUp--hasInfoPane .OneUp-content{left:320px}[dir=ltr] .OneUp--hasInfoPane .OneUp-paneHost{right:0}[dir=rtl] .OneUp--hasInfoPane .OneUp-paneHost{left:0}.sm .OneUp--hasInfoPane .OneUp-infoPane,.sm .OneUp--hasInfoPane .OneUp-paneHost{width:100%}.OneUp--slideShowOn .OneUp-commandBar{visibility:hidden}.OneUp--slideShowOn .OneUp-content{top:0}.OneUp--awake .OneUp-detailsBar{visibility:inherit;opacity:1;transition-delay:0s,0s,0s}.OneUp--awake.OneUp--slideShowOn .OneUp-commandBar{visibility:inherit}.OneUp-caption-container{display:flex;align-items:center;justify-content:center;width:100%;background-color:rgba(255,255,255,.75)}.OneUp-caption{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";flex:1 1 auto;height:30px;border:0;padding:0;background:0 0;text-align:center;width:100%;max-width:600px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.OneUp-caption--editable{cursor:pointer}.OneUp-caption-clipper{display:table-cell;max-width:600px;height:30px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.lg .OneUp-caption-clipper{max-width:510px}.md .OneUp-caption-clipper{max-width:345px}.sm .OneUp-caption-clipper{max-width:150px}.OneUp-options{position:absolute;top:0;bottom:0;text-align:right}[dir=ltr] .OneUp-options{right:8px}[dir=rtl] .OneUp-options{left:8px}.OneUp-info{position:absolute;top:0;display:block;padding:20px 8px;height:40px}[dir=ltr] .OneUp-info{right:0}[dir=rtl] .OneUp-info{left:0}.OneUp-paneHost{position:absolute;width:320px;top:0;bottom:0;overflow:hidden;z-index:1}[dir=ltr] .OneUp-paneHost{right:-321px}[dir=rtl] .OneUp-paneHost{left:-321px}.OneUp-infoPane{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;top:0;bottom:0;right:0;width:320px}.od-userSelect--enabled .OneUp-infoPane{-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text}.OneUp .od-Panel,.OneUp .od-PanelOverlay{top:0}"}]);var i=n(0),s=n(1361),o=n(138),u=n(2158),a=n(1514),f=n(1376),l=n(62),c=n(849),h=n(1228),p=n(1423),d=n(32),v=n(502),m=n(1378),g=n(1565),y=n(1596),b=n(2154),w=n(1859),E=n(2043),S=n(14),x=n(33),T=n(1367),N=n(1377),C=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AccessibilityMode";r._accessibilityMode=t.accessibilityMode;r._itemSelectionHelper=new(r.child(N.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!!e.officeBundle&&e.appMap===g.c};t.prototype.onExecute=function(e,t){this._accessibilityMode(!this._accessibilityMode.peek());return S.n.resolve({resultType:x.e.Success})};return t})(T.e),k=(n(1714),["S"]),L=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources;n._actionMap=r.consume(o.e);n._selection=r.consume(o.C);var s=r.consume(d.h.optional),u=n.scope.attach(new(r.consume(b.e.local))({})),a=n.createPureComputed(n._computeOpenInOfficeOnlineText),g=n.createPureComputed(n._computeOpenInOfficeClientText),y=n.createPureComputed(n._computOpenInOfficeSuffixClass),S=n.createPureComputed(n._computeOfficeIcon),x=[new(n.managed(p.e))({text:a,renderLabel:2,icon:S,classSuffix:y,action:new(n.managed(n._actionMap.OpenInOfficeOnlineAction))}),new(n.managed(p.e))({text:g,renderLabel:2,icon:S,classSuffix:y,action:new(n.managed(n._actionMap.OpenInOfficeClientAction))})],T=[new(n.managed(p.e))({text:f.e.OpenInBrowser,renderLabel:2,icon:new m.e("PDF"),classSuffix:"PDF",action:new(n.managed(n._actionMap.OpenPdfInBrowserAction))}),new(n.managed(p.e))({text:f.e.OpenInTextEditor,renderLabel:2,icon:new m.e("Edit"),action:new(n.managed(n._actionMap.OpenInTextEditorAction))})],N=n.observables.createArray([]);n.createBackgroundComputed(function(){N.splice.apply(N,Object(i.__spreadArrays)([0,N.peek().length],x,u.openWithCommands(),T))});var L=n.createPureComputed(function(){for(var e={},t=0,n=N();t<n.length;t++){var r=n[t];if(r.isVisible()){var i=r.icon(),s=r.iconUrl();if(i&&"Page"!==i.toString()||s){e.icon=i;e.iconUrl=s;return e}}}e.icon=new m.e("Page");return e}),A=n.createPureComputed(function(){return L().icon}),O=n.createPureComputed(function(){return L().iconUrl}),M=s?Object(v.isFeatureEnabled)(v.ShareV3)?new(n.managed(w.t))({renderLabel:2,mode:0}).command:new(n.managed(p.e))({text:f.e.Share,tooltip:f.e.ShareCommandTooltipV3,renderLabel:2,icon:new m.e("Share"),action:Object(v.isFeatureEnabled)(v.UseNewSharingDialog)&&"21"===s.webTemplate?new(n.managed(n._actionMap.ShareByLinkAction))({sharingMethod:2}):new(n.managed(n._actionMap.ShareAction))({activeTab:1}),keys:k}):new(n.managed(p.e))({text:f.e.Share,renderLabel:2,icon:new m.e("Share"),action:new(n.managed(n._actionMap.ShareByLinkAction)),keys:k}),_=r.consume(E.e),D=r.consume(c.e),P=r.consume(h.resourceKey);n.commands(Object(i.__spreadArrays)([new(n.managed(p.e))({text:f.e.Open,icon:A,iconUrl:O,classSuffix:y,renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!1,location:3,children:N}),M,Object(v.isFeatureEnabled)(v.ShareV3)?new(n.managed(w.t))({renderLabel:2,mode:1}).command:new(n.managed(p.e))({text:f.e.GetLink,renderLabel:2,icon:new m.e("Link"),action:new(n.managed(n._actionMap.GetLinkAction))({useOldSharingDialog:s&&"21"!==s.webTemplate})}),new(n.managed(p.e))({text:f.e.print,renderLabel:2,icon:new m.e("Print"),keys:["CtrlP"],action:new(n.managed(n._actionMap.PrintPdfAction))}),new(n.managed(p.e))({text:f.e.addToSharedList,renderLabel:2,icon:new m.e("Add"),action:new(n.managed(n._actionMap.AddToSharedListAction))}),new(n.managed(p.e))({text:f.e.removeFromSharedList,renderLabel:2,icon:new m.e("Cancel"),action:new(n.managed(n._actionMap.RemoveFromSharedListAction))}),new(n.managed(p.e))({text:f.e.AddToAlbum,icon:new m.e("Photo2Add"),renderLabel:2,action:new(n.managed(n._actionMap.AddToAlbumAction))({})}),new(n.managed(p.e))({text:f.e.playSlideshow,icon:new m.e("Play"),renderLabel:2,action:new(n.managed(n._actionMap.PlaySlideShowAction))({})}),new(n.managed(p.e))({text:f.e.rotate,icon:new m.e("rotate"),renderLabel:2,action:new(n.managed(n._actionMap.RotateAction))({})}),new(n.managed(p.e))({text:f.e.applyOfficeLens,renderLabel:2,icon:new m.e("LightningBolt"),action:new(n.managed(n._actionMap.ApplyOfficeLensAction))}),new(n.managed(p.e))({text:f.e.removeOfficeLens,renderLabel:2,icon:new m.e("Undo"),action:new(n.managed(n._actionMap.RemoveOfficeLensAction))}),new(n.managed(p.e))({text:f.e.Download,icon:new m.e("Download"),renderLabel:2,action:new(n.managed(n._actionMap.DownloadAction))({}),automationId:"download"}),new(n.managed(p.e))({text:f.e.DeleteItem,icon:new m.e("Delete"),renderLabel:2,action:new(n.managed(n._actionMap.DeleteAction))({})}),new(n.managed(p.e))({text:f.e.viewOriginal,icon:new m.e("Picture"),renderLabel:2,action:new(n.managed(n._actionMap.ViewOriginalAction))({})}),new(n.managed(p.e))({text:f.e.viewInFolder,icon:new m.e("Folder"),action:new(n.managed(n._actionMap.ViewInFolderAction)),renderLabel:2}),new(n.managed(p.e))({text:f.e.OrderPrints,icon:new m.e("Print"),renderLabel:2,action:new(n.managed(n._actionMap.OrderPrintsAction))({})}),new(n.managed(p.e))({text:f.e.Embed,icon:new m.e("Embed"),renderLabel:2,action:new(n.managed(n._actionMap.EmbedAction))({})}),new(n.managed(p.e))({text:f.e.editTags,renderLabel:2,icon:new m.e("Tag"),keys:["T"],action:new(n.managed(n._actionMap.EditTagsAction))}),new(n.managed(p.e))({renderLabel:2,text:n.createPureComputed(function(){return _()?f.e.ViewMode:f.e.AccessibilityMode}),icon:n.createPureComputed(function(){return _()?new m.e("Page"):new m.e("EaseOfAccess")}),action:new(n.managed(C))({accessibilityMode:_})}),new(n.managed(p.e))({text:f.e.Copy,renderLabel:2,icon:new m.e("Copy"),automationId:"copy",action:new(n.managed(n._actionMap.LaunchMoveCopyPanelAction))({isMove:!1})}),new(n.managed(p.e))({text:l.e.ShowVersionHistory,renderLabel:2,icon:new m.e("StackIndicator"),action:new(n.managed(n._actionMap.ShowVersionHistoryAction))})],s&&s.allowInfectedDownload?[new(n.managed(p.e))({text:f.e.Download,renderLabel:2,icon:new m.e("Download"),action:new(n.managed(n._actionMap.ShowMalwareDetectedAction))({})})]:[],[u.actionsCommand,n.overflowHostCommand,new(n.managed(p.e))({tooltip:l.e.DetailsPane,icon:new m.e("Info"),location:12,action:new(n.managed(n._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:D,ariaExpanded:P,renderLabel:0,hasIconOnly:!0,keys:["I"],automationId:"showProperties"})]));return n}t.prototype._computeOpenInOfficeOnlineText=function(){return g.u(Object(y.e)(this._selection))||f.e.Open};t.prototype._computeOpenInOfficeClientText=function(){return g.a(Object(y.e)(this._selection))};t.prototype._computOpenInOfficeSuffixClass=function(){return g.i(Object(y.e)(this._selection))};t.prototype._computeOfficeIcon=function(){var e,t=Object(y.e)(this._selection);t&&(e=g.o(t));return e||new m.e("Page")};return t})(a.t),A=n(1362),O=n(2082),M=n(346),_=n(1936),D=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="Conditional";n.isQosLogged=!1;n._action=t.action;n._condition=t.condition;return n}t.prototype.onExecute=function(e,t){return this._action.execute(e)};t.prototype.onIsAvailable=function(){return this._condition()&&this._action.isAvailable()};return t})(T.e),P=n(2598),H=!n(18).e.isActivated("032F039F-DB6A-48D0-AB4A-8B26E231C862","7/23/2020","Refresh the page on previewer close for non-lightspeed"),B={ignoreHistory:!0,openRelation:1},j=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,B,n)||this;r.name="ClosePreviewer";return r}t.prototype.onExecute=function(t,n){if(Object(v.isFeatureEnabled)(v.RefreshOnPreviewClose)&&H){document.body.style.display="none";return e.prototype.onExecute.call(this,t,n).then(function(e){window.location.reload();return e})}return e.prototype.onExecute.call(this,t,n)};return t})(P.e),F=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._legend=t.legend;var r=n.createPureComputed(function(){return!t.canNavigate()}),i=n.createPureComputed(function(){return t.canNavigate()&&t.areFlippersPermanent()}),s=new(n.managed(D))({action:t.previous,condition:t.canNavigate}),o=new(n.managed(D))({action:t.next,condition:t.canNavigate});n.commands.push(new(n.managed(O.default))({renderLabel:2}).command,new(n.managed(p.e))({text:_.e.previousTooltip,icon:new m.e(M.e.isRightToLeft?"ChevronRight":"ChevronLeft"),renderLabel:2,location:12,isPermanent:i,isInvisibleWhenDisabled:!0,automationId:"previousButton",keys:[M.e.isRightToLeft?"Right":"Left"],action:s}),new(n.managed(p.e))({text:n._legend,location:12,automationId:"oneUpPageCount",isDisabled:A.observable(!0),isHidden:r}),new(n.managed(p.e))({text:_.e.nextTooltip,icon:new m.e(M.e.isRightToLeft?"ChevronLeft":"ChevronRight"),renderLabel:2,location:12,positionIconRight:!0,isPermanent:i,isInvisibleWhenDisabled:!0,automationId:"nextButton",keys:[M.e.isRightToLeft?"Left":"Right"],action:o}),new(n.managed(p.e))({icon:new m.e("Cancel"),text:f.e.Close,hasIconOnly:!0,renderLabel:0,action:new(n.managed(j)),automationId:"close",keys:["Esc"],location:12}));return n}return t})(a.t),I=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._actionMap=n.resources.consume(o.e);n.commands=A.observableArray([new(n.managed(p.e))({text:f.e.pauseSlideshow,renderLabel:2,icon:new m.e("Pause"),action:new(n.managed(n._actionMap.StopSlideShowAction))({})})]);return n}return t})(a.t),q=n(2099),R=n(1660),U=n(1929),z=n(1385),W=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._callback=r.callback;n._delay=r.delay||500;n.events.on(n.element,"click",n._onClick);return n}t.prototype._onClick=function(e){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}else this._timerID=this.async.setTimeout(this._onClickTimer,this._delay)};t.prototype._onClickTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return t})(n(1372).t),X=n(2430),V=n(2265),$=n(112),J=n(1482),K=n(2427),Q=n(25),G=n(2267),Y=n(1440),Z=n(2266),ee=n(1871),te=n(2039),ne=n(828),re=n(94),ie=n(1399),se=n(1796),oe=n(1747),ue=n(1749),ae=n(700),fe=Object(ae.e)({eventName:"OneUpCarousel,",shortEventName:"OneUpCarousel"},{initialFileType:1,initialFileExtension:1,initialFileSize:2,pagesViewed:2,totalPages:2,isFolderShownInSession:3}),le=n(1366),ce=n(2100),he=new(n(7).t)("deeplinkCommentId"),pe=n(2356),de=n(2268),ve=n(2150),me=n(2023),ge=n(95),ye=n(1755),be=n(1383),we=n(2269),Ee=n(2045),Se=n(1538),xe=n(2270),Te=n(283),Ne=n(87),Ce=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.overlayHostTagName=se.default.tagName;r.dialogHostTagName=oe.default.tagName;r.panelHostTagName=ue.default.tagName;r.carouselTagName=ve.e.tagName;r.oneUpSlideTagName=pe.e.tagName;r.addBindingHandlers({clientRect:R.e,keyboard:z.e,idle:V.e,throttledClick:W,control:le.n,childFocus:U.e,hideWhenInactive:ye.e,transclusionHost:X.e});r._carouselEvent=new fe;r._carouselEventData={initialFileType:"",initialFileExtension:"",initialFileSize:0,pagesViewed:0,totalPages:0,isFolderShownInSession:!1};var i=n.rateLimitExtenders,s=void 0===i?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:i;r._rateLimitExtenders=s;var a=r,f=a.observables,l=a.resources;r.slideLoadState=f.create(0);var p=n.toolbarProvider;r.agentHost={name:me.e.tagName,params:{provider:p}};r.showAgent=f.pureCompute(function(){return p.contexts().length>0});var d=n.paneProvider;r.paneHost={name:me.e.tagName,params:{provider:d,useCustomTemplate:!0}};l.bind(w.n);l.bind(w.e);l.expose(E.e,f.create(!1));l.bind(K.e);l.bind(J.e);l.bind(be.e);r.isSlideShowModeEnabled=f.create(!1);l.expose(o._,r);r.addCaptionLabel=f.create("");r.isRotating=f.create(!1);r.isIdle=f.create(!1);r._actionMap=n.actionMap;r._initializeItem({item:n.focusItem});var m=n.currentItemSet;r._initializeItemSet({itemSet:n.focusItemSet||m});r._parent=f.pureCompute(function(){return r._itemSet().item()});l.block(o.f);r._selectionModel=l.expose(o.C,new(r.managed(u.e))({indexResolver:n.indexResolver}));r.allocationRange=t.requiredRange;r.size=f.create({width:0,height:0});l.expose($.e.infoPane.hidePreview,f.create(!0));l.bind(c.e);var g=r.isInfoPaneExpanded=l.consume(h.resourceKey);r._focusedInfoPaneSection=n.focusedInfoPaneSection;r.showPane=f.pureCompute(function(){return g()||d.contexts().length>0});r.isCommandBarVisible=f.create(!0);r.oneUp={currentPriority:f.createCallback(de.e),isRotating:r.isRotating,isCommandBarVisible:r.isCommandBarVisible,isInfoPaneExpanded:g,enableSlideControls:f.create(!1),size:r.size,slide:f.create(),shareLinkId:t.shareLinkId};r.isPhotosOnly=r._exposeIfNeeded($.e.oneUpOverlay.isPhotosOnly,f.create(!1));r.isDarkBackgroundEnabled=f.pureCompute(function(){return r.isPhotosOnly()&&r._shouldUseDarkBackground(n.identityDataSource)});var y={deferEvaluation:!0};r.canNavigate=f.pureCompute(r._computeCanNavigate,y);r.accessibleItemAnnouncementText=f.pureCompute(r._computeAccessibleItemAnnouncementText);r.caption=f.pureCompute(r._computeCaption,y);r.showEditCaption=f.pureCompute(r._computeIsEditCaptionEnabled,y);r._dataManagerMapper=n.dataManagerMapper;r._areFlippersPermanent=f.pureCompute(function(){return r.items().length>1});r.legend=f.pureCompute(r._computeLegend,y);r._initializeActions();r.commandBarSpecification=Object(le.r)(Se.e,{commandSet:r._getCommandSet(n),isMobile:!1});r._initializeOpenParentWhenEmpty();r.isIdleEnabled=f.pureCompute(r._computeIsIdleEnabled,y);r.isDetailsFocused=f.create(!1);r.isAwake=f.pureCompute(r._computeIsAwake,y);r.isPanningEnabled=f.pureCompute(r._computeIsPanningEnabled,y);var b=ie.e.getScrollbarWidth()+"px";r.nextFlipperStyle={};r.nextFlipperStyle[M.e.safeRight]=b;r.previousFlipperStyle={};r.previousFlipperStyle[M.e.safeLeft]=b;r.detailsBarStyle=f.pureCompute(r._computeDetailsBarStyle,y);var S=f.pureCompute(function(){return r.slideLoadState()>=3});r.infoPaneSpecification=Object(le.r)(ce.e,{showSections:S});t.isSlideshow&&f.compute(function(){t.isSlideshow(r.isSlideShowModeEnabled())}).extend({deferred:!0});var x=n.viewParams&&n.viewParams.peek();if(Object(v.isFeatureEnabled)(v.EnableCommentDeepLinking)&&r._shouldShowActivityFeed(x)&&!r.isInfoPaneExpanded.peek()){var T=r._focusedInfoPaneSection;T&&T(9);if(x&&x.commentId){var N=x.commentId;r._navigation=r.resources.consume(re.e);var C=r._navigation.viewParams;if(C&&C.commentId){delete C.commentId;r._navigation.updateViewParams(C)}r.deeplinkCommentId=r.resources.consume(he.optional);r.deeplinkCommentId&&r.deeplinkCommentId({commentId:N})}r._showPropertiesAction.execute(null)}f.backgroundCompute(r._computeSetCaptionLabel);f.backgroundCompute(r._computeClearCaptionFocus);f.backgroundCompute(r._computeSelectItem);f.backgroundCompute(r._computeTriggerClientRectUpdate);f.backgroundCompute(r._computeCommandBarShownOnIdleFullScreen);f.backgroundCompute(r._computeIsFirstSlideOpened);f.backgroundCompute(r._computePagesViewed);return r}t.prototype.executeAction=function(e,t){if(e.isAvailable.peek()){e.execute(t);return!1}return!0};t.prototype.enterSlideshowMode=function(){Z.e.enterFullScreen();if(this.isSlideShowModeEnabled.peek()){this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!0}return!1};t.prototype.exitSlideshowMode=function(){Z.e.exitFullScreen();this.isSlideShowModeEnabled(!1);if(this._timeOutId){this.async.clearTimeout(this._timeOutId);return!0}return!1};t.prototype.onExitInfoPane=function(e){this.async.setTimeout(function(){A.removeNode(e)},500)};t.prototype.onContentClicked=function(e){var t=this.oneUp.slide,n=t&&t.peek();return!(!n||!n.isPanningEnabled.peek()||this.isSlideShowModeEnabled.peek())};t.prototype.toggleInfoPaneExpanded=function(e){this._showPropertiesAction.execute(e);return!1};t.prototype.editCaption=function(e){if(!this.isInfoPaneExpanded.peek()){var t=this._focusedInfoPaneSection;t&&t(1);this._showPropertiesAction.execute(e)}return!1};t.prototype.dispose=function(){var t=this.peekUnwrapObservable(this._itemSet);if(t){var n=t.content.peek();this._carouselEventData.totalPages=n.items.length}this._carouselEvent.end(this._carouselEventData);Z.e.isFullScreen()&&Z.e.exitFullScreen();e.prototype.dispose.call(this)};t.prototype._startSlideshow=function(){this.isInfoPaneExpanded.peek()&&this.toggleInfoPaneExpanded(null);if(!this.isSlideShowModeEnabled.peek())return!1;this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!(!this.slideLoadState.peek()||this.executeAction(this._openNext,null))||void 0};t.prototype._initializeItemSet=function(e){var t=this,n=e.itemSet;this._sourceItemSet=n;var r,i=this.observables;this.index=i.pureCompute(this._computeIndex);this._isPlaceholderItemSetRequired=i.pureCompute(function(){var e=n();return(!e.content()||e.isPlaceholder)&&-1===t.index()},{deferEvaluation:!0});var s=i.pureCompute(function(){var e;if(t._isPlaceholderItemSetRequired()){(e=new ee.e).item=n.peek().item;r&&r.dispose();r=i.compute(function(){var n=new te.e;n.items=[t.item()];e.content(n)})}else e=n();return e});s.equalityComparer=ne.t;var u=i.pureCompute(function(){return s().item()});u.equalityComparer=ne.t;this.resources.expose(o.o,u);this._itemSet=this.resources.expose(o.u,s);this.items=i.createArray();i.backgroundCompute(function(){t.items(t._itemSet().content().items)})};t.prototype._initializeItem=function(e){var t=this,n=e.item,r=this.observables,i=this.item=r.create();i.equalityComparer=ne.t;if(n){r.backgroundCompute(function(){i(n())});r.backgroundCompute(function(){if(i()!==n.peek()){var e=t._openCurrent;e.isAvailable.peek()&&e.execute(null).done()}}).extend(this._rateLimitExtenders)}};t.prototype._computeIndex=function(){var e=this.item(),t=this._sourceItemSet().content().items;return e?t.indexOf(e):-1};t.prototype._computeAccessibleItemAnnouncementText=function(){var e=this.item(),t=e&&e().displayName;return t?Q.format(G.e.accessibleItemAnnouncement,t):""};t.prototype._initializeActions=function(){var e=this,t=this.observables,n=t.pureCompute(function(){return t.unwrap(e.item())}),r=this._actionMap,s=this.managed(r.OpenAction),o={openRelation:2,focusUrl:!0,itemSet:this._itemSet,ignoreHistory:!0};this._openCurrent=new s(Object(i.__assign)(Object(i.__assign)({},o),{item:n}));this._openPrevious=new s(Object(i.__assign)(Object(i.__assign)({},o),{item:t.pureCompute(this._computePreviousItem)}));this._openNext=new s(Object(i.__assign)(Object(i.__assign)({},o),{item:t.pureCompute(this._computeNextItem)}));this.updateCaptionAction=new(this.managed(r.UpdateCaptionAction))({item:n});this._showPropertiesAction=new(this.managed(r.ShowPropertiesAction))({useToggleBehavior:!0})};t.prototype._computePreviousItem=function(){var e=this.index();if(!(e<0))for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),r=e-1;r>=0;r--){var i=this.unwrapObservable(n[r]);if(!t||i&&!i.video)return i}};t.prototype._computeNextItem=function(){var e=this.index();if(!(e<0)){for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),r=e+1,i=n.length;r<i;r++){var s=this.unwrapObservable(n[r]);if(!t||s&&!s.video)return s}t&&this.exitSlideshowMode()}};t.prototype._initializeOpenParentWhenEmpty=function(){var e=this,t=new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this._parent,ignoreHistory:!0}),n=this.observables,r=n.pureCompute(function(){var t=e._itemSet();t.content();return!t.isPlaceholder&&!t.item().isPlaceholder||t.item().error?e.items().length:r.peek()});n.backgroundCompute(function(){0===r()&&t.isAvailable.peek()&&t.execute(null)}).extend(this._rateLimitExtenders)};t.prototype._computeTriggerClientRectUpdate=function(){this.isInfoPaneExpanded();this.isCommandBarVisible();A.computedContext.isInitial()||this.async.setTimeout(function(){ge.t.raise(document.body,"resize",void 0,!0)},500)};t.prototype._computeClearCaptionFocus=function(){!this.isInfoPaneExpanded()&&this._focusedInfoPaneSection&&this._focusedInfoPaneSection(null)};t.prototype._computeCommandBarShownOnIdleFullScreen=function(){Z.e.isFullScreen()&&this.isCommandBarVisible(!this.isIdle())};t.prototype._computePagesViewed=function(){var e=this.oneUp.slide();if(e){this._carouselEventData.pagesViewed++;e.item&&e.item.peek()&&e.item.peek().folder&&(this._carouselEventData.isFolderShownInSession=!0)}};t.prototype._computeCanNavigate=function(){if(!Object(v.isFeatureEnabled)(v.RemoveOneUpSlideNavigation))return!0;var e=this.item.peek();if(!e){this.item();return!1}var t=e.peek();if(!t||t.isPlaceholder){e();return!1}return!!t.photo};t.prototype._computeIsFirstSlideOpened=function(){var e=this.oneUp.slide,t=e.peek();if(t){if(t.item){var n=t.item.peek();if(n){var r=this._carouselEventData;r.initialFileSize=n.size;r.initialFileType=n.iconName&&n.iconName.toLowerCase();r.initialFileExtension=n.extension&&n.extension.toLowerCase()}}t.isFirstSlideOpened(!0)}else e()};t.prototype._getCommandSet=function(e){var t=e.commandSet;return void 0===t?this._createSelectableCommandSet(e):t};t.prototype._createSelectableCommandSet=function(e){var t=this,n=e.oneUpCommandSet,r=void 0===n?new(this.managed(L)):n,i=e.slideshowCommandSet,s=void 0===i?new(this.managed(I)):i,o=this.observables,u=new(this.managed(F))({legend:this.legend,next:this._openNext,previous:this._openPrevious,areFlippersPermanent:this._areFlippersPermanent,canNavigate:this.canNavigate,parent:this._parent}),a=o.pureCompute(function(){var e=t.oneUp.slide();if(t.isSlideShowModeEnabled())return[s,u];var n=e&&e.commandSet();if(n)return[n,u];var i=e&&e.augmentCommandSet();return i?[r,i,u]:[r,u]});return new(this.managed(q.e))({commandSets:a})};t.prototype._computeDetailsBarStyle=function(){var e=this.oneUp.slide(),t=ie.e.getScrollbarWidth(),n=e&&e.hasHorizontalScrollbar()?t:0,r=e&&e.hasVerticalScrollbar()?t:0,i={bottom:n+"px"};i[M.e.safeRight]=r+"px";return i};t.prototype._computeSetCaptionLabel=function(){var e=this.item(),t=e&&e.peek(),n=t&&t.photo?Y.e.captionAddCaption:Y.e.captionAddDescription;this.addCaptionLabel(n)};t.prototype._computeLegend=function(){var e=this.index(),t=this._dataManagerMapper,n=t&&t(),r=n?n.itemSet():this._itemSet(),i=n?n.getOriginalItemIndexByMappedIndex(e):e;return i>-1?Q.format(G.e.legendFormat,i+1,r.content().items.length):""};t.prototype._computeCaption=function(){var e=this.unwrapObservable(this.item());return e&&e.caption};t.prototype._computeIsAwake=function(){return this.isDetailsFocused()||!this.isIdle()||!this.isIdleEnabled()};t.prototype._computeIsIdleEnabled=function(){var e=this.oneUp.slide();return!e||e.isIdleEnabled()};t.prototype._computeIsPanningEnabled=function(){if(!this.canNavigate())return!1;var e=this.oneUp.slide();return e&&e.isPanningEnabled()};t.prototype._computeIsEditCaptionEnabled=function(){var e=this.oneUp.slide();return e&&e.isEditCaptionEnabled()&&(this.updateCaptionAction.isAvailable()||!!this.caption())};t.prototype._computeSelectItem=function(){var e=this.item(),t=this._selectionModel;if(t.selection()[0]!==e){var n=t.getItemKey(e);t.setSelectedKeys([n])}};t.prototype._shouldShowActivityFeed=function(e){return e&&(e.commentId||e.Nav&&e.Nav.indexOf("commentId")>=0)};t.prototype._shouldUseDarkBackground=function(e){if(Object(v.isFeatureEnabled)(v.DarkBackgroundForPhotosOneUp))return!0;if(Object(v.isFeatureEnabled)(v.DarkBackgroundForPhotosOneUpExperiment)){if(e){var t=e.getIdentity();t&&Te.t.init({userLoginName:t.email})}return new Te.t({name:"DarkBackgroundForPhotosOneUpExperiment",startDate:"3/20/2020",version:Te.e.v2},v.DarkBackgroundForPhotosOneUpExperiment_ABTrigger).isOn()}return!1};t.prototype._exposeIfNeeded=function(e,t){return this.resources.isExposed(e)?this.resources.consume(e):this.resources.expose(e,t)};t.dependencies=Object(i.__assign)(Object(i.__assign)({},s.t.dependencies),{focusItem:o.m.optional,focusItemSet:o.g.optional,currentItemSet:o.u.optional,indexResolver:o.M.optional,paneProvider:we.e,toolbarProvider:Ee.e,actionMap:o.e,focusedInfoPaneSection:xe.e.optional,dataManagerMapper:o.s.optional,viewParams:o.B,commandSet:void 0,oneUpCommandSet:void 0,slideshowCommandSet:void 0,rateLimitExtenders:void 0,identityDataSource:Ne.E});return t})(s.t);n.d(t,"resourceKey",function(){return ke});var ke=Object(le.t)({automationName:"ms-one-up",name:"OneUp_5",template:'<div class="OneUp" data-bind="css:{\'OneUp--hasInfoPane\':showPane,\'OneUp--awake\':isAwake,\'OneUp--panningEnabled\':isPanningEnabled,\'OneUp--hasItems\':items().length,\'OneUp--hasCommandBar\':isCommandBarVisible,\'OneUp--slideShowOn\':isSlideShowModeEnabled,\'OneUp--darkBackground\':isDarkBackgroundEnabled}" role="presentation"><div class="OneUp-accessibleItemAnnouncement" aria-live="polite" data-bind="text:accessibleItemAnnouncementText"></div><div class="OneUp-commandBar" data-bind="hideWhenInactive,control:commandBarSpecification"></div><div class="OneUp-content" data-bind="hideWhenInactive,clientRect:{size:size}" role="presentation"><div class="OneUp-carousel" data-bind="component:{name:carouselTagName,params:{item:item,items:items,canNavigate:canNavigate,allocationRange:allocationRange,loadState:slideLoadState,isEnabled:isPanningEnabled,isRotating:isRotating}},idle:{isIdle:isIdle,isEnabled:isIdleEnabled},throttledClick:{callback:$component.onContentClicked.bind($component)},automation:\'carousel\'" role="presentation">\x3c!--ko component:{name:$component.oneUpSlideTagName,params:{slide:$host,oneUp:$component.oneUp}}--\x3e\x3c!--/ko--\x3e</div><div class="OneUp-detailsBar" data-bind="css:{\'OneUp-detailsBar--hasCaption\':showEditCaption},style:detailsBarStyle,childFocus:isDetailsFocused" role="presentation">\x3c!--ko if:showEditCaption--\x3e<div class="OneUp-caption-container">\x3c!--ko if:updateCaptionAction.isAvailable--\x3e<button class="OneUp-caption OneUp-caption--editable" data-bind="click:editCaption,css:{\'OneUp-caption--existing\':caption}"><span data-bind="text:caption()||addCaptionLabel"></span></button>\x3c!--/ko--\x3e\x3c!--ko ifnot:updateCaptionAction.isAvailable--\x3e<div class="OneUp-caption OneUp-caption--existing"><span data-bind="text:caption"></span></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:showAgent--\x3e<div class="OneUp-agent" data-bind="component:agentHost"></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:showPane--\x3e<div class="OneUp-paneHost" data-bind="hideWhenInactive,component:paneHost" role="presentation">\x3c!--ko with:$host.contexts()[0]--\x3e\x3c!--ko transclusionHost:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:$host.contexts().length--\x3e\x3c!--ko if:$component.isInfoPaneExpanded--\x3e<div class="OneUp-infoPane" data-bind="control:infoPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko component:{name:panelHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:dialogHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:overlayHostTagName}--\x3e\x3c!--/ko--\x3e</div>',viewModelType:Ce});t.default=ke},1419:function(e,t,n){"use strict";n(1430);var r=n(1444),i=n(1363),s={tagName:"ms-file-type-icon",template:'<span class="FileTypeIcon" data-bind="attr:{title:hoverText},click:onClick,css:{\'FileTypeIcon--clickable\':!!onClick}" tabindex="-1"><img class="FileTypeIcon-icon" data-bind="attr:{src:iconUrl,alt:iconFieldAriaLabel},style:{width:size,height:size,\'font-size\':size}">\x3c!--ko if:overlayUrl--\x3e<img class="FileTypeIcon-overlay" data-bind="attr:{src:overlayUrl}">\x3c!--/ko--\x3e</span>',viewModel:r.e,synchronous:!0};i.e(s);t.e=s},1430:function(e,t,n){"use strict";var r=n(122);Object(r.n)([{rawString:".FileTypeIcon{position:relative;display:inline-block}.FileTypeIcon--clickable{cursor:pointer}.FileTypeIcon-icon{display:inline-block;vertical-align:middle;position:relative;overflow:hidden}.FileTypeIcon-icon::before{display:block}.FileTypeIcon-overlay{display:block;border:0;position:relative;left:9px;bottom:9px;height:9px;width:9px}"}])},1444:function(e,t,n){"use strict";var r,i=n(0),s=n(1361),o=n(1412),u=n(1452),a=16;(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(r||(r={}));var f=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.iconFieldAriaLabel,i=void 0===r?"":r,s=t.iconName,f=t.extension,l=t.item,c=t.desiredSize||a;n.hoverText=t.hoverText;n.onClick=t.onClick;var h=n,p=h.observables,d=h.resources,v=p.create(""),m=p.create(i);if(t.iconUrl)v(t.iconUrl);else if(s){var g=t.iconSize||c,y=o.e(d,s,g);v(y);if(f){var b=d.consume(u.e.optional);b&&p.backgroundCompute(function(){v(b.getFileTypeIconUrl(f)||y);m(b.getFileTypeName(f)||i)})}if(l&&l.vault&&l.vault.root){var w=n._getVaultFolderIconName(l);v(o.e(d,w,g))}}n.size=(v.peek()?c:0)+"px";n.iconUrl=v;n.iconFieldAriaLabel=m;t.overlayType?n.overlayUrl=window.require.toUrl("odsp-media/images/overlays/"+t.overlayType.toLowerCase()):n.overlayUrl="";return n}t.prototype._getVaultFolderIconName=function(e){return e.vault.isLocked?r.vaultClosed:r.vaultOpen};return t})(s.t);t.e=f},1576:function(e,t,n){"use strict";n.d(t,"t",function(){return o});var r=n(0),i=n(1361),s=n(33);function o(e){if(!e)return{resultCode:"unknown",resultType:s.e.Failure};var t=e.correlationId;return{resultCode:e.code||e.name,resultType:e.isExpected?s.e.ExpectedFailure:s.e.Failure,error:e.message||""+e,extraData:t?{CorrelationId:t}:{}}}var u=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.slide=t.slide;r.oneUp=t.oneUp;return r}return t})(i.t);t.e=u},1578:function(e,t,n){"use strict";var r;(function(e){e[e.Lock=1]="Lock";e[e.Unlock=2]="Unlock";e[e.Manage=3]="Manage";e[e.FreDialog=4]="FreDialog";e[e.ShowFiles=5]="ShowFiles";e[e.Reset=6]="Reset";e[e.Debug=7]="Debug";e[e.FilesRemaining=8]="FilesRemaining"})(r||(r={}));t.e=r},1680:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t=e.document;t.body||t.createElement("body");var n=t.createElement("form");n.action=e.url;n.method="POST";n.style.visibility="hidden";n.target="_self";var r=e.postdata;for(var i in r){var s=t.createElement("input");s.type="hidden";s.name=i;s.value=r[i];n.appendChild(s)}t.body.appendChild(n);n.submit()}},1697:function(e,t,n){"use strict";var r=n(122);Object(r.n)([{rawString:".od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}])},1716:function(e,t,n){"use strict";var r=n(0),i=n(33),s=n(25),o=n(2172),u=n(1366),a=n(1576),f=n(2267),l=n(1419),c=n(2174),h=n(2431),p=n(113),d=n(41),v=n(1371),m=96,g='<a href="https://go.microsoft.com/fwlink/?linkid=862871" target="_blank">',y="</a>",b=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.strings=f.e;r.addBindingHandlers({activate:o.e,control:u.n});var i=t.slide.renderOptions,a=t.showActions,h=void 0===a?!i||!i.hideDownload:a;r._isOneDriveWinApp=Object(p.e)();r.showActions=r._isOneDriveWinApp?r.showActionInOneDriveWinApp(t.slide.item().queryType,t.slide.item().type):h;r._allowInfectedDownload=n.allowInfectedDownload;r.malwareDetectedSvgUrl=window.require.toUrl("odsp-media/images/atp/malware_icon_208x208.svg");r.malwareDetectedIconAlt=f.e.malwareDetectedIconAriaLabel;r.itemMalwareDetected=r.createPureComputed(function(){var e=t.slide.item();return e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected},{deferEvaluation:!0});r.fileTypeIconTagName=l.e.tagName;r.fileName=r.createPureComputed(function(){var e=t.slide.item();return e.displayName||e.name},{deferEvaluation:!0});r.fileTypeIconViewModelParams=r.createPureComputed(function(){var e=t.slide.item();return{iconName:e.iconName,iconUrl:e.iconUrl,extension:e.extension,desiredSize:m}},{deferEvaluation:!0});r.actionBarControl=Object(u.r)(c.e,{forceExternal:!!i,item:t.slide.item,hideOpenCommand:r.itemMalwareDetected});r.message=r.createPureComputed(function(){var e=t.slide.item();return r.itemMalwareDetected()?r._allowInfectedDownload?s.format(f.e.malwareDetectedAllowDownloadMessage,g,y):s.format(f.e.malwareDetectedMessage,g,y):3===e.itemStatus?f.e.blockedByPolicy:f.e.notPreviewAvaible});return r}t.prototype.activate=function(){var e=this.observables.create({resultType:i.e.ExpectedFailure,resultCode:"Fallback",error:"Fallback viewer loaded"}),t=this.slide;this.scope.attach(t.loadResult.register(e));t.loadState(3)};t.prototype.showActionInOneDriveWinApp=function(e,t){return e===d.e.SharedWithMe||t===v.e.Folder||t===v.e.Unknown||t===v.e.OneNote||t===v.e.File||t===v.e.Media};t.dependencies=Object(r.__assign)(Object(r.__assign)({},a.e.dependencies),{allowInfectedDownload:h.e});return t})(a.e),w=Object(u.t)({automationName:"od-one-up-other",name:"OneUpOther_6",template:'<div class="OneUp-other" data-bind="activate:$component.activate.bind($component)"><div class="OneUp-other-content">\x3c!--ko if:itemMalwareDetected()--\x3e<div><img class="OneUp-other-malwareDetectedIcon" data-bind="attr:{src:malwareDetectedSvgUrl,alt:malwareDetectedIconAlt}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:itemMalwareDetected()--\x3e<div class="OneUp-other-fileIcon" data-bind="component:{name:fileTypeIconTagName,params:fileTypeIconViewModelParams}"></div>\x3c!--/ko--\x3e<div class="OneUp-other-fileName" data-bind="text:fileName"></div><div class="OneUp-other-message" data-bind="html:message"></div>\x3c!--ko if:showActions--\x3e<div class="OneUp-other-actions" data-bind="control:actionBarControl"></div>\x3c!--/ko--\x3e</div></div>',viewModelType:b});t.e=w},1748:function(e,t,n){"use strict";n.r(t);var r='<div class="od-Error"><div class="od-Error-image"><img data-bind="attr:{src:imageUrl,alt:errorTitle,class:errorClassName}"></div><div class="od-Error-title" data-bind="text:errorTitle"></div>\x3c!--ko if:errorDetailedText--\x3e<div class="od-Error-subText" data-bind="text:errorDetailedText,css:{\'od-Error-subtext--accessremoved\':isAccessRemoved}"></div>\x3c!--/ko--\x3e\x3c!--ko if:errorHtml--\x3e<div class="od-Error-subText" data-bind="html:errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if:showAction--\x3e<form class="od-Error-button" data-bind="attr:{action:actionUrl}" method="get"><button class="od-Button" data-bind="click:onButtonClick" type="submit"><span class="od-Button-label" data-bind="text:actionText"></span></button></form>\x3c!--/ko--\x3e<div class="od-Error-code" data-bind="visible:correlationIdText,text:correlationIdText"></div><div class="od-Error-code" data-bind="visible:showErrorCode,text:errorCodeText"></div></div>',i=(n(1697),n(0)),s=n(1361),o=n(1577),u=n(96),a=n(145),f=n(25),l=n(1228),c=n(94),h=n(10),p=n(87),d=(function(){function e(e,t){this._errorDataSource=t.errorDataSource;this._defaultErrorAction={text:o.e.DefaultActionText,url:t.urlDataSource.getRootUrl()}}e.prototype.getAction=function(e){return this._errorDataSource?this._errorDataSource.getAction(e):this._defaultErrorAction};return e})(),v=Object(h.s)("ErrorProvider_6",d,{errorDataSource:p.c.optional,urlDataSource:p.ge}),m=n(138),g=n(1578),y="accessremoved",b=161,w=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.error;r._navigation=r.resources.consume(c.e);r._actionMap=r.resources.consume(m.e.optional);var s,h,p,d,g,w,S=r.resources.consume(v);r.errorClassName="od-Error-imageTag";if(E(i)){s=i.errorTitle;h=i.errorCode;p=i.errorDetailedText;d=i.errorDetailedHtml;g=i.correlationId;w=S.getAction(i)}else i.message&&(p=i.message);s||(s=o.e.DefaultTitle);r.errorTitle=s;r.errorDetailedText=p;r.errorHtml=d;r.errorCode=h;p||d||(p=o.e.DefaultSubText);r.errorDetailedText=p;r.showAction=!!w&&!w.hideButton&&!t.hideAction;if(w){r.actionText=w.text;r.actionUrl=w.url}r.showErrorCode=h&&r.errorTitle===o.e.DefaultTitle;if(r.showErrorCode){u.e.log(i,"ServerError",""+h);r.errorCodeText=f.format(o.e.errorCodeText,h)}else r.errorCodeText="";r.correlationIdText=g?f.format(o.e.errorCorrelationIdText,g):"";if(h===y){r.isAccessRemoved=!0;r.imageUrl=window.require.toUrl("odsp-media/images/error/error2.svg")}else{r.isAccessRemoved=!1;r.imageUrl=r._getRandomImage()}if(E(i)&&i.actionUrl&&i.errorCode===b){r.resources.consume(l.resourceKey)(!1);r.actionText=o.e.UnlockButtonText;r.errorDetailedText=o.e.UnlockRequiredErrorText;r.errorCodeText="";r.errorTitle=o.e.UnlockRequiredErrorTitle;r.imageUrl=window.require.toUrl("odsp-media/images/error/vault/vaultclosed.svg");r.errorClassName="od-Error-vaultImage";a.e.logData({name:"Vault.Bookmarked.Loaded"})}return r}t.prototype.onButtonClick=function(){if(this.showAction)if(this.errorCode===b&&this._actionMap){a.e.logData({name:"Vault.Bookmarked.Unlock"});new(this.managed(this._actionMap.VaultAction))({actionType:g.e.Unlock}).execute(null)}else{this._navigation.navigateTo(this.actionUrl)}return!1};t.prototype._getRandomImage=function(){var e=Math.ceil(3*Math.random());return window.require.toUrl("odsp-media/images/error/error"+e+".svg")};return t})(s.t);function E(e){return!(!e||!e.errorTitle&&void 0===e.errorCode)}var S=n(1363),x=n(1366);n.d(t,"resourceKey",function(){return N});var T=S.e({tagName:"ms-error",template:r,viewModel:w,synchronous:!0}),N=Object(x.t)({name:"Error_6",automationName:"ms-error",template:r,viewModelType:w});t.default=T},1755:function(e,t,n){"use strict";var r=n(0),i=n(1372),s=n(1464),o=n(1362),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._isActive=r.observables.create(!0);new(r.managed(s.e))({element:r.element,allBindingsAccessor:r.allBindingsAccessor,bindingContext:r.bindingContext,valueAccessor:function(){return{isActive:r._isActive}}});o.applyBindingsToNode(r.element,{attr:{"aria-hidden":r.observables.pureCompute(function(){return r._isActive()?void 0:"true"})}},r.bindingContext);return r}return t})(i.t);t.e=u},1777:function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(567);function i(e,t){e.extend({rateLimit:{timeout:1,method:"notifyWhenChangesStop"}});var n,i=e.subscribe(function(r){t.cancelAnimationFrame(n);n=t.requestAnimationFrame(function(){n=t.requestAnimationFrame(function(){n=void 0;e()})})},null,"beforeChange");return e=Object(r.e)(e,function(){i.dispose()})}function s(e,t){e.equalityComparer=t;return e}},1829:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r,i=n(18);function s(){if(i.e.isActivated("67239929-E0E5-4822-8C9B-8C11B3F750AA","4/22/2020","Use same iframe element to test for srcdoc"))return"srcdoc"in HTMLIFrameElement.prototype;"boolean"!=typeof r&&(r="srcdoc"in document.createElement("iframe"));return r}},1830:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n(398),s=n(1754),o=n(1372),u=10,a={0:function(e){return e},1:function(e){return 18*e},2:function(e){return.5*window.innerHeight}},f=300,l=window.navigator,c=l&&l.pointerEnabled,h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor(),i=n.observables,o=r.allowedModes,u=void 0===o?15:o;n._transformV=r.transform||i.create(s.e.IDENTITY);n._isActive=r.isActive||i.create(!1);n._isEnabled=r.isEnabled||i.create(!0);n._mayStartPan=r.mayStartPan||p;n._constrainScale=r.constrainScale||d;n._allowedModes=u;n._useNativePan=!!r.useNativePan;n._gestureMode=i.create(0);n._touchCount=0;n._pointers={};n._pointerCount=0;n._initialTransformV=i.create(s.e.IDENTITY);n._initialTransformV.equalityComparer=m;n._incrementTransformPx=i.create(s.e.IDENTITY);n._incrementTransformPx.equalityComparer=m;n._initialCenterPx=i.create();n._initialCenterPx.equalityComparer=v;n._initialRadius=i.create();n._incrementTransformV=i.compute(n._computeIncrementTransformV);n._incrementTransformV.equalityComparer=m;i.compute(n._computeResetTransform);i.compute(n._computeTransform);var a={};if(c&&7&u)a.pointerdown=n._onPointerDown;else{1&u&&(a.touchstart=n._onTouchStart);6&u&&(a.mousedown=n._onMouseDown)}if(8&u){n._isWheeling=i.compute(n._computeIsWheeling);i.compute(n._computeStopWheeling).extend({rateLimit:{timeout:f,method:"notifyWhenChangesStop"}});i.compute(n._computeEndWheel);a.wheel=n._onWheel}a.contextmenu=function(e){if(n._isEnabled.peek())return 0!=(4&u)};n.events.onAll(n.element,a);return n}t.prototype._computeIncrementTransformV=function(){var e=this._size||i.e.ORIGIN,t=this._incrementTransformPx();return new s.e(new i.e(t.translate.x/e.x,t.translate.y/e.y),t.scale)};t.prototype._computeResetTransform=function(){if(!this._initialCenterPx()){this._initialTransformV(this._transformV());this._incrementTransformPx(s.e.IDENTITY)}};t.prototype._computeTransform=function(){this._isActive()&&this._transformV(this._incrementTransformV().multiply(this._initialTransformV.peek()))};t.prototype._computeIsWheeling=function(){return 8===this._gestureMode()};t.prototype._computeStopWheeling=function(){var e=this._isWheeling();this._transformV();e&&this._gestureMode(0)};t.prototype._computeEndWheel=function(){if(!this._isWheeling()){this._clearGesture();this._isActive(!1)}};t.prototype._onWheel=function(e){if(this._isEnabled.peek()){e.preventDefault();this._updateSize();var t=this._transformToElement(e),n=a[e.deltaMode](e.deltaY);this._handleWheel(t,n)}};t.prototype._handleWheel=function(e,t){var n=Math.pow(2,-t/300);if(!this._initialCenterPx.peek()){this._gestureMode(8);this._resetGesture([e.add(this._size.scale(-.5)),e.add(this._size.scale(.5))])}var r=s.e.zoom(e.subtract(this._initialCenterPx.peek()),e,n);8===this._gestureMode.peek()&&this._continueGesture(this._gesturePoints.map(function(e){return r.apply(e)}))};t.prototype._onMouseDown=function(e){if(this._isEnabled.peek()&&0===e.button){this._updateSize();var t=this._transformToElement(e);this._gestureMode(4);var n=e.ctrlKey?[this._size.subtract(t),t]:[t];this._resetGesture(n);this.events.off(this.element,"mousedown",this._onMouseDown);this.events.onAll(document,{mousedown:this._onMouseDown,mouseup:this._onMouseUp,click:this._onClick,mousemove:this._onMouseMove},!0)}};t.prototype._onMouseMove=function(e){e.preventDefault();this._updateSize(!1);var t=this._transformToElement(e),n=e.ctrlKey?[this._size.subtract(t),t]:[t];4===this._gestureMode.peek()&&this._continueGesture(n)};t.prototype._onClick=function(e){Date.now()-this._lastActiveMouseUp<100&&e.stopPropagation()};t.prototype._onMouseUp=function(e){if(0===e.button){if(this._isActive()){this._lastActiveMouseUp=Date.now();e.preventDefault()}this._updateSize(!1);if(4===this._gestureMode.peek()){this._clearGesture();this._gestureMode(0)}this._isActive(!1);this.events.off(document,"mousedown",this._onMouseDown,!0);this.events.off(document,"mouseup",this._onMouseUp,!0);this.events.off(document,"mousemove",this._onMouseMove,!0);this.events.on(this.element,"mousedown",this._onMouseDown)}};t.prototype._onTouchStart=function(e){if(this._isEnabled.peek()){this._isActive.peek()&&(!this._useNativePan||e.touches.length>1)&&e.preventDefault();this._updateSize(0===this._touchCount);var t=this._touchCount;this._touchCount+=e.changedTouches.length;if(!t&&this._touchCount){this._gestureMode(1);this.events.off(this.element,"touchstart",this._onTouchStart);this.events.onAll(document,{touchstart:this._onTouchStart,touchmove:this._onTouchMove,touchend:this._onTouchEnd,touchcancel:this._onTouchCancel},!0)}else 1===this._gestureMode.peek()&&this._clearGesture();1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))}};t.prototype._onTouchMove=function(e){(!this._useNativePan||e.touches.length>1)&&e.preventDefault();this._updateSize(!1);this._continueGesture(this._getPointsFromTouches(e.touches))};t.prototype._onTouchEnd=function(e){this._isActive.peek()&&e.preventDefault();this._updateSize(!1);this._removeTouches(e)};t.prototype._onTouchCancel=function(e){this._updateSize(!1);this._removeTouches(e)};t.prototype._removeTouches=function(e){var t=this._touchCount;this._touchCount-=e.changedTouches.length;1===this._gestureMode.peek()&&this._clearGesture();if(t&&!this._touchCount){1===this._gestureMode.peek()&&this._gestureMode(0);this._isActive(!1);this.events.off(document,"touchstart",this._onTouchStart,!0);this.events.off(document,"touchmove",this._onTouchMove,!0);this.events.off(document,"touchend",this._onTouchEnd,!0);this.events.off(document,"touchcancel",this._onTouchCancel,!0);this.events.on(this.element,"touchstart",this._onTouchStart)}else 1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))};t.prototype._onPointerDown=function(e){if(this._isEnabled.peek()){var t=this._allowedModes,n=e.pointerType,r="mouse"===n?4:"pen"===n?2:1;if(t&r&&!this._pointers[e.pointerId]){var i=0===this._pointerCount;!this._isActive.peek()||this._useNativePan&&i||e.preventDefault();this._updateSize(i);this._pointers[e.pointerId]=this._transformToElement(e);this._pointerCount++;if(i){this._gestureMode(r);this.events.off(this.element,"pointerdown",this._onPointerDown);this.events.onAll(document,{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointercancel:this._onPointerCancelOrLost,lostpointercapture:this._onPointerCancelOrLost},!0)}else this._isPointerGesture()&&this._clearGesture();this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers())}}};t.prototype._onPointerMove=function(e){if(this._pointers[e.pointerId]){(!this._useNativePan||this._pointerCount>1)&&e.preventDefault();this._updateSize(!1);this._pointers[e.pointerId]=this._transformToElement(e);this._isPointerGesture()&&this._continueGesture(this._getPointsFromPointers())}};t.prototype._onPointerUp=function(e){this._isActive()&&e.preventDefault();this._onPointerCancelOrLost(e)};t.prototype._onPointerCancelOrLost=function(e){this._updateSize(!1);this._removePointers(e)};t.prototype._removePointers=function(e){if(this._pointers[e.pointerId]){delete this._pointers[e.pointerId];this._pointerCount--;this._isPointerGesture()&&this._clearGesture();if(0===this._pointerCount){this._isPointerGesture()&&this._gestureMode(0);this._isActive(!1);this.events.off(document,"pointerdown",this._onPointerDown,!0);this.events.off(document,"pointermove",this._onPointerMove,!0);this.events.off(document,"pointerup",this._onPointerUp,!0);this.events.off(document,"pointercancel",this._onPointerCancelOrLost,!0);this.events.off(document,"lostpointercapture",this._onPointerCancelOrLost,!0);this.events.on(this.element,"pointerdown",this._onPointerDown)}else this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers())}};t.prototype._clearGesture=function(){this._gesturePoints=null;this._initialCenterPx(null)};t.prototype._continueGesture=function(e){this._gesturePoints=e;this._initialCenterPx.peek()||this._resetGesture(e);var t,n=i.e.getCenter(e),r=this._getRadius(e,n),o=this._initialRadius.peek();t=0!==r&&0!==o?r/o:1;var u=this._initialTransformV.peek().scale*t,a=this._constrainScale(u)/u,f=this._initialCenterPx.peek(),l=s.e.zoom(i.e.ORIGIN,f,t*a),c=new s.e(n.subtract(f));this._incrementTransformPx(c.multiply(l));!this._isActive.peek()&&this._mayStartPan(this._incrementTransformPx.peek(),r-o,e)&&this._isActive(!0)};t.prototype._resetGesture=function(e){this._gesturePoints=e;var t=i.e.getCenter(e),n=this._getRadius(e,t);this._initialCenterPx(t);this._initialRadius(n)};t.prototype._getRadius=function(e,t){for(var n=0,r=0,i=e;r<i.length;r++){n+=i[r].distance(t)}return n/e.length};t.prototype._getPointsFromTouches=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this._transformToElement(e[n]));return t};t.prototype._getPointsFromPointers=function(){var e=[];for(var t in this._pointers)e.push(this._pointers[t]);return e};t.prototype._updateSize=function(e){void 0===e&&(e=!0);if(!this._size||e){var t=this.element.getBoundingClientRect();this._size=new i.e(t.width,t.height);this._clientToElementTransform=new s.e(new i.e(-t.left,-t.top))}};t.prototype._transformToElement=function(e){return this._clientToElementTransform.apply(new i.e(e.clientX,e.clientY))};t.prototype._isPointerGesture=function(){return 7&this._gestureMode.peek()};return t})(o.t);t.t=h;function p(e,t,n){return e.translate.abs()>=u||Math.abs(t)>=u}function d(e){return e}function v(e,t){return e===t||!(!e||!t)&&(e.x===t.x&&e.y===t.y)}function m(e,t){return e===t||!(!e||!t)&&(v(e.translate,t.translate)&&e.scale===t.scale)}},1858:function(e,t,n){"use strict";var r=n(1495),i=n(0),s=n(1693),o=n(1524),u=n(1646),a=n(1777),f=n(33),l=n(1366),c=n(1716),h=n(1576),p=n(115),d=n(502),v=n(233),m=(function(e){Object(i.__extends)(t,e);function t(t,n){var s=e.call(this,t,n)||this;s.addBindingHandlers({control:l.n});s.thumbnailTagName=r.e.tagName;var u=s,f=u.observables,h=u.slide,p=t.slide.renderOptions,m=t.scale,g=void 0===m?f.create(1):m,y=t.size,b=void 0===y?s.oneUp.size:y,w=t.allowLoading,E=void 0===w?f.create(!0):w,S=t.fallbackThumbnail,x=t.showErrorActions,T=void 0===x?!p||!p.hideDownload:x,N=t.allowError,C=void 0===N||N,k=t.item,L=void 0===k?h.item:k,A=t.isPreview;s._item=L;s._scale=g;s._size=b;s._fallbackThumbnail=S;s._allowError=f.wrap(C);s._isLoaded=f.create(!1);s._isRendered=f.create(!1);f.backgroundCompute(s._updateSlideLoadState);s._image=f.pureCompute(s._computeImage);s._image.equalityComparer=v.t;s._desiredSize=f.pureCompute(s._computeDesiredSize);s._desiredSize.equalityComparer=v.t;s._rotation=f.pureCompute(s._computeRotation);s._markAccess=Object(d.isFeatureEnabled)(d.ReportOneUpFileAccess)&&f.pureCompute(function(){return!A&&!h.offset()});s._error=f.create();s._fadeIn=f.pureCompute(function(){return Math.abs(s.slide.offset())<2});s._allowLoading=f.pureCompute(function(){var e=E(),t=s.oneUp.isRotating();return e&&!t});s._coverage=a.t(f.pureCompute(s._computeImageFrameCoverage),v.t);s.hasThumbnail=f.pureCompute(s._computeHasThumbnail);s.thumbnailParams=f.pureCompute(s._computeThumbnailParams);s.hasError=f.pureCompute(s._computeHasError);var O=Object(i.__assign)(Object(i.__assign)({},t),{showActions:T,slide:Object(i.__assign)(Object(i.__assign)({},t.slide),{loadResult:f.createCallback(Object(o.t)())})});s.fallbackControl=Object(l.r)(c.e,O);var M=s._result=f.pureCompute(s._computeResult);s.scope.attach(t.slide.loadResult.register(M));return s}t.prototype._computeImage=function(){var e=this._item(),t=(e.orientedThumbnail||e).thumbnail||this.unwrapObservable(this._fallbackThumbnail),n=this._markAccess;if(n){var r=t&&t.url;if(r&&r.indexOf("provider=spo")>=0){var s=r.replace(/&(width|height)=[^&]*/g,""),o=n()?"Access":"Preview";return Object(i.__assign)(Object(i.__assign)({},t),{action:o,getAligned:function(e){return{width:e.width,height:e.height,url:s+"&width="+(0|e.width)+"&height="+(0|e.height)+"&action="+o}}})}}return t};t.prototype._computeRotation=function(){var e=this._item().orientedThumbnail;return e?e.rotation:s.e.none};t.prototype._computeImageFrameCoverage=function(){var e,t=this._image(),n=this._size();t.width&&t.height&&(t.width>n.width||t.height>n.height)&&(e=.25);return{minimum:0,maximum:1,fallback:e}};t.prototype._computeHasThumbnail=function(){return!(!this._size().width||!this._image()||!this.slide.loadState()&&this.hasError())};t.prototype._computeResult=function(){var e=this._result.peek();if(e)return e;var t=this._error();if(t){var n=void 0,r=!1;if(t instanceof p.e){n=t.code;r=t.isExpected}return{resultType:r?f.e.ExpectedFailure:f.e.Failure,resultCode:n||"LoadFailure",error:"Unable to load image"}}return this._isLoaded()?{resultType:f.e.Success}:void 0};t.prototype._computeHasError=function(){var e=this.hasError.peek();if(!e){e=this._allowError()&&!!this._error();var t=this._error();if(t&&t instanceof Array)for(var n=0;n<t.length;n++)if(t[n]&&"NeedAccessToken"===t[n].message)return!1}return e};t.prototype._computeDesiredSize=function(){var e=this._size(),t=this._image();if("Preview"!==(t&&t.action))return e;var n=Math.max(e.width,e.height),r=t&&Math.max(t.width,t.height)||0;if(r&&n>r)return g(r);for(var i=0,s=[400,960,1600,2560];i<s.length;i++){var o=s[i];if(r&&o>r)return g(r);if(o>n)return g(o)}return g(2560)};t.prototype._computeThumbnailParams=function(){var e;this.hasThumbnail()&&(e={image:this._image,rotation:this._rotation,desiredSize:this._desiredSize,scale:this._scale,error:this._error,alignment:u.e.fit,fadeIn:this._fadeIn,isCurrent:this._isLoaded,isLoaded:this._isRendered,coverage:this._coverage,allowLoading:this._allowLoading});return e};t.prototype._updateSlideLoadState=function(){var e=this.slide.loadState;this._isLoaded()?e(3):this._isRendered()&&e(2)};return t})(h.e);function g(e){return{width:e,height:e}}var y=Object(l.t)({automationName:"od-one-up-thumbnail",name:"OneUpThumbnail_6",template:"\x3c!--ko if:hasError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!hasError()&&hasThumbnail()--\x3e\x3c!--ko component:{name:thumbnailTagName,params:thumbnailParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e",viewModelType:m});t.e=y},1880:function(e,t,n){"use strict";var r=n(0),i=n(1372),s=n(1362),o=n(1680),u=n(1829),a=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;n.createComputed(n._computeUpdate);return n}t.prototype._computeUpdate=function(){var e=this,t=this.unwrapObservable(this.valueAccessor());if(t){var n,r,i;switch(t.type){case"get":if(t.url){i=!0;r=function(e){e.src=t.url}}break;case"content":i=!0;r=function(n){if(Object(u.e)())n.srcdoc=t.content;else{var r=new Blob([t.content],{type:"text/html"}),i=window.URL.createObjectURL(r);e.scope.attach({dispose:function(){window.URL.revokeObjectURL(i)}});n.src=i}};break;case"post":if(t.url){i=!0;n=function(e){Object(o.e)({url:t.url,postdata:t.postdata,document:e.contentDocument})}}}var a=i&&(this._iframe||document.createElement("iframe"));(function(e,t){if(e){t.className&&(e.className=t.className);t.title&&(e.title=t.title);t.role&&e.setAttribute("role",t.role);"string"==typeof t.sandbox&&e.setAttribute("sandbox",t.sandbox);e.frameBorder="0"}})(a,t);r&&r(a);if(a&&!this._iframe){this._iframe=a;this.events.on(a,"load",this._onLoad);s.virtualElements.setDomNodeChildren(this.element,[a]);s.utils.domNodeDisposal.addDisposeCallback(a,function(){e.events.off(a,"load",e._onLoad);(function(e){e.src="";e.srcdoc=""})(a)})}n&&n(a);if(a);else{s.virtualElements.emptyNode(this.element);this._iframe=void 0}}else{s.virtualElements.emptyNode(this.element);this._iframe=void 0}};t.prototype._onLoad=function(e){var t=this.peekUnwrapObservable(this.valueAccessor());t.onLoad&&t.onLoad(e)};t.supportsVirtualElements=!0;return t})(i.t);t.e=a},2043:function(e,t,n){"use strict";var r=new(n(7).t)({name:"AccessibilityMode.key_6"});t.e=r},2044:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(153),i=n(14),s=n(115);function o(e,t,n){return i.n.all([f(e),f(e,n)]).then(function(e){var n=e[0],r=e[1],i=r.length>n.length;return{text:i?n:r,mimeType:t,isSafeText:i||a(r)}},function(e){return e.filter(function(e){return!i.n.isCanceled(e)})[0]||e[0]})}function u(e,t){return f(e).then(function(e){return{text:e,mimeType:t,isSafeText:!0}})}function a(e){for(var t=0;t<e.length;t++)if(!(n=e.charCodeAt(t),n<127||l[n]))return!1;var n;return!0}function f(e,t){var n=new r.e,i=new FileReader;i.onload=function(){n.complete(i.result||"")};i.onerror=function(e){var t=i.error;n.error(new s.e({code:t&&(t.name||"Parse."+t.code)||"Parse",isExpected:!1,message:t&&t.message||"Parsing error"}))};i.readAsText(e,t);return n.getPromise()}var l={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}},2045:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(1878),s=new r.t({name:"ToolbarProvider.key_6",factory:i.e})},2099:function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.commandSets,i=void 0===r?[]:r;n._commandSets=n.wrapObservable(i);n.createComputed(n._computeUpdateCommandSet);return n}t.prototype._computeUpdateCommandSet=function(){for(var e,t,n=[],i=[],s=[],o=0,u=this._commandSets();o<u.length;o++){for(var a=u[o],f=this.observables.unwrap(a),l=[],c=0,h=f.commands();c<h.length;c++){var p=h[c];p===f.overflowHostCommand?s.push.apply(s,p.children()):4==(4&p.location)?l.push(p):n.push(p)}i.unshift.apply(i,l)}var d=this.overflowHostCommand.children.peek();(e=this.overflowHostCommand.children).splice.apply(e,Object(r.__spreadArrays)([0,d.length],s));n.push(this.overflowHostCommand);n.push.apply(n,i);(t=this.commands).splice.apply(t,Object(r.__spreadArrays)([0,this.commands.peek().length],n))};return t})(n(1514).t);t.e=i},2100:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(10),s=new r.t({name:"LegacyDetailsPaneHost.key_4",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("134")]).then(n.bind(null,2539)).then(function(e){return e.resourceKey.local})})})},2150:function(e,t,n){"use strict";var r=n(122);Object(r.n)([{rawString:".Carousel{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.Carousel-platform{z-index:0;position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:0 0;touch-action:none}.Carousel-platform.is-enabled{will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.Carousel-slide{position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:0;visibility:hidden;transition:opacity 0s linear .3s,visibility 0s linear .3s,transform 0s linear}.Carousel-slide.is-current.is-loaded{opacity:1;visibility:inherit;transition-delay:0s,0s,0s}.Carousel-slide.is-current.is-deleted,.Carousel-slide.is-deleted{z-index:0;opacity:0;visibility:hidden;transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-enabled .Carousel-slide{will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.Carousel-platform.is-flipping .Carousel-slide{transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='1']{z-index:10}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='1'].is-current.is-loaded{transition-duration:.3s,0s,.3s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='2']{z-index:9}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='2'].is-loaded{transition-duration:.3s,0s,.3s;transition-delay:.3s,.6s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='3']{z-index:8}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='4']{z-index:7}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='5']{z-index:6}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='6']{z-index:5}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='7']{z-index:4}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='8']{z-index:3}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='1']{transform:translate(2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='1']{transform:translate(-2%,0)}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='-1']{transform:translate(-2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='-1']{transform:translate(2%,0)}.Carousel-platform.is-rotating .Carousel-slide{transition-delay:0s,0s,0s;transition-duration:0s,0s,0s}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='2']{transform:translate(204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='1']{transform:translate(102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-1']{transform:translate(-102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-2']{transform:translate(-204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-1'],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-2'],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='1'],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='2']{visibility:inherit;opacity:1}.Carousel-platform.is-gliding{transition:transform .3s ease-out}.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='-1'],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='-2'],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='1'],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='2']{transition-delay:.3s,.3s,0s}"}]);var i=n(1363),s=n(0),o=n(1362),u=n(398),a=n(1754),f=n(1177),l=n(1777),c=n(1361),h=n(1434),p=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({host:h.e});n.item=t.item;n.offset=t.offset;n.loadState=t.loadState||n.observables.create(0);n.order=t.order||n.observables.create(1);n.direction=n.createComputed(n._computeDirection);return n}t.prototype._computeDirection=function(){var e=this.offset();return e>0?1:e<0?-1:0};return t})(c.t),d=n(1830),v=15,m=1e3,g=1,y=.3,b=600,w=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({host:h.e,pan:d.t});var i=t.item,s=t.items,o=t.isEnabled,u=void 0===o||o,a=t.isRotating,l=void 0===a?r.createObservable(!1):a,c=t.loadState,p=void 0===c?r.createObservable(0):c,w=t.allocationRange,E=void 0===w?r.createObservable({start:0,end:0}):w;r.item=i;r._items=s;r._slideAllocationCount=r.createPureComputed(function(){return!t.canNavigate||t.canNavigate()?v:1});r._allocationRange=E;r.isEnabled=r.wrapObservable(u);r.isRotating=l;r.loadState=p;r._rotationThreshold=y;r._velocityThreshold=g;r._index=r.createPureComputed(r._computeIndex);r._lastValidIndex=r.createPureComputed(r._computeLastValidIndex);r._itemsInSlides=r.observables.createArray();r._itemHistory=r.observables.createArray();r.createBackgroundComputed(r._computeUpdateItemHistory);r.createBackgroundComputed(r._computeCleanItemHistory).extend({rateLimit:{timeout:b,method:"notifyWhenChangesStop"}});r._elementsToRemove=r.observables.createArray();r._initializeSlides();r._initializeMotion();r.carouselTransform=r.createPureComputed(r._computeCarouselTransform);r.carouselTransform.equalityComparer=f.e;r._initializeDirection();r.createBackgroundComputed(r._computeSwitchItemsOnItemRemoval);r.createBackgroundComputed(r._computeAllocationRange);r.createBackgroundComputed(r._computeItemsInSlides);r.createBackgroundComputed(r._computeElementsToRemove).extend({rateLimit:{timeout:m,method:"notifyWhenChangesStop"}});r.platformStyle=r.createPureComputed(r._computePlatformStyle);r.panBindingParams={isActive:r.isPowered,isEnabled:r.isEnabled,transform:r.panTransform,mayStartPan:function(e,t,n){return r.isEnabled.peek()&&Math.abs(e.translate.x)>=10&&t<5&&n.length<2},allowedModes:7};return r}t.prototype.onSlideRemoved=function(e){o.utils.toggleDomNodeCssClass(e,"is-deleted",!0);o.utils.toggleDomNodeCssClass(e,"is-current",!1);this._elementsToRemove.push(e)};t.prototype._initializeMotion=function(){this.isFlipping=this.createObservable(!0);this.isPowered=this.createObservable(!1);this.isGliding=this.createObservable(!1);this.panTransform=this.createObservable(a.e.IDENTITY);this.panTransform.equalityComparer=f.e;this._initializeVelocity();this.createBackgroundComputed(this._computeStartPowered);this.createBackgroundComputed(this._computeRotateToSlide);l.e(this.createBackgroundComputed(this._computeStartGlide),this.async);this.createBackgroundComputed(this._computeEndGlide).extend({rateLimit:{timeout:600,method:"notifyWhenChangesStop"}});this.createBackgroundComputed(this._computeEndRotation)};t.prototype._computeStartPowered=function(){if(this.isPowered()){this.isRotating(!0);this.isGliding(!1);this.isFlipping(!1)}};t.prototype._computeStartGlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();if(!e&&!t){this.panTransform(a.e.IDENTITY);this.isGliding(!0);this.isRotating(!0)}};t.prototype._computeEndGlide=function(){var e=this.isPowered.peek(),t=this.isGliding();if(!e&&t){this.isGliding(!1);this.isRotating(!1)}};t.prototype._computeEndRotation=function(){this.isRotating()||this.isFlipping(!0)};t.prototype._initializeDirection=function(){var e=this,t=this._index.peek();this.addDisposable(this.item.subscribe(function(){t=e._index.peek()},this,"beforeChange"));this.createBackgroundComputed(function(){e.isFlipping()&&(t=e._index.peek())});this.direction=this.createPureComputed(function(){var n=e._index();return e.isFlipping()&&n>-1&&t>-1?Math.max(-1,Math.min(1,n-t)):0})};t.prototype._initializeSlides=function(){var e=this,t=this.addDisposable(this._itemsInSlides.filter(function(t){return t&&(e._items.indexOf(t)>-1||t===e.item())}));this.slides=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=e.createObservable(0),r=e.createPureComputed(function(){return e._items.indexOf(t)}),i=e.createPureComputed(function(){return r()-e._index()}),s=e.createComputed(function(){i()||e.loadState(n())}),o=e.createPureComputed(function(){return e._itemHistory.indexOf(t)+1}),u=new(e.resources.injected(p))({item:t,offset:i,loadState:n,order:o});return{mappedValue:u,dispose:function(){u.dispose();i.dispose();r.dispose();s.dispose();o.dispose()}}}}))};t.prototype._computeAllocationRange=function(){var e=this.item(),t=this._items,n=t().length,r=this._itemsInSlides.peek(),i=t.indexOf(e),s=r.indexOf(e),o=this._slideAllocationCount();if((-1===s||i>=2&&s<2||i<=n-1-2&&s>r.length-1-2||n<=o&&n!==r.length)&&i>-1)if(o>1){var u=i+this.direction.peek()*(.8*(Math.floor(o/2)-2)),a=Math.max(0,Math.min(n-o,u-Math.floor(o/2))),f=Math.min(n,a+o);this._allocationRange({start:a,end:f})}else this._allocationRange({start:i,end:i+1})};t.prototype._computeItemsInSlides=function(){var e,t,n=this._allocationRange();if(this._index()>-1&&n.end-n.start>0)t=this._items.slice(n.start,n.end);else{var r=this.item();t=r?[r]:[]}(e=this._itemsInSlides).splice.apply(e,Object(s.__spreadArrays)([0,this._itemsInSlides.peek().length],t))};t.prototype._computeSwitchItemsOnItemRemoval=function(){var e=this.item.peek(),t=this._items.indexOf(e),n=this._lastValidIndex();if(-1===t&&e&&n>-1){var r=this._items.peek(),i=Math.max(0,Math.min(r.length-1,n));r[i]&&this.item(r[i])}};t.prototype._computeUpdateItemHistory=function(){var e=this.item();this._itemHistory.unshift(e)};t.prototype._computeCleanItemHistory=function(){this._itemHistory().length>1&&this._itemHistory.splice(1,this._itemHistory().length)};t.prototype._computeElementsToRemove=function(){this.item();this._itemsInSlides();for(var e;e=this._elementsToRemove.shift();)o.removeNode(e)};t.prototype._initializeVelocity=function(){var e=this,t=this.panTransform.peek(),n=0;this.velocity=this.createPureComputed(function(){var r=e.panTransform(),i=(new Date).getTime(),s=r.translate.subtract(t.translate).scale(1e3/(i-n));n=i;t=r;return s});this.velocity.equalityComparer=f.e};t.prototype._computeRotateToSlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();if(!e&&!t){var n=this.panTransform.peek().translate.negate(),r=this.velocity.peek().negate(),i=this._index.peek(),s=this._calculateFractionalIndexOffset(n,r)+n.x;this.item(this._items.peek()[Math.max(0,Math.min(this._items.peek().length-1,i+Math.round(s)))]);this.panTransform(new a.e(new u.e(this._index.peek(),0).subtract(new u.e(i,0).add(n))))}};t.prototype._calculateFractionalIndexOffset=function(e,t){var n=0;e.x>this._rotationThreshold&&e.x<.5?n+=.5:e.x<-this._rotationThreshold&&e.x>-.5&&(n-=.5);t.x>this._velocityThreshold&&e.x<.5?n+=.5:t.x<-this._velocityThreshold&&e.x>-.5&&(n-=.5);return n=Math.max(-1,Math.min(1,n))};t.prototype._computeCarouselTransform=function(){var e=this.panTransform().translate,t=this._items.peek().length,n=this._index.peek();if(-1===n){n=0;t=1}var r=-e.x,i=r,s=n+r;if(s<0||s>t-1){var o=r>0?Math.floor:Math.ceil,f=Math.max(0-n,Math.min(t-1-n,o(r))),l=Math.PI;i=Math.atan(l*(r-f))/l+f}return new a.e(new u.e(-i,e.y))};t.prototype._computeIndex=function(){return this._items.indexOf(this.item())};t.prototype._computeLastValidIndex=function(){var e=this._items.indexOf(this.item());if(e<0){var t=this._lastValidIndex.peek();if("number"==typeof t)return t}return e};t.prototype._computePlatformStyle=function(){var e="translate("+100*this.carouselTransform().translate.x+"%, 0)";return{"-ms-transform":e,"-webkit-transform":e,transform:e}};return t})(c.t),E=i.e({tagName:"ms-carousel",template:"<div class=\"Carousel\"><div class=\"Carousel-platform\" data-bind=\"template:{foreach:slides,beforeRemove:$component.onSlideRemoved.bind($component),dontLimitMoves:true},pan:panBindingParams,style:platformStyle,css:{'is-flipping':isFlipping,'is-rotating':isRotating,'is-enabled':isEnabled,'is-powered':isPowered,'is-gliding':isGliding,'is-rotating-forward':direction()>0,'is-rotating-backward':direction()<0}\"><div class=\"Carousel-slide\" data-bind=\"host:{},attr:{'data-item-offset':offset,'data-item-order':order,'data-item-direction':direction},css:{'is-current':item&&item===$component.item(),'is-loaded':!!loadState()}\"></div></div></div>",viewModel:w,synchronous:!0});t.e=E},2154:function(e,t,n){"use strict";var r=n(0),i=n(1224),s=n(1423),o=n(1378),u=n(1452),a=n(1396),f=n(1225),l=n(33),c=n(14),h=n(87),p=n(348),d=n(41),v=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="FileHandlerCreate";var r=n._fileHandlerAction=t.fileHandlerAction;n._itemProvider=n.resources.consume(f.resourceKey);n._urlDataSource=n.resources.consume(h.ge);r&&r.handler&&r.handler.isPromoted&&(n.name="PromotedFileHandlerCreate");return n}t.prototype.onIsAvailable=function(){if(!this._fileHandlerAction)return!1;var e=this._urlDataSource.getKeyParams(this.item().key);return this._urlDataSource.isCurrentQuery(d.e.Files,e)};t.prototype.onExecute=function(e,t){var n=this,r=this._fileHandlerAction;if(!r)return c.n.reject(new Error("No action registered for file handler"));var i=r.availableOn.file,s=i&&i.extensions&&i.extensions[0].replace(".","");if(!r.handler.isPromoted){var o=window.open("","_blank");o&&(o.opener=null)}var u=this.item.peek().key;return this._itemProvider.createCustomDocument(u,s).then(function(e){return e?n.resources.consumeAsync(p.t).then(function(t){return t.invokeAction({items:[e],action:r})}):c.n.wrapError()}).then(function(){return c.n.wrap({resultType:l.e.Success})},function(e){return c.n.wrap({resultType:c.n.isCanceled(e)?l.e.ExpectedFailure:l.e.Failure})})};return t})(a.e),m=n(1367),g=n(1377),y=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="FileHandlerCustom";var r=n._fileHandlerAction=t.fileHandlerAction;n._fileHandlerProvider=n.resources.consume(u.e);var i=r.availableOn;n._itemSelectionHelper=new(n.child(g.e))({overrideItem:t.item,allowMultiSelect:!!i.allowMultiSelect,canFallback:!!i.folder});r&&r.handler&&r.handler.isPromoted&&(n.name="PromotedFileHandlerCustom");return n}t.prototype.onIsAvailable=function(){if(!this._fileHandlerAction)return!1;var e=this._itemSelectionHelper.selection();return!!e&&!!e.length&&e.every(this._acceptItemObservable,this)};t.prototype.onExecute=function(e){var t,n=this,r=this._fileHandlerAction;if(!r)return c.n.reject("No action registered for file handler");if(!r.handler.isPromoted){if(!(t=window.open("","_blank")))return c.n.reject({resultType:l.e.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveSelection().then(function(e){n.resources.consumeAsync(p.t).then(function(n){return n.invokeAction({items:e,action:r,target:t})})}).then(function(){return c.n.wrap({resultType:l.e.Success})},function(e){return c.n.wrap({resultType:c.n.isCanceled(e)?l.e.ExpectedFailure:l.e.Failure})})};t.prototype._acceptItemObservable=function(e){var t=e.peek(),n=this._fileHandlerAction;return!(!n||!t.graph)&&(t.folder?!!n.availableOn.folder&&!t.isRootFolder:this._fileHandlerProvider.isActionForExtension(n,t.extension))};return t})(m.e),b=n(2264),w=n(138),E=n(152),S=n(1376),x=n(25),T=n(7),N=n(10);n.d(t,"e",function(){return k});var C=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t,n)||this,u=t.sourceEngagementName,a=t.item,f=t.includeLegacyActions;i._sourceEngagementName=u;i._overrideItem=a;var l=i.observables;i._legacyCommandMap=l.create({});i._commandViewModelType=i.managed(s.e);i._actionMap=n.actionMap;i._customActionProvider=n.customActionProvider;i._fileHandlerProvider=n.fileHandlerProvider;i._commonParams={renderLabel:2,location:10};f&&i._loadLegacyCommandMap();i._commandMap=l.pureCompute(i._computeCommandMap);i._fullCommandMap=l.pureCompute(i._computeFullCommandMap);i._flatten=l.pureCompute(i._computeFlatten);i.newFileCommands=l.pureCompute(i._computeNewFileCommands);i.openWithCommands=l.pureCompute(i._computeOpenWithCommands);var c=l.createArray(),h=i.scope.attach(c.filter(function(e){return e.isVisible()}));i.actionsCommand=new i._commandViewModelType({text:S.e.Actions,icon:l.pureCompute(function(){return h().length>1?new o.e("SetAction"):void 0}),renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!0,children:c});var p=l.pureCompute(i._computeCustomCommands);l.backgroundCompute(function(){c.splice.apply(c,Object(r.__spreadArrays)([0,1/0],p()))});return i}t.prototype._computeNewFileCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.create.map(this._createNewFileCommand,this):[]};t.prototype._createNewFileCommand=function(e,t){var n=e.handler,r={text:e.handler.fileTypeDisplayName||x.format(S.e.CreateFileWithExtension,e.availableOn.file.extensions[0]),action:new(this.managed(v))({fileHandlerAction:e}),renderLabel:2,engagementName:"FileHandlerCreate",source:this._sourceEngagementName};0===t&&(r.hasLineBreakBefore=!0);var i=this._fileHandlerProvider.getIconUrl(e.icon||n.fileTypeIcon);i?r.iconUrl=i:r.icon=new o.e("Page");return new this._commandViewModelType(r)};t.prototype._computeOpenWithCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.open.map(this._createOpenFileCommand,this):[]};t.prototype._createOpenFileCommand=function(e){var t=e.handler,n={fileHandlerAction:e};this._overrideItem&&(n.item=this._overrideItem);var r={text:e.displayName||x.format(S.e.OpenWithFileHandler,t.displayName),collapsedText:this.createObservable(S.e.Open),action:new(this.managed(b.e))(n),renderLabel:2,engagementName:t.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",source:this._sourceEngagementName,iconUrl:this._fileHandlerProvider.getIconUrl(e.icon||t.fileTypeIcon)};return new this._commandViewModelType(r)};t.prototype._computeCommandMap=function(){for(var e=this,t=this._fileHandlerProvider,n=t?t.data().actions.custom:[],i=this._commonParams,s={},o=this.observables,u=function(n){var u=n.handler,f=u.appId,l=s[f]||(s[f]=new a._commandViewModelType(Object(r.__assign)(Object(r.__assign)({},i),{iconUrl:t.getIconUrl(u.appIcon),text:u.actionMenuDisplayName||u.displayName,requiredChildren:1,collapseSingleChildCommands:!0}))),c=new a._commandViewModelType(Object(r.__assign)(Object(r.__assign)({},i),{text:o.pureCompute(function(){return!e._flatten()&&n.shortDisplayName||n.displayName}),collapsedText:o.create(n.displayName),iconUrl:t.getIconUrl(n.icon),action:new(a.managed(y))({fileHandlerAction:n}),engagementName:"FileHandlerCustom",source:a._sourceEngagementName}));l.children.push(c)},a=this,f=0,l=n;f<l.length;f++){u(l[f])}return s};t.prototype._loadLegacyCommandMap=function(){var e=this,t=this._customActionProvider,n=this._actionMap;t&&n&&t.getCustomActionData().then(function(i){var s={},o=[],u=i.ContextMenu;if(u&&0!==u.length){for(var a=e._commandViewModelType,f=e.managed(n.CustomActionNavigationAction),l=e.observables,c=e._commonParams,h=0,p=u;h<p.length;h++){var d=p[h],v=Object(r.__assign)(Object(r.__assign)({},c),{text:d.text});if(t.isGroup(d)){var m=d.children.map(function(e){return new a({text:e.text,engagementName:"CustomActionRibbonTab",iconUrl:e.iconUrl,renderLabel:2,action:new f({customAction:e})})});o.push(new a(Object(r.__assign)(Object(r.__assign)({},v),{tooltip:d.tooltip,requiredChildren:1,children:l.createArray(m)})))}else o.push(new a(Object(r.__assign)(Object(r.__assign)({},v),{iconUrl:d.iconUrl,engagementName:"CustomActionECB",action:new f({customAction:d})})))}s["Add-ins"]=new a(Object(r.__assign)(Object(r.__assign)({},c),{text:S.e.AddIns,children:l.createArray(o),requiredChildren:1}));e._legacyCommandMap(s)}})};t.prototype._computeFullCommandMap=function(){return Object(r.__assign)(Object(r.__assign)({},this._commandMap&&this._commandMap()||{}),this._legacyCommandMap&&this._legacyCommandMap()||{})};t.prototype._computeCustomCommands=function(){var e=this._fullCommandMap(),t=[],n=[],r=this._flatten();for(var i in e){for(var s=e[i],o=s.visibleChildren(),u=0,a=o;u<a.length;u++){var f=a[u];f.parentCommand=r?void 0:s;r&&(f.visibleChildren().length>1?t:n).push(f)}!r&&s.isVisible()&&(o.length>1?t:n).push(s)}return t.concat(n)};t.prototype._computeFlatten=function(){var e=this._fullCommandMap(),t=0,n=0,r=0;for(var i in e){var s=e[i].visibleChildren().length;s>1&&r++;s&&n++;t+=s;if(r>0&&n>1&&t>4)return!1}return!0};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{actionMap:w.e.optional,customActionProvider:E.t.optional,fileHandlerProvider:u.e.optional});return t})(i.default),k=new T.t({name:"FileHandlerCommands_4",factory:new N.r(C)})},2174:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(10),s=new r.t({name:"ItemActionBar.key_6",loader:new i.t(function(){return n.e("93").then(n.bind(null,2867)).then(function(e){return e.resourceKey.local})})})},2265:function(e,t,n){"use strict";var r=n(0),i=n(1372),s=n(398),o=n(1362),u=n(134),a=4e3,f=window.navigator,l=f&&f.pointerEnabled,c=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.valueAccessor();r._isIdle=i.isIdle||o.observable(!1);r._isEnabled=i.isEnabled||o.observable(!0);r._isInIdleZone=o.observable(!1);r._idleZoneElement=i.idleZoneElement||r.element;r._shouldClicksWake=i.shouldClicksWake;r._lastTouchPosition=null;r._lastMousePosition=null;r._lastPointerExitPosition=null;r._pointerCount=0;r._pointers={};r._isMouseDown=!1;r._isSuspended=!1;r._idle=r.createComputed(r._computeIdle).extend({rateLimit:{timeout:a,method:"notifyWhenChangesStop"}});r.createComputed(r._computeAwakenWhenNotEnabled);r.createComputed(r._computeSuspendIdleEvents);r.events.on(r._idleZoneElement,"click",r._onClick);r.events.on(document,"mousedown",r._onMouseDown,!0);r.events.on(document,"mousemove",r._onMouseMove,!0);r.events.on(document,"mouseup",r._onMouseUp,!0);r.events.on(document,"mouseout",r._onMouseOut,!0);r.events.on(document,"mousewheel",r._onMouseWheel,!0);r.events.on(window,"blur",r._onWindowBlur,!0);r.events.on(window,"focus",r._onWindowFocus,!0);if(l){r.events.on(document,"pointerdown",r._onPointerDown,!0);r.events.on(document,"pointermove",r._onPointerMove,!0);r.events.on(document,"pointerup",r._onPointerUp,!0);r.events.on(document,"pointercancel",r._onPointerCancel,!0);r.events.on(document,"lostpointercapture",r._onLostPointerCapture,!0)}else{r.events.on(document,"touchstart",r._onTouchStart,!0);r.events.on(document,"touchmove",r._onTouchMove,!0);r.events.on(document,"touchend",r._onTouchEnd,!0);r.events.on(document,"touchcancel",r._onTouchCancel,!0)}return r}t.prototype._computeIdle=function(){var e=this._isIdle(),t=this._isInIdleZone(),n=this._isEnabled();!e&&t&&n&&this._isIdle(!0)};t.prototype._computeAwakenWhenNotEnabled=function(){this._isEnabled()||this._isIdle(!1)};t.prototype._resetPosition=function(){this._lastMousePosition=null;this._lastTouchPosition=null};t.prototype._onClick=function(e){if(0===e.button){var t=this._lastMousePosition,n=new s.e(e.clientX,e.clientY);this._resetPosition();if(!(t&&n.distance(t)>=10)){this._isInIdleZone(!0);!this._isSuspended&&this._isEnabled.peek()&&(this._shouldClicksWake?this._isIdle(!1):this._isIdle(!this._isIdle.peek()))}}};t.prototype._onMouseDown=function(e){if(0===e.button){this._isMouseDown=!0;var t=new s.e(e.clientX,e.clientY);this._lastMousePosition=t}};t.prototype._onMouseMove=function(e){var t=this._lastTouchPosition,n=this._lastMousePosition,r=new s.e(e.clientX,e.clientY);if(!(t&&r.distance(t)<10)){var i=(function(e,t){for(;e;){if(e===t)return!0;e=Object(u.e)(e)}return!1})(e.target,this._idleZoneElement);this._isInIdleZone(i);if(!this._isMouseDown&&!this._pointerCount&&n&&r.distance(n)>=10){this._resetPosition();!this._isSuspended&&this._isEnabled.peek()&&this._isIdle(!1)}this._lastMousePosition||(this._lastMousePosition=r)}};t.prototype._onMouseUp=function(e){0===e.button&&(this._isMouseDown=!1)};t.prototype._onMouseOut=function(e){if(!this._isMouseDown){var t=this._lastPointerExitPosition,n=new s.e(e.clientX,e.clientY);this._resetPosition();this._lastPointerExitPosition=null;if(!(t&&n.distance(t)<10)&&(function(e){var t=e.relatedTarget||e.toElement;return!t||"HTML"===t.nodeName})(e)){var r=this._isInIdleZone.peek();this._isInIdleZone(!0);r&&this._idle()}}};t.prototype._onMouseWheel=function(e){this._isIdle(!1)};t.prototype._onWindowBlur=function(e){this._isIdle(!0)};t.prototype._onWindowFocus=function(e){this._isIdle(!1)};t.prototype._onTouchStart=function(e){this._pointerCount+=e.changedTouches.length;this._trackTouch(e);this._lastMousePosition=this._lastTouchPosition};t.prototype._onTouchMove=function(e){this._trackTouch(e)};t.prototype._onTouchEnd=function(e){this._pointerCount-=e.changedTouches.length;this._trackTouch(e)};t.prototype._onTouchCancel=function(e){this._pointerCount-=e.changedTouches.length};t.prototype._trackTouch=function(e){this._lastTouchPosition=new s.e(e.changedTouches[0].clientX,e.changedTouches[0].clientY)};t.prototype._onPointerDown=function(e){if("mouse"!==e.pointerType&&!this._pointers[e.pointerId]){this._pointerCount++;this._trackPointer(e);this._lastMousePosition=this._lastTouchPosition}};t.prototype._onPointerMove=function(e){"mouse"!==e.pointerType&&this._pointers[e.pointerId]&&this._trackPointer(e)};t.prototype._onPointerUp=function(e){if("mouse"!==e.pointerType){this._trackPointer(e);this._removePointer(e)}};t.prototype._onPointerCancel=function(e){if("mouse"!==e.pointerType){this._trackPointer(e);this._removePointer(e)}};t.prototype._onLostPointerCapture=function(e){"mouse"!==e.pointerType&&this._removePointer(e)};t.prototype._trackPointer=function(e){var t=new s.e(e.clientX,e.clientY);this._pointers[e.pointerId]=t;this._lastTouchPosition=t};t.prototype._removePointer=function(e){if(this._pointers[e.pointerId]){this._lastPointerExitPosition=this._pointers[e.pointerId];delete this._pointers[e.pointerId];this._pointerCount--}};t.prototype._computeSuspendIdleEvents=function(){this._isIdle();this._isSuspended=!0;this.async.clearTimeout(this._suspendIdleEventsTimeoutId);this._suspendIdleEventsTimeoutId=this.async.setTimeout(this._onSuspensionCompleted,500)};t.prototype._onSuspensionCompleted=function(){this._isSuspended=!1};return t})(i.t);t.e=c},2266:function(e,t,n){"use strict";var r=(function(){function e(){}e.isFullScreen=function(){var e=window.document;return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement};e.enterFullScreen=function(){var t=window.document.body;e.isFullScreen()||(t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen())};e.exitFullScreen=function(){var e=window.document;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()};e.isFullScreenAllowed=function(){var e=window.document;return e.fullscreenEnabled||e.webkitFullscreenEnabled||e.mozFullScreenEnabled||e.msFullscreenEnabled};return e})();t.e=r},2268:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={defaultValue:-1/0,reducer:function(e,t){return e>0?t:t>0?e:Math.max(e,t)}}},2269:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(1878),s=new r.t({name:"PaneProvider.key_6",factory:i.e})},2270:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1224),i=new(n(7).t)({name:"FocusedInfoPaneSection.key_4",factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(),disposable:t}}}})},2356:function(e,t,n){"use strict";var r=n(122);Object(r.n)([{rawString:".OneUp-slide{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-slide:after,.OneUp-slide:before{display:block;position:absolute;width:2%;height:100%;content:''}html[dir=ltr] .OneUp-slide:before{right:100%}html[dir=rtl] .OneUp-slide:before{left:100%}html[dir=ltr] .OneUp-slide:after{left:100%}html[dir=rtl] .OneUp-slide:after{right:100%}.od-OneUpVideo{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-other{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.OneUp-other .OneUp-other-content{text-align:center}.OneUp-other .OneUp-other-content .OneUp-other-fileName{font-size:21px}.OneUp-other .OneUp-other-content .OneUp-other-download{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-other .OneUp-other-content .OneUp-other-message{margin-top:15px;margin-bottom:15px}.OneUp-other .OneUp-other-content .OneUp-other-actions .od-ButtonBar-main{float:none}.OneUp-other .OneUp-other-content .OneUp-other-fileIcon .FileTypeIcon{outline:0}.OneUp-other .OneUp-other-content .od-ButtonBarCommand:not(.od-Button--primary){background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.OneUp-photo .od-Projector--live .od-ImageTile-background{transition:max-width 267ms cubic-bezier(.1,.9,.2,1),max-height 267ms cubic-bezier(.1,.9,.2,1)}.OneUp-photo .od-Projector--live.od-Projector--panning .od-ImageTile-background{transition-duration:0s,0s}.OneUp-otherTile{width:240px;height:240px;margin:auto;position:relative}.OneUp-fileHandler,.OneUp-fileHandler-frame{border:0;width:100%;height:100%}.OneUp-other-malwareDetectedIcon{height:208px;width:208px}"}]);var i=n(1363),s=n(0),o=n(1361),u=n(1661),a=n(82),f=n(33),l=n(345),c=n(1366),h=n(502),p=n(7),d=n(10),v=new p.t({name:"OneUp3d.key_6",loader:new d.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("91")]).then(n.bind(null,3957)).then(function(e){return e.resourceKey.local})})}),m=n(1576),g=n(1748),y=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:c.n});var i=t.slide.item.peek(),s=i&&i.error&&i.error.data,o=t.slide.renderOptions,u=t.showErrorActions,a=void 0===u||u;r.errorComponent={specification:Object(c.r)(g.resourceKey,{error:s,hideAction:!!o||!a}),afterRender:function(){return r._activate()}};return r}t.prototype._activate=function(){var e=this.slide,t=e.item.peek(),n=t&&t.error&&t.error.data,r=this.observables.create({resultType:f.e.Failure,resultCode:""+n.errorCode,error:n&&n.errorDetailedText,extraData:{CorrelationId:n&&n.correlationId}});this.scope.attach(e.loadResult.register(r));e.loadState(3)};return t})(m.e),b=Object(c.t)({automationName:"od-one-up-error",name:"OneUpError_6",template:'<div class="OneUp-error" data-bind="control:errorComponent"></div>',viewModelType:y}),w=new p.t({name:"OneUpFileHandler.key_6",loader:new d.t(function(){return n.e("92").then(n.bind(null,3956)).then(function(e){return e.resourceKey.local})})});Object(r.n)([{rawString:".OneUp-html{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUp-html.iOS{overflow:auto}.OneUp-html iframe{width:100%;height:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15);overflow:auto;-webkit-overflow-scrolling:touch}"}]);var E=n(1524),S=n(14),x=n(298),T=n(1604),N=n(2044),C=n(1880),k=n(1716),L=n(87),A=n(259),O=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:c.n,iframe:C.e});var i=r,o=i.observables,u=i.slide,a=Object(s.__assign)(Object(s.__assign)({},u),{loadResult:o.createCallback(Object(E.t)())}),f=n.platformDetection.isIOS;r.className=f?"iOS":"";r.showError=o.create(!1);r.showHtml=o.pureCompute(r._computeShowHtml);r.fallbackControl=Object(c.r)(k.e,{slide:a,oneUp:r.oneUp});r.iframeOptions=o.create();r._downloadDataSource=n.downloadDataSource;r._graphDataSource=n.graphDataSource;var l=r._loadResult=o.create();r.scope.attach(u.loadResult.register(l));r._populateContent(f);return r}t.prototype._computeShowHtml=function(){return!this.slide.offset()&&!!this.iframeOptions()};t.prototype._populateContent=function(e){var t=this,n=this.slide.item.peek();this.showError(!1);this.trackPromise(this._getContents(n).then(function(n){if(n){var r=Object(h.isFeatureEnabled)(h.OneUpHtmlAllowPopups)?"allow-popups":"",i=Object(h.isFeatureEnabled)(h.AllowCompatLegacyHtmlScripts)?"allow-scripts":"";t.iframeOptions({type:"content",sandbox:r+" "+i,content:n,onLoad:function(n){t.slide.loadState(3);t._loadResult({resultType:f.e.Success});var r=n.target;if(e&&r){var i=r.clientWidth,s=r.clientHeight;r.style.width=i+"px";r.style.height=s+"px"}}})}else{t._loadResult({resultType:f.e.ExpectedFailure,resultCode:"NoContent",error:"HTML is empty"});t._showError()}},function(e){t._loadResult({resultType:e&&e.isExpected?f.e.ExpectedFailure:f.e.Failure,resultCode:e&&(e.code||e.name),error:e&&e.message});t._showError()}))};t.prototype._showError=function(){this.showError(!0);this.slide.loadState(3)};t.prototype._getContents=function(e){var t=e.extension,n=e.htmlConversion,r=t&&t.toLowerCase();if(n&&!(".htm"===r||".html"===r||".svg"===r)){var i=this._graphDataSource,s=n.url||i.getAuthenticationParams(e).then(function(t){return i.getItemUrl(e,{useDirectEndpoint:!0})+"/content?format=html&"+Object(x.e)(t)});return S.n.resolve(s).then(function(e){return T.e.startAndPostProcess({url:e},function(e,t){return e.responseText})}).catch(function(e){if(e instanceof XMLHttpRequest){var t=new Error("HTTP "+e.status),n=e.getResponseHeader("X-ErrorCode");t.code=""+(n||e.status);t.isExpected=406===e.status;return S.n.reject(t)}return S.n.reject(e)})}return this._downloadDataSource.getItemContents(e).then(function(e){return N.t(e,"text/html")}).then(function(e){return e.text})};t.dependencies=Object(s.__assign)(Object(s.__assign)({},m.e.dependencies),{downloadDataSource:L.a,graphDataSource:L.b,platformDetection:A.e});return t})(m.e),M=Object(c.t)({automationName:"od-one-up-html",name:"OneUpHtml_6",template:'\x3c!--ko if:showError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showHtml--\x3e<div class="OneUp-html" data-bind="iframe:iframeOptions,class:className" style="-webkit-overflow-scrolling: touch;"></div>\x3c!--/ko--\x3e',viewModelType:O}),_=new p.t({name:"OneUpImage360.key_6",loader:new d.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("90")]).then(n.bind(null,3954)).then(function(e){return e.resourceKey.local})})}),D=new p.t({name:"OneUpPanorama.key_6",loader:new d.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("94")]).then(n.bind(null,3916)).then(function(e){return e.resourceKey.local})})});Object(r.n)([{rawString:".od-Projector{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden}.od-Projector-image{position:absolute;left:0;top:0;width:100%;height:100%;transform-origin:0 0;touch-action:none;will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.od-Projector--gliding.od-Projector--preview .od-Projector-image{transition:transform 267ms cubic-bezier(.1,.9,.2,1)}.od-Projector--gliding.od-Projector--live .od-Projector-image{transition:left 267ms cubic-bezier(.1,.9,.2,1),top 267ms cubic-bezier(.1,.9,.2,1),width 267ms cubic-bezier(.1,.9,.2,1),height 267ms cubic-bezier(.1,.9,.2,1)}"}]);var P,H=n(1434),B=n(1830),j=n(1660),F=n(1754),I=n(708),q=n(913),R=n(398),U=n(1777),z=new I.e(0,0,1,1),W=z.getCenter(),X=.5,V=!0;(function(e){e[e.live=0]="live";e[e.preview=1]="preview"})(P||(P={}));var $=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({host:H.e,pan:B.t,clientRect:j.e});var i=t.isZoomed,s=void 0===i?r.createObservable(!1):i,o=t.isEnabled,u=void 0===o?r.createObservable(!0):o,a=t.mode,f=void 0===a?P.live:a;r.panTransform=r.createObservable(F.e.IDENTITY);r.panTransform.equalityComparer=B.e;r.contentTransform=r.createObservable(F.e.IDENTITY);r.contentTransform.equalityComparer=B.e;r.imageTransform=r.createObservable(F.e.IDENTITY);r.imageTransform.equalityComparer=B.e;r.isPanning=r.createObservable(!1);r.isGliding=r.createObservable(!1);r.isZoomed=s;r.isEnabled=u;r.size=r.createObservable();r._lastZoomTogglePosition=null;r._mode=f;r.mode=P[r._mode];r.createBackgroundComputed(r._computeResetGlide);r.createBackgroundComputed(r._computePreviewTransform);r.createBackgroundComputed(r._computeCommitTransform);var l=r.createBackgroundComputed(r._computeStartGlide);r.createBackgroundComputed(r._computeEndGlide).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});var c=r.createBackgroundComputed(r._computeApplyTransformOnZoomed);r.createBackgroundComputed(r._computeResetZoomOnTransformed);r.imageStyle=r.createPureComputed(r._computeImageStyle,{deferEvaluation:!0});if(!n||!n.disableFrameSkip){U.e(l,r.async);U.e(c,r.async)}r.host={transform:r._mode===P.live?r.panTransform:r.contentTransform,isGliding:r.isGliding};return r}t.prototype.toggleIsZoomed=function(e,t){var n=this.size.peek(),r=n&&new R.e(t.clientX/n.width,t.clientY/n.height)||W;this._lastZoomTogglePosition=r;this.isZoomed(!this.isZoomed())};t.prototype.mayStartPan=function(e,t,n){return this.isEnabled.peek()&&(Math.abs(t)>=10&&n.length>=2||this.isZoomed.peek()&&e.translate.abs()>=10)};t.prototype.constrainPanScale=function(e){return Math.max(1,Math.min(4,e))};t.prototype._computeResetGlide=function(){if(this.isPanning()){this.isGliding(!1);this.isZoomed(!0)}};t.prototype._computePreviewTransform=function(){if(this.isPanning()){var e=this.panTransform();e=J(e,!0);this.imageTransform(this.contentTransform().invert().multiply(e))}};t.prototype._computeCommitTransform=function(){if(!this.isPanning()&&!this.isGliding.peek()){var e=this.panTransform.peek();e=e.scale<F.e.IDENTITY.scale?F.e.IDENTITY:J(e);this._applyTransform(e)}};t.prototype._computeStartGlide=function(){if(!this.isPanning()&&!F.e.areEqual(this.imageTransform(),F.e.IDENTITY)){this.isGliding(!0);this.imageTransform(F.e.IDENTITY)}};t.prototype._computeEndGlide=function(){var e=this.isPanning(),t=this.isGliding();!e&&t&&this.isGliding(!1)};t.prototype._computeApplyTransformOnZoomed=function(){var e=this.isZoomed(),t=this.isEnabled(),n=this.isPanning.peek(),r=this.contentTransform.peek();n||(e&&t?F.e.areEqual(r,F.e.IDENTITY)&&this._applyTransform(F.e.zoom(R.e.ORIGIN,this._lastZoomTogglePosition||W,3)):F.e.areEqual(r,F.e.IDENTITY)||this._applyTransform(F.e.IDENTITY));this._lastZoomTogglePosition=null};t.prototype._computeResetZoomOnTransformed=function(){var e=this.isPanning(),t=this.contentTransform();!e&&F.e.areEqual(t,F.e.IDENTITY)&&this.isZoomed(!1)};t.prototype._computeImageStyle=function(){var e=this.contentTransform(),t=this.imageTransform();if(this._mode===P.live){var n=e.multiply(t);return{left:100*n.translate.x+"%",top:100*n.translate.y+"%",width:100*n.scale+"%",height:100*n.scale+"%"}}var r="translate("+100*t.translate.x+"%, "+100*t.translate.y+"%)";return{left:100*e.translate.x+"%",top:100*e.translate.y+"%",width:100*e.scale+"%",height:100*e.scale+"%","-ms-transform":r,"-webkit-transform":r,transform:r}};t.prototype._applyTransform=function(e){var t=this.contentTransform.peek().multiply(this.imageTransform.peek());this.contentTransform(e);this.imageTransform(e.invert().multiply(t));this.panTransform(e)};return t})(o.t);function J(e,t){void 0===t&&(t=!1);var n=Math.max(F.e.IDENTITY.scale,e.scale),r=new I.e(e.apply(W).subtract(new R.e(n,n).scale(X)),new q.e(n,n)),i=z,s=i.nudge(r),o=i.getCenter().subtract(s.getCenter());t&&V&&(o=o.unit().scale(o.abs()-Math.atan(Math.PI*o.abs())/Math.PI*Math.log(e.scale/F.e.IDENTITY.scale)));return new F.e(o).multiply(e)}var K=i.e({tagName:"od-projector",template:'<div class="od-Projector" data-bind="class:\'od-Projector--\'+mode,css:{\'od-Projector--gliding\':isGliding,\'od-Projector--panning\':isPanning},pan:{isActive:isPanning,transform:panTransform,mayStartPan:$component.mayStartPan.bind($component),constrainScale:$component.constrainPanScale.bind($component)},clientRect:{size:size},event:{dblclick:$component.toggleIsZoomed.bind($component)}"><div class="od-Projector-image" data-bind="style:imageStyle,host:{data:host}"></div></div>',viewModel:$,synchronous:!0}),Q=n(1858),G=n(1177),Y=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:c.n});r.slide.isEditCaptionEnabled(!0);var i=t.item,s=void 0===i?r.slide.item:i;r._item=s;r._isZoomed=r.createObservable(!1);var o={isEnabled:r.createPureComputed(function(){return!r.slide.offset()&&!r.oneUp.isRotating()}),isZoomed:r._isZoomed};r.projector={name:K.tagName,params:o};r.createBackgroundComputed(r._computeChangesOnZoom);return r}t.prototype.getThumbnailControl=function(e){var t=this,n=e.transform,r=e.isGliding,i=this.createPureComputed(function(){return n().scale}),s=this.createPureComputed(function(){var e=t.oneUp.size();return{width:e.width*n().scale,height:e.height*n().scale}});s.equalityComparer=G.e;var o=this.createPureComputed(function(){return!r()});return Object(c.r)(Q.e,{slide:this.slide,oneUp:this.oneUp,size:s,scale:i,fallbackThumbnail:this.createPureComputed(this._computeFallbackThumbnail),allowLoading:o,item:this._item})};t.prototype._computeFallbackThumbnail=function(){var e=this._item().photo;if(e){var t=e.originalUrl,n=e.width,r=e.height;if(t)return{url:t,width:n,height:r}}};t.prototype._computeChangesOnZoom=function(){var e=this._isZoomed();this.slide.isPanningEnabled(!e)};return t})(m.e),Z=Object(c.t)({automationName:"od-one-up-photo",name:"OneUpPhoto_6",template:'<div class="OneUp-photo" data-bind="component:projector">\x3c!--ko control:getThumbnailControl($host)--\x3e\x3c!--/ko--\x3e</div>',viewModelType:Y});n(843).e.addConfig({map:{"*":{"../build/pdf.js":"pdfjs-dist/build/pdf"}}});var ee=new p.t({name:"OneUpPdf.key_6",loader:new d.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("95")]).then(n.bind(null,3935)).then(function(e){return e.resourceKey.local})})}),te=new p.t({name:"OneUpTextFile.key_6",loader:new d.t(function(){return n.e("96").then(n.bind(null,3917)).then(function(e){return e.resourceKey.local})})}),ne=new p.t({name:"OneUpVideo.key_6",loader:new d.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("97")]).then(n.bind(null,3889)).then(function(e){return e.resourceKey.local})})}),re=new p.t({name:"OneUpWAC.key_6",loader:new d.t(function(){return n.e("98").then(n.bind(null,3934)).then(function(e){return e.resourceKey.local})})}),ie=new p.t({name:"OneUpWrs.key_6",loader:new d.t(function(){return n.e("99").then(n.bind(null,3910)).then(function(e){return e.resourceKey.local})})}),se=new p.t({name:"OneUpZip.key_6",loader:new d.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("100")]).then(n.bind(null,3932)).then(function(e){return e.resourceKey.local})})}),oe=n(828),ue=n(1452),ae=n(1881),fe=n(1829),le={"3d":v,Audio:ne,Error:b,FileHandler:w,Html:M,Other:k.e,Panorama:D,Image360:_,Pdf:ee,Photo:Z,TextFile:te,Thumbnail:Q.e,Video:ne,WAC:re,Wrs:ie,Zip:se},ce=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:c.n});r._offset=t.slide.offset;var i=r._oneUp=t.oneUp,s=t.renderOptions,o=r.observables,u=r._loadResult=o.createCallback({defaultValue:void 0,reducer:de});t.loadResult&&r.scope.attach(t.loadResult.register(u));r.slide={loadState:t.slide.loadState,offset:r._getSlideOffset(),item:t.slide.item,isIdleEnabled:o.create(!0),isEditCaptionEnabled:o.create(!1),isPanningEnabled:o.create(!s),hasHorizontalScrollbar:o.create(!1),hasVerticalScrollbar:o.create(!1),isFirstSlideOpened:o.create(!1),commandSet:o.create(),augmentCommandSet:o.create(),loadResult:u,renderOptions:s};var a=r.resources;r._fileHandlerProvider=a.consume(ue.e.optional);var f=a.consume(A.e);r._enableHTML=Object(h.isFeatureEnabled)(h.UseSandboxHtmlViewer)&&(Object(fe.e)()||f.isEdge);r._enablePdf=Object(h.isFeatureEnabled)(h.UseWebPdfViewer);r._enableImage360=Object(h.isFeatureEnabled)(h.Image360Viewer)&&!f.isMobile;r._enablePriority=Object(h.isFeatureEnabled)(h.SlidePriority);var l=r.priority=o.pureCompute(r._computePriority);r.scope.attach(i.currentPriority.register(l));r.name=o.pureCompute(r._computeName);r.name.equalityComparer=oe.t;r.key=o.pureCompute(r._computeKey);r.key.equalityComparer=oe.t;r.component=o.pureCompute(r._computeComponent);r._qos=o.compute(r._computeQos);o.compute(r._computeUpdateOneUpSlide);o.backgroundCompute(r._computeCompleteQos);return r}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0)};t.prototype._computeComponent=function(){var e=this.key(),t={slide:this.slide,oneUp:this._oneUp};return e&&Object(c.r)(e.bypass,t)};t.prototype._computeName=function(){var e=this.slide.item(),t=this._extension(e),n=(this.slide.renderOptions||{}).viewer;return!e||e.isPlaceholder?void 0:e.error?"Error":3===e.itemStatus||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected?"Other":n||(e.officeBundle?"Wrs":e.wopiFrameUrl?"WAC":this._hasFileHandler(e,t)?"FileHandler":this._enableHTML&&e.htmlConversion?"Html":this._enablePdf&&(".pdf"===t||".ai"===t||e.pdfConversion)?"Pdf":e.video?"Video":e.audio?"Audio":e.panorama?"Panorama":this._enableImage360&&e.image360?"Image360":e.model3d?"3d":e.zip?"Zip":this._useTextEditor(e)?"TextFile":e.photo?"Photo":e.thumbnail?"Thumbnail":"Other")};t.prototype._computeKey=function(){if(this._enablePriority){if(this.priority()<this._oneUp.currentPriority())return}var e=this.name();return e&&le[e]};t.prototype._computePriority=function(){var e=this.slide,t=e.loadState()>=3,n=e.offset(),r=(n>0?n:n<0?-n:0)+1;return t?r:-r};t.prototype._useTextEditor=function(e){return Object(h.isFeatureEnabled)(h.UseOneUpTextEditor)&&Object(ae.r)(e)};t.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""};t.prototype._hasFileHandler=function(e,t){var n=this._fileHandlerProvider;return!!n&&(!!e.graph&&!!n.getDefaultPreviewHandler(t))};t.prototype._computeUpdateOneUpSlide=function(){this._offset()?this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0):this._oneUp.slide(this.slide)};t.prototype._getSlideOffset=function(){var e=this,t=this.createPureComputed(function(){var n=t.peek();return void 0!==n&&e._oneUp.isRotating()?n:e._offset()});return t};t.prototype._computeQos=function(){var e=this.slide,t=this._qosValue,n=this.name();if(n){if(t&&t.loaded.data.extraData.viewer===n)return t;if(!e.offset()&&!(e.loadState()>0||e.loadResult())){var r=e.item.peek(),i=r.size,o=e.renderOptions,f=o&&o.qosEvent,l=r.urls?r.urls[u.t.mediaBaseUrl]:"",c=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},f&&f.data.extraData||{}),l?{mediaServiceRegion:l}:{}),{viewer:n,extension:this._extension(r),fileSize:i,fileSizeRange:he(i)});return this._qosValue={loaded:new a.e({name:"LoadSlide",extraData:c}),loaded2:new a.e({name:"ItemViewer."+n+".Load",extraData:c}),rendered:new a.e({name:"ItemViewer."+n+".Render",extraData:c})}}}};t.prototype._computeCompleteQos=function(){var e=this.slide;if(!e.offset()){var t=this._qos();if(t){var n=t.loaded,r=t.loaded2,i=t.rendered,o=this.name.peek(),u=e.item.peek(),a={extension:this._extension(u),fileSizeRange:he(u.size),viewer:o},c=this.key(),h=e.loadState();c&&h>=1&&i.end({resultType:f.e.Success,extraData:Object(s.__assign)(Object(s.__assign)({},i.data.extraData),a)});var p=this._loadResult();if(c&&p){var d=e.renderOptions,v=d&&d.qosEvent,m=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},n.data.extraData),a),p.extraData||{}),g=Object(s.__assign)(Object(s.__assign)({},p),{extraData:m});n.end(g);r.end(g);v&&v.end(g);if(this._oneUp.shareLinkId){var y={};try{y.previewLoaded=Date.now();y.navigationStart=performance.timing.navigationStart;y.redirectStart=performance.timing.redirectStart;y.redirectEnd=performance.timing.redirectEnd}catch(e){}var b=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},p),m),y),{slrid:this._oneUp.shareLinkId});this.resources.consume(l.e).logData({name:"ShareLinkClicked.PreviewLoaded",extraData:b})}}}}};return t})(o.t);function he(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return(1<<t%10)+"-"+(1<<t%10+1)+(t<10?" B":" "+"KMGTPEZY"[t/10-1|0]+"iB")}function pe(e){e&&(e=(e=e.replace(/(tempauth|token|authkey)=[^&'"]+/g,"token=*")).replace(/[\w-]+:\/\/\S+/g,"*URI*"));return e}function de(e,t){return t&&Object(s.__assign)(Object(s.__assign)({},t),{error:pe(t.error)})}var ve=i.e({tagName:"od-one-up-slide",template:'<div class="OneUp-slide" data-bind="control:component" role="presentation"></div>',viewModel:ce,synchronous:!0});t.e=ve},3969:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1),s=n(1803),o=n(1366),u=n(1265),a=n(7),f=n(1224),l=n(828),c=n(10),h=n(408),p=n(266),d=n(75),v=n(1984),m=n(848),g=n(87),y=n(1676),b=n(1871),w=n(2039),E=n(580),S=n(406),x=n(593),T=n(43),N=n(54),C=n(12),k=2,L=[];function A(e){return e&&e.length?e:L}function O(e,t,n){return e.isItemFacetResolved(t,n)&&e.demandItemFacet(t,n)}var M=n(362),_=new y.e,D=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=n.itemsScopeItemKey,s=n.urlDataSource,o=n.itemCacheObservablesFactory,u=r.observables,a=function(e){var t=e.demandItemFacet(M.e,i),n=s.getFocusItemKey(t),r=n&&s.getKeyParams(n);if(r){var o=e.demandItemFacet(x.e,T.n),u=x.e.evaluate(o)(e,{viewParams:r,isNavigation:!1}).itemKey;return u?Object(h.e)(e,{itemKey:u}):void 0}},f=o.pureCompute(function(e){var t=a(e);return e.demandItemFacet(E.t,t)});f.equalityComparer=l.t;var c=o.pureCompute(function(e){var t=Object(p.e)(e,{itemsScopeItemKey:i});return e.demandItemFacet(E.t,t)});c.equalityComparer=l.t;var v=o.pureCompute(function(e){if(!a(e))return[];var t=(function(e,t){var n=t.itemSetKey,r=e.demandItemFacet(C.e,n);return A(r&&r.itemKeys)})(e,{itemSetKey:Object(d.e)(e,i)});return(function(e,t){var n=[],r=function(t){for(var i=0,s=t;i<s.length;i++){var o=s[i];if(O(e,N.s,o)){var u=e.isItemFacetResolved(C.e,o),a=O(e,N.e,o),f="number"==typeof a?a:1,l=u&&e.demandItemFacet(C.e,o);if(l)r(l.itemKeys);else for(var c=0;c<f;c++)n.push(o)}else n.push(o)}};r(t.itemKeys);return A(n)})(e,{itemKeys:t})});v.equalityComparer=l.e;var m=[],g=o.pureCompute(function(e){var t=a(e);return t?(function(e,t){var n=e.demandItemFacet(E.t,t.focusItemKey),r=t.itemKeys,i=t.fetchRadius,s=void 0===i?k:i;if(!n||!r.length)return L;for(var o=[],u=0,a=r.length;u<a;u++){var f=r[u];O(e,C.r,f)||O(e,N.s,f)?o[u]=void 0:o[u]=e.demandItemFacet(E.t,f)}var l=o.indexOf(n);if(l<0)return L;var c=Math.max(0,l-s),h=Math.min(l+s,o.length-1);for(u=c;u<=h;u++)o[u]||e.demandItemFacet(C.e,r[u]);return A(o)})(e,{itemKeys:v(),focusItemKey:t}):m});g.equalityComparer=l.e;var y=u.pureCompute(function(){var e=c&&c();return e&&e()});y.equalityComparer=l.t;var D=new b.e;D.item=y;u.compute(function(){var e=new w.e;e.items=g();D.content(e)});var P=u.create(D),H=u.create(_),B=u.pureCompute(function(){var e=c()||H,t=new b.e;t.item=e;t.isPlaceholder=!1;return t}),j=o.pureCompute(function(e){return e.demandItemFacet(M.e,i)});j.equalityComparer=l.t;var F=o.pureCompute(function(e){var t=a(e);return!!t&&Object(S.e)(e,t)});r.currentItem=y;r.focusItem=f;r.focusItemSet=P;r.viewParams=j;r.currentItemSet=B;r.isOneUp=F;return r}t.dependencies=Object(r.__assign)(Object(r.__assign)({},f.default.dependencies),{itemsScopeItemKey:m.e,itemCacheObservablesFactory:v.e,urlDataSource:g.ge});return t})(f.default),P=Object(c.s)("OneUpItemCacheDataManager_3",D),H=n(138),B=n(1351);n.d(t,"OneUpView",function(){return j});n.d(t,"typeResourceKey",function(){return F});var j=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=new a.n(t.resources);n._resources=r;n._oneUpSpecification=n._setupOneUpView();var i=r.consume(P),s=i.currentItem,o=i.focusItem,u=i.focusItemSet;r.expose(H.o,s);r.expose(H.m,o);r.expose(H.g,u);return n}t.prototype.render=function(){return i.createElement(B.e,null,i.createElement(s.e,{specification:this._oneUpSpecification,resources:this._resources}))};t.prototype._setupOneUpView=function(){return Object(o.r)(u.resourceKey,{})};return t})(i.PureComponent),F=new a.t({name:"OneUp_6",factory:new a.e(j)})}}]);